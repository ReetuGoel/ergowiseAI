/*! For license information please see main.8aa49d08.js.LICENSE.txt */
(()=>{var e={356:(e,t,n)=>{e.exports=n(9645).last},528:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler");Symbol.for("react.provider");var s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case a:case i:case o:case u:case d:case f:return e;default:switch(e=e&&e.$$typeof){case c:case l:case p:case h:case s:return e;default:return t}}case r:return t}}}t.zv=function(e){return g(e)===a}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},870:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObject=function(e){return null!==e&&("object"===typeof e||"function"===typeof e)}},1153:(e,t,n)=>{"use strict";var r=n(5043),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:u,props:o,_owner:s.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},1203:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8420);t.isArrayLike=function(e){return null!=e&&"function"!==typeof e&&r.isLength(e.length)}},1234:()=>{},1293:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4830);t.debounce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"!==typeof n&&(n={});const{leading:a=!1,trailing:o=!0,maxWait:i}=n,s=Array(2);let c;a&&(s[0]="leading"),o&&(s[1]="trailing");let l=null;const u=r.debounce(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];c=e.apply(this,n),l=null},t,{edges:s}),d=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=i&&(null===l&&(l=Date.now()),Date.now()-l>=i)?(c=e.apply(this,n),l=Date.now(),u.cancel(),u.schedule(),c):(u.apply(this,n),c)};return d.cancel=u.cancel,d.flush=()=>(u.flush(),c),d}},1444:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toPath=function(e){const t=[],n=e.length;if(0===n)return t;let r=0,a="",o="",i=!1;for(46===e.charCodeAt(0)&&(t.push(""),r++);r<n;){const s=e[r];o?"\\"===s&&r+1<n?(r++,a+=e[r]):s===o?o="":a+=s:i?'"'===s||"'"===s?o=s:"]"===s?(i=!1,t.push(a),a=""):a+=s:"["===s?(i=!0,a&&(t.push(a),a="")):"."===s?a&&(t.push(a),a=""):a+=s,r++}return a&&t.push(a),t}},2104:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1203),a=n(9921);t.isArrayLikeObject=function(e){return a.isObjectLike(e)&&r.isArrayLike(e)}},2132:(e,t,n)=>{"use strict";var r=n(2897).default;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const a=n(8268),o=n(870),i=n(4803),s=n(9972);function c(e,t,n,a){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,n,r){if(null==t)return!0;if(Array.isArray(t))return l(e,t,n,r);if(t instanceof Map)return function(e,t,n,r){if(0===t.size)return!0;if(!(e instanceof Map))return!1;for(const[a,o]of t.entries()){if(!1===n(e.get(a),o,a,e,t,r))return!1}return!0}(e,t,n,r);if(t instanceof Set)return u(e,t,n,r);const a=Object.keys(t);if(null==e)return 0===a.length;if(0===a.length)return!0;if(r&&r.has(t))return r.get(t)===e;r&&r.set(t,e);try{for(let o=0;o<a.length;o++){const s=a[o];if(!i.isPrimitive(e)&&!(s in e))return!1;if(void 0===t[s]&&void 0!==e[s])return!1;if(null===t[s]&&null!==e[s])return!1;if(!n(e[s],t[s],s,e,t,r))return!1}return!0}finally{r&&r.delete(t)}}(e,t,n,a);case"function":return Object.keys(t).length>0?c(e,r({},t),n,a):s.eq(e,t);default:return o.isObject(e)?"string"!==typeof t||""===t:s.eq(e,t)}}function l(e,t,n,r){if(0===t.length)return!0;if(!Array.isArray(e))return!1;const a=new Set;for(let o=0;o<t.length;o++){const i=t[o];let s=!1;for(let c=0;c<e.length;c++){if(a.has(c))continue;let l=!1;if(n(e[c],i,o,e,t,r)&&(l=!0),l){a.add(c),s=!0;break}}if(!s)return!1}return!0}function u(e,t,n,r){return 0===t.size||e instanceof Set&&l([...e],[...t],n,r)}t.isMatchWith=function(e,t,n){return"function"!==typeof n?a.isMatch(e,t):c(e,t,function e(t,r,a,o,i,s){const l=n(t,r,a,o,i,s);return void 0!==l?Boolean(l):c(t,r,e,s)},new Map)},t.isSetMatch=u},2204:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5316),a=n(7312),o=n(3799);t.sortBy=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const s=n.length;return s>1&&o.isIterateeCall(e,n[0],n[1])?n=[]:s>2&&o.isIterateeCall(n[0],n[1],n[2])&&(n=[n[0]]),r.orderBy(e,a.flatten(n),["asc"])}},2330:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,i=r.useEffect,s=r.useLayoutEffect,c=r.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),a=r[0].inst,u=r[1];return s(function(){a.value=n,a.getSnapshot=t,l(a)&&u({inst:a})},[e,n,t]),i(function(){return l(a)&&u({inst:a}),e(function(){l(a)&&u({inst:a})})},[e]),c(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2430:function(e,t,n){var r;!function(a,o,i){var s,c=256,l=i.pow(c,6),u=i.pow(2,52),d=2*u,h=255;function p(e,t,n){var r=[],h=y(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(o)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(c):(e=new Uint8Array(c),(a.crypto||a.msCrypto).getRandomValues(e)),v(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,v(o)]}}():e,3),r),p=new f(r),b=function(){for(var e=p.g(6),t=l,n=0;e<u;)e=(e+n)*c,t*=c,n=p.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,y(v(p.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,h,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,a=0,o=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);a<c;)i[a]=a++;for(a=0;a<c;a++)i[a]=i[o=h&o+e[a%n]+(t=i[a])],i[o]=t;(r.g=function(e){for(var t,n=0,a=r.i,o=r.j,i=r.S;e--;)t=i[a=h&a+1],n=n*c+i[h&(i[a]=i[o=h&o+t])+(i[o]=t)];return r.i=a,r.j=o,n})(c)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(g(e[n],t-1))}catch(o){}return r.length?r:"string"==a?e:e+"\0"}function y(e,t){for(var n,r=e+"",a=0;a<r.length;)t[h&a]=h&(n^=19*t[h&a])+r.charCodeAt(a++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(y(i.random(),o),e.exports){e.exports=p;try{s=n(1234)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2489:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},2682:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPlainObject=function(e){if("object"!==typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t;const n=e[Symbol.toStringTag];if(null==n)return!1;return!!(null!==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))&&void 0!==t&&t.writable)&&e.toString()==="[object ".concat(n,"]")}let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}},2715:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9599),a=n(7330),o=n(3808),i=n(8845);t.iteratee=function(e){if(null==e)return r.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&2===e.length?i.matchesProperty(e[0],e[1]):o.matches(e);case"string":case"symbol":case"number":return a.property(e)}}},2730:(e,t,n)=>{"use strict";var r=n(5043),a=n(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,a,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var F,L=Object.assign;function z(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var B=!1;function j(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),o=r.stack.split("\n"),i=a.length-1,s=o.length-1;1<=i&&0<=s&&a[i]!==o[s];)s--;for(;1<=i&&0<=s;i--,s--)if(a[i]!==o[s]){if(1!==i||1!==s)do{if(i--,0>--s||a[i]!==o[s]){var c="\n"+a[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=i&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function W(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case I:return"Profiler";case C:return"StrictMode";case O:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){Z(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function oe(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ce=null;function Ie(e){if(e=ba(e)){if("function"!==typeof ke)throw Error(o(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Ee(e){Se?Ce?Ce.push(e):Ce=[e]:Se=e}function Te(){if(Se){var e=Se,t=Ce;if(Ce=Se=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ne(e,t){return e(t)}function Oe(){}var Ae=!1;function _e(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ne(e,t,n)}finally{Ae=!1,(null!==Se||null!==Ce)&&(Oe(),Te())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Pe=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Pe=!1}function Me(e,t,n,r,a,o,i,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Fe=!1,Le=null,ze=!1,Be=null,je={onError:function(e){Fe=!0,Le=e}};function We(e,t,n,r,a,o,i,s,c){Fe=!1,Le=null,Me.apply(je,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(Ue(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Ge(a),e;if(i===r)return Ge(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,c=a.child;c;){if(c===n){s=!0,n=a,r=i;break}if(c===r){s=!0,r=a,n=i;break}c=c.sibling}if(!s){for(c=i.child;c;){if(c===n){s=!0,n=i,r=a;break}if(c===r){s=!0,r=i,n=a;break}c=c.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Ze=a.unstable_now,$e=a.unstable_getCurrentPriorityLevel,Je=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,ot=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~a;0!==s?r=dt(s):0!==(o&=i)&&(r=dt(o))}else 0!==(i=n&~a)?r=dt(i):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(o=t&-t)||16===a&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-it(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,Ct,It,Et=!1,Tt=[],Nt=null,Ot=null,At=null,_t=new Map,Rt=new Map,Pt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Ot=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Ft(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=va(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void It(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Bt(e,t,n){zt(e)&&n.delete(t)}function jt(){Et=!1,null!==Nt&&zt(Nt)&&(Nt=null),null!==Ot&&zt(Ot)&&(Ot=null),null!==At&&zt(At)&&(At=null),_t.forEach(Bt),Rt.forEach(Bt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,jt)))}function Ut(e){function t(t){return Wt(t,e)}if(0<Tt.length){Wt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Wt(Nt,e),null!==Ot&&Wt(Ot,e),null!==At&&Wt(At,e),_t.forEach(t),Rt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var Vt=x.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var a=bt,o=Vt.transition;Vt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=a,Vt.transition=o}}function Kt(e,t,n,r){var a=bt,o=Vt.transition;Vt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=a,Vt.transition=o}}function qt(e,t,n,r){if(Gt){var a=Yt(e,t,n,r);if(null===a)Gr(e,t,r,Xt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Nt=Ft(Nt,e,t,n,r,a),!0;case"dragenter":return Ot=Ft(Ot,e,t,n,r,a),!0;case"mouseover":return At=Ft(At,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return _t.set(o,Ft(_t.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Rt.set(o,Ft(Rt.get(o)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var o=ba(a);if(null!==o&&wt(o),null===(o=Yt(e,t,n,r))&&Gr(e,t,r,Xt,n),o===a)break;a=o}null!==a&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=va(e=we(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,$t=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=$t,r=n.length,a="value"in Zt?Zt.value:Zt.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[o-t];t++);return Jt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,o){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(ln),dn=L({},ln,{view:0,detail:0}),hn=an(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,sn=e.screenY-cn.screenY):sn=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=an(pn),mn=an(L({},pn,{dataTransfer:0})),gn=an(L({},dn,{relatedTarget:0})),yn=an(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(vn),xn=an(L({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function In(){return Cn}var En=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(En),Nn=an(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=an(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),An=an(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(_n),Pn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var Fn=u&&"TextEvent"in window&&!Mn,Ln=u&&(!Dn||Mn&&8<Mn&&11>=Mn),zn=String.fromCharCode(32),Bn=!1;function jn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ee(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,qn=null;function Xn(e){zr(e,0)}function Yn(e){if(q(xa(e)))return e}function Qn(e,t){if("change"===e)return t}var Zn=!1;if(u){var $n;if(u){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}$n=Jn}else $n=!1;Zn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),qn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(qn)){var t=[];Hn(t,qn,e,we(e)),_e(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(qn)}function or(e,t){if("click"===e)return Yn(t)}function ir(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=void 0===r.end?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=ur(n,o);var i=ur(n,r);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&cr(vr,r)||(vr=r,0<(r=Kr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Cr={};function Ir(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return Sr[e]=n[t];return e}u&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Er=Ir("animationend"),Tr=Ir("animationiteration"),Nr=Ir("animationstart"),Or=Ir("transitionend"),Ar=new Map,_r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Ar.set(e,t),c(t,[e])}for(var Pr=0;Pr<_r.length;Pr++){var Dr=_r[Pr];Rr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Rr(Er,"onAnimationEnd"),Rr(Tr,"onAnimationIteration"),Rr(Nr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Or,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,i,s,c,l){if(We.apply(this,arguments),Fe){if(!Fe)throw Error(o(198));var u=Le;Fe=!1,Le=null,ze||(ze=!0,Be=u)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&a.isPropagationStopped())break e;Lr(a,s,l),o=c}else for(i=0;i<r.length;i++){if(c=(s=r[i]).instance,l=s.currentTarget,s=s.listener,c!==o&&a.isPropagationStopped())break e;Lr(a,s,l),o=c}}}if(ze)throw e=Be,ze=!1,Be=null,e}function Br(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[Wr]){e[Wr]=!0,i.forEach(function(t){"selectionchange"!==t&&(Fr.has(t)||jr(t,!1,e),jr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wr]||(t[Wr]=!0,jr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Qt(t)){case 1:var a=Ht;break;case 4:a=Kt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&((c=i.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;i=i.return}for(;null!==s;){if(null===(i=va(s)))return;if(5===(c=i.tag)||6===c){r=o=i;continue e}s=s.parentNode}}r=r.return}_e(function(){var r=o,a=we(n),i=[];e:{var s=Ar.get(e);if(void 0!==s){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=Tn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=On;break;case Er:case Tr:case Nr:c=yn;break;case Or:c=An;break;case"scroll":c=hn;break;case"wheel":c=Rn;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Nn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Re(f,h))&&u.push(Hr(f,m,p)))),d)break;f=f.return}0<u.length&&(s=new c(s,l,null,n,a),i.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(l=n.relatedTarget||n.fromElement)||!va(l)&&!l[fa])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?va(l):null)&&(l!==(d=Ue(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?s:xa(c),p=null==l?s:xa(l),(s=new u(m,f+"leave",c,n,a)).target=d,s.relatedTarget=p,m=null,va(a)===r&&((u=new u(h,f+"enter",l,n,a)).target=p,u.relatedTarget=d,m=u),d=m,c&&l)e:{for(h=l,f=0,p=u=c;p;p=qr(p))f++;for(p=0,m=h;m;m=qr(m))p++;for(;0<f-p;)u=qr(u),f--;for(;0<p-f;)h=qr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=qr(u),h=qr(h)}u=null}else u=null;null!==c&&Xr(i,s,c,u,!1),null!==l&&null!==d&&Xr(i,d,l,u,!0)}if("select"===(c=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var g=Qn;else if(Gn(s))if(Zn)g=ir;else{g=ar;var y=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Hn(i,g,n,a):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?xa(r):window,e){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(i,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(i,n,a)}var v;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?jn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(v=en()):($t="value"in(Zt=a)?Zt.value:Zt.textContent,Un=!0)),0<(y=Kr(r,b)).length&&(b=new xn(b,e,null,n,a),i.push({event:b,listeners:y}),v?b.data=v:null!==(v=Wn(n))&&(b.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,zn);case"textInput":return(e=t.data)===zn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Dn&&jn(e,t)?(e=en(),Jt=$t=Zt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),i.push({event:a,listeners:r}),a.data=v))}zr(i,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Re(e,n))&&r.unshift(Hr(e,o,a)),null!=(o=Re(e,t))&&r.push(Hr(e,o,a))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var o=t._reactName,i=[];null!==n&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==l&&(s=l,a?null!=(c=Re(n,o))&&i.unshift(Hr(n,c,s)):a||null!=(c=Re(n,o))&&i.push(Hr(n,c,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Zr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function $r(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(o(425))}function Jr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout(function(){throw e})}function ca(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function la(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),ha="__reactFiber$"+da,pa="__reactProps$"+da,fa="__reactContainer$"+da,ma="__reactEvents$"+da,ga="__reactListeners$"+da,ya="__reactHandles$"+da;function va(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[ha])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wa(e){return e[pa]||null}var ka=[],Sa=-1;function Ca(e){return{current:e}}function Ia(e){0>Sa||(e.current=ka[Sa],ka[Sa]=null,Sa--)}function Ea(e,t){Sa++,ka[Sa]=e.current,e.current=t}var Ta={},Na=Ca(Ta),Oa=Ca(!1),Aa=Ta;function _a(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){Ia(Oa),Ia(Na)}function Da(e,t,n){if(Na.current!==Ta)throw Error(o(168));Ea(Na,t),Ea(Oa,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(o(108,V(e)||"Unknown",a));return L({},n,r)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Aa=Na.current,Ea(Na,e),Ea(Oa,Oa.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Ma(e,t,Aa),r.__reactInternalMemoizedMergedChildContext=e,Ia(Oa),Ia(Na),Ea(Na,e)):Ia(Oa),Ea(Oa,n)}var za=null,Ba=!1,ja=!1;function Wa(e){null===za?za=[e]:za.push(e)}function Ua(){if(!ja&&null!==za){ja=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,Ba=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),qe(Je,Ua),a}finally{bt=t,ja=!1}}return null}var Va=[],Ga=0,Ha=null,Ka=0,qa=[],Xa=0,Ya=null,Qa=1,Za="";function $a(e,t){Va[Ga++]=Ka,Va[Ga++]=Ha,Ha=e,Ka=t}function Ja(e,t,n){qa[Xa++]=Qa,qa[Xa++]=Za,qa[Xa++]=Ya,Ya=e;var r=Qa;e=Za;var a=32-it(r)-1;r&=~(1<<a),n+=1;var o=32-it(t)+a;if(30<o){var i=a-a%5;o=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Qa=1<<32-it(t)+a|n<<a|r,Za=o+e}else Qa=1<<o|n<<a|r,Za=e}function eo(e){null!==e.return&&($a(e,1),Ja(e,1,0))}function to(e){for(;e===Ha;)Ha=Va[--Ga],Va[Ga]=null,Ka=Va[--Ga],Va[Ga]=null;for(;e===Ya;)Ya=qa[--Xa],qa[Xa]=null,Za=qa[--Xa],qa[Xa]=null,Qa=qa[--Xa],qa[Xa]=null}var no=null,ro=null,ao=!1,oo=null;function io(e,t){var n=Rl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=la(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Qa,overflow:Za}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(ao){var t=ro;if(t){var n=t;if(!so(e,t)){if(co(e))throw Error(o(418));t=la(n.nextSibling);var r=no;t&&so(e,t)?io(r,n):(e.flags=-4097&e.flags|2,ao=!1,no=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,ao=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!ao)return uo(e),ao=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ro)){if(co(e))throw po(),Error(o(418));for(;t;)io(e,t),t=la(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=la(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?la(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=la(e.nextSibling)}function fo(){ro=no=null,ao=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function yo(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vo=Ca(null),bo=null,xo=null,wo=null;function ko(){wo=xo=bo=null}function So(e){var t=vo.current;Ia(vo),e._currentValue=t}function Co(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Io(e,t){bo=e,wo=xo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Eo(e){var t=e._currentValue;if(wo!==e)if(e={context:e,memoizedValue:t,next:null},null===xo){if(null===bo)throw Error(o(308));xo=e,bo.dependencies={lanes:0,firstContext:e}}else xo=xo.next=e;return t}var To=null;function No(e){null===To?To=[e]:To.push(e)}function Oo(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,No(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ao(e,r)}function Ao(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var _o=!1;function Ro(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Po(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Do(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Oc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ao(e,n)}return null===(a=r.interleaved)?(t.next=t,No(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ao(e,n)}function Fo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Lo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zo(e,t,n,r){var a=e.updateQueue;_o=!1;var o=a.firstBaseUpdate,i=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,l=c.next;c.next=null,null===i?o=l:i.next=l,i=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=a.baseState;for(i=0,u=l=c=null,s=o;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=L({},d,h);break e;case 2:_o=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,i|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===u&&(c=d),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===o&&(a.shared.lanes=0);Lc|=i,e.lanes=i,e.memoizedState=d}}function Bo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var jo=(new r.Component).refs;function Wo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Uo={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),a=nl(e),o=Do(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Mo(e,o,a))&&(rl(t,e,a,r),Fo(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),a=nl(e),o=Do(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Mo(e,o,a))&&(rl(t,e,a,r),Fo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),a=Do(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Mo(e,a,r))&&(rl(t,e,r,n),Fo(t,e,r))}};function Vo(e,t,n,r,a,o,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,o))}function Go(e,t,n){var r=!1,a=Ta,o=t.contextType;return"object"===typeof o&&null!==o?o=Eo(o):(a=Ra(t)?Aa:Na.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?_a(e,a):Ta),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Uo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ho(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Uo.enqueueReplaceState(t,t.state,null)}function Ko(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=jo,Ro(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=Eo(o):(o=Ra(t)?Aa:Na.current,a.context=_a(e,o)),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Wo(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Uo.enqueueReplaceState(a,a.state,null),zo(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function qo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=a.refs;t===jo&&(t=a.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Xo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yo(e){return(0,e._init)(e._payload)}function Qo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dl(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=zl(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===R&&Yo(o)===t.type)?((r=a(t,n.props)).ref=qo(e,t,n),r.return=e,r):((r=Ml(n.type,n.key,n.props,null,e.mode,r)).ref=qo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bl(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Fl(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=zl(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Ml(t.type,t.key,t.props,null,e.mode,n)).ref=qo(e,null,t),n.return=e,n;case k:return(t=Bl(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Fl(t,e.mode,n,null)).return=e,t;Xo(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?l(e,t,n,r):null;case k:return n.key===a?u(e,t,n,r):null;case R:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||M(n))return null!==a?null:d(e,t,n,r,null);Xo(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case R:return f(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,a,null);Xo(t,r)}return null}function m(a,o,s,c){for(var l=null,u=null,d=o,m=o=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(a,d,s[m],c);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(a,d),o=i(y,o,m),null===u?l=y:u.sibling=y,u=y,d=g}if(m===s.length)return n(a,d),ao&&$a(a,m),l;if(null===d){for(;m<s.length;m++)null!==(d=h(a,s[m],c))&&(o=i(d,o,m),null===u?l=d:u.sibling=d,u=d);return ao&&$a(a,m),l}for(d=r(a,d);m<s.length;m++)null!==(g=f(d,a,m,s[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=i(g,o,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(a,e)}),ao&&$a(a,m),l}function g(a,s,c,l){var u=M(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var d=u=null,m=s,g=s=0,y=null,v=c.next();null!==m&&!v.done;g++,v=c.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=p(a,m,v.value,l);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(a,m),s=i(b,s,g),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(a,m),ao&&$a(a,g),u;if(null===m){for(;!v.done;g++,v=c.next())null!==(v=h(a,v.value,l))&&(s=i(v,s,g),null===d?u=v:d.sibling=v,d=v);return ao&&$a(a,g),u}for(m=r(a,m);!v.done;g++,v=c.next())null!==(v=f(m,a,g,v.value,l))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=i(v,s,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(a,e)}),ao&&$a(a,g),u}return function e(r,o,i,c){if("object"===typeof i&&null!==i&&i.type===S&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var l=i.key,u=o;null!==u;){if(u.key===l){if((l=i.type)===S){if(7===u.tag){n(r,u.sibling),(o=a(u,i.props.children)).return=r,r=o;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===R&&Yo(l)===u.type){n(r,u.sibling),(o=a(u,i.props)).ref=qo(r,u,i),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===S?((o=Fl(i.props.children,r.mode,c,i.key)).return=r,r=o):((c=Ml(i.type,i.key,i.props,null,r.mode,c)).ref=qo(r,o,i),c.return=r,r=c)}return s(r);case k:e:{for(u=i.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===i.containerInfo&&o.stateNode.implementation===i.implementation){n(r,o.sibling),(o=a(o,i.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Bl(i,r.mode,c)).return=r,r=o}return s(r);case R:return e(r,o,(u=i._init)(i._payload),c)}if(te(i))return m(r,o,i,c);if(M(i))return g(r,o,i,c);Xo(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==o&&6===o.tag?(n(r,o.sibling),(o=a(o,i)).return=r,r=o):(n(r,o),(o=zl(i,r.mode,c)).return=r,r=o),s(r)):n(r,o)}}var Zo=Qo(!0),$o=Qo(!1),Jo={},ei=Ca(Jo),ti=Ca(Jo),ni=Ca(Jo);function ri(e){if(e===Jo)throw Error(o(174));return e}function ai(e,t){switch(Ea(ni,t),Ea(ti,e),Ea(ei,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ia(ei),Ea(ei,t)}function oi(){Ia(ei),Ia(ti),Ia(ni)}function ii(e){ri(ni.current);var t=ri(ei.current),n=ce(t,e.type);t!==n&&(Ea(ti,e),Ea(ei,n))}function si(e){ti.current===e&&(Ia(ei),Ia(ti))}var ci=Ca(0);function li(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ui=[];function di(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var hi=x.ReactCurrentDispatcher,pi=x.ReactCurrentBatchConfig,fi=0,mi=null,gi=null,yi=null,vi=!1,bi=!1,xi=0,wi=0;function ki(){throw Error(o(321))}function Si(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Ci(e,t,n,r,a,i){if(fi=i,mi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hi.current=null===e||null===e.memoizedState?ss:cs,e=n(r,a),bi){i=0;do{if(bi=!1,xi=0,25<=i)throw Error(o(301));i+=1,yi=gi=null,t.updateQueue=null,hi.current=ls,e=n(r,a)}while(bi)}if(hi.current=is,t=null!==gi&&null!==gi.next,fi=0,yi=gi=mi=null,vi=!1,t)throw Error(o(300));return e}function Ii(){var e=0!==xi;return xi=0,e}function Ei(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yi?mi.memoizedState=yi=e:yi=yi.next=e,yi}function Ti(){if(null===gi){var e=mi.alternate;e=null!==e?e.memoizedState:null}else e=gi.next;var t=null===yi?mi.memoizedState:yi.next;if(null!==t)yi=t,gi=e;else{if(null===e)throw Error(o(310));e={memoizedState:(gi=e).memoizedState,baseState:gi.baseState,baseQueue:gi.baseQueue,queue:gi.queue,next:null},null===yi?mi.memoizedState=yi=e:yi=yi.next=e}return yi}function Ni(e,t){return"function"===typeof t?t(e):t}function Oi(e){var t=Ti(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=gi,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(null!==a){i=a.next,r=r.baseState;var c=s=null,l=null,u=i;do{var d=u.lane;if((fi&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,s=r):l=l.next=h,mi.lanes|=d,Lc|=d}u=u.next}while(null!==u&&u!==i);null===l?s=r:l.next=c,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{i=a.lane,mi.lanes|=i,Lc|=i,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ai(e){var t=Ti(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);sr(i,t.memoizedState)||(xs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function _i(){}function Ri(e,t){var n=mi,r=Ti(),a=t(),i=!sr(r.memoizedState,a);if(i&&(r.memoizedState=a,xs=!0),r=r.queue,Gi(Mi.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==yi&&1&yi.memoizedState.tag){if(n.flags|=2048,Bi(9,Di.bind(null,n,r,a,t),void 0,null),null===Ac)throw Error(o(349));0!==(30&fi)||Pi(n,t,a)}return a}function Pi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=mi.updateQueue)?(t={lastEffect:null,stores:null},mi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Di(e,t,n,r){t.value=n,t.getSnapshot=r,Fi(t)&&Li(e)}function Mi(e,t,n){return n(function(){Fi(t)&&Li(e)})}function Fi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Li(e){var t=Ao(e,1);null!==t&&rl(t,e,1,-1)}function zi(e){var t=Ei();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,mi,e),[t.memoizedState,e]}function Bi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=mi.updateQueue)?(t={lastEffect:null,stores:null},mi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ji(){return Ti().memoizedState}function Wi(e,t,n,r){var a=Ei();mi.flags|=e,a.memoizedState=Bi(1|t,n,void 0,void 0===r?null:r)}function Ui(e,t,n,r){var a=Ti();r=void 0===r?null:r;var o=void 0;if(null!==gi){var i=gi.memoizedState;if(o=i.destroy,null!==r&&Si(r,i.deps))return void(a.memoizedState=Bi(t,n,o,r))}mi.flags|=e,a.memoizedState=Bi(1|t,n,o,r)}function Vi(e,t){return Wi(8390656,8,e,t)}function Gi(e,t){return Ui(2048,8,e,t)}function Hi(e,t){return Ui(4,2,e,t)}function Ki(e,t){return Ui(4,4,e,t)}function qi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ui(4,4,qi.bind(null,t,e),n)}function Yi(){}function Qi(e,t){var n=Ti();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Si(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Zi(e,t){var n=Ti();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Si(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $i(e,t,n){return 0===(21&fi)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),mi.lanes|=n,Lc|=n,e.baseState=!0),t)}function Ji(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=pi.transition;pi.transition={};try{e(!1),t()}finally{bt=n,pi.transition=r}}function es(){return Ti().memoizedState}function ts(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Oo(e,t,n,r))){rl(n,e,r,tl()),os(n,t,r)}}function ns(e,t,n){var r=nl(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=o(i,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,i)){var c=t.interleaved;return null===c?(a.next=a,No(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(l){}null!==(n=Oo(e,t,a,r))&&(rl(n,e,r,a=tl()),os(n,t,r))}}function rs(e){var t=e.alternate;return e===mi||null!==t&&t===mi}function as(e,t){bi=vi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function os(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var is={readContext:Eo,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},ss={readContext:Eo,useCallback:function(e,t){return Ei().memoizedState=[e,void 0===t?null:t],e},useContext:Eo,useEffect:Vi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wi(4194308,4,qi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wi(4,2,e,t)},useMemo:function(e,t){var n=Ei();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ei();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,mi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ei().memoizedState=e},useState:zi,useDebugValue:Yi,useDeferredValue:function(e){return Ei().memoizedState=e},useTransition:function(){var e=zi(!1),t=e[0];return e=Ji.bind(null,e[1]),Ei().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=mi,a=Ei();if(ao){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Ac)throw Error(o(349));0!==(30&fi)||Pi(r,t,n)}a.memoizedState=n;var i={value:n,getSnapshot:t};return a.queue=i,Vi(Mi.bind(null,r,i,e),[e]),r.flags|=2048,Bi(9,Di.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Ei(),t=Ac.identifierPrefix;if(ao){var n=Za;t=":"+t+"R"+(n=(Qa&~(1<<32-it(Qa)-1)).toString(32)+n),0<(n=xi++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cs={readContext:Eo,useCallback:Qi,useContext:Eo,useEffect:Gi,useImperativeHandle:Xi,useInsertionEffect:Hi,useLayoutEffect:Ki,useMemo:Zi,useReducer:Oi,useRef:ji,useState:function(){return Oi(Ni)},useDebugValue:Yi,useDeferredValue:function(e){return $i(Ti(),gi.memoizedState,e)},useTransition:function(){return[Oi(Ni)[0],Ti().memoizedState]},useMutableSource:_i,useSyncExternalStore:Ri,useId:es,unstable_isNewReconciler:!1},ls={readContext:Eo,useCallback:Qi,useContext:Eo,useEffect:Gi,useImperativeHandle:Xi,useInsertionEffect:Hi,useLayoutEffect:Ki,useMemo:Zi,useReducer:Ai,useRef:ji,useState:function(){return Ai(Ni)},useDebugValue:Yi,useDeferredValue:function(e){var t=Ti();return null===gi?t.memoizedState=e:$i(t,gi.memoizedState,e)},useTransition:function(){return[Ai(Ni)[0],Ti().memoizedState]},useMutableSource:_i,useSyncExternalStore:Ri,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var n="",r=t;do{n+=W(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ps="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Do(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hc||(Hc=!0,Kc=r),hs(0,t)},n}function ms(e,t,n){(n=Do(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===qc?qc=new Set([this]):qc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=El.bind(null,e,t,n),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Do(-1,1)).tag=2,Mo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?$o(t,null,n,r):Zo(t,e.child,n,r)}function ks(e,t,n,r,a){n=n.render;var o=t.ref;return Io(t,a),r=Ci(e,t,n,r,o,a),n=Ii(),null===e||xs?(ao&&n&&eo(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var o=n.type;return"function"!==typeof o||Pl(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ml(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cs(e,t,o,r,a))}if(o=e.child,0===(e.lanes&a)){var i=o.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(i,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Dl(o,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,a){if(null!==e){var o=e.memoizedProps;if(cr(o,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=o,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return Ts(e,t,n,r,a)}function Is(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ea(Dc,Pc),Pc|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ea(Dc,Pc),Pc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Ea(Dc,Pc),Pc|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ea(Dc,Pc),Pc|=r;return ws(e,t,a,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,r,a){var o=Ra(n)?Aa:Na.current;return o=_a(t,o),Io(t,a),n=Ci(e,t,n,r,o,a),r=Ii(),null===e||xs?(ao&&r&&eo(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Ns(e,t,n,r,a){if(Ra(n)){var o=!0;Fa(t)}else o=!1;if(Io(t,a),null===t.stateNode)Gs(e,t),Go(t,n,r),Ko(t,n,r,a),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var c=i.context,l=n.contextType;"object"===typeof l&&null!==l?l=Eo(l):l=_a(t,l=Ra(n)?Aa:Na.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==r||c!==l)&&Ho(t,i,r,l),_o=!1;var h=t.memoizedState;i.state=h,zo(t,r,i,a),c=t.memoizedState,s!==r||h!==c||Oa.current||_o?("function"===typeof u&&(Wo(t,n,u,r),c=t.memoizedState),(s=_o||Vo(t,n,s,r,h,c,l))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=l,r=s):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Po(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:yo(t.type,s),i.props=l,d=t.pendingProps,h=i.context,"object"===typeof(c=n.contextType)&&null!==c?c=Eo(c):c=_a(t,c=Ra(n)?Aa:Na.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||h!==c)&&Ho(t,i,r,c),_o=!1,h=t.memoizedState,i.state=h,zo(t,r,i,a);var f=t.memoizedState;s!==d||h!==f||Oa.current||_o?("function"===typeof p&&(Wo(t,n,p,r),f=t.memoizedState),(l=_o||Vo(t,n,l,r,h,f,c)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,c),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=c,r=l):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Os(e,t,n,r,o,a)}function Os(e,t,n,r,a,o){Es(e,t);var i=0!==(128&t.flags);if(!r&&!i)return a&&La(t,n,!1),Hs(e,t,o);r=t.stateNode,bs.current=t;var s=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=Zo(t,e.child,null,o),t.child=Zo(t,null,s,o)):ws(e,t,s,o),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Da(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Da(0,t.context,!1),ai(e,t.containerInfo)}function _s(e,t,n,r,a){return fo(),mo(a),t.flags|=256,ws(e,t,n,r),t.child}var Rs,Ps,Ds,Ms,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function zs(e,t,n){var r,a=t.pendingProps,i=ci.current,s=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ea(ci,1&i),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,s?(a=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Ll(c,a,0,null),e=Fl(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Fs,e):Bs(t,c));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,a,i,s){if(n)return 256&t.flags?(t.flags&=-257,js(e,t,s,r=ds(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,a=t.mode,r=Ll({mode:"visible",children:r.children},a,0,null),(i=Fl(i,a,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&Zo(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Fs,i);if(0===(1&t.mode))return js(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,js(e,t,s,r=ds(i=Error(o(419)),r,void 0))}if(c=0!==(s&e.childLanes),xs||c){if(null!==(r=Ac)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==i.retryLane&&(i.retryLane=a,Ao(e,a),rl(r,e,a,-1))}return gl(),js(e,t,s,r=ds(Error(o(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Nl.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ro=la(a.nextSibling),no=t,ao=!0,oo=null,null!==e&&(qa[Xa++]=Qa,qa[Xa++]=Za,qa[Xa++]=Ya,Qa=e.id,Za=e.overflow,Ya=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,c,a,r,i,n);if(s){s=a.fallback,c=t.mode,r=(i=e.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==i?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=Dl(i,l)).subtreeFlags=14680064&i.subtreeFlags,null!==r?s=Dl(r,s):(s=Fl(s,c,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,c=null===(c=e.child.memoizedState)?Ls(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=Fs,a}return e=(s=e.child).sibling,a=Dl(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function js(e,t,n,r){return null!==r&&mo(r),Zo(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ws(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Co(e.return,t,n)}function Us(e,t,n,r,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function Vs(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=ci.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ws(e,n,t);else if(19===e.tag)Ws(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ea(ci,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===li(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Us(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===li(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Us(t,!0,n,null,o);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Dl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){if(!ao)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Ra(t.type)&&Pa(),qs(t),null;case 3:return r=t.stateNode,oi(),Ia(Oa),Ia(Na),di(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sl(oo),oo=null))),Ps(e,t),qs(t),null;case 5:si(t);var a=ri(ni.current);if(n=t.type,null!==e&&null!=t.stateNode)Ds(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qs(t),null}if(e=ri(ei.current),ho(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[ha]=t,r[pa]=i,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)Br(Mr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,i),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Br("invalid",r);break;case"textarea":ae(r,i),Br("invalid",r)}for(var c in ve(n,i),a=null,i)if(i.hasOwnProperty(c)){var l=i[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==i.suppressHydrationWarning&&$r(r.textContent,l,e),a=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==i.suppressHydrationWarning&&$r(r.textContent,l,e),a=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":K(r),J(r,i,!0);break;case"textarea":K(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Jr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[ha]=t,e[pa]=r,Rs(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)Br(Mr[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Q(e,r),a=Y(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(i in ve(n,a),l=a)if(l.hasOwnProperty(i)){var u=l[i];"style"===i?ge(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Br("scroll",e):null!=u&&b(e,i,u,c))}switch(n){case"input":K(e),J(e,r,!1);break;case"textarea":K(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ms(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=ri(ni.current),ri(ei.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(i=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return qs(t),null;case 13:if(Ia(ci),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ao&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,i=!1;else if(i=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(o(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(o(317));i[ha]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),i=!1}else null!==oo&&(sl(oo),oo=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ci.current)?0===Mc&&(Mc=3):gl())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return oi(),Ps(e,t),null===e&&Ur(t.stateNode.containerInfo),qs(t),null;case 10:return So(t.type._context),qs(t),null;case 19:if(Ia(ci),null===(i=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(c=i.rendering))if(r)Ks(i,!1);else{if(0!==Mc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=li(e))){for(t.flags|=128,Ks(i,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(c=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,e=c.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ea(ci,1&ci.current|2),t.child}e=e.sibling}null!==i.tail&&Ze()>Vc&&(t.flags|=128,r=!0,Ks(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=li(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ks(i,!0),null===i.tail&&"hidden"===i.tailMode&&!c.alternate&&!ao)return qs(t),null}else 2*Ze()-i.renderingStartTime>Vc&&1073741824!==n&&(t.flags|=128,r=!0,Ks(i,!1),t.lanes=4194304);i.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=i.last)?n.sibling=c:t.child=c,i.last=c)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ze(),t.sibling=null,n=ci.current,Ea(ci,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pc)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ys(e,t){switch(to(t),t.tag){case 1:return Ra(t.type)&&Pa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return oi(),Ia(Oa),Ia(Na),di(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return si(t),null;case 13:if(Ia(ci),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ia(ci),null;case 4:return oi(),null;case 10:return So(t.type._context),null;case 22:case 23:return hl(),null;default:return null}}Rs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Ds=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ri(ei.current);var o,i=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),i=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),i=[];break;case"textarea":a=re(e,a),r=re(e,r),i=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(u in ve(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(i=i||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(i=i||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Br("scroll",e),i||c===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qs=!1,Zs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Js=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Il(e,t,r)}else n.current=null}function tc(e,t,n){try{n()}catch(r){Il(e,t,r)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,void 0!==o&&tc(t,n,o)}a=a.next}while(a!==r)}}function ac(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function oc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ic(e){var t=e.alternate;null!==t&&(e.alternate=null,ic(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[ma],delete t[ga],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var dc=null,hc=!1;function pc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Zs||ec(n,t);case 6:var r=dc,a=hc;dc=null,pc(e,t,n),hc=a,null!==(dc=r)&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(hc?(e=dc,n=n.stateNode,8===e.nodeType?ca(e.parentNode,n):1===e.nodeType&&ca(e,n),Ut(e)):ca(dc,n.stateNode));break;case 4:r=dc,a=hc,dc=n.stateNode.containerInfo,hc=!0,pc(e,t,n),dc=r,hc=a;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var o=a,i=o.destroy;o=o.tag,void 0!==i&&(0!==(2&o)||0!==(4&o))&&tc(n,t,i),a=a.next}while(a!==r)}pc(e,t,n);break;case 1:if(!Zs&&(ec(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Il(n,t,s)}pc(e,t,n);break;case 21:pc(e,t,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,pc(e,t,n),Zs=r):pc(e,t,n);break;default:pc(e,t,n)}}function mc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach(function(t){var r=Ol.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var i=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,hc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,hc=!0;break e}c=c.return}if(null===dc)throw Error(o(160));fc(i,s,a),dc=null,hc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){Il(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yc(t,e),t=t.sibling}function yc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),vc(e),4&r){try{rc(3,e,e.return),ac(3,e)}catch(g){Il(e,e.return,g)}try{rc(5,e,e.return)}catch(g){Il(e,e.return,g)}}break;case 1:gc(t,e),vc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(gc(t,e),vc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(g){Il(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===i.type&&null!=i.name&&Z(a,i),be(c,s);var u=be(c,i);for(s=0;s<l.length;s+=2){var d=l[s],h=l[s+1];"style"===d?ge(a,h):"dangerouslySetInnerHTML"===d?de(a,h):"children"===d?he(a,h):b(a,d,h,u)}switch(c){case"input":$(a,i);break;case"textarea":oe(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(a,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(a,!!i.multiple,i.defaultValue,!0):ne(a,!!i.multiple,i.multiple?[]:"",!1))}a[pa]=i}catch(g){Il(e,e.return,g)}}break;case 6:if(gc(t,e),vc(e),4&r){if(null===e.stateNode)throw Error(o(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Il(e,e.return,g)}}break;case 3:if(gc(t,e),vc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Il(e,e.return,g)}break;case 4:default:gc(t,e),vc(e);break;case 13:gc(t,e),vc(e),8192&(a=e.child).flags&&(i=null!==a.memoizedState,a.stateNode.isHidden=i,!i||null!==a.alternate&&null!==a.alternate.memoizedState||(Uc=Ze())),4&r&&mc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Zs=(u=Zs)||d,gc(t,e),Zs=u):gc(t,e),vc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Js=e,d=e.child;null!==d;){for(h=Js=d;null!==Js;){switch(f=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:rc(4,p,p.return);break;case 1:ec(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Il(r,n,g)}}break;case 5:ec(p,p.return);break;case 22:if(null!==p.memoizedState){kc(h);continue}}null!==f?(f.return=p,Js=f):kc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,u?"function"===typeof(i=a.style).setProperty?i.setProperty("display","none","important"):i.display="none":(c=h.stateNode,s=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",s))}catch(g){Il(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Il(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gc(t,e),vc(e),4&r&&mc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sc(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),uc(e,cc(e),a);break;case 3:case 4:var i=r.stateNode.containerInfo;lc(e,cc(e),i);break;default:throw Error(o(161))}}catch(s){Il(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,n){Js=e,xc(e,t,n)}function xc(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var a=Js,o=a.child;if(22===a.tag&&r){var i=null!==a.memoizedState||Qs;if(!i){var s=a.alternate,c=null!==s&&null!==s.memoizedState||Zs;s=Qs;var l=Zs;if(Qs=i,(Zs=c)&&!l)for(Js=a;null!==Js;)c=(i=Js).child,22===i.tag&&null!==i.memoizedState?Sc(a):null!==c?(c.return=i,Js=c):Sc(a);for(;null!==o;)Js=o,xc(o,t,n),o=o.sibling;Js=a,Qs=s,Zs=l}wc(e)}else 0!==(8772&a.subtreeFlags)&&null!==o?(o.return=a,Js=o):wc(e)}}function wc(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Zs||ac(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Zs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:yo(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Bo(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bo(t,s,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ut(h)}}}break;default:throw Error(o(163))}Zs||512&t.flags&&oc(t)}catch(p){Il(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function kc(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function Sc(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ac(4,t)}catch(c){Il(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(c){Il(t,a,c)}}var o=t.return;try{oc(t)}catch(c){Il(t,o,c)}break;case 5:var i=t.return;try{oc(t)}catch(c){Il(t,i,c)}}}catch(c){Il(t,t.return,c)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Cc,Ic=Math.ceil,Ec=x.ReactCurrentDispatcher,Tc=x.ReactCurrentOwner,Nc=x.ReactCurrentBatchConfig,Oc=0,Ac=null,_c=null,Rc=0,Pc=0,Dc=Ca(0),Mc=0,Fc=null,Lc=0,zc=0,Bc=0,jc=null,Wc=null,Uc=0,Vc=1/0,Gc=null,Hc=!1,Kc=null,qc=null,Xc=!1,Yc=null,Qc=0,Zc=0,$c=null,Jc=-1,el=0;function tl(){return 0!==(6&Oc)?Ze():-1!==Jc?Jc:Jc=Ze()}function nl(e){return 0===(1&e.mode)?1:0!==(2&Oc)&&0!==Rc?Rc&-Rc:null!==go.transition?(0===el&&(el=mt()),el):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function rl(e,t,n,r){if(50<Zc)throw Zc=0,$c=null,Error(o(185));yt(e,n,r),0!==(2&Oc)&&e===Ac||(e===Ac&&(0===(2&Oc)&&(zc|=n),4===Mc&&cl(e,Rc)),al(e,r),1===n&&0===Oc&&0===(1&t.mode)&&(Vc=Ze()+500,Ba&&Ua()))}function al(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-it(o),s=1<<i,c=a[i];-1===c?0!==(s&n)&&0===(s&r)||(a[i]=pt(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ht(e,e===Ac?Rc:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,Wa(e)}(ll.bind(null,e)):Wa(ll.bind(null,e)),ia(function(){0===(6&Oc)&&Ua()}),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Al(n,ol.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ol(e,t){if(Jc=-1,el=0,0!==(6&Oc))throw Error(o(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var r=ht(e,e===Ac?Rc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yl(e,r);else{t=r;var a=Oc;Oc|=2;var i=ml();for(Ac===e&&Rc===t||(Gc=null,Vc=Ze()+500,pl(e,t));;)try{bl();break}catch(c){fl(e,c)}ko(),Ec.current=i,Oc=a,null!==_c?t=0:(Ac=null,Rc=0,t=Mc)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=il(e,a))),1===t)throw n=Fc,pl(e,0),cl(e,r),al(e,Ze()),n;if(6===t)cl(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!sr(o(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=yl(e,r))&&(0!==(i=ft(e))&&(r=i,t=il(e,i))),1===t))throw n=Fc,pl(e,0),cl(e,r),al(e,Ze()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:kl(e,Wc,Gc);break;case 3:if(cl(e,r),(130023424&r)===r&&10<(t=Uc+500-Ze())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(kl.bind(null,e,Wc,Gc),t);break}kl(e,Wc,Gc);break;case 4:if(cl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-it(r);i=1<<s,(s=t[s])>a&&(a=s),r&=~i}if(r=a,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ic(r/1960))-r)){e.timeoutHandle=ra(kl.bind(null,e,Wc,Gc),r);break}kl(e,Wc,Gc);break;default:throw Error(o(329))}}}return al(e,Ze()),e.callbackNode===n?ol.bind(null,e):null}function il(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(pl(e,t).flags|=256),2!==(e=yl(e,t))&&(t=Wc,Wc=n,null!==t&&sl(t)),e}function sl(e){null===Wc?Wc=e:Wc.push.apply(Wc,e)}function cl(e,t){for(t&=~Bc,t&=~zc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(0!==(6&Oc))throw Error(o(327));Sl();var t=ht(e,0);if(0===(1&t))return al(e,Ze()),null;var n=yl(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=il(e,r))}if(1===n)throw n=Fc,pl(e,0),cl(e,t),al(e,Ze()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kl(e,Wc,Gc),al(e,Ze()),null}function ul(e,t){var n=Oc;Oc|=1;try{return e(t)}finally{0===(Oc=n)&&(Vc=Ze()+500,Ba&&Ua())}}function dl(e){null!==Yc&&0===Yc.tag&&0===(6&Oc)&&Sl();var t=Oc;Oc|=1;var n=Nc.transition,r=bt;try{if(Nc.transition=null,bt=1,e)return e()}finally{bt=r,Nc.transition=n,0===(6&(Oc=t))&&Ua()}}function hl(){Pc=Dc.current,Ia(Dc)}function pl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==_c)for(n=_c.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pa();break;case 3:oi(),Ia(Oa),Ia(Na),di();break;case 5:si(r);break;case 4:oi();break;case 13:case 19:Ia(ci);break;case 10:So(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Ac=e,_c=e=Dl(e.current,null),Rc=Pc=t,Mc=0,Fc=null,Bc=zc=Lc=0,Wc=jc=null,null!==To){for(t=0;t<To.length;t++)if(null!==(r=(n=To[t]).interleaved)){n.interleaved=null;var a=r.next,o=n.pending;if(null!==o){var i=o.next;o.next=a,r.next=i}n.pending=r}To=null}return e}function fl(e,t){for(;;){var n=_c;try{if(ko(),hi.current=is,vi){for(var r=mi.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}vi=!1}if(fi=0,yi=gi=mi=null,bi=!1,xi=0,Tc.current=null,null===n||null===n.return){Mc=1,Fc=t,_c=null;break}e:{var i=e,s=n.return,c=n,l=t;if(t=Rc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ys(s);if(null!==f){f.flags&=-257,vs(f,s,c,0,t),1&f.mode&&gs(i,u,t),l=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){gs(i,u,t),gl();break e}l=Error(o(426))}else if(ao&&1&c.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),vs(y,s,c,0,t),mo(us(l,c));break e}}i=l=us(l,c),4!==Mc&&(Mc=2),null===jc?jc=[i]:jc.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Lo(i,fs(0,l,t));break e;case 1:c=l;var v=i.type,b=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qc||!qc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Lo(i,ms(i,c,t));break e}}i=i.return}while(null!==i)}wl(n)}catch(x){t=x,_c===n&&null!==n&&(_c=n=n.return);continue}break}}function ml(){var e=Ec.current;return Ec.current=is,null===e?is:e}function gl(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Ac||0===(268435455&Lc)&&0===(268435455&zc)||cl(Ac,Rc)}function yl(e,t){var n=Oc;Oc|=2;var r=ml();for(Ac===e&&Rc===t||(Gc=null,pl(e,t));;)try{vl();break}catch(a){fl(e,a)}if(ko(),Oc=n,Ec.current=r,null!==_c)throw Error(o(261));return Ac=null,Rc=0,Mc}function vl(){for(;null!==_c;)xl(_c)}function bl(){for(;null!==_c&&!Ye();)xl(_c)}function xl(e){var t=Cc(e.alternate,e,Pc);e.memoizedProps=e.pendingProps,null===t?wl(e):_c=t,Tc.current=null}function wl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Pc)))return void(_c=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(_c=n);if(null===e)return Mc=6,void(_c=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(_c=t);_c=t=e}while(null!==t);0===Mc&&(Mc=5)}function kl(e,t,n){var r=bt,a=Nc.transition;try{Nc.transition=null,bt=1,function(e,t,n,r){do{Sl()}while(null!==Yc);if(0!==(6&Oc))throw Error(o(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-it(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}(e,i),e===Ac&&(_c=Ac=null,Rc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xc||(Xc=!0,Al(tt,function(){return Sl(),null})),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Nc.transition,Nc.transition=null;var s=bt;bt=1;var c=Oc;Oc|=4,Tc.current=null,function(e,t){if(ea=Gt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==a&&3!==h.nodeType||(c=s+a),h!==i||0!==r&&3!==h.nodeType||(l=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===a&&(c=s),p===i&&++d===r&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Gt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:yo(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(w){Il(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=nc,nc=!1}(e,n),yc(n,e),fr(ta),Gt=!!ea,ta=ea=null,e.current=n,bc(n,e,a),Qe(),Oc=c,bt=s,Nc.transition=i}else e.current=n;if(Xc&&(Xc=!1,Yc=e,Qc=a),i=e.pendingLanes,0===i&&(qc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),al(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hc)throw Hc=!1,e=Kc,Kc=null,e;0!==(1&Qc)&&0!==e.tag&&Sl(),i=e.pendingLanes,0!==(1&i)?e===$c?Zc++:(Zc=0,$c=e):Zc=0,Ua()}(e,t,n,r)}finally{Nc.transition=a,bt=r}return null}function Sl(){if(null!==Yc){var e=xt(Qc),t=Nc.transition,n=bt;try{if(Nc.transition=null,bt=16>e?16:e,null===Yc)var r=!1;else{if(e=Yc,Yc=null,Qc=0,0!==(6&Oc))throw Error(o(331));var a=Oc;for(Oc|=4,Js=e.current;null!==Js;){var i=Js,s=i.child;if(0!==(16&Js.flags)){var c=i.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Js=u;null!==Js;){var d=Js;switch(d.tag){case 0:case 11:case 15:rc(8,d,i)}var h=d.child;if(null!==h)h.return=d,Js=h;else for(;null!==Js;){var p=(d=Js).sibling,f=d.return;if(ic(d),d===u){Js=null;break}if(null!==p){p.return=f,Js=p;break}Js=f}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Js=i}}if(0!==(2064&i.subtreeFlags)&&null!==s)s.return=i,Js=s;else e:for(;null!==Js;){if(0!==(2048&(i=Js).flags))switch(i.tag){case 0:case 11:case 15:rc(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Js=v;break e}Js=i.return}}var b=e.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=b;null!==Js;){if(0!==(2048&(c=Js).flags))try{switch(c.tag){case 0:case 11:case 15:ac(9,c)}}catch(k){Il(c,c.return,k)}if(c===s){Js=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Js=w;break e}Js=c.return}}if(Oc=a,Ua(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{bt=n,Nc.transition=t}}return!1}function Cl(e,t,n){e=Mo(e,t=fs(0,t=us(n,t),1),1),t=tl(),null!==e&&(yt(e,1,t),al(e,t))}function Il(e,t,n){if(3===e.tag)Cl(e,e,n);else for(;null!==t;){if(3===t.tag){Cl(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qc||!qc.has(r))){t=Mo(t,e=ms(t,e=us(n,e),1),1),e=tl(),null!==t&&(yt(t,1,e),al(t,e));break}}t=t.return}}function El(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Ac===e&&(Rc&n)===n&&(4===Mc||3===Mc&&(130023424&Rc)===Rc&&500>Ze()-Uc?pl(e,0):Bc|=n),al(e,t)}function Tl(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tl();null!==(e=Ao(e,t))&&(yt(e,t,n),al(e,n))}function Nl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tl(e,n)}function Ol(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Tl(e,n)}function Al(e,t){return qe(e,t)}function _l(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rl(e,t,n,r){return new _l(e,t,n,r)}function Pl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dl(e,t){var n=e.alternate;return null===n?((n=Rl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ml(e,t,n,r,a,i){var s=2;if(r=e,"function"===typeof e)Pl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Fl(n.children,a,i,t);case C:s=8,a|=8;break;case I:return(e=Rl(12,n,t,2|a)).elementType=I,e.lanes=i,e;case O:return(e=Rl(13,n,t,a)).elementType=O,e.lanes=i,e;case A:return(e=Rl(19,n,t,a)).elementType=A,e.lanes=i,e;case P:return Ll(n,a,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case T:s=9;break e;case N:s=11;break e;case _:s=14;break e;case R:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Rl(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Fl(e,t,n,r){return(e=Rl(7,e,r,t)).lanes=n,e}function Ll(e,t,n,r){return(e=Rl(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function zl(e,t,n){return(e=Rl(6,e,null,t)).lanes=n,e}function Bl(e,t,n){return(t=Rl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jl(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Wl(e,t,n,r,a,o,i,s,c){return e=new jl(e,t,n,s,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Rl(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ro(o),e}function Ul(e){if(!e)return Ta;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ra(n))return Ma(e,n,t)}return t}function Vl(e,t,n,r,a,o,i,s,c){return(e=Wl(n,r,!0,e,0,o,0,s,c)).context=Ul(null),n=e.current,(o=Do(r=tl(),a=nl(n))).callback=void 0!==t&&null!==t?t:null,Mo(n,o,a),e.current.lanes=a,yt(e,a,r),al(e,r),e}function Gl(e,t,n,r){var a=t.current,o=tl(),i=nl(a);return n=Ul(n),null===t.context?t.context=n:t.pendingContext=n,(t=Do(o,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Mo(a,t,i))&&(rl(e,a,i,o),Fo(e,a,i)),i}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ql(e,t){Kl(e,t),(e=e.alternate)&&Kl(e,t)}Cc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oa.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:As(t),fo();break;case 5:ii(t);break;case 1:Ra(t.type)&&Fa(t);break;case 4:ai(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ea(vo,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ea(ci,1&ci.current),t.flags|=128,null):0!==(n&t.child.childLanes)?zs(e,t,n):(Ea(ci,1&ci.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ea(ci,1&ci.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ea(ci,ci.current),r)break;return null;case 22:case 23:return t.lanes=0,Is(e,t,n)}return Hs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ao&&0!==(1048576&t.flags)&&Ja(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var a=_a(t,Na.current);Io(t,n),a=Ci(null,t,r,e,a,n);var i=Ii();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(r)?(i=!0,Fa(t)):i=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ro(t),a.updater=Uo,t.stateNode=a,a._reactInternals=t,Ko(t,r,e,n),t=Os(null,t,r,!0,i,n)):(t.tag=0,ao&&i&&eo(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Pl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===_)return 14}return 2}(r),e=yo(r,e),a){case 0:t=Ts(null,t,r,e,n);break e;case 1:t=Ns(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,yo(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:yo(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ns(e,t,r,a=t.elementType===r?a:yo(r,a),n);case 3:e:{if(As(t),null===e)throw Error(o(387));r=t.pendingProps,a=(i=t.memoizedState).element,Po(e,t),zo(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=_s(e,t,r,n,a=us(Error(o(423)),t));break e}if(r!==a){t=_s(e,t,r,n,a=us(Error(o(424)),t));break e}for(ro=la(t.stateNode.containerInfo.firstChild),no=t,ao=!0,oo=null,n=$o(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===a){t=Hs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return ii(t),null===e&&lo(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==i&&na(r,i)&&(t.flags|=32),Es(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&lo(t),null;case 13:return zs(e,t,n);case 4:return ai(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Zo(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ks(e,t,r,a=t.elementType===r?a:yo(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Ea(vo,r._currentValue),r._currentValue=s,null!==i)if(sr(i.value,s)){if(i.children===a.children&&!Oa.current){t=Hs(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var c=i.dependencies;if(null!==c){s=i.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===i.tag){(l=Do(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Co(i.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(o(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Co(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Io(t,n),r=r(a=Eo(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=yo(r=t.type,t.pendingProps),Ss(e,t,r,a=yo(r.type,a),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:yo(r,a),Gs(e,t),t.tag=1,Ra(r)?(e=!0,Fa(t)):e=!1,Io(t,n),Go(t,r,a),Ko(t,r,a,n),Os(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return Is(e,t,n)}throw Error(o(156,t.tag))};var Xl="function"===typeof reportError?reportError:function(e){console.error(e)};function Yl(e){this._internalRoot=e}function Ql(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $l(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jl(){}function eu(e,t,n,r,a){var o=n._reactRootContainer;if(o){var i=o;if("function"===typeof a){var s=a;a=function(){var e=Hl(i);s.call(e)}}Gl(t,i,e,a)}else i=function(e,t,n,r,a){if(a){if("function"===typeof r){var o=r;r=function(){var e=Hl(i);o.call(e)}}var i=Vl(t,r,e,0,null,!1,0,"",Jl);return e._reactRootContainer=i,e[fa]=i.current,Ur(8===e.nodeType?e.parentNode:e),dl(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hl(c);s.call(e)}}var c=Wl(e,0,!1,null,0,!1,0,"",Jl);return e._reactRootContainer=c,e[fa]=c.current,Ur(8===e.nodeType?e.parentNode:e),dl(function(){Gl(t,c,n,r)}),c}(n,t,e,a,r);return Hl(i)}Ql.prototype.render=Yl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Gl(e,t,null,null)},Ql.prototype.unmount=Yl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl(function(){Gl(null,e,null,null)}),t[fa]=null}},Ql.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),al(t,Ze()),0===(6&Oc)&&(Vc=Ze()+500,Ua()))}break;case 13:dl(function(){var t=Ao(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}}),ql(e,1)}},kt=function(e){if(13===e.tag){var t=Ao(e,134217728);if(null!==t)rl(t,e,134217728,tl());ql(e,134217728)}},St=function(e){if(13===e.tag){var t=nl(e),n=Ao(e,t);if(null!==n)rl(n,e,t,tl());ql(e,t)}},Ct=function(){return bt},It=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(o(90));q(r),$(r,a)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=ul,Oe=dl;var tu={usingClientEntryPoint:!1,Events:[ba,xa,wa,Ee,Te,ul]},nu={findFiberByHostInstance:va,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{at=au.inject(ru),ot=au}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(o(299));var n=!1,r="",a=Xl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Wl(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Yl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!$l(t))throw Error(o(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,a=!1,i="",s=Xl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vl(t,null,e,1,null!=n?n:null,a,0,i,s),e[fa]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Ql(t)},t.render=function(e,t,n){if(!$l(t))throw Error(o(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$l(e))throw Error(o(40));return!!e._reactRootContainer&&(dl(function(){eu(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$l(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},2777:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isSymbol=function(e){return"symbol"===typeof e||e instanceof Symbol}},2897:(e,t,n)=>{var r=n(3693);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},3272:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toKey=function(e){var t;return"string"===typeof e||"symbol"===typeof e?e:Object.is(null===e||void 0===e||null===(t=e.valueOf)||void 0===t?void 0:t.call(e),-0)?"-0":String(e)}},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3757:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},3799:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4704),a=n(1203),o=n(870),i=n(9972);t.isIterateeCall=function(e,t,n){return!!o.isObject(n)&&(!!("number"===typeof t&&a.isArrayLike(n)&&r.isIndex(t)&&t<n.length||"string"===typeof t&&t in n)&&i.eq(n[t],e))}},3808:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(5261);t.matches=function(e){return e=a.cloneDeep(e),t=>r.isMatch(t,e)}},3821:(e,t,n)=>{e.exports=n(2204).sortBy},3879:function(e,t,n){(function(){"use strict";var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var a=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function o(e,t){if(t)e:{var n=a;e=e.split(".");for(var o=0;o<e.length-1;o++){var i=e[o];if(!(i in n))break e;n=n[i]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}function i(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function s(e){var n="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return n?n.call(e):{next:t(e)}}function c(e){if(!(e instanceof Array)){e=s(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}o("Symbol",function(e){function t(e,t){this.h=e,r(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",a=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(r||"")+"_"+a++,r)}}),o("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var s=a[n[o]];"function"===typeof s&&"function"!=typeof s.prototype[e]&&r(s.prototype,e,{configurable:!0,writable:!0,value:function(){return i(t(this))}})}return e});var l="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e};o("Object.assign",function(e){return e||l});var u,d="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var h;e:{var p={};try{p.__proto__={a:!0},h=p.a;break e}catch(xn){}h=!1}u=h?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var f=u;function m(e,t){if(e.prototype=d(t.prototype),e.prototype.constructor=e,f)f(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(t,n);r&&Object.defineProperty(e,n,r)}else e[n]=t[n];e.za=t.prototype}function g(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function y(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function v(e,t){e.l={ma:t,na:!0},e.h=e.s||e.v}function b(e,t,n){return e.h=n,{value:t}}function x(e){this.h=new g,this.i=e}function w(e,t,n,r){try{var a=t.call(e.h.j,n);if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");if(!a.done)return e.h.m=!1,a;var o=a.value}catch(i){return e.h.j=null,v(e.h,i),k(e)}return e.h.j=null,r.call(e.h,o),k(e)}function k(e){for(;e.h.h;)try{var t=e.i(e.h);if(t)return e.h.m=!1,{value:t.value,done:!1}}catch(n){e.h.i=void 0,v(e.h,n)}if(e.h.m=!1,e.h.l){if(t=e.h.l,e.h.l=null,t.na)throw t.ma;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function S(e){this.next=function(t){return y(e.h),e.h.j?t=w(e,e.h.j.next,t,e.h.u):(e.h.u(t),t=k(e)),t},this.throw=function(t){return y(e.h),e.h.j?t=w(e,e.h.j.throw,t,e.h.u):(v(e.h,t),t=k(e)),t},this.return=function(t){return function(e,t){y(e.h);var n=e.h.j;return n?w(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.h.return):(e.h.return(t),k(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function C(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise(function(r,a){!function e(o){o.done?r(o.value):Promise.resolve(o.value).then(t,n).then(e,a)}(e.next())})}(new S(new x(e)))}function I(e){return e||Array.prototype.fill}g.prototype.u=function(e){this.i=e},g.prototype.return=function(e){this.l={return:e},this.h=this.v},o("Promise",function(e){function t(e){this.i=0,this.j=void 0,this.h=[],this.u=!1;var t=this.l();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.h=null}function r(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.i=function(e){if(null==this.h){this.h=[];var t=this;this.j(function(){t.m()})}this.h.push(e)};var o=a.setTimeout;n.prototype.j=function(e){o(e,0)},n.prototype.m=function(){for(;this.h&&this.h.length;){var e=this.h;this.h=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.l(r)}}}this.h=null},n.prototype.l=function(e){this.j(function(){throw e})},t.prototype.l=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.I),reject:e(this.m)}},t.prototype.I=function(e){if(e===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.L(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.F(e):this.s(e)}},t.prototype.F=function(e){var t=void 0;try{t=e.then}catch(n){return void this.m(n)}"function"==typeof t?this.M(t,e):this.s(e)},t.prototype.m=function(e){this.v(2,e)},t.prototype.s=function(e){this.v(1,e)},t.prototype.v=function(e,t){if(0!=this.i)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.i);this.i=e,this.j=t,2===this.i&&this.K(),this.H()},t.prototype.K=function(){var e=this;o(function(){if(e.D()){var t=a.console;"undefined"!==typeof t&&t.error(e.j)}},1)},t.prototype.D=function(){if(this.u)return!1;var e=a.CustomEvent,t=a.Event,n=a.dispatchEvent;return"undefined"===typeof n||("function"===typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"===typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=a.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.j,n(e))},t.prototype.H=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)i.i(this.h[e]);this.h=null}};var i=new n;return t.prototype.L=function(e){var t=this.l();e.T(t.resolve,t.reject)},t.prototype.M=function(e,t){var n=this.l();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{a(e(t))}catch(n){o(n)}}:t}var a,o,i=new t(function(e,t){a=e,o=t});return this.T(r(e,a),r(n,o)),i},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.T=function(e,t){function n(){switch(r.i){case 1:e(r.j);break;case 2:t(r.j);break;default:throw Error("Unexpected state: "+r.i)}}var r=this;null==this.h?i.i(n):this.h.push(n),this.u=!0},t.resolve=r,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var a=s(e),o=a.next();!o.done;o=a.next())r(o.value).T(t,n)})},t.all=function(e){var n=s(e),a=n.next();return a.done?r([]):new t(function(e,t){function o(t){return function(n){i[t]=n,0==--s&&e(i)}}var i=[],s=0;do{i.push(void 0),s++,r(a.value).T(o(i.length-1),t),a=n.next()}while(!a.done)})},t}),o("Array.prototype.keys",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,function(e){return e})}}),o("Array.prototype.fill",function(e){return e||function(e,t,n){var r=this.length||0;for(0>t&&(t=Math.max(0,r+t)),(null==n||n>r)&&(n=r),0>(n=Number(n))&&(n=Math.max(0,r+n)),t=Number(t||0);t<n;t++)this[t]=e;return this}}),o("Int8Array.prototype.fill",I),o("Uint8Array.prototype.fill",I),o("Uint8ClampedArray.prototype.fill",I),o("Int16Array.prototype.fill",I),o("Uint16Array.prototype.fill",I),o("Int32Array.prototype.fill",I),o("Uint32Array.prototype.fill",I),o("Float32Array.prototype.fill",I),o("Float64Array.prototype.fill",I),o("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}}),o("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(t=t||0)&&(t=Math.max(t+r,0));t<r;t++){var a=n[t];if(a===e||Object.is(a,e))return!0}return!1}}),o("String.prototype.includes",function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}});var E=this||self;function T(e,t){e=e.split(".");var n,r=E;e[0]in r||"undefined"==typeof r.execScript||r.execScript("var "+e[0]);for(;e.length&&(n=e.shift());)e.length||void 0===t?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=t}function N(e){var t;return(t=E.navigator)&&(t=t.userAgent)||(t=""),-1!=t.indexOf(e)}var O=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),a="string"===typeof e?e.split(""):e,o=0;o<n;o++)o in a&&(r[o]=t.call(void 0,a[o],o,e));return r},A={},_=null;function R(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):-1!="=.".indexOf(e[t-1])&&(n=-1!="=.".indexOf(e[t-2])?n-2:n-1);var r=new Uint8Array(n),a=0;return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),a=_[n];if(null!=a)return a;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}P();for(var r=0;;){var a=n(-1),o=n(0),i=n(64),s=n(64);if(64===s&&-1===a)break;t(a<<2|o>>4),64!=i&&(t(o<<4&240|i>>2),64!=s&&t(i<<6&192|s))}}(e,function(e){r[a++]=e}),a!==n?r.subarray(0,a):r}function P(){if(!_){_={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=e.concat(t[n].split(""));A[n]=r;for(var a=0;a<r.length;a++){var o=r[a];void 0===_[o]&&(_[o]=a)}}}}var D="undefined"!==typeof Uint8Array,M=!(N("Trident")||N("MSIE"))&&"function"===typeof E.btoa;function F(e){if(!M){var t;void 0===t&&(t=0),P(),t=A[t];for(var n=Array(Math.floor(e.length/3)),r=t[64]||"",a=0,o=0;a<e.length-2;a+=3){var i=e[a],s=e[a+1],c=e[a+2],l=t[i>>2];i=t[(3&i)<<4|s>>4],s=t[(15&s)<<2|c>>6],c=t[63&c],n[o++]=l+i+s+c}switch(l=0,c=r,e.length-a){case 2:c=t[(15&(l=e[a+1]))<<2]||r;case 1:e=e[a],n[o]=t[e>>2]+t[(3&e)<<4|l>>4]+c+r}return n.join("")}for(t="";10240<e.length;)t+=String.fromCharCode.apply(null,e.subarray(0,10240)),e=e.subarray(10240);return t+=String.fromCharCode.apply(null,e),btoa(t)}var L,z=RegExp("[-_.]","g");function B(e){switch(e){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function j(e){if(!M)return R(e);z.test(e)&&(e=e.replace(z,B)),e=atob(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function W(){return L||(L=new Uint8Array(0))}var U={},V="function"===typeof Uint8Array.prototype.slice,G=0,H=0;function K(e){var t=0>e,n=(e=Math.abs(e))>>>0;e=Math.floor((e-n)/4294967296),t&&(t=(n=s(Y(n,e))).next().value,e=n.next().value,n=t),G=n>>>0,H=e>>>0}var q,X="function"===typeof BigInt;function Y(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function Q(e,t){this.i=e>>>0,this.h=t>>>0}function Z(e){if(!e)return q||(q=new Q(0,0));if(!/^-?\d+$/.test(e))return null;if(16>e.length)K(Number(e));else if(X)e=BigInt(e),G=Number(e&BigInt(4294967295))>>>0,H=Number(e>>BigInt(32)&BigInt(4294967295));else{var t=+("-"===e[0]);H=G=0;for(var n=e.length,r=t,a=(n-t)%6+t;a<=n;r=a,a+=6)r=Number(e.slice(r,a)),H*=1e6,4294967296<=(G=1e6*G+r)&&(H+=G/4294967296|0,G%=4294967296);t&&(e=(t=s(Y(G,H))).next().value,t=t.next().value,G=e,H=t)}return new Q(G,H)}function $(e,t){return Error("Invalid wire type: "+e+" (at position "+t+")")}function J(){return Error("Failed to read varint, encoding is invalid.")}function ee(e,t){return Error("Tried to read past the end of the data "+t+" > "+e)}function te(){throw Error("Invalid UTF8")}function ne(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var re,ae,oe,ie=void 0,se="undefined"!==typeof TextDecoder,ce="undefined"!==typeof TextEncoder;function le(e){if(e!==U)throw Error("illegal external caller")}function ue(e,t){if(le(t),this.V=e,null!=e&&0===e.length)throw Error("ByteString should be constructed with non-empty values")}function de(){return oe||(oe=new ue(null,U))}function he(e){le(U);var t=e.V;return null==(t=null==t||D&&null!=t&&t instanceof Uint8Array?t:"string"===typeof t?j(t):null)?t:e.V=t}function pe(e,t){this.i=null,this.m=!1,this.h=this.j=this.l=0,fe(this,e,t)}function fe(e,t,n){n=void 0===n?{}:n,e.S=void 0!==n.S&&n.S,t&&(t=function(e){if("string"===typeof e)return{buffer:j(e),C:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),C:!1};if(e.constructor===Uint8Array)return{buffer:e,C:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),C:!1};if(e.constructor===ue)return{buffer:he(e)||W(),C:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(t),e.i=t.buffer,e.m=t.C,e.l=0,e.j=e.i.length,e.h=e.l)}function me(e,t){if(e.h=t,t>e.j)throw ee(e.j,t)}function ge(e){var t=e.i,n=e.h,r=t[n++],a=127&r;if(128&r&&(a|=(127&(r=t[n++]))<<7,128&r&&(a|=(127&(r=t[n++]))<<14,128&r&&(a|=(127&(r=t[n++]))<<21,128&r&&(a|=(r=t[n++])<<28,128&r&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw J();return me(e,n),a}function ye(e,t){if(0>t)throw Error("Tried to read a negative byte length: "+t);var n=e.h,r=n+t;if(r>e.j)throw ee(t,e.j-n);return e.h=r,n}pe.prototype.reset=function(){this.h=this.l};var ve=[];function be(){this.h=[]}function xe(e,t,n){for(;0<n||127<t;)e.h.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.h.push(t)}function we(e,t){for(;127<t;)e.h.push(127&t|128),t>>>=7;e.h.push(t)}function ke(e,t){if(ve.length){var n=ve.pop();fe(n,e,t),e=n}else e=new pe(e,t);this.h=e,this.j=this.h.h,this.i=this.l=-1,this.setOptions(t)}function Se(e){var t=e.h;if(t.h==t.j)return!1;e.j=e.h.h;var n=ge(e.h)>>>0;if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw $(n,e.j);if(1>t)throw Error("Invalid field number: "+t+" (at position "+e.j+")");return e.l=t,e.i=n,!0}function Ce(e){switch(e.i){case 0:if(0!=e.i)Ce(e);else e:{for(var t=(e=e.h).h,n=t+10,r=e.i;t<n;)if(0===(128&r[t++])){me(e,t);break e}throw J()}break;case 1:me(e=e.h,e.h+8);break;case 2:2!=e.i?Ce(e):(t=ge(e.h)>>>0,me(e=e.h,e.h+t));break;case 5:me(e=e.h,e.h+4);break;case 3:for(t=e.l;;){if(!Se(e))throw Error("Unmatched start-group tag: stream EOF");if(4==e.i){if(e.l!=t)throw Error("Unmatched end-group tag");break}Ce(e)}break;default:throw $(e.i,e.j)}}be.prototype.length=function(){return this.h.length},be.prototype.end=function(){var e=this.h;return this.h=[],e},ke.prototype.setOptions=function(e){e=void 0===e?{}:e,this.ca=void 0!==e.ca&&e.ca},ke.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var Ie=[];function Ee(){this.j=[],this.i=0,this.h=new be}function Te(e,t){0!==t.length&&(e.j.push(t),e.i+=t.length)}var Ne="function"===typeof Symbol&&"symbol"===typeof Symbol()?Symbol():void 0;function Oe(e,t){return Ne?e[Ne]|=t:void 0!==e.A?e.A|=t:(Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}}),t)}function Ae(e,t){Ne?e[Ne]&&(e[Ne]&=~t):void 0!==e.A&&(e.A&=~t)}function _e(e){var t;return null==(t=Ne?e[Ne]:e.A)?0:t}function Re(e,t){Ne?e[Ne]=t:void 0!==e.A?e.A=t:Object.defineProperties(e,{A:{value:t,configurable:!0,writable:!0,enumerable:!1}})}function Pe(e){return Oe(e,1),e}function De(e,t){Re(t,-51&e)}function Me(e,t){Re(t,-41&e|18)}var Fe={};function Le(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)&&e.constructor===Object}var ze,Be,je=[];function We(e){if(2&_e(e.o))throw Error("Cannot mutate an immutable Message")}function Ue(e){var t=e.length;(t=t?e[t-1]:void 0)&&Le(t)?t.g=1:(t={},e.push((t.g=1,t)))}function Ve(e){var t=e.i+e.G;return e.B||(e.B=e.o[t]={})}function Ge(e,t){return-1===t?null:t>=e.i?e.B?e.B[t]:void 0:e.o[t+e.G]}function He(e,t,n,r){We(e),Ke(e,t,n,r)}function Ke(e,t,n,r){e.j&&(e.j=void 0),t>=e.i||r?Ve(e)[t]=n:(e.o[t+e.G]=n,(e=e.B)&&t in e&&delete e[t])}function qe(e,t,n,r){var a=Ge(e,t);Array.isArray(a)||(a=ze);var o=_e(a);if(1&o||Pe(a),r)2&o||Oe(a,2),1&n||Object.freeze(a);else{r=!(2&n);var i=2&o;1&n||!i?r&&16&o&&!i&&Ae(a,16):Ke(e,t,a=Pe(Array.prototype.slice.call(a)))}return a}function Xe(e,t){var n=Ge(e,t),r=null==n?n:"number"===typeof n||"NaN"===n||"Infinity"===n||"-Infinity"===n?Number(n):void 0;return null!=r&&r!==n&&Ke(e,t,r),r}function Ye(e,t,n,r,a){e.h||(e.h={});var o=e.h[n],i=qe(e,n,3,a);if(!o){var s=i;o=[];var c=!!(16&_e(e.o));i=!!(2&_e(s));var l=s;!a&&i&&(s=Array.prototype.slice.call(s));for(var u=i,d=0;d<s.length;d++){var h=s[d],p=t,f=!1;if(f=void 0!==f&&f,void 0!==(h=Array.isArray(h)?new p(h):f?new p:void 0)){var m=f=_e(p=h.o);i&&(m|=2),c&&(m|=16),m!=f&&Re(p,m),p=m,u=u||!!(2&p),o.push(h)}}return e.h[n]=o,t=33|(c=_e(s)),c!=(t=u?-9&t:8|t)&&(u=s,Object.isFrozen(u)&&(u=Array.prototype.slice.call(u)),Re(u,t),s=u),l!==s&&Ke(e,n,s),(a||r&&i)&&Oe(o,2),r&&Object.freeze(o),o}return a||(a=Object.isFrozen(o),r&&!a?Object.freeze(o):!r&&a&&(o=Array.prototype.slice.call(o),e.h[n]=o)),o}function Qe(e,t,n){var r=!!(2&_e(e.o));if(t=Ye(e,t,n,r,r),e=qe(e,n,3,r),!(r||8&_e(e))){for(r=0;r<t.length;r++){if(2&_e((n=t[r]).o)){var a=ct(n,!1);a.j=n}else a=n;n!==a&&(t[r]=a,e[r]=a.o)}Oe(e,8)}return t}function Ze(e,t,n){if(null!=n&&"number"!==typeof n)throw Error("Value of float/double field must be a number|null|undefined, found "+typeof n+": "+n);He(e,t,n)}function $e(e,t,n,r,a){We(e);var o=Ye(e,n,t,!1,!1);return n=null!=r?r:new n,e=qe(e,t,2,!1),void 0!=a?(o.splice(a,0,n),e.splice(a,0,n.o)):(o.push(n),e.push(n.o)),n.C()&&Ae(e,8),n}function Je(e,t){return null==e?t:e}function et(e,t,n){return n=void 0===n?0:n,Je(Xe(e,t),n)}function tt(e,t,n,r){if(null!=e){if(Array.isArray(e))e=nt(e,t,n,void 0!==r);else if(Le(e)){var a,o={};for(a in e)o[a]=tt(e[a],t,n,r);e=o}else e=t(e,r);return e}}function nt(e,t,n,r){var a=_e(e);r=r?!!(16&a):void 0,e=Array.prototype.slice.call(e);for(var o=0;o<e.length;o++)e[o]=tt(e[o],t,n,r);return n(a,e),e}function rt(e){return e.ja===Fe?e.toJSON():function(e){switch(typeof e){case"number":return isFinite(e)?e:String(e);case"object":if(e)if(Array.isArray(e)){if(0!==(128&_e(e)))return Ue(e=Array.prototype.slice.call(e)),e}else{if(D&&null!=e&&e instanceof Uint8Array)return F(e);if(e instanceof ue){var t=e.V;return null==t?"":"string"===typeof t?t:e.V=F(t)}}}return e}(e)}function at(e,t){128&e&&Ue(t)}function ot(e,t,n){if(n=void 0===n?Me:n,null!=e){if(D&&e instanceof Uint8Array)return e.length?new ue(new Uint8Array(e),U):de();if(Array.isArray(e)){var r=_e(e);return 2&r?e:!t||32&r||!(16&r||0===r)?(4&(t=_e(e=nt(e,ot,4&r?Me:n,!0)))&&2&t&&Object.freeze(e),e):(Re(e,2|r),e)}return e.ja===Fe?st(e):e}}function it(e,t,n,r,a,o,i){if(e=e.h&&e.h[n]){if(2&(r=_e(e))?r=e:(Me(r,o=O(e,st)),Object.freeze(o),r=o),We(t),i=null==r?ze:Pe([]),null!=r){for(o=!!r.length,e=0;e<r.length;e++){var s=r[e];o=o&&!(2&_e(s.o)),i[e]=s.o}o=1|(o?8:0),((e=_e(i))&o)!==o&&(Object.isFrozen(i)&&(i=Array.prototype.slice.call(i)),Re(i,e|o)),t.h||(t.h={}),t.h[n]=r}else t.h&&(t.h[n]=void 0);Ke(t,n,i,a)}else He(t,n,ot(r,o,i),a)}function st(e){return 2&_e(e.o)||Oe((e=ct(e,!0)).o,2),e}function ct(e,t){var n=e.o,r=[];Oe(r,16);var a=e.constructor.h;if(a&&r.push(a),a=e.B){r.length=n.length,r.fill(void 0,r.length,n.length);var o={};r[r.length-1]=o}0!==(128&_e(n))&&Ue(r),t=t||e.C()?Me:De,o=e.constructor,Be=r,r=new o(r),Be=void 0,e.R&&(r.R=e.R.slice()),o=!!(16&_e(n));for(var i=a?n.length-1:n.length,s=0;s<i;s++)it(e,r,s-e.G,n[s],!1,o,t);if(a)for(var c in a)it(e,r,+c,a[c],!0,o,t);return r}function lt(e,t,n){null==e&&(e=Be),Be=void 0;var r,a=this.constructor.i||0,o=0<a,i=this.constructor.h,s=!1;if(null==e){var c=48,l=!0;o&&(a=0,c|=128),Re(e=i?[i]:[],c)}else{if(!Array.isArray(e))throw Error();if(i&&i!==e[0])throw Error();var u=c=Oe(e,0);if((l=0!==(16&u))&&((s=0!==(32&u))||(u|=32)),o){if(128&u)a=0;else if(0<e.length){var d=e[e.length-1];if(Le(d)&&"g"in d){a=0,u|=128,delete d.g;var h,p=!0;for(h in d){p=!1;break}p&&e.pop()}}}else if(128&u)throw Error();c!==u&&Re(e,u)}if(this.G=(i?0:-1)-a,this.h=void 0,this.o=e,a=(i=this.o.length)-1,i&&Le(i=this.o[a])?(this.B=i,this.i=a-this.G):void 0!==t&&-1<t?(this.i=Math.max(t,a+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!o&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(n)for(t=l&&!s&&!0,o=this.i,l=0;l<n.length;l++)(s=n[l])<o?(a=e[s+=this.G])?ut(a,t):e[s]=ze:(r||(r=Ve(this)),(a=r[s])?ut(a,t):r[s]=ze)}function ut(e,t){if(Array.isArray(e)){var n=_e(e),r=1;!t||2&n||(r|=16),(n&r)!==r&&Re(e,n|r)}}function dt(e,t,n){if(n){var r,a={};for(r in n){var o=n[r],i=o.ra;i||(a.J=o.xa||o.oa.W,o.ia?(a.aa=bt(o.ia),i=function(e){return function(t,n,r){return e.J(t,n,r,e.aa)}}(a)):o.ka?(a.Z=xt(o.da.P,o.ka),i=function(e){return function(t,n,r){return e.J(t,n,r,e.Z)}}(a)):i=a.J,o.ra=i),i(t,e,o.da),a={J:a.J,aa:a.aa,Z:a.Z}}}!function(e,t){if(t=t.R){Te(e,e.h.end());for(var n=0;n<t.length;n++)Te(e,he(t[n])||W())}}(t,e)}Re(je,23),ze=Object.freeze(je),lt.prototype.toJSON=function(){return nt(this.o,rt,at)},lt.prototype.C=function(){return!!(2&_e(this.o))},lt.prototype.ja=Fe,lt.prototype.toString=function(){return this.o.toString()};var ht=Symbol();function pt(e,t,n){return e[ht]||(e[ht]=function(e,r){return t(e,r,n)})}function ft(e){var t=e[ht];if(!t){var n=Rt(e);t=function(e,t){return Pt(e,t,n)},e[ht]=t}return t}function mt(e){var t=function(e){var t=e.ia;return t?ft(t):(t=e.wa)?pt(e.da.P,t,e.ka):void 0}(e),n=e.da,r=e.oa.U;return t?function(e,a){return r(e,a,n,t)}:function(e,t){return r(e,t,n)}}function gt(e,t){var n=e[t];return"function"==typeof n&&0===n.length&&(n=n(),e[t]=n),Array.isArray(n)&&(Tt in n||wt in n||0<n.length&&"function"==typeof n[0])?n:void 0}function yt(e,t,n,r,a,o){t.P=e[0];var i=1;if(e.length>i&&"number"!==typeof e[i]){var s=e[i++];n(t,s)}for(;i<e.length;){n=e[i++];for(var c=i+1;c<e.length&&"number"!==typeof e[c];)c++;switch(s=e[i++],c-=i){case 0:r(t,n,s);break;case 1:(c=gt(e,i))?(i++,a(t,n,s,c)):r(t,n,s,e[i++]);break;case 2:a(t,n,s,c=gt(e,c=i++),e[i++]);break;case 3:o(t,n,s,e[i++],e[i++],e[i++]);break;case 4:o(t,n,s,e[i++],e[i++],e[i++],e[i++]);break;default:throw Error("unexpected number of binary field arguments: "+c)}}return t}var vt=Symbol();function bt(e){var t=e[vt];if(!t){var n=Et(e);t=function(e,t){return Dt(e,t,n)},e[vt]=t}return t}function xt(e,t){var n=e[vt];return n||(n=function(e,n){return dt(e,n,t)},e[vt]=n),n}var wt=Symbol();function kt(e,t){e.push(t)}function St(e,t,n){e.push(t,n.W)}function Ct(e,t,n,r){var a=bt(r),o=Et(r).P,i=n.W;e.push(t,function(e,t,n){return i(e,t,n,o,a)})}function It(e,t,n,r,a,o){var i=xt(r,o),s=n.W;e.push(t,function(e,t,n){return s(e,t,n,r,i)})}function Et(e){var t=e[wt];return t||(t=yt(e,e[wt]=[],kt,St,Ct,It),Tt in e&&wt in e&&(e.length=0),t)}var Tt=Symbol();function Nt(e,t){e[0]=t}function Ot(e,t,n,r){var a=n.U;e[t]=r?function(e,t,n){return a(e,t,n,r)}:a}function At(e,t,n,r,a){var o=n.U,i=ft(r),s=Rt(r).P;e[t]=function(e,t,n){return o(e,t,n,s,i,a)}}function _t(e,t,n,r,a,o,i){var s=n.U,c=pt(r,a,o);e[t]=function(e,t,n){return s(e,t,n,r,c,i)}}function Rt(e){var t=e[Tt];return t||(t=yt(e,e[Tt]={},Nt,Ot,At,_t),Tt in e&&wt in e&&(e.length=0),t)}function Pt(e,t,n){for(;Se(t)&&4!=t.i;){var r=t.l,a=n[r];if(!a){var o=n[0];o&&(o=o[r])&&(a=n[r]=mt(o))}if(!a||!a(t,e,r)){r=e,o=(a=t).j,Ce(a);var i=a;if(!i.ca){if(a=i.h.h-o,i.h.h=o,i=i.h,0==a)a=de();else{if(o=ye(i,a),i.S&&i.m)a=i.i.subarray(o,o+a);else{i=i.i;var s=o;a=s===(a=o+a)?W():V?i.slice(s,a):new Uint8Array(i.subarray(s,a))}a=0==a.length?de():new ue(a,U)}(o=r.R)?o.push(a):r.R=[a]}}}return e}function Dt(e,t,n){for(var r=n.length,a=1==r%2,o=a?1:0;o<r;o+=2)(0,n[o+1])(t,e,n[o]);dt(e,t,a?n[0]:void 0)}function Mt(e,t){return{U:e,W:t}}var Ft=Mt(function(e,t,n){if(5!==e.i)return!1;var r=(e=e.h).i,a=e.h,o=r[a],i=r[a+1],s=r[a+2];return r=r[a+3],me(e,e.h+4),e=2*((i=(o|i<<8|s<<16|r<<24)>>>0)>>31)+1,o=i>>>23&255,i&=8388607,He(t,n,255==o?i?NaN:1/0*e:0==o?e*Math.pow(2,-149)*i:e*Math.pow(2,o-150)*(i+Math.pow(2,23))),!0},function(e,t,n){if(null!=(t=Xe(t,n))){we(e.h,8*n+5),e=e.h;var r=+t;0===r?0<1/r?G=H=0:(H=0,G=2147483648):isNaN(r)?(H=0,G=2147483647):34028234663852886e22<(r=(n=0>r?-2147483648:0)?-r:r)?(H=0,G=(2139095040|n)>>>0):11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),H=0,G=(n|r)>>>0):(t=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-t),16777216<=(r=Math.round(8388608*r))&&++t,H=0,G=(n|t+127<<23|8388607&r)>>>0),n=G,e.h.push(n>>>0&255),e.h.push(n>>>8&255),e.h.push(n>>>16&255),e.h.push(n>>>24&255)}}),Lt=Mt(function(e,t,n){if(0!==e.i)return!1;var r=e.h,a=0,o=e=0,i=r.i,s=r.h;do{var c=i[s++];a|=(127&c)<<o,o+=7}while(32>o&&128&c);for(32<o&&(e|=(127&c)>>4),o=3;32>o&&128&c;o+=7)e|=(127&(c=i[s++]))<<o;if(me(r,s),!(128>c))throw J();return r=a>>>0,(e=2147483648&(c=e>>>0))&&(c=~c>>>0,0==(r=1+~r>>>0)&&(c=c+1>>>0)),r=4294967296*c+(r>>>0),He(t,n,e?-r:r),!0},function(e,t,n){null!=(t=Ge(t,n))&&("string"===typeof t&&Z(t),null!=t&&(we(e.h,8*n),"number"===typeof t?(e=e.h,K(t),xe(e,G,H)):(n=Z(t),xe(e.h,n.i,n.h))))}),zt=Mt(function(e,t,n){return 0===e.i&&(He(t,n,ge(e.h)),!0)},function(e,t,n){if(null!=(t=Ge(t,n))&&null!=t)if(we(e.h,8*n),e=e.h,0<=(n=t))we(e,n);else{for(t=0;9>t;t++)e.h.push(127&n|128),n>>=7;e.h.push(1)}}),Bt=Mt(function(e,t,n){if(2!==e.i)return!1;var r=ge(e.h)>>>0,a=ye(e=e.h,r);if(e=e.i,se){var o,i=e;(o=re)||(o=re=new TextDecoder("utf-8",{fatal:!0})),e=a+r,i=0===a&&e===i.length?i:i.subarray(a,e);try{var s=o.decode(i)}catch(d){if(void 0===ie){try{o.decode(new Uint8Array([128]))}catch(h){}try{o.decode(new Uint8Array([97])),ie=!0}catch(h){ie=!1}}throw!ie&&(re=void 0),d}}else{r=(s=a)+r,a=[];for(var c,l,u=null;s<r;)128>(c=e[s++])?a.push(c):224>c?s>=r?te():(l=e[s++],194>c||128!==(192&l)?(s--,te()):a.push((31&c)<<6|63&l)):240>c?s>=r-1?te():128!==(192&(l=e[s++]))||224===c&&160>l||237===c&&160<=l||128!==(192&(i=e[s++]))?(s--,te()):a.push((15&c)<<12|(63&l)<<6|63&i):244>=c?s>=r-2?te():128!==(192&(l=e[s++]))||0!==l-144+(c<<28)>>30||128!==(192&(i=e[s++]))||128!==(192&(o=e[s++]))?(s--,te()):(c=(7&c)<<18|(63&l)<<12|(63&i)<<6|63&o,c-=65536,a.push(55296+(c>>10&1023),56320+(1023&c))):te(),8192<=a.length&&(u=ne(u,a),a.length=0);s=ne(u,a)}return He(t,n,s),!0},function(e,t,n){if(null!=(t=Ge(t,n))){var r=!1;if(r=void 0!==r&&r,ce){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(t))throw Error("Found an unpaired surrogate");t=(ae||(ae=new TextEncoder)).encode(t)}else{for(var a=0,o=new Uint8Array(3*t.length),i=0;i<t.length;i++){var s=t.charCodeAt(i);if(128>s)o[a++]=s;else{if(2048>s)o[a++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&i<t.length){var c=t.charCodeAt(++i);if(56320<=c&&57343>=c){s=1024*(s-55296)+c-56320+65536,o[a++]=s>>18|240,o[a++]=s>>12&63|128,o[a++]=s>>6&63|128,o[a++]=63&s|128;continue}i--}if(r)throw Error("Found an unpaired surrogate");s=65533}o[a++]=s>>12|224,o[a++]=s>>6&63|128}o[a++]=63&s|128}}t=a===o.length?o:o.subarray(0,a)}we(e.h,8*n+2),we(e.h,t.length),Te(e,e.h.end()),Te(e,t)}}),jt=Mt(function(e,t,n,r,a){if(2!==e.i)return!1;t=$e(t,n,r),n=e.h.j,r=ge(e.h)>>>0;var o=e.h.h+r,i=o-n;if(0>=i&&(e.h.j=o,a(t,e,void 0,void 0,void 0),i=o-e.h.h),i)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-i)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.h.h=o,e.h.j=n,!0},function(e,t,n,r,a){if(null!=(t=Qe(t,r,n)))for(r=0;r<t.length;r++){var o=e;we(o.h,8*n+2);var i=o.h.end();Te(o,i),i.push(o.i),o=i,a(t[r],e),i=e;var s=o.pop();for(s=i.i+i.h.length()-s;127<s;)o.push(127&s|128),s>>>=7,i.i++;o.push(s),i.i++}});function Wt(e){return function(t,n){e:{if(Ie.length){var r=Ie.pop();r.setOptions(n),fe(r.h,t,n),t=r}else t=new ke(t,n);try{var a=Rt(e),o=Pt(new a.P,t,a);break e}finally{(a=t.h).i=null,a.m=!1,a.l=0,a.j=0,a.h=0,a.S=!1,t.l=-1,t.i=-1,100>Ie.length&&Ie.push(t)}o=void 0}return o}}function Ut(e){return function(){var t=new Ee;Dt(this,t,Et(e)),Te(t,t.h.end());for(var n=new Uint8Array(t.i),r=t.j,a=r.length,o=0,i=0;i<a;i++){var s=r[i];n.set(s,o),o+=s.length}return t.j=[n],n}}function Vt(e){lt.call(this,e)}m(Vt,lt);var Gt=[Vt,1,zt,2,Ft,3,Bt,4,Bt];function Ht(e){lt.call(this,e,-1,Kt)}Vt.prototype.l=Ut(Gt),m(Ht,lt),Ht.prototype.addClassification=function(e,t){return $e(this,1,Vt,e,t),this};var Kt=[1],qt=Wt([Ht,1,jt,Gt]);function Xt(e){lt.call(this,e)}m(Xt,lt);var Yt=[Xt,1,Ft,2,Ft,3,Ft,4,Ft,5,Ft];function Qt(e){lt.call(this,e,-1,Zt)}Xt.prototype.l=Ut(Yt),m(Qt,lt);var Zt=[1],$t=Wt([Qt,1,jt,Yt]);function Jt(e){lt.call(this,e)}m(Jt,lt);var en=[Jt,1,Ft,2,Ft,3,Ft,4,Ft,5,Ft,6,Lt],tn=Wt(en);function nn(e,t,n){if(n=e.createShader(0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(n));return n}function rn(e){return Qe(e,Vt,1).map(function(e){var t=Ge(e,1);return{index:null==t?0:t,qa:et(e,2),label:null!=Ge(e,3)?Je(Ge(e,3),""):void 0,displayName:null!=Ge(e,4)?Je(Ge(e,4),""):void 0}})}function an(e){return{x:et(e,1),y:et(e,2),z:et(e,3),visibility:null!=Xe(e,4)?et(e,4):void 0}}function on(e){return Qe($t(e),Xt,1).map(an)}function sn(e,t){this.i=e,this.h=t,this.m=0}function cn(e,t,n){return function(e,t){var n=e.h;if(void 0===e.s){var r=nn(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),a=nn(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,a),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=e.s=o,n.useProgram(r),a=n.getUniformLocation(r,"sampler0"),e.l={O:n.getAttribLocation(r,"aVertex"),N:n.getAttribLocation(r,"aTex"),ya:a},e.v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.enableVertexAttribArray(e.l.O),n.vertexAttribPointer(e.l.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),e.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.enableVertexAttribArray(e.l.N),n.vertexAttribPointer(e.l.N,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(a,0)}r=e.l,n.useProgram(e.s),n.canvas.width=t.width,n.canvas.height=t.height,n.viewport(0,0,t.width,t.height),n.activeTexture(n.TEXTURE0),e.i.bindTexture2d(t.glName),n.enableVertexAttribArray(r.O),n.bindBuffer(n.ARRAY_BUFFER,e.v),n.vertexAttribPointer(r.O,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,e.u),n.vertexAttribPointer(r.N,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.O),n.disableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,null),e.i.bindTexture2d(0)}(e,t),"function"===typeof e.h.canvas.transferToImageBitmap?Promise.resolve(e.h.canvas.transferToImageBitmap()):n?Promise.resolve(e.h.canvas):"function"===typeof createImageBitmap?createImageBitmap(e.h.canvas):(void 0===e.j&&(e.j=document.createElement("canvas")),new Promise(function(t){e.j.height=e.h.canvas.height,e.j.width=e.h.canvas.width,e.j.getContext("2d",{}).drawImage(e.h.canvas,0,0,e.h.canvas.width,e.h.canvas.height),t(e.j)}))}function ln(e){this.h=e}Jt.prototype.l=Ut(en);var un=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function dn(e,t){return t+e}function hn(e,t){window[e]=t}function pn(e){if(this.h=e,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=e&&e.locateFile||dn,"object"===typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"===typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=t,e.options)for(var n=(t=s(Object.keys(e.options))).next();!n.done;n=t.next()){n=n.value;var r=e.options[n].default;void 0!==r&&(this.l[n]="function"===typeof r?r():r)}}function fn(e){var t,n,r,a,o,i,s,l,u,d,h;return C(function(p){switch(p.h){case 1:return e.ga?(t=void 0===e.h.files?[]:"function"===typeof e.h.files?e.h.files(e.l):e.h.files,b(p,C(function(e){switch(e.h){case 1:return e.s=2,b(e,WebAssembly.instantiate(un),4);case 4:e.h=3,e.s=0;break;case 2:return e.s=0,e.l=null,e.return(!1);case 3:return e.return(!0)}}),2)):p.return();case 2:if(n=p.i,"object"===typeof window)return hn("createMediapipeSolutionsWasm",{locateFile:e.locateFile}),hn("createMediapipeSolutionsPackedAssets",{locateFile:e.locateFile}),i=t.filter(function(e){return void 0!==e.data}),s=t.filter(function(e){return void 0===e.data}),l=Promise.all(i.map(function(t){var n=mn(e,t.url);if(void 0!==t.path){var r=t.path;n=n.then(function(t){return e.overrideFile(r,t),Promise.resolve(t)})}return n})),u=Promise.all(s.map(function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise(function(e){t.addEventListener("load",function(){e()},!1),t.addEventListener("error",function(){e()},!1),document.body.appendChild(t)})}(e.locateFile(t.url,e.ha)):Promise.resolve()})).then(function(){var t,n,r;return C(function(a){if(1==a.h)return t=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=e,b(a,t(n),2);r.i=a.i,a.h=0})}),d=C(function(t){return e.h.graph&&e.h.graph.url?t=b(t,mn(e,e.h.graph.url),0):(t.h=0,t=void 0),t}),b(p,Promise.all([u,l,d]),7);if("function"!==typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=t.filter(function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n}).map(function(t){return e.locateFile(t.url,e.ha)}),importScripts.apply(null,c(r)),a=e,b(p,createMediapipeSolutionsWasm(Module),6);case 6:a.i=p.i,e.m=new OffscreenCanvas(1,1),e.i.canvas=e.m,o=e.i.GL.createContext(e.m,{antialias:!1,alpha:!1,va:"undefined"!==typeof WebGL2RenderingContext?2:1}),e.i.GL.makeContextCurrent(o),p.h=4;break;case 7:if(e.m=document.createElement("canvas"),!(h=e.m.getContext("webgl2",{}))&&!(h=e.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),p.return();e.K=h,e.i.canvas=e.m,e.i.createContext(e.m,!0,!0,{});case 4:e.j=new e.i.SolutionWasm,e.ga=!1,p.h=0}})}function mn(e,t){var n,r;return C(function(a){return t in e.L?a.return(e.L[t]):(n=e.locateFile(t,""),r=fetch(n).then(function(e){return e.arrayBuffer()}),e.L[t]=r,a.return(r))})}function gn(e,t,n){var r,a,o,i,c,l,u,d,h,p,f,m,g,y;return C(function(v){switch(v.h){case 1:if(!n)return v.return(t);for(r={},a=0,o=s(Object.keys(n)),i=o.next();!i.done;i=o.next())c=i.value,"string"!==typeof(l=n[c])&&"texture"===l.type&&void 0!==t[l.stream]&&++a;1<a&&(e.M=!1),u=s(Object.keys(n)),i=u.next();case 2:if(i.done){v.h=4;break}if(d=i.value,"string"===typeof(h=n[d]))return g=r,y=d,b(v,function(e,t,n){var r;return C(function(a){return"number"===typeof n||n instanceof Uint8Array||n instanceof e.i.Uint8BlobList?a.return(n):n instanceof e.i.Texture2dDataOut?((r=e.v[t])||(r=new sn(e.i,e.K),e.v[t]=r),a.return(cn(r,n,e.M))):a.return(void 0)})}(e,d,t[h]),14);if(p=t[h.stream],"detection_list"===h.type){if(p){for(var x=p.getRectList(),w=p.getLandmarksList(),k=p.getClassificationsList(),S=[],I=0;I<x.size();++I){var E=tn(x.get(I)),T=void 0;T=void 0===T?0:T,E={la:{sa:et(E,1),ta:et(E,2),height:et(E,3),width:et(E,4),rotation:et(E,5,0),pa:Je(Ge(E,6),T)},ea:on(w.get(I)),ba:rn(qt(k.get(I)))},S.push(E)}x=S}else x=[];r[d]=x,v.h=7;break}if("proto_list"===h.type){if(p){for(x=Array(p.size()),w=0;w<p.size();w++)x[w]=p.get(w);p.delete()}else x=[];r[d]=x,v.h=7;break}if(void 0===p){v.h=3;break}if("float_list"===h.type){r[d]=p,v.h=7;break}if("proto"===h.type){r[d]=p,v.h=7;break}if("texture"!==h.type)throw Error("Unknown output config type: '"+h.type+"'");return(f=e.v[d])||(f=new sn(e.i,e.K),e.v[d]=f),b(v,cn(f,p,e.M),13);case 13:m=v.i,r[d]=m;case 7:h.transform&&r[d]&&(r[d]=h.transform(r[d])),v.h=3;break;case 14:g[y]=v.i;case 3:i=u.next(),v.h=2;break;case 4:return v.return(r)}})}function yn(e,t){for(var n=t.name||"$",r=[].concat(c(t.wants)),a=new e.i.StringList,o=s(t.wants),i=o.next();!i.done;i=o.next())a.push_back(i.value);o=e.i.PacketListener.implement({onResults:function(a){for(var o={},i=0;i<t.wants.length;++i)o[r[i]]=a.get(i);var s=e.listeners[n];s&&(e.I=gn(e,o,t.outs).then(function(n){n=s(n);for(var a=0;a<t.wants.length;++a){var i=o[r[a]];"object"===typeof i&&i.hasOwnProperty&&i.hasOwnProperty("delete")&&i.delete()}n&&(e.I=n)}))}}),e.j.attachMultiListener(a,o),a.delete()}function vn(e){switch(void 0===e&&(e=0),e){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function bn(e){var t=this;e=e||{},this.h=new pn({locateFile:e.locateFile,files:function(e){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:vn(e.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:on},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:on},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"===typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){var n,r,a;return C(function(o){return 1==o.h?(n=vn(e),r="third_party/mediapipe/modules/pose_landmark/"+n,b(o,mn(t.h,n),2)):(a=o.i,t.h.overrideFile(r,a),o.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}(e=pn.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},e.reset=function(){var e=this;return C(function(t){e.j&&(e.j.reset(),e.s={},e.v={}),t.h=0})},e.setOptions=function(e,t){var n=this;if(t=t||this.h.options){for(var r=[],a=[],o={},i=s(Object.keys(e)),c=i.next();!c.done;o={X:o.X,Y:o.Y},c=i.next())if(!((c=c.value)in this.l)||this.l[c]!==e[c]){this.l[c]=e[c];var l=t[c];void 0!==l&&(l.onChange&&(o.X=l.onChange,o.Y=e[c],r.push(function(e){return function(){return C(function(t){if(1==t.h)return b(t,e.X(e.Y),2);!0===t.i&&(n.u=!0),t.h=0})}}(o))),l.graphOptionXref&&(c=Object.assign({},{calculatorName:"",calculatorIndex:0},l.graphOptionXref,{valueNumber:1===l.type?e[c]:0,valueBoolean:0===l.type&&e[c],valueString:2===l.type?e[c]:""}),a.push(c)))}0===r.length&&0===a.length||(this.u=!0,this.H=(void 0===this.H?[]:this.H).concat(a),this.F=(void 0===this.F?[]:this.F).concat(r))}},e.initialize=function(){var e=this;return C(function(t){return 1==t.h?b(t,fn(e),2):3!=t.h?b(t,function(e){var t,n,r,a,o,i,c,l;return C(function(u){if(1==u.h)return e.h.graph&&e.h.graph.url&&e.fa===e.h.graph.url?u.return():(e.u=!0,e.h.graph&&e.h.graph.url?(e.fa=e.h.graph.url,b(u,mn(e,e.h.graph.url),3)):void(u.h=2));for(2!=u.h&&(t=u.i,e.j.loadGraph(t)),n=s(Object.keys(e.D)),r=n.next();!r.done;r=n.next())a=r.value,e.j.overrideFile(a,e.D[a]);if(e.D={},e.h.listeners)for(o=s(e.h.listeners),i=o.next();!i.done;i=o.next())c=i.value,yn(e,c);l=e.l,e.l={},e.setOptions(l),u.h=0})}(e),3):b(t,function(e){var t,n,r,a,o,i;return C(function(c){switch(c.h){case 1:if(!e.u)return c.return();if(!e.F){c.h=2;break}t=s(e.F),n=t.next();case 3:if(n.done){c.h=5;break}return b(c,(0,n.value)(),4);case 4:n=t.next(),c.h=3;break;case 5:e.F=void 0;case 2:if(e.H){for(r=new e.i.GraphOptionChangeRequestList,a=s(e.H),o=a.next();!o.done;o=a.next())i=o.value,r.push_back(i);e.j.changeOptions(r),r.delete(),e.H=void 0}e.u=!1,c.h=0}})}(e),0)})},e.overrideFile=function(e,t){this.j?this.j.overrideFile(e,t):this.D[e]=t},e.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},e.send=function(e,t){var n,r,a,o,i,c,l,u,d,h=this;return C(function(p){switch(p.h){case 1:return h.h.inputs?(n=1e3*(void 0===t||null===t?performance.now():t),b(p,h.I,2)):p.return();case 2:return b(p,h.initialize(),3);case 3:for(r=new h.i.PacketDataList,a=s(Object.keys(e)),o=a.next();!o.done;o=a.next())if(i=o.value,c=h.h.inputs[i]){e:{var f=e[i];switch(c.type){case"video":var m=h.s[c.stream];if(m||(m=new sn(h.i,h.K),h.s[c.stream]=m),0===m.m&&(m.m=m.i.createTexture()),"undefined"!==typeof HTMLVideoElement&&f instanceof HTMLVideoElement)var g=f.videoWidth,y=f.videoHeight;else"undefined"!==typeof HTMLImageElement&&f instanceof HTMLImageElement?(g=f.naturalWidth,y=f.naturalHeight):(g=f.width,y=f.height);y={glName:m.m,width:g,height:y},(g=m.h).canvas.width=y.width,g.canvas.height=y.height,g.activeTexture(g.TEXTURE0),m.i.bindTexture2d(m.m),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,f),m.i.bindTexture2d(0),m=y;break e;case"detections":for((m=h.s[c.stream])||(m=new ln(h.i),h.s[c.stream]=m),m.data||(m.data=new m.h.DetectionListData),m.data.reset(f.length),y=0;y<f.length;++y){g=f[y];var v=m.data,x=v.setBoundingBox,w=y,k=g.la,S=new Jt;if(Ze(S,1,k.sa),Ze(S,2,k.ta),Ze(S,3,k.height),Ze(S,4,k.width),Ze(S,5,k.rotation),He(S,6,k.pa),k=S.l(),x.call(v,w,k),g.ea)for(v=0;v<g.ea.length;++v){S=g.ea[v],w=(x=m.data).addNormalizedLandmark,k=y,S=Object.assign({},S,{visibility:S.visibility?S.visibility:0});var C=new Xt;Ze(C,1,S.x),Ze(C,2,S.y),Ze(C,3,S.z),S.visibility&&Ze(C,4,S.visibility),S=C.l(),w.call(x,k,S)}if(g.ba)for(v=0;v<g.ba.length;++v)w=(x=m.data).addClassification,k=y,S=g.ba[v],Ze(C=new Vt,2,S.qa),S.index&&He(C,1,S.index),S.label&&He(C,3,S.label),S.displayName&&He(C,4,S.displayName),S=C.l(),w.call(x,k,S)}m=m.data;break e;default:m={}}}switch(l=m,u=c.stream,c.type){case"video":r.pushTexture2d(Object.assign({},l,{stream:u,timestamp:n}));break;case"detections":(d=l).stream=u,d.timestamp=n,r.pushDetectionList(d);break;default:throw Error("Unknown input config type: '"+c.type+"'")}}return h.j.send(r),b(p,h.I,4);case 4:r.delete(),p.h=0}})},e.onResults=function(e,t){this.listeners[t||"$"]=e},T("Solution",pn),T("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=bn.prototype).reset=function(){this.h.reset()},e.close=function(){return this.h.close(),Promise.resolve()},e.onResults=function(e){this.h.onResults(e)},e.initialize=function(){var e=this;return C(function(t){return b(t,e.h.initialize(),0)})},e.send=function(e,t){var n=this;return C(function(r){return b(r,n.h.send(e,t),0)})},e.setOptions=function(e){this.h.setOptions(e)},T("Pose",bn),T("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),T("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),T("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),T("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),T("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),T("VERSION","0.5.1675469404")}).call(this)},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var a,o={},i=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,a)&&!C.hasOwnProperty(a)&&(o[a]=t[a]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===o[a]&&(o[a]=c[a]);return{$$typeof:n,type:e,key:i,ref:s,props:o,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function O(e,t,a,o,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return i=i(c=e),e=""===o?"."+N(c,0):o,w(i)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),O(i,t,a,"",function(e){return e})):null!=i&&(E(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,a+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(T,"$&/")+"/")+e)),t.push(i)),1;if(c=0,o=""===o?".":o+":",w(e))for(var l=0;l<e.length;l++){var u=o+N(s=e[l],l);c+=O(s,t,a,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=O(s=s.value,t,a,u=o+N(s,l++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function A(e,t,n){if(null==e)return e;var r=[],a=0;return O(e,r,"","",function(e){return t.call(n,e,a++)}),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},P={transition:null},D={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:P,ReactCurrentOwner:S};t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=i,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),o=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)k.call(t,l)&&!C.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:n,type:e.type,key:o,ref:i,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},4208:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.uniqBy=function(e,t){const n=new Map;for(let r=0;r<e.length;r++){const a=e[r],o=t(a);n.has(o)||n.set(o,a)}return Array.from(n.values())}},4332:(e,t,n)=>{e.exports=n(5053).uniqBy},4334:(e,t,n)=>{var r=n(7359),a=n(7066),o=n(9016),i=n(9538),s=n(6288),c=n(5262),l=n(2430);l.alea=r,l.xor128=a,l.xorwow=o,l.xorshift7=i,l.xor4096=s,l.tychei=c,e.exports=l},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4704:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;t.isIndex=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return n.test(e)}}},4803:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isPrimitive=function(e){return null==e||"object"!==typeof e&&"function"!==typeof e}},4830:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.debounce=function(e,t){let n,{signal:r,edges:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null;const i=null!=a&&a.includes("leading"),s=null==a||a.includes("trailing"),c=()=>{null!==o&&(e.apply(n,o),n=void 0,o=null)};let l=null;const u=()=>{null!=l&&clearTimeout(l),l=setTimeout(()=>{l=null,s&&c(),d()},t)},d=()=>{null!==l&&(clearTimeout(l),l=null),n=void 0,o=null},h=function(){if(null!==r&&void 0!==r&&r.aborted)return;n=this;for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];o=t;const s=null==l;u(),i&&s&&c()};return h.schedule=u,h.cancel=d,h.flush=()=>{c()},null===r||void 0===r||r.addEventListener("abort",d,{once:!0}),h}},4879:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6770);t.toFinite=function(e){if(!e)return 0===e?e:0;if((e=r.toNumber(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e===e?e:0}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5053:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(4208),a=n(9599),o=n(2104),i=n(2715);t.uniqBy=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.identity;return o.isArrayLikeObject(e)?r.uniqBy(Array.from(e),i.iteratee(t)):[]}},5261:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433);t.cloneDeep=function(e){return r.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},5262:function(e,t,n){var r;!function(e,a){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},5303:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2489),a=n(4704),o=n(6321),i=n(1444);t.has=function(e,t){let n;if(n=Array.isArray(t)?t:"string"===typeof t&&r.isDeepKey(t)&&null==(null===e||void 0===e?void 0:e[t])?i.toPath(t):[t],0===n.length)return!1;let s=e;for(let r=0;r<n.length;r++){const e=n[r];if(null==s||!Object.hasOwn(s,e)){if(!((Array.isArray(s)||o.isArguments(s))&&a.isIndex(e)&&e<s.length))return!1}s=s[e]}return!0}},5316:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9709),a=n(7043),o=n(1444);t.orderBy=function(e,t,n,i){if(null==e)return[];n=i?void 0:n,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(n)||(n=null==n?[]:[n]),n=n.map(e=>String(e));const s=(e,t)=>{let n=e;for(let r=0;r<t.length&&null!=n;++r)n=n[t[r]];return n},c=t.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"===typeof e||Array.isArray(e)||a.isKey(e)?e:{key:e,path:o.toPath(e)}));return e.map(e=>({original:e,criteria:c.map(t=>((e,t)=>null==t||null==e?t:"object"===typeof e&&"key"in e?Object.hasOwn(t,e.key)?t[e.key]:s(t,e.path):"function"===typeof e?e(t):Array.isArray(e)?s(t,e):"object"===typeof t?t[e]:t)(t,e))})).slice().sort((e,t)=>{for(let a=0;a<c.length;a++){const o=r.compareValues(e.criteria[a],t.criteria[a],n[a]);if(0!==o)return o}return 0}).map(e=>e.original)}},5414:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(1293);t.throttle=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{leading:a=!0,trailing:o=!0}=n;return r.debounce(e,t,{leading:a,maxWait:t,trailing:o})}},5508:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6433),a=n(7599);t.cloneDeepWith=function(e,t){return r.cloneDeepWith(e,(n,o,i,s)=>{const c=null===t||void 0===t?void 0:t(n,o,i,s);if(void 0!==c)return c;if("object"===typeof e)switch(Object.prototype.toString.call(e)){case a.numberTag:case a.stringTag:case a.booleanTag:{const t=new e.constructor(null===e||void 0===e?void 0:e.valueOf());return r.copyProperties(t,e),t}case a.argumentsTag:{const t={};return r.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}},5817:()=>{},5990:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},6288:function(e,t,n){var r;!function(e,a){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,o=t.i;return t.w=r=r+1640531527|0,n=a[o+34&127],e=a[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,a,o,i,s=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),a=0,o=-32;o<c;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=i+1640531527|0,a=0==(n=s[127&o]^=r+i)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,o=512;o>0;--o)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=i,e.X=s,e.i=a}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},6321:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5990);t.isArguments=function(e){return null!==e&&"object"===typeof e&&"[object Arguments]"===r.getTag(e)}},6392:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.last=function(e){return e[e.length-1]}},6433:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6443),a=n(5990),o=n(7599),i=n(4803),s=n(3757);function c(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d=null===u||void 0===u?void 0:u(e,t,n,r);if(void 0!==d)return d;if(i.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const t=new Array(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=c(e[a],a,n,r,u);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;r.set(e,t);for(const[a,o]of e)t.set(a,c(o,a,n,r,u));return t}if(e instanceof Set){const t=new Set;r.set(e,t);for(const a of e)t.add(c(a,void 0,n,r,u));return t}if("undefined"!==typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(s.isTypedArray(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);r.set(e,t);for(let a=0;a<e.length;a++)t[a]=c(e[a],a,n,r,u);return t}if(e instanceof ArrayBuffer||"undefined"!==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),l(t,e,n,r,u),t}if("undefined"!==typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return r.set(e,t),l(t,e,n,r,u),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return r.set(e,t),l(t,e,n,r,u),t}if(e instanceof Error){const t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,l(t,e,n,r,u),t}if("object"===typeof e&&function(e){switch(a.getTag(e)){case o.argumentsTag:case o.arrayTag:case o.arrayBufferTag:case o.dataViewTag:case o.booleanTag:case o.dateTag:case o.float32ArrayTag:case o.float64ArrayTag:case o.int8ArrayTag:case o.int16ArrayTag:case o.int32ArrayTag:case o.mapTag:case o.numberTag:case o.objectTag:case o.regexpTag:case o.setTag:case o.stringTag:case o.symbolTag:case o.uint8ArrayTag:case o.uint8ClampedArrayTag:case o.uint16ArrayTag:case o.uint32ArrayTag:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),l(t,e,n,r,u),t}return e}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const i=[...Object.keys(t),...r.getSymbols(t)];for(let r=0;r<i.length;r++){const s=i[r],l=Object.getOwnPropertyDescriptor(e,s);(null==l||l.writable)&&(e[s]=c(t[s],s,n,a,o))}}t.cloneDeepWith=function(e,t){return c(e,void 0,e,new Map,t)},t.cloneDeepWithImpl=c,t.copyProperties=l},6443:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}},6770:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777);t.toNumber=function(e){return r.isSymbol(e)?NaN:Number(e)}},7043:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2777),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.isKey=function(e,t){return!Array.isArray(e)&&(!("number"!==typeof e&&"boolean"!==typeof e&&null!=e&&!r.isSymbol(e))||("string"===typeof e&&(o.test(e)||!a.test(e))||null!=t&&Object.hasOwn(t,e)))}},7066:function(e,t,n){var r;!function(e,a){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},7231:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(3799),a=n(4879);t.range=function(e,t,n){n&&"number"!==typeof n&&r.isIterateeCall(e,t,n)&&(t=n=void 0),e=a.toFinite(e),void 0===t?(t=e,e=0):t=a.toFinite(t),n=void 0===n?e<t?1:-1:a.toFinite(n);const o=Math.max(Math.ceil((t-e)/(n||1)),0),i=new Array(o);for(let r=0;r<o;r++)i[r]=e,e+=n;return i}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<o(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,i=a>>>1;r<i;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<a&&0>o(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<a&&0>o(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function w(e){if(g=!1,x(e),!m)if(null!==r(l))m=!0,P(k);else{var t=r(u);null!==t&&D(w,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,v(E),E=-1),f=!0;var o=p;try{for(x(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!O());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var s=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(l)&&a(l),x(n)}else a(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&D(w,d.startTime-n),c=!1}return c}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,C=!1,I=null,E=-1,T=5,N=-1;function O(){return!(t.unstable_now()-N<T)}function A(){if(null!==I){var e=t.unstable_now();N=e;var n=!0;try{n=I(!0,e)}finally{n?S():(C=!1,I=null)}}else C=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,R=_.port2;_.port1.onmessage=A,S=function(){R.postMessage(null)}}else S=function(){y(A,0)};function P(e){I=e,C||(C=!0,S())}function D(e,n){E=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,P(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,o){var i=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?i+o:i:o=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>i?(e.sortIndex=o,n(u,e),null===r(l)&&e===r(u)&&(g?(v(E),E=-1):g=!0,D(w,o-i))):(e.sortIndex=s,n(l,e),m||f||(m=!0,P(k))),e},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7237:(e,t,n)=>{"use strict";n(8365)},7260:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isUnsafeProperty=function(e){return"__proto__"===e}},7283:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,i){if("function"!==typeof r)throw new TypeError("The listener must be a function");var s=new a(r,o||e,i),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function i(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,o=r.length,i=new Array(o);a<o;a++)i[a]=r[a].fn;return i},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,a,o,i){var s=n?n+e:e;if(!this._events[s])return!1;var c,l,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,a),!0;case 5:return u.fn.call(u.context,t,r,a,o),!0;case 6:return u.fn.call(u.context,t,r,a,o,i),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,a);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,a){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return i(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||i(this,o);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==t||a&&!s[c].once||r&&s[c].context!==r)&&l.push(s[c]);l.length?this._events[o]=1===l.length?l[0]:l:i(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},7312:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.flatten=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=[],r=Math.floor(t),a=(e,t)=>{for(let o=0;o<e.length;o++){const i=e[o];Array.isArray(i)&&t<r?a(i,t+1):n.push(i)}};return a(e,0),n}},7330:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(9323);t.property=function(e){return function(t){return r.get(t,e)}}},7353:e=>{e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(I){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},o={};function i(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=o[e])?r:(n=c(e,(0|e)<0?-1:0,!0),i&&(o[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=c(e,e<0?-1:0,!1),i&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?y:g;if(t){if(e<0)return y;if(e>=p)return k}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?s(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,r){return new n(e,t,r)}n.fromInt=i,n.fromNumber=s,n.fromBits=c;var l=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var a=s(l(n,8)),o=g,i=0;i<e.length;i+=8){var c=Math.min(8,e.length-i),d=parseInt(e.substring(i,i+c),n);if(c<8){var h=s(l(n,c));o=o.mul(h).add(s(d))}else o=(o=o.mul(a)).add(s(d))}return o.unsigned=t,o}function d(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?u(e,t):c(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=u,n.fromValue=d;var h=4294967296,p=h*h,f=p/2,m=i(1<<24),g=i(0);n.ZERO=g;var y=i(0,!0);n.UZERO=y;var v=i(1);n.ONE=v;var b=i(1,!0);n.UONE=b;var x=i(-1);n.NEG_ONE=x;var w=c(-1,2147483647,!1);n.MAX_VALUE=w;var k=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=c(0,-2147483648,!1);n.MIN_VALUE=S;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(l(e,6),this.unsigned),o=this,i="";;){var c=o.div(a),u=(o.sub(c.mul(a)).toInt()>>>0).toString(e);if((o=c).isZero())return u+i;for(;u.length<6;)u="0"+u;i=""+u+i}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1===(1&this.low)},C.isEven=function(){return 0===(1&this.low)},C.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},C.neg=C.negate,C.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,l=e.low>>>16,u=0,h=0,p=0,f=0;return p+=(f+=o+(65535&e.low))>>>16,h+=(p+=a+l)>>>16,u+=(h+=n+s)>>>16,u+=t+i,c((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},C.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(S))return e.isOdd()?S:g;if(e.eq(S))return this.isOdd()?S:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,o=this.low>>>16,i=65535&this.low,l=e.high>>>16,u=65535&e.high,h=e.low>>>16,p=65535&e.low,f=0,y=0,v=0,b=0;return v+=(b+=i*p)>>>16,y+=(v+=o*p)>>>16,v&=65535,y+=(v+=i*h)>>>16,f+=(y+=a*p)>>>16,y&=65535,f+=(y+=o*h)>>>16,y&=65535,f+=(y+=i*u)>>>16,f+=n*p+a*h+o*u+i*l,c((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(y&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var n,a,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return b;o=y}else{if(this.eq(S))return e.eq(v)||e.eq(x)?S:e.eq(S)?v:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:x:(a=this.sub(e.mul(n)),o=n.add(a.div(e)));if(e.eq(S))return this.unsigned?y:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=g}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(n)/Math.LN2),u=i<=48?1:l(2,i-48),h=s(n),p=h.mul(e);p.isNegative()||p.gt(a);)p=(h=s(n-=u,this.unsigned)).mul(e);h.isZero()&&(h=v),o=o.add(h),a=a.sub(p)}return o},C.div=C.divide,C.modulo=function(e){return r(e)||(e=d(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return c(~this.low,~this.high,this.unsigned)},C.and=function(e){return r(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return r(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return r(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},7359:function(e,t,n){var r;!function(e,a){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},7599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.argumentsTag="[object Arguments]",t.arrayBufferTag="[object ArrayBuffer]",t.arrayTag="[object Array]",t.bigInt64ArrayTag="[object BigInt64Array]",t.bigUint64ArrayTag="[object BigUint64Array]",t.booleanTag="[object Boolean]",t.dataViewTag="[object DataView]",t.dateTag="[object Date]",t.errorTag="[object Error]",t.float32ArrayTag="[object Float32Array]",t.float64ArrayTag="[object Float64Array]",t.functionTag="[object Function]",t.int16ArrayTag="[object Int16Array]",t.int32ArrayTag="[object Int32Array]",t.int8ArrayTag="[object Int8Array]",t.mapTag="[object Map]",t.numberTag="[object Number]",t.objectTag="[object Object]",t.regexpTag="[object RegExp]",t.setTag="[object Set]",t.stringTag="[object String]",t.symbolTag="[object Symbol]",t.uint16ArrayTag="[object Uint16Array]",t.uint32ArrayTag="[object Uint32Array]",t.uint8ArrayTag="[object Uint8Array]",t.uint8ClampedArrayTag="[object Uint8ClampedArray]"},7736:(e,t,n)=>{var r=n(3738).default,a=n(9045);e.exports=function(e){var t=a(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7770:(e,t,n)=>{e.exports=n(9323).get},7820:(e,t,n)=>{e.exports=n(5414).throttle},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8210:function(e,t,n){var r;!function(){"use strict";var a,o=1e9,i={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},s=!0,c="[DecimalError] ",l=c+"Invalid argument: ",u=c+"Exponent out of range: ",d=Math.floor,h=Math.pow,p=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,f=1e7,m=9007199254740991,g=d(1286742750677284.5),y={};function v(e,t){var n,r,a,o,i,c,l,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),s?N(t,h):t;if(l=e.d,u=t.d,i=e.e,a=t.e,l=l.slice(),o=i-a){for(o<0?(r=l,o=-o,c=u.length):(r=u,a=i,c=l.length),o>(c=(i=Math.ceil(h/7))>c?i+1:c+1)&&(o=c,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for((c=l.length)-(o=u.length)<0&&(o=c,r=u,u=l,l=r),n=0;o;)n=(l[--o]=l[o]+u[o]+n)/f|0,l[o]%=f;for(n&&(l.unshift(n),++a),c=l.length;0==l[--c];)l.pop();return t.d=l,t.e=a,s?N(t,h):t}function b(e,t,n){if(e!==~~e||e<t||e>n)throw Error(l+e)}function x(e){var t,n,r,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)(n=7-(r=e[t]+"").length)&&(o+=I(n)),o+=r;(n=7-(r=(i=e[t])+"").length)&&(o+=I(n))}else if(0===i)return"0";for(;i%10===0;)i/=10;return o+i}y.absoluteValue=y.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},y.comparedTo=y.cmp=function(e){var t,n,r,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(t=0,n=(r=o.d.length)<(a=e.d.length)?r:a;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return r===a?0:r>a^o.s<0?1:-1},y.decimalPlaces=y.dp=function(){var e=this,t=e.d.length-1,n=7*(t-e.e);if(t=e.d[t])for(;t%10==0;t/=10)n--;return n<0?0:n},y.dividedBy=y.div=function(e){return w(this,new this.constructor(e))},y.dividedToIntegerBy=y.idiv=function(e){var t=this.constructor;return N(w(this,new t(e),0,1),t.precision)},y.equals=y.eq=function(e){return!this.cmp(e)},y.exponent=function(){return S(this)},y.greaterThan=y.gt=function(e){return this.cmp(e)>0},y.greaterThanOrEqualTo=y.gte=function(e){return this.cmp(e)>=0},y.isInteger=y.isint=function(){return this.e>this.d.length-2},y.isNegative=y.isneg=function(){return this.s<0},y.isPositive=y.ispos=function(){return this.s>0},y.isZero=function(){return 0===this.s},y.lessThan=y.lt=function(e){return this.cmp(e)<0},y.lessThanOrEqualTo=y.lte=function(e){return this.cmp(e)<1},y.logarithm=y.log=function(e){var t,n=this,r=n.constructor,o=r.precision,i=o+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(a))throw Error(c+"NaN");if(n.s<1)throw Error(c+(n.s?"NaN":"-Infinity"));return n.eq(a)?new r(0):(s=!1,t=w(E(n,i),E(e,i),i),s=!0,N(t,o))},y.minus=y.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?O(t,e):v(t,(e.s=-e.s,e))},y.modulo=y.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(c+"NaN");return n.s?(s=!1,t=w(n,e,0,1).times(e),s=!0,n.minus(t)):N(new r(n),a)},y.naturalExponential=y.exp=function(){return k(this)},y.naturalLogarithm=y.ln=function(){return E(this)},y.negated=y.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},y.plus=y.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?v(t,e):O(t,(e.s=-e.s,e))},y.precision=y.sd=function(e){var t,n,r,a=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(l+e);if(t=S(a)+1,n=7*(r=a.d.length-1)+1,r=a.d[r]){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},y.squareRoot=y.sqrt=function(){var e,t,n,r,a,o,i,l=this,u=l.constructor;if(l.s<1){if(!l.s)return new u(0);throw Error(c+"NaN")}for(e=S(l),s=!1,0==(a=Math.sqrt(+l))||a==1/0?(((t=x(l.d)).length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=d((e+1)/2)-(e<0||e%2),r=new u(t=a==1/0?"5e"+e:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+e)):r=new u(a.toString()),a=i=(n=u.precision)+3;;)if(r=(o=r).plus(w(l,o,i+2)).times(.5),x(o.d).slice(0,i)===(t=x(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&"4999"==t){if(N(o,n+1,0),o.times(o).eq(l)){r=o;break}}else if("9999"!=t)break;i+=4}return s=!0,N(r,n)},y.times=y.mul=function(e){var t,n,r,a,o,i,c,l,u,d=this,h=d.constructor,p=d.d,m=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,n=d.e+e.e,(l=p.length)<(u=m.length)&&(o=p,p=m,m=o,i=l,l=u,u=i),o=[],r=i=l+u;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,a=l+r;a>r;)c=o[a]+m[r]*p[a-r-1]+t,o[a--]=c%f|0,t=c/f|0;o[a]=(o[a]+t)%f|0}for(;!o[--i];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,s?N(e,h.precision):e},y.toDecimalPlaces=y.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(b(e,0,o),void 0===t?t=r.rounding:b(t,0,8),N(n,e+S(n)+1,t))},y.toExponential=function(e,t){var n,r=this,a=r.constructor;return void 0===e?n=A(r,!0):(b(e,0,o),void 0===t?t=a.rounding:b(t,0,8),n=A(r=N(new a(r),e+1,t),!0,e+1)),n},y.toFixed=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?A(a):(b(e,0,o),void 0===t?t=i.rounding:b(t,0,8),n=A((r=N(new i(a),e+S(a)+1,t)).abs(),!1,e+S(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)},y.toInteger=y.toint=function(){var e=this,t=e.constructor;return N(new t(e),S(e)+1,t.rounding)},y.toNumber=function(){return+this},y.toPower=y.pow=function(e){var t,n,r,o,i,l,u=this,h=u.constructor,p=+(e=new h(e));if(!e.s)return new h(a);if(!(u=new h(u)).s){if(e.s<1)throw Error(c+"Infinity");return u}if(u.eq(a))return u;if(r=h.precision,e.eq(a))return N(u,r);if(l=(t=e.e)>=(n=e.d.length-1),i=u.s,l){if((n=p<0?-p:p)<=m){for(o=new h(a),t=Math.ceil(r/7+4),s=!1;n%2&&_((o=o.times(u)).d,t),0!==(n=d(n/2));)_((u=u.times(u)).d,t);return s=!0,e.s<0?new h(a).div(o):N(o,r)}}else if(i<0)throw Error(c+"NaN");return i=i<0&&1&e.d[Math.max(t,n)]?-1:1,u.s=1,s=!1,o=e.times(E(u,r+12)),s=!0,(o=k(o)).s=i,o},y.toPrecision=function(e,t){var n,r,a=this,i=a.constructor;return void 0===e?r=A(a,(n=S(a))<=i.toExpNeg||n>=i.toExpPos):(b(e,1,o),void 0===t?t=i.rounding:b(t,0,8),r=A(a=N(new i(a),e,t),e<=(n=S(a))||n<=i.toExpNeg,e)),r},y.toSignificantDigits=y.tosd=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(b(e,1,o),void 0===t?t=n.rounding:b(t,0,8)),N(new n(this),e,t)},y.toString=y.valueOf=y.val=y.toJSON=function(){var e=this,t=S(e),n=e.constructor;return A(e,t<=n.toExpNeg||t>=n.toExpPos)};var w=function(){function e(e,t){var n,r=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+r,e[a]=n%f|0,r=n/f|0;return r&&e.unshift(r),e}function t(e,t,n,r){var a,o;if(n!=r)o=n>r?1:-1;else for(a=o=0;a<n;a++)if(e[a]!=t[a]){o=e[a]>t[a]?1:-1;break}return o}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*f+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,a,o,i){var s,l,u,d,h,p,m,g,y,v,b,x,w,k,C,I,E,T,O=r.constructor,A=r.s==a.s?1:-1,_=r.d,R=a.d;if(!r.s)return new O(r);if(!a.s)throw Error(c+"Division by zero");for(l=r.e-a.e,E=R.length,C=_.length,g=(m=new O(A)).d=[],u=0;R[u]==(_[u]||0);)++u;if(R[u]>(_[u]||0)&&--l,(x=null==o?o=O.precision:i?o+(S(r)-S(a))+1:o)<0)return new O(0);if(x=x/7+2|0,u=0,1==E)for(d=0,R=R[0],x++;(u<C||d)&&x--;u++)w=d*f+(_[u]||0),g[u]=w/R|0,d=w%R|0;else{for((d=f/(R[0]+1)|0)>1&&(R=e(R,d),_=e(_,d),E=R.length,C=_.length),k=E,v=(y=_.slice(0,E)).length;v<E;)y[v++]=0;(T=R.slice()).unshift(0),I=R[0],R[1]>=f/2&&++I;do{d=0,(s=t(R,y,E,v))<0?(b=y[0],E!=v&&(b=b*f+(y[1]||0)),(d=b/I|0)>1?(d>=f&&(d=f-1),1==(s=t(h=e(R,d),y,p=h.length,v=y.length))&&(d--,n(h,E<p?T:R,p))):(0==d&&(s=d=1),h=R.slice()),(p=h.length)<v&&h.unshift(0),n(y,h,v),-1==s&&(s=t(R,y,E,v=y.length))<1&&(d++,n(y,E<v?T:R,v)),v=y.length):0===s&&(d++,y=[0]),g[u++]=d,s&&y[0]?y[v++]=_[k]||0:(y=[_[k]],v=1)}while((k++<C||void 0!==y[0])&&x--)}return g[0]||g.shift(),m.e=l,N(m,i?o+S(m)+1:o)}}();function k(e,t){var n,r,o,i,c,l=0,d=0,p=e.constructor,f=p.precision;if(S(e)>16)throw Error(u+S(e));if(!e.s)return new p(a);for(null==t?(s=!1,c=f):c=t,i=new p(.03125);e.abs().gte(.1);)e=e.times(i),d+=5;for(c+=Math.log(h(2,d))/Math.LN10*2+5|0,n=r=o=new p(a),p.precision=c;;){if(r=N(r.times(e),c),n=n.times(++l),x((i=o.plus(w(r,n,c))).d).slice(0,c)===x(o.d).slice(0,c)){for(;d--;)o=N(o.times(o),c);return p.precision=f,null==t?(s=!0,N(o,f)):o}o=i}}function S(e){for(var t=7*e.e,n=e.d[0];n>=10;n/=10)t++;return t}function C(e,t,n){if(t>e.LN10.sd())throw s=!0,n&&(e.precision=n),Error(c+"LN10 precision limit exceeded");return N(new e(e.LN10),t)}function I(e){for(var t="";e--;)t+="0";return t}function E(e,t){var n,r,o,i,l,u,d,h,p,f=1,m=e,g=m.d,y=m.constructor,v=y.precision;if(m.s<1)throw Error(c+(m.s?"NaN":"-Infinity"));if(m.eq(a))return new y(0);if(null==t?(s=!1,h=v):h=t,m.eq(10))return null==t&&(s=!0),C(y,h);if(h+=10,y.precision=h,r=(n=x(g)).charAt(0),i=S(m),!(Math.abs(i)<15e14))return d=C(y,h+2,v).times(i+""),m=E(new y(r+"."+n.slice(1)),h-10).plus(d),y.precision=v,null==t?(s=!0,N(m,v)):m;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=x((m=m.times(e)).d)).charAt(0),f++;for(i=S(m),r>1?(m=new y("0."+n),i++):m=new y(r+"."+n.slice(1)),u=l=m=w(m.minus(a),m.plus(a),h),p=N(m.times(m),h),o=3;;){if(l=N(l.times(p),h),x((d=u.plus(w(l,new y(o),h))).d).slice(0,h)===x(u.d).slice(0,h))return u=u.times(2),0!==i&&(u=u.plus(C(y,h+2,v).times(i+""))),u=w(u,new y(f),h),y.precision=v,null==t?(s=!0,N(u,v)):u;u=d,o+=2}}function T(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);)++r;for(a=t.length;48===t.charCodeAt(a-1);)--a;if(t=t.slice(r,a)){if(a-=r,n=n-r-1,e.e=d(n/7),e.d=[],r=(n+1)%7,n<0&&(r+=7),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=7;r<a;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),s&&(e.e>g||e.e<-g))throw Error(u+n)}else e.s=0,e.e=0,e.d=[0];return e}function N(e,t,n){var r,a,o,i,c,l,p,m,y=e.d;for(i=1,o=y[0];o>=10;o/=10)i++;if((r=t-i)<0)r+=7,a=t,p=y[m=0];else{if((m=Math.ceil((r+1)/7))>=(o=y.length))return e;for(p=o=y[m],i=1;o>=10;o/=10)i++;a=(r%=7)-7+i}if(void 0!==n&&(c=p/(o=h(10,i-a-1))%10|0,l=t<0||void 0!==y[m+1]||p%o,l=n<4?(c||l)&&(0==n||n==(e.s<0?3:2)):c>5||5==c&&(4==n||l||6==n&&(r>0?a>0?p/h(10,i-a):0:y[m-1])%10&1||n==(e.s<0?8:7))),t<1||!y[0])return l?(o=S(e),y.length=1,t=t-o-1,y[0]=h(10,(7-t%7)%7),e.e=d(-t/7)||0):(y.length=1,y[0]=e.e=e.s=0),e;if(0==r?(y.length=m,o=1,m--):(y.length=m+1,o=h(10,7-r),y[m]=a>0?(p/h(10,i-a)%h(10,a)|0)*o:0),l)for(;;){if(0==m){(y[0]+=o)==f&&(y[0]=1,++e.e);break}if(y[m]+=o,y[m]!=f)break;y[m--]=0,o=1}for(r=y.length;0===y[--r];)y.pop();if(s&&(e.e>g||e.e<-g))throw Error(u+S(e));return e}function O(e,t){var n,r,a,o,i,c,l,u,d,h,p=e.constructor,m=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),s?N(t,m):t;if(l=e.d,h=t.d,r=t.e,u=e.e,l=l.slice(),i=u-r){for((d=i<0)?(n=l,i=-i,c=h.length):(n=h,r=u,c=l.length),i>(a=Math.max(Math.ceil(m/7),c)+2)&&(i=a,n.length=1),n.reverse(),a=i;a--;)n.push(0);n.reverse()}else{for((d=(a=l.length)<(c=h.length))&&(c=a),a=0;a<c;a++)if(l[a]!=h[a]){d=l[a]<h[a];break}i=0}for(d&&(n=l,l=h,h=n,t.s=-t.s),c=l.length,a=h.length-c;a>0;--a)l[c++]=0;for(a=h.length;a>i;){if(l[--a]<h[a]){for(o=a;o&&0===l[--o];)l[o]=f-1;--l[o],l[a]+=f}l[a]-=h[a]}for(;0===l[--c];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(t.d=l,t.e=r,s?N(t,m):t):new p(0)}function A(e,t,n){var r,a=S(e),o=x(e.d),i=o.length;return t?(n&&(r=n-i)>0?o=o.charAt(0)+"."+o.slice(1)+I(r):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+I(-a-1)+o,n&&(r=n-i)>0&&(o+=I(r))):a>=i?(o+=I(a+1-i),n&&(r=n-a-1)>0&&(o=o+"."+I(r))):((r=a+1)<i&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-i)>0&&(a+1===i&&(o+="."),o+=I(r))),e.s<0?"-"+o:o}function _(e,t){if(e.length>t)return e.length=t,!0}function R(e){if(!e||"object"!==typeof e)throw Error(c+"Object expected");var t,n,r,a=["precision",1,o,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if(void 0!==(r=e[n=a[t]])){if(!(d(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(l+n+": "+r);this[n]=r}if(void 0!==(r=e[n="LN10"])){if(r!=Math.LN10)throw Error(l+n+": "+r);this[n]=new this(r)}return this}i=function e(t){var n,r,a;function o(e){var t=this;if(!(t instanceof o))return new o(e);if(t.constructor=o,e instanceof o)return t.s=e.s,t.e=e.e,void(t.d=(e=e.d)?e.slice():e);if("number"===typeof e){if(0*e!==0)throw Error(l+e);if(e>0)t.s=1;else{if(!(e<0))return t.s=0,t.e=0,void(t.d=[0]);e=-e,t.s=-1}return e===~~e&&e<1e7?(t.e=0,void(t.d=[e])):T(t,e.toString())}if("string"!==typeof e)throw Error(l+e);if(45===e.charCodeAt(0)?(e=e.slice(1),t.s=-1):t.s=1,!p.test(e))throw Error(l+e);T(t,e)}if(o.prototype=y,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.clone=e,o.config=o.set=R,void 0===t&&(t={}),t)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<a.length;)t.hasOwnProperty(r=a[n++])||(t[r]=this[r]);return o.config(t),o}(i),i.default=i.Decimal=i,a=new i(1),void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}()},8268:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(2132);t.isMatch=function(e,t){return r.isMatchWith(e,t,()=>{})}},8346:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},8365:(e,t,n)=>{"use strict";var r=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useSyncExternalStore,i=r.useRef,s=r.useEffect,c=r.useMemo,l=r.useDebugValue},8396:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(5508);t.cloneDeep=function(e){return r.cloneDeepWith(e)}},8420:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},8443:(e,t,n)=>{"use strict";e.exports=n(9717)},8590:()=>{},8845:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(8268),a=n(3272),o=n(8396),i=n(9323),s=n(5303);t.matchesProperty=function(e,t){switch(typeof e){case"object":var n;Object.is(null===(n=e)||void 0===n?void 0:n.valueOf(),-0)&&(e="-0");break;case"number":e=a.toKey(e)}return t=o.cloneDeep(t),function(n){const a=i.get(n,e);return void 0===a?s.has(n,e):void 0===t?void 0===a:r.isMatch(a,t)}}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,a){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9323:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(7260),a=n(2489),o=n(3272),i=n(1444);t.get=function e(t,n,s){if(null==t)return s;switch(typeof n){case"string":{if(r.isUnsafeProperty(n))return s;const o=t[n];return void 0===o?a.isDeepKey(n)?e(t,i.toPath(n),s):s:o}case"number":case"symbol":{"number"===typeof n&&(n=o.toKey(n));const e=t[n];return void 0===e?s:e}default:{var c;if(Array.isArray(n))return function(e,t,n){if(0===t.length)return n;let a=e;for(let o=0;o<t.length;o++){if(null==a)return n;if(r.isUnsafeProperty(t[o]))return n;a=a[t[o]]}if(void 0===a)return n;return a}(t,n,s);if(n=Object.is(null===(c=n)||void 0===c?void 0:c.valueOf(),-0)?"-0":String(n),r.isUnsafeProperty(n))return s;const e=t[n];return void 0===e?s:e}}}},9397:(e,t,n)=>{e.exports=n(2682).isPlainObject},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9538:function(e,t,n){var r;!function(e,a){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},9599:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.identity=function(e){return e}},9645:(e,t,n)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const r=n(6392),a=n(8346),o=n(1203);t.last=function(e){if(o.isArrayLike(e))return r.last(a.toArray(e))}},9709:(e,t)=>{"use strict";function n(e){return"symbol"===typeof e?1:null===e?2:void 0===e?3:e!==e?4:0}Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});t.compareValues=(e,t,r)=>{if(e!==t){const a=n(e),o=n(t);if(a===o&&0===a){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?o-a:a-o}return 0}},9717:(e,t,n)=>{"use strict";var r=n(5043),a=n(9461);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=a.useSyncExternalStore,s=r.useRef,c=r.useEffect,l=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=l(function(){function e(e){if(!c){if(c=!0,i=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return s=t}return s=e}if(t=s,o(i,e))return t;var n=r(e);return void 0!==a&&a(t,n)?(i=e,t):(i=e,s=n)}var i,s,c=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,n,r,a]);var p=i(e,d[0],d[1]);return c(function(){h.hasValue=!0,h.value=p},[p]),u(p),p}},9859:(e,t,n)=>{e.exports=n(7231).range},9921:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.isObjectLike=function(e){return"object"===typeof e&&null!==e}},9972:(e,t)=>{"use strict";Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t.eq=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>i[e]=()=>r[e]);return i.default=()=>r,n.d(o,i),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".7d9fe89e.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="ergowise-app:";n.l=(r,a,o,i)=>{if(e[r])e[r].push(a);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=r),e[r]=[a];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/ergowiseAI/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var o=new Promise((n,r)=>a=e[t]=[n,r]);r.push(a[2]=o);var i=n.p+n.u(t),s=new Error;n.l(i,r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,a[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var a,o,i=r[0],s=r[1],c=r[2],l=0;if(i.some(t=>0!==e[t])){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(c)c(n)}for(t&&t(r);l<i.length;l++)o=i[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkergowise_app=self.webpackChunkergowise_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{scaleBand:()=>Ei,scaleDiverging:()=>xd,scaleDivergingLog:()=>wd,scaleDivergingPow:()=>Sd,scaleDivergingSqrt:()=>Cd,scaleDivergingSymlog:()=>kd,scaleIdentity:()=>fc,scaleImplicit:()=>Ci,scaleLinear:()=>pc,scaleLog:()=>Sc,scaleOrdinal:()=>Ii,scalePoint:()=>Ni,scalePow:()=>Rc,scaleQuantile:()=>Gc,scaleQuantize:()=>Hc,scaleRadial:()=>Mc,scaleSequential:()=>pd,scaleSequentialLog:()=>fd,scaleSequentialPow:()=>gd,scaleSequentialQuantile:()=>vd,scaleSequentialSqrt:()=>yd,scaleSequentialSymlog:()=>md,scaleSqrt:()=>Pc,scaleSymlog:()=>Tc,scaleThreshold:()=>Kc,scaleTime:()=>ld,scaleUtc:()=>ud,tickFormat:()=>dc});var t={};n.r(t),n.d(t,{CompositeArrayBuffer:()=>KD,browserFiles:()=>DF,browserHTTPRequest:()=>VF,concatenateArrayBuffers:()=>dM,copyModel:()=>QM,decodeWeights:()=>nM,decodeWeightsStream:()=>sM,encodeWeights:()=>tM,fromMemory:()=>qF,fromMemorySync:()=>XF,getLoadHandlers:()=>kM,getModelArtifactsForJSON:()=>mM,getModelArtifactsForJSONSync:()=>fM,getModelArtifactsInfoForJSON:()=>gM,getSaveHandlers:()=>wM,getWeightSpecs:()=>yM,http:()=>UF,isHTTPScheme:()=>jF,listModels:()=>XM,loadWeights:()=>LF,moveModel:()=>ZM,registerLoadRouter:()=>xM,registerSaveRouter:()=>bM,removeModel:()=>YM,weightsLoaderFactory:()=>zF,withSaveHandler:()=>YF,withSaveHandlerSync:()=>QF});var r={};n.r(r),n.d(r,{assertParamsValid:()=>iL,computeFlatOffset:()=>bL,computeOutShape:()=>cL,getNormalizedAxes:()=>hL,isSliceContinous:()=>vL,maskToAxes:()=>sL,parseSliceParams:()=>xL,sliceInfo:()=>wL,startForAxis:()=>gL,startIndicesWithElidedDims:()=>pL,stopForAxis:()=>yL,stopIndicesWithElidedDims:()=>fL,stridesForAxis:()=>mL,stridesWithElidedDims:()=>lL});var a={};n.r(a),n.d(a,{conv2d:()=>DW,depthwiseConv2d:()=>LW,matMul:()=>zW});var o={};n.r(o),n.d(o,{collectGatherOpShapeInfo:()=>GV,computeOutShape:()=>VV,segOpComputeOptimalWindowSize:()=>UV});var i={};n.r(i),n.d(i,{ERF_A1:()=>iV,ERF_A2:()=>sV,ERF_A3:()=>cV,ERF_A4:()=>lV,ERF_A5:()=>uV,ERF_P:()=>oV,PARALLELIZE_THRESHOLD:()=>XU,RowPartitionType:()=>VU,SELU_SCALE:()=>aV,SELU_SCALEALPHA:()=>rV,applyActivation:()=>RW,assertAndGetBroadcastShape:()=>TF,assertAxesAreInnerMostDims:()=>Xz,assertParamsConsistent:()=>WU,assignToTypedArray:()=>gV,axesAreInnerMostDims:()=>Gz,calculateShapes:()=>cW,checkEinsumDimSizes:()=>IV,checkPadOnDimRoundingMode:()=>YL,combineLocations:()=>Hz,combineRaggedTensorToTensorShapes:()=>GU,complexWithEvenIndex:()=>pV,complexWithOddIndex:()=>fV,computeConv2DInfo:()=>zL,computeConv3DInfo:()=>BL,computeDefaultPad:()=>jL,computeDilation2DInfo:()=>ML,computeOptimalWindowSize:()=>YU,computeOutAndReduceShapes:()=>Kz,computeOutShape:()=>UU,computePool2DInfo:()=>FL,computePool3DInfo:()=>LL,convertConv2DDataFormat:()=>XL,decodeEinsumEquation:()=>SV,eitherStridesOrDilationsAreOne:()=>KL,expandShapeToKeepDim:()=>qz,exponent:()=>vV,exponents:()=>yV,fromStringArrayToUint8:()=>KV,fromUint8ToStringArray:()=>HV,getAxesPermutation:()=>Yz,getBroadcastDims:()=>IF,getComplexWithIndex:()=>mV,getEinsumComputePath:()=>EV,getEinsumPermutation:()=>CV,getFusedBiasGradient:()=>_W,getFusedDyActivation:()=>AW,getImageCenter:()=>QU,getInnerMostAxes:()=>Zz,getPermuted:()=>$U,getRaggedRank:()=>KU,getReductionAxes:()=>EF,getReshaped:()=>ZU,getReshapedPermuted:()=>JU,getRowPartitionTypesHelper:()=>HU,getSliceBeginCoords:()=>eV,getSliceSize:()=>tV,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>AV,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>_V,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>RV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>MV,getSparseReshapeInputOutputMismatchErrorMessage:()=>LV,getSparseReshapeInputOutputMultipleErrorMessage:()=>FV,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>PV,getSparseReshapeNegativeOutputDimErrorMessage:()=>DV,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>WV,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>zV,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>BV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>jV,getUndoAxesPermutation:()=>Qz,isIdentityPermutation:()=>TV,log:()=>wP,mergeRealAndImagArrays:()=>dV,prepareAndValidate:()=>nV,prepareSplitSize:()=>OV,segment_util:()=>o,shouldFuse:()=>PW,slice_util:()=>r,splitRealAndImagArrays:()=>hV,stridesOrDilationsArePositive:()=>qL,tupleValuesAreOne:()=>HL,upcastType:()=>vD,validateDefaultValueShape:()=>qU,validateInput:()=>sW,validateUpdateShape:()=>iW,warn:()=>xP});var s={};n.r(s),n.d(s,{mx:()=>NH,XI:()=>AH,Nk:()=>_H,f6:()=>RH,ct:()=>CH,YG:()=>FH,hH:()=>LH,z3:()=>zH,sG:()=>BH,uM:()=>jH,C1:()=>UH,vS:()=>WH,qB:()=>VH,GG:()=>GH,lg:()=>KH,rq:()=>HH,cu:()=>XH,WR:()=>qH,GE:()=>YH,px:()=>QH,jC:()=>ZH,He:()=>$H,hE:()=>JH,BF:()=>eK,Dk:()=>nK,cl:()=>rK,_B:()=>oK,ub:()=>lK,_f:()=>dK,Ku:()=>gK,qy:()=>yK,Zy:()=>vK,bu:()=>bK,zv:()=>xK,dH:()=>vH,HS:()=>wK,yH:()=>kK,l3:()=>SK,z9:()=>CK,x6:()=>IK,_m:()=>EK,eW:()=>TK,GK:()=>OK,SP:()=>_K,yr:()=>RK,dl:()=>PK,Dw:()=>MK,xT:()=>zK,_X:()=>aK,wz:()=>BK});var c={};n.r(c),n.d(c,{json:()=>a1});var l={};n.r(l),n.d(l,{json:()=>o1});var u={};n.r(u),n.d(u,{json:()=>i1});var d={};n.r(d),n.d(d,{json:()=>s1});var h={};n.r(h),n.d(h,{json:()=>c1});var p={};n.r(p),n.d(p,{json:()=>l1});var f={};n.r(f),n.d(f,{json:()=>u1});var m={};n.r(m),n.d(m,{json:()=>d1});var g={};n.r(g),n.d(g,{json:()=>h1});var y={};n.r(y),n.d(y,{json:()=>p1});var v={};n.r(v),n.d(v,{json:()=>f1});var b={};n.r(b),n.d(b,{json:()=>m1});var x={};n.r(x),n.d(x,{json:()=>g1});var w={};n.r(w),n.d(w,{json:()=>y1});var k={};n.r(k),n.d(k,{json:()=>v1});var S={};n.r(S),n.d(S,{json:()=>b1});var C={};n.r(C),n.d(C,{json:()=>x1});var I={};n.r(I),n.d(I,{json:()=>w1});var E={};n.r(E),n.d(E,{json:()=>k1});var T={};n.r(T),n.d(T,{OP_SCOPE_SUFFIX:()=>jD,abs:()=>CF,acos:()=>SL,acosh:()=>CL,add:()=>iF,addN:()=>IL,all:()=>EL,any:()=>TL,argMax:()=>NL,argMin:()=>OL,asin:()=>AL,asinh:()=>_L,atan:()=>RL,atan2:()=>PL,atanh:()=>DL,avgPool:()=>ZL,avgPool3d:()=>$L,basicLSTMCell:()=>az,batchNorm:()=>iz,batchNorm2d:()=>sz,batchNorm3d:()=>cz,batchNorm4d:()=>lz,batchToSpaceND:()=>oz,bincount:()=>uz,bitwiseAnd:()=>dz,booleanMaskAsync:()=>bW,broadcastArgs:()=>hz,broadcastTo:()=>pz,buffer:()=>nF,cast:()=>rF,ceil:()=>fz,clipByValue:()=>mz,clone:()=>aF,complex:()=>UD,concat:()=>JL,concat1d:()=>gz,concat2d:()=>yz,concat3d:()=>vz,concat4d:()=>bz,conv1d:()=>wz,conv2d:()=>xz,conv2dTranspose:()=>Sz,conv3d:()=>Cz,conv3dTranspose:()=>Ez,cos:()=>Tz,cosh:()=>Nz,cosineWindow:()=>TW,cumprod:()=>Oz,cumsum:()=>Az,denseBincount:()=>_z,depthToSpace:()=>Rz,depthwiseConv2d:()=>Pz,diag:()=>Dz,dilation2d:()=>Mz,div:()=>cF,divNoNan:()=>zz,dot:()=>Bz,dropout:()=>IW,einsum:()=>jz,elu:()=>Wz,enclosingPowerOfTwo:()=>EW,ensureShape:()=>Uz,equal:()=>Fz,erf:()=>Vz,euclideanNorm:()=>rB,exp:()=>aB,expandDims:()=>oB,expm1:()=>iB,eye:()=>cB,fft:()=>Gj,fill:()=>wF,floor:()=>lB,floorDiv:()=>sF,fused:()=>a,gather:()=>uB,gatherND:()=>CW,greater:()=>dB,greaterEqual:()=>hB,ifft:()=>Hj,imag:()=>pB,image:()=>MU,inTopKAsync:()=>NW,irfft:()=>Kj,isFinite:()=>fB,isInf:()=>mB,isNaN:()=>gB,leakyRelu:()=>yB,less:()=>vB,lessEqual:()=>bB,linalg:()=>FU,linspace:()=>xB,localResponseNormalization:()=>wB,log:()=>kB,log1p:()=>SB,logSigmoid:()=>EB,logSoftmax:()=>TB,logSumExp:()=>NB,logicalAnd:()=>OB,logicalNot:()=>AB,logicalOr:()=>_B,logicalXor:()=>RB,losses:()=>LU,lowerBound:()=>MB,matMul:()=>ez,max:()=>$z,maxPool:()=>FB,maxPool3d:()=>LB,maxPoolWithArgmax:()=>zB,maximum:()=>NF,mean:()=>BB,meshgrid:()=>UB,min:()=>Jz,minimum:()=>VB,mirrorPad:()=>GB,mod:()=>HB,moments:()=>KB,movingAverage:()=>wW,mul:()=>lF,multiRNNCell:()=>qB,multinomial:()=>XB,neg:()=>CB,norm:()=>nB,notEqual:()=>YB,oneHot:()=>QB,ones:()=>WB,onesLike:()=>ZB,op:()=>WD,outerProduct:()=>$B,pad:()=>JB,pad1d:()=>ej,pad2d:()=>tj,pad3d:()=>nj,pad4d:()=>rj,pool:()=>oj,pow:()=>kF,prelu:()=>ij,print:()=>oF,prod:()=>sj,raggedGather:()=>cj,raggedRange:()=>lj,raggedTensorToTensor:()=>uj,rand:()=>dj,randomGamma:()=>gj,randomNormal:()=>yj,randomStandardNormal:()=>vj,randomUniform:()=>bj,randomUniformInt:()=>xj,range:()=>wj,real:()=>kj,reciprocal:()=>Sj,relu:()=>Cj,relu6:()=>Ij,reshape:()=>QL,reverse:()=>Ej,reverse1d:()=>Tj,reverse2d:()=>Nj,reverse3d:()=>Oj,reverse4d:()=>Aj,rfft:()=>Xj,round:()=>_j,rsqrt:()=>Rj,scalar:()=>fF,scatterND:()=>kW,searchSorted:()=>DB,selu:()=>Pj,separableConv2d:()=>Dj,setdiff1dAsync:()=>Mj,sigmoid:()=>tz,sign:()=>Fj,signal:()=>DU,sin:()=>Lj,sinh:()=>zj,slice:()=>nz,slice1d:()=>Bj,slice2d:()=>jj,slice3d:()=>Wj,slice4d:()=>Uj,softmax:()=>Vj,softplus:()=>IB,spaceToBatchND:()=>aj,sparse:()=>zU,sparseToDense:()=>SW,spectral:()=>PU,split:()=>qj,sqrt:()=>uF,square:()=>dF,squaredDifference:()=>Yj,squeeze:()=>Qj,stack:()=>Zj,step:()=>$j,stridedSlice:()=>Jj,string:()=>BU,sub:()=>SF,sum:()=>eB,tan:()=>eW,tanh:()=>rz,tensor:()=>GD,tensor1d:()=>tW,tensor2d:()=>nW,tensor3d:()=>ZF,tensor4d:()=>rW,tensor5d:()=>aW,tensor6d:()=>oW,tensorScatterUpdate:()=>lW,tile:()=>sB,topk:()=>uW,transpose:()=>xW,truncatedNormal:()=>dW,unique:()=>hW,unsortedSegmentSum:()=>pW,unstack:()=>fW,upperBound:()=>mW,variable:()=>gW,where:()=>Lz,whereAsync:()=>vW,zeros:()=>jB,zerosLike:()=>hF});var N=n(5043),O=n.t(N,2),A=n(4391);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function R(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}function P(e,t,n){return(t=R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){P(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var F=n(579);const L={user:null,users:[],login:async()=>!1,signup:async()=>!1,logout:()=>{},updateUser:()=>{}},z=(0,N.createContext)(L),B="ergowise:user",j="ergowise:users";function W(e){let{children:t}=e;const[n,r]=(0,N.useState)(null),[a,o]=(0,N.useState)([]);(0,N.useEffect)(()=>{try{const e=localStorage.getItem(B),t=localStorage.getItem(j);e&&r(JSON.parse(e)),t&&o(JSON.parse(t))}catch(e){console.warn("Auth init failed",e)}},[]);const i=e=>{o(e),localStorage.setItem(j,JSON.stringify(e))};return(0,F.jsx)(z.Provider,{value:{user:n,users:a,login:async(e,t)=>{const n=a.find(t=>t.email.toLowerCase()===e.toLowerCase());return!!n&&(r(n),localStorage.setItem(B,JSON.stringify(n)),!0)},signup:async(e,t,n)=>{if(a.some(e=>e.email.toLowerCase()===t.toLowerCase()))return!1;const o={id:crypto.randomUUID(),name:e,email:t,avatar:void 0},s=[...a,o];return i(s),r(o),localStorage.setItem(B,JSON.stringify(o)),!0},logout:()=>{r(null),localStorage.removeItem(B)},updateUser:e=>{if(!n)return;const t=M(M({},n),e);r(t),localStorage.setItem(B,JSON.stringify(t));const o=a.findIndex(e=>e.id===t.id);if(o>=0){const e=[...a];e[o]=t,i(e)}}},children:t})}function U(){return(0,N.useContext)(z)}const V={toasts:[],addToast:()=>{},removeToast:()=>{}},G=(0,N.createContext)(V);function H(e){let{children:t}=e;const[n,r]=(0,N.useState)([]),a=(0,N.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const a=Math.random().toString(36).substring(2),o={id:a,message:e,type:t,duration:n};r(e=>[...e,o]),n>0&&setTimeout(()=>{r(e=>e.filter(e=>e.id!==a))},n)},[]),o=(0,N.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]);return(0,F.jsxs)(G.Provider,{value:{toasts:n,addToast:a,removeToast:o},children:[t,(0,F.jsx)(K,{})]})}function K(){const{toasts:e,removeToast:t}=X();return(0,F.jsx)("div",{style:{position:"fixed",top:20,right:20,zIndex:1e3,display:"flex",flexDirection:"column",gap:8},children:e.map(e=>(0,F.jsx)(q,{toast:e,onRemove:t},e.id))})}function q(e){let{toast:t,onRemove:n}=e;return(0,F.jsx)("div",{style:(r=t.type,M(M({},{padding:"12px 16px",borderRadius:12,color:"#fff",fontWeight:600,fontSize:14,minWidth:250,maxWidth:400,cursor:"pointer",transition:"all 0.3s ease",transform:"translateX(0)",opacity:1,animation:"slideIn 0.3s ease"}),{},{background:{success:"linear-gradient(135deg, #10b981, #059669)",error:"linear-gradient(135deg, #ef4444, #dc2626)",warning:"linear-gradient(135deg, #f59e0b, #d97706)",info:"linear-gradient(135deg, var(--color-primary), var(--color-secondary))"}[r]})),onClick:()=>n(t.id),children:t.message});var r}function X(){return(0,N.useContext)(G)}function Y(e){let{onSwitch:t}=e;const{login:n}=U(),{addToast:r}=X(),[a,o]=(0,N.useState)(""),[i,s]=(0,N.useState)(""),[c,l]=(0,N.useState)(""),[u,d]=(0,N.useState)(!1);return(0,F.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0),l("");await n(a,i)?r("Welcome back! Login successful.","success"):(l("Invalid credentials or user not found"),r("Login failed. Please check your credentials.","error")),d(!1)},style:Q,children:[(0,F.jsx)("h2",{style:Z,children:"Log in to ErgoWise"}),(0,F.jsxs)("label",{style:$,children:["Email",(0,F.jsx)("input",{style:J,value:a,onChange:e=>o(e.target.value),required:!0,type:"email"})]}),(0,F.jsxs)("label",{style:$,children:["Password",(0,F.jsx)("input",{style:J,value:i,onChange:e=>s(e.target.value),required:!0,type:"password"})]}),c&&(0,F.jsx)("div",{style:te,children:c}),(0,F.jsx)("button",{style:ee,disabled:u,children:u?"Logging in...":"Log In"}),(0,F.jsxs)("p",{style:{textAlign:"center",marginTop:12,fontSize:14},children:["No account? ",(0,F.jsx)("span",{style:ne,onClick:t,children:"Sign up"})]})]})}const Q={display:"flex",flexDirection:"column",gap:"12px",background:"var(--color-surface)",padding:"32px 36px",borderRadius:24,boxShadow:"0 8px 32px rgba(234,88,12,0.15)",width:"100%",maxWidth:380},Z={margin:0,textAlign:"center",color:"var(--color-primary)"},$={display:"flex",flexDirection:"column",fontSize:14,fontWeight:600,color:"var(--color-text-soft)"},J={marginTop:4,padding:"10px 14px",borderRadius:12,border:"1px solid var(--color-surface-alt2)",fontSize:15},ee={marginTop:8,padding:"12px 20px",borderRadius:14,border:"none",background:"var(--color-primary)",color:"#fff",fontWeight:600,cursor:"pointer",fontSize:16},te={background:"#fef2f2",color:"#b91c1c",padding:"8px 12px",borderRadius:8,fontSize:13},ne={color:"var(--color-primary)",cursor:"pointer",fontWeight:600};function re(e){let{onSwitch:t}=e;const{signup:n}=U(),{addToast:r}=X(),[a,o]=(0,N.useState)(""),[i,s]=(0,N.useState)(""),[c,l]=(0,N.useState)(""),[u,d]=(0,N.useState)(""),[h,p]=(0,N.useState)(!1);return(0,F.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(!0),d("");await n(a,i,c)?r("Welcome to ErgoWise, ".concat(a,"! Account created successfully."),"success"):(d("Email already registered"),r("Signup failed. Email already exists.","error")),p(!1)},style:ae,children:[(0,F.jsx)("h2",{style:oe,children:"Create your account"}),(0,F.jsxs)("label",{style:ie,children:["Name",(0,F.jsx)("input",{style:se,value:a,onChange:e=>o(e.target.value),required:!0})]}),(0,F.jsxs)("label",{style:ie,children:["Email",(0,F.jsx)("input",{style:se,value:i,onChange:e=>s(e.target.value),required:!0,type:"email"})]}),(0,F.jsxs)("label",{style:ie,children:["Password",(0,F.jsx)("input",{style:se,value:c,onChange:e=>l(e.target.value),required:!0,type:"password"})]}),u&&(0,F.jsx)("div",{style:le,children:u}),(0,F.jsx)("button",{style:ce,disabled:h,children:h?"Signing up...":"Sign Up"}),(0,F.jsxs)("p",{style:{textAlign:"center",marginTop:12,fontSize:14},children:["Have an account? ",(0,F.jsx)("span",{style:ue,onClick:t,children:"Log in"})]})]})}const ae={display:"flex",flexDirection:"column",gap:"12px",background:"var(--color-surface)",padding:"32px 36px",borderRadius:24,boxShadow:"0 8px 32px rgba(234,88,12,0.15)",width:"100%",maxWidth:380},oe={margin:0,textAlign:"center",color:"var(--color-primary)"},ie={display:"flex",flexDirection:"column",fontSize:14,fontWeight:600,color:"var(--color-text-soft)"},se={marginTop:4,padding:"10px 14px",borderRadius:12,border:"1px solid var(--color-surface-alt2)",fontSize:15},ce={marginTop:8,padding:"12px 20px",borderRadius:14,border:"none",background:"var(--color-primary)",color:"#fff",fontWeight:600,cursor:"pointer",fontSize:16},le={background:"#fef2f2",color:"#b91c1c",padding:"8px 12px",borderRadius:8,fontSize:13},ue={color:"var(--color-primary)",cursor:"pointer",fontWeight:600};function de(){const[e,t]=(0,N.useState)("login");return(0,F.jsx)("div",{style:he,children:(0,F.jsx)("div",{style:pe,children:"login"===e?(0,F.jsx)(Y,{onSwitch:()=>t("signup")}):(0,F.jsx)(re,{onSwitch:()=>t("login")})})})}const he={minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--gradient-bg)"},pe={display:"flex",flexDirection:"column",alignItems:"center",gap:24};function fe(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const me=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ge=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},ye=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var ve={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const be=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],xe=(0,N.forwardRef)((e,t)=>{let{color:n="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:i="",children:s,iconNode:c}=e,l=fe(e,be);return(0,N.createElement)("svg",M(M(M({ref:t},ve),{},{width:r,height:r,stroke:n,strokeWidth:o?24*Number(a)/Number(r):a,className:ye("lucide",i)},!s&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(l)&&{"aria-hidden":"true"}),l),[...c.map(e=>{let[t,n]=e;return(0,N.createElement)(t,n)}),...Array.isArray(s)?s:[s]])}),we=["className"],ke=(e,t)=>{const n=(0,N.forwardRef)((n,r)=>{let{className:a}=n,o=fe(n,we);return(0,N.createElement)(xe,M({ref:r,iconNode:t,className:ye("lucide-".concat(me(ge(e))),"lucide-".concat(e),a)},o))});return n.displayName=ge(e),n},Se=ke("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Ce=ke("armchair",[["path",{d:"M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3",key:"irtipd"}],["path",{d:"M3 16a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"1qyhux"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]]),Ie=ke("keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),Ee=ke("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Te=ke("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Ne=ke("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Oe=ke("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function Ae(e){let{startTrigger:t}=e;const[n,r]=(0,N.useState)(300),[a,o]=(0,N.useState)(!1),i=(0,N.useRef)(null),s=(0,N.useRef)(null),c=e=>{s.current&&(s.current.textContent="",setTimeout(()=>{s.current&&(s.current.textContent=e)},10))},l=()=>{o(!0),c("Break started. Timer counting down."),i.current=window.setInterval(()=>{r(e=>e<=1?(i.current&&window.clearInterval(i.current),o(!1),c("Break complete. Great job!"),300):e-1)},1e3)},u=(0,N.useRef)(!1);(0,N.useEffect)(()=>{u.current?void 0!==t&&(a||l()):u.current=!0},[t]),(0,N.useEffect)(()=>()=>{i.current&&window.clearInterval(i.current)},[]);const d=Math.floor(n/60),h=n%60;return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",border:"2px solid var(--color-surface-alt2)",borderRadius:16,padding:"2rem",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",maxWidth:320,margin:"2rem auto"},children:[(0,F.jsx)("div",{ref:s,"aria-live":"polite","aria-atomic":"true",style:{position:"absolute",width:1,height:1,margin:-1,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",border:0}}),(0,F.jsx)("h2",{style:{color:"var(--color-primary)",marginBottom:"1rem",fontWeight:700},children:"Take a Break!"}),(0,F.jsxs)("div",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"var(--color-accent)",marginBottom:"1.5rem"},children:[d,":",h.toString().padStart(2,"0")]}),a?(0,F.jsx)("button",{style:{background:"var(--color-secondary)",color:"#fff",border:"none",borderRadius:8,padding:"0.7rem 2rem",fontSize:"1rem",cursor:"pointer",fontWeight:600,boxShadow:"0 1px 4px rgba(0,0,0,0.25)"},onClick:()=>{i.current&&window.clearInterval(i.current),o(!1),r(300),c("Break canceled.")},children:"Stop Break"}):(0,F.jsx)("button",{style:{background:"var(--color-primary)",color:"#fff",border:"none",borderRadius:8,padding:"0.7rem 2rem",fontSize:"1rem",cursor:"pointer",fontWeight:600,boxShadow:"0 1px 4px rgba(0,0,0,0.2)"},onClick:l,children:"Start Break"}),(0,F.jsx)("p",{style:{marginTop:"1.5rem",color:"var(--color-text)"},children:"Regular breaks help you stay healthy and focused!"})]})}const _e=[{category:"Desk Setup",icon:(0,F.jsx)(Se,{size:32,color:"var(--color-primary)"}),description:"Let's start with your desk and workspace positioning.",questions:[{key:"deskHeight",question:"Is your desk height comfortable?",options:["Yes","No"]}]},{category:"Chair & Posture",icon:(0,F.jsx)(Ce,{size:32,color:"var(--color-primary)"}),description:"Let's check your chair and posture.",questions:[{key:"chairSupport",question:"Does your chair provide good back support?",options:["Yes","No"]}]},{category:"Keyboard & Mouse",icon:(0,F.jsx)(Ie,{size:32,color:"var(--color-primary)"}),description:"Let's review your keyboard and mouse setup.",questions:[{key:"keyboardPosition",question:"Is your keyboard at a comfortable position?",options:["Yes","No"]}]},{category:"Lighting",icon:(0,F.jsx)(Ee,{size:32,color:"var(--color-primary)"}),description:"Let's check your workspace lighting.",questions:[{key:"lighting",question:"Is your workspace lighting adequate?",options:["Yes","No"]}]}];function Re(e){let{progress:t}=e;const n=60+1.2*t,r=Math.floor(t/20)+1;return(0,F.jsxs)("svg",{width:"120",height:"120",viewBox:"0 0 120 120",children:[(0,F.jsx)("ellipse",{cx:"60",cy:"110",rx:"40",ry:"10",fill:"var(--neutral-bg-accent)"}),(0,F.jsx)("rect",{x:"55",y:110-n,width:"10",height:n,rx:"5",fill:"var(--semantic-warning)"}),[...Array(r)].map((e,t)=>(0,F.jsx)("circle",{cx:60+20*Math.sin(t/r*Math.PI*2),cy:110-n-20+10*Math.cos(t/r*Math.PI*2),r:12,fill:"var(--color-primary)",opacity:.85},t)),(0,F.jsx)("circle",{cx:"100",cy:"20",r:"12",fill:"var(--semantic-warning)",opacity:.7})]})}function Pe(){const[e,t]=(0,N.useState)(0),[n,r]=(0,N.useState)({}),a=_e[e],o=_e.reduce((e,t)=>e+t.questions.length,0),i=Object.keys(n).length,s=Math.round(i/o*100),c=a.questions.every(e=>n[e.key]),l=e===_e.length-1;return(0,F.jsxs)("div",{style:{maxWidth:500,margin:"0 auto",background:"var(--color-surface-alt)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.12)",padding:"32px 16px"},children:[(0,F.jsxs)("div",{style:{textAlign:"center",marginBottom:24},children:[(0,F.jsx)("h2",{style:{fontSize:28,fontWeight:700,color:"var(--color-primary)",marginBottom:8},children:"Ergonomic Assessment"}),(0,F.jsx)("p",{style:{color:"var(--color-text-soft)",marginBottom:16},children:"Grow your wellness tree by building good habits!"}),(0,F.jsx)(Re,{progress:s}),(0,F.jsx)("div",{style:{marginBottom:8,marginTop:8},children:(0,F.jsxs)("span",{style:{fontSize:14,color:"var(--color-text-soft)"},children:["Step ",e+1," of ",_e.length]})}),(0,F.jsx)("div",{style:{width:"100%",background:"var(--color-surface-alt2)",borderRadius:8,height:10,margin:"0 auto",marginBottom:16,overflow:"hidden"},children:(0,F.jsx)("div",{style:{background:"var(--color-primary)",height:10,borderRadius:8,width:"".concat(s,"%"),transition:"width 0.3s"}})})]}),(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:24,justifyContent:"center"},children:[(0,F.jsx)("div",{style:{background:"var(--color-surface-alt2)",borderRadius:16,padding:16,display:"flex",alignItems:"center"},children:a.icon}),(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{style:{fontWeight:600,fontSize:20,color:"var(--color-primary)"},children:a.category}),(0,F.jsx)("div",{style:{fontSize:15,color:"var(--color-text-soft)",marginTop:4},children:a.description})]})]}),a.questions.map((e,t)=>(0,F.jsxs)("div",{style:{marginBottom:24,padding:20,background:"var(--color-surface)",borderRadius:16,boxShadow:"0 2px 8px rgba(0,0,0,0.12)"},children:[(0,F.jsxs)("div",{style:{fontWeight:500,fontSize:17,marginBottom:12,color:"var(--color-text)"},children:[t+1,". ",e.question]}),(0,F.jsx)("div",{style:{display:"flex",gap:16},children:e.options.map(t=>(0,F.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:8,background:n[e.key]===t?"var(--color-surface-alt2)":"#fff",border:"2px solid var(--color-primary)",borderRadius:8,padding:"10px 20px",cursor:"pointer",fontWeight:500,color:"var(--color-primary)",fontSize:16,boxShadow:n[e.key]===t?"0 2px 8px rgba(0,0,0,0.15)":void 0,transition:"all 0.2s"},children:[(0,F.jsx)("input",{type:"radio",name:e.key,value:t,checked:n[e.key]===t,onChange:()=>((e,t)=>r(M(M({},n),{},{[e]:t})))(e.key,t),style:{accentColor:"var(--color-primary)"}}),t]},t))})]},e.key)),(0,F.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:32},children:[(0,F.jsxs)("button",{onClick:()=>t(e=>Math.max(0,e-1)),disabled:0===e,style:{padding:"12px 28px",background:"#fff",color:"var(--color-primary)",border:"2px solid var(--color-surface-alt2)",borderRadius:8,fontWeight:600,fontSize:17,cursor:0===e?"not-allowed":"pointer",opacity:0===e?.5:1,display:"flex",alignItems:"center",gap:8},children:[(0,F.jsx)(Te,{size:20})," Previous"]}),l?(0,F.jsxs)("button",{onClick:()=>alert("Assessment Complete! Your tree is thriving!"),disabled:!c,style:{padding:"12px 28px",background:"var(--color-primary)",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:17,cursor:c?"pointer":"not-allowed",opacity:c?1:.5,display:"flex",alignItems:"center",gap:8},children:["Complete Assessment ",(0,F.jsx)(Ne,{size:20})]}):(0,F.jsxs)("button",{onClick:()=>t(e=>e+1),disabled:!c,style:{padding:"12px 28px",background:"var(--color-primary)",color:"#fff",border:"none",borderRadius:8,fontWeight:600,fontSize:17,cursor:c?"pointer":"not-allowed",opacity:c?1:.5,display:"flex",alignItems:"center",gap:8},children:["Next Category ",(0,F.jsx)(Oe,{size:20})]})]})]})}function De(e){let{size:t=48,showWordmark:n=!1,tagline:r="POSTURE. AI. WELLNESS"}=e;return(0,F.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:n?12:0},children:[(0,F.jsx)("div",{style:{position:"relative",width:t,height:t},children:(0,F.jsx)("img",{src:"/ewlogo.png",alt:"ErgoWise - AI-Powered Posture Analysis",width:t,height:t,style:{flexShrink:0,objectFit:"contain",filter:"drop-shadow(0 2px 8px rgba(0,0,0,0.15))",borderRadius:"8px"}})}),n&&(0,F.jsxs)("div",{style:{lineHeight:1.05},children:[(0,F.jsx)("div",{style:{fontSize:Math.round(.5*t),fontWeight:700,letterSpacing:"-0.8px",background:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",color:"#333"},children:"ErgoWise"}),r&&(0,F.jsx)("div",{style:{fontSize:Math.round(.18*t),color:"#666",opacity:.9,letterSpacing:"1px",fontWeight:500},children:r})]})]})}const Me=ke("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Fe=ke("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),Le=(0,N.createContext)(void 0);function ze(e){let{children:t}=e;const[n,r]=(0,N.useState)(()=>localStorage.getItem("ergowise:theme")||"light");(0,N.useEffect)(()=>{localStorage.setItem("ergowise:theme",n),document.documentElement.setAttribute("data-theme",n)},[n]);const a="dark"===n;return(0,F.jsx)(Le.Provider,{value:{theme:n,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")},isDark:a},children:t})}function Be(){const e=(0,N.useContext)(Le);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e}function je(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=je(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function We(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=je(e))&&(r&&(r+=" "),r+=t);return r}var Ue=n(7820),Ve=n.n(Ue),Ge=n(7770),He=n.n(Ge),Ke=e=>0===e?0:e>0?1:-1,qe=e=>"number"==typeof e&&e!=+e,Xe=e=>"string"===typeof e&&e.indexOf("%")===e.length-1,Ye=e=>("number"===typeof e||e instanceof Number)&&!qe(e),Qe=e=>Ye(e)||"string"===typeof e,Ze=0,$e=e=>{var t=++Ze;return"".concat(e||"").concat(t)},Je=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Ye(e)&&"string"!==typeof e)return r;if(Xe(e)){if(null==t)return r;var o=e.indexOf("%");n=t*parseFloat(e.slice(0,o))/100}else n=+e;return qe(n)&&(n=r),a&&null!=t&&n>t&&(n=t),n},et=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++){if(n[e[r]])return!0;n[e[r]]=!0}return!1},tt=(e,t)=>Ye(e)&&Ye(t)?n=>e+n*(t-e):()=>t;function nt(e,t,n){return Ye(e)&&Ye(t)?e+n*(t-e):t}function rt(e,t,n){if(e&&e.length)return e.find(e=>e&&("function"===typeof t?t(e):He()(e,t))===n)}var at=e=>null===e||"undefined"===typeof e,ot=e=>at(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),it=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a]};function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach(function(t){lt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function lt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut=(0,N.forwardRef)((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:a="100%",height:o="100%",minWidth:i=0,minHeight:s,maxHeight:c,children:l,debounce:u=0,id:d,className:h,onResize:p,style:f={}}=e,m=(0,N.useRef)(null),g=(0,N.useRef)();g.current=p,(0,N.useImperativeHandle)(t,()=>m.current);var[y,v]=(0,N.useState)({containerWidth:r.width,containerHeight:r.height}),b=(0,N.useCallback)((e,t)=>{v(n=>{var r=Math.round(e),a=Math.round(t);return n.containerWidth===r&&n.containerHeight===a?n:{containerWidth:r,containerHeight:a}})},[]);(0,N.useEffect)(()=>{var e=e=>{var t,{width:n,height:r}=e[0].contentRect;b(n,r),null===(t=g.current)||void 0===t||t.call(g,n,r)};u>0&&(e=Ve()(e,u,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=m.current.getBoundingClientRect();return b(n,r),t.observe(m.current),()=>{t.disconnect()}},[b,u]);var x=(0,N.useMemo)(()=>{var{containerWidth:e,containerHeight:t}=y;if(e<0||t<0)return null;it(Xe(a)||Xe(o),"The width(%s) and height(%s) are both fixed numbers,\n       maybe you don't need to use a ResponsiveContainer.",a,o),it(!n||n>0,"The aspect(%s) must be greater than zero.",n);var r=Xe(a)?e:a,u=Xe(o)?t:o;return n&&n>0&&(r?u=r/n:u&&(r=u*n),c&&u>c&&(u=c)),it(r>0||u>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",r,u,a,o,i,s,n),N.Children.map(l,e=>(0,N.cloneElement)(e,{width:r,height:u,style:ct({width:r,height:u},e.props.style)}))},[n,l,o,c,s,i,y,a]);return N.createElement("div",{id:d?"".concat(d):void 0,className:We("recharts-responsive-container",h),style:ct(ct({},f),{},{width:a,height:o,minWidth:i,minHeight:s,maxHeight:c}),ref:m},N.createElement("div",{style:{width:0,height:0,overflow:"visible"}},x))});function dt(e){return"Minified Redux error #".concat(e,"; visit https://redux.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}var ht=(()=>"function"===typeof Symbol&&Symbol.observable||"@@observable")(),pt=()=>Math.random().toString(36).substring(7).split("").join("."),ft={INIT:"@@redux/INIT".concat(pt()),REPLACE:"@@redux/REPLACE".concat(pt()),PROBE_UNKNOWN_ACTION:()=>"@@redux/PROBE_UNKNOWN_ACTION".concat(pt())};function mt(e){if("object"!==typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function gt(e,t,n){if("function"!==typeof e)throw new Error(dt(2));if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(dt(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(dt(1));return n(gt)(e,t)}let r=e,a=t,o=new Map,i=o,s=0,c=!1;function l(){i===o&&(i=new Map,o.forEach((e,t)=>{i.set(t,e)}))}function u(){if(c)throw new Error(dt(3));return a}function d(e){if("function"!==typeof e)throw new Error(dt(4));if(c)throw new Error(dt(5));let t=!0;l();const n=s++;return i.set(n,e),function(){if(t){if(c)throw new Error(dt(6));t=!1,l(),i.delete(n),o=null}}}function h(e){if(!mt(e))throw new Error(dt(7));if("undefined"===typeof e.type)throw new Error(dt(8));if("string"!==typeof e.type)throw new Error(dt(17));if(c)throw new Error(dt(9));try{c=!0,a=r(a,e)}finally{c=!1}return(o=i).forEach(e=>{e()}),e}h({type:ft.INIT});return{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!==typeof e)throw new Error(dt(10));r=e,h({type:ft.REPLACE})},[ht]:function(){const e=d;return{subscribe(t){if("object"!==typeof t||null===t)throw new Error(dt(11));function n(){const e=t;e.next&&e.next(u())}n();return{unsubscribe:e(n)}},[ht](){return this}}}}}function yt(e){const t=Object.keys(e),n={};for(let i=0;i<t.length;i++){const r=t[i];0,"function"===typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let a;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if("undefined"===typeof n(void 0,{type:ft.INIT}))throw new Error(dt(12));if("undefined"===typeof n(void 0,{type:ft.PROBE_UNKNOWN_ACTION()}))throw new Error(dt(13))})}(n)}catch(o){a=o}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(a)throw a;let o=!1;const i={};for(let a=0;a<r.length;a++){const s=r[a],c=n[s],l=e[s],u=c(l,t);if("undefined"===typeof u){t&&t.type;throw new Error(dt(14))}i[s]=u,o=o||u!==l}return o=o||r.length!==Object.keys(e).length,o?i:e}}function vt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?e=>e:1===t.length?t[0]:t.reduce((e,t)=>function(){return e(t(...arguments))})}function bt(e){return mt(e)&&"type"in e&&"string"===typeof e.type}function xt(e){return t=>{let{dispatch:n,getState:r}=t;return t=>a=>"function"===typeof a?a(n,r,e):t(a)}}var wt=xt(),kt=xt,St=Symbol.for("immer-nothing"),Ct=Symbol.for("immer-draftable"),It=Symbol.for("immer-state");function Et(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var Tt=Object.getPrototypeOf;function Nt(e){return!!e&&!!e[It]}function Ot(e){var t;return!!e&&(_t(e)||Array.isArray(e)||!!e[Ct]||!(null===(t=e.constructor)||void 0===t||!t[Ct])||Ft(e)||Lt(e))}var At=Object.prototype.constructor.toString();function _t(e){if(!e||"object"!==typeof e)return!1;const t=Tt(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===At}function Rt(e,t){0===Pt(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Pt(e){const t=e[It];return t?t.type_:Array.isArray(e)?1:Ft(e)?2:Lt(e)?3:0}function Dt(e,t){return 2===Pt(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Mt(e,t,n){const r=Pt(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Ft(e){return e instanceof Map}function Lt(e){return e instanceof Set}function zt(e){return e.copy_||e.base_}function Bt(e,t){if(Ft(e))return new Map(e);if(Lt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=_t(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[It];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Tt(e),t)}{const t=Tt(e);if(null!==t&&n)return M({},e);const r=Object.create(t);return Object.assign(r,e)}}function jt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ut(e)||Nt(e)||!Ot(e)||(Pt(e)>1&&Object.defineProperties(e,{set:{value:Wt},add:{value:Wt},clear:{value:Wt},delete:{value:Wt}}),Object.freeze(e),t&&Object.values(e).forEach(e=>jt(e,!0))),e}function Wt(){Et(2)}function Ut(e){return Object.isFrozen(e)}var Vt,Gt={};function Ht(e){const t=Gt[e];return t||Et(0),t}function Kt(){return Vt}function qt(e,t){t&&(Ht("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Xt(e){Yt(e),e.drafts_.forEach(Zt),e.drafts_=null}function Yt(e){e===Vt&&(Vt=e.parent_)}function Qt(e){return Vt={drafts_:[],parent_:Vt,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Zt(e){const t=e[It];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function $t(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[It].modified_&&(Xt(t),Et(4)),Ot(e)&&(e=Jt(t,e),t.parent_||tn(t,e)),t.patches_&&Ht("Patches").generateReplacementPatches_(n[It].base_,e,t.patches_,t.inversePatches_)):e=Jt(t,n,[]),Xt(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==St?e:void 0}function Jt(e,t,n){if(Ut(t))return t;const r=t[It];if(!r)return Rt(t,(a,o)=>en(e,r,t,a,o,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return tn(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,o=!1;3===r.type_&&(a=new Set(t),t.clear(),o=!0),Rt(a,(a,i)=>en(e,r,t,a,i,n,o)),tn(e,t,!1),n&&e.patches_&&Ht("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function en(e,t,n,r,a,o,i){if(Nt(a)){const i=Jt(e,a,o&&t&&3!==t.type_&&!Dt(t.assigned_,r)?o.concat(r):void 0);if(Mt(n,r,i),!Nt(i))return;e.canAutoFreeze_=!1}else i&&n.add(a);if(Ot(a)&&!Ut(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Jt(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(Ft(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||tn(e,a)}}function tn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&jt(t,n)}var nn={get(e,t){if(t===It)return e;const n=zt(e);if(!Dt(n,t))return function(e,t,n){var r;const a=on(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!Ot(r)?r:r===an(e.base_,t)?(cn(e),e.copy_[t]=ln(r,e)):r},has:(e,t)=>t in zt(e),ownKeys:e=>Reflect.ownKeys(zt(e)),set(e,t,n){const r=on(zt(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=an(zt(e),t),i=null===r||void 0===r?void 0:r[It];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((a=n)===(o=r)?0!==a||1/a===1/o:a!==a&&o!==o)&&(void 0!==n||Dt(e.base_,t)))return!0;cn(e),sn(e)}var a,o;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==an(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,cn(e),sn(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=zt(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Et(11)},getPrototypeOf:e=>Tt(e.base_),setPrototypeOf(){Et(12)}},rn={};function an(e,t){const n=e[It];return(n?zt(n):e)[t]}function on(e,t){if(!(t in e))return;let n=Tt(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Tt(n)}}function sn(e){e.modified_||(e.modified_=!0,e.parent_&&sn(e.parent_))}function cn(e){e.copy_||(e.copy_=Bt(e.base_,e.scope_.immer_.useStrictShallowCopy_))}Rt(nn,(e,t)=>{rn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),rn.deleteProperty=function(e,t){return rn.set.call(this,e,t,void 0)},rn.set=function(e,t,n){return nn.set.call(this,e[0],t,n,e[0])};function ln(e,t){const n=Ft(e)?Ht("MapSet").proxyMap_(e,t):Lt(e)?Ht("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Kt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,o=nn;n&&(a=[r],o=rn);const{revoke:i,proxy:s}=Proxy.revocable(a,o);return r.draft_=s,r.revoke_=i,s}(e,t);return(t?t.scope_:Kt()).drafts_.push(n),n}function un(e){return Nt(e)||Et(10),dn(e)}function dn(e){if(!Ot(e)||Ut(e))return e;const t=e[It];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Bt(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Bt(e,!0);return Rt(n,(e,t)=>{Mt(n,e,dn(t))}),t&&(t.finalized_=!1),n}var hn=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,o=new Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];return r.produce(e,e=>t.call(this,e,...o))}}let r;if("function"!==typeof t&&Et(6),void 0!==n&&"function"!==typeof n&&Et(7),Ot(e)){const a=Qt(this),o=ln(e,void 0);let i=!0;try{r=t(o),i=!1}finally{i?Xt(a):Yt(a)}return qt(a,n),$t(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===St&&(r=void 0),this.autoFreeze_&&jt(r,!0),n){const t=[],a=[];Ht("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}Et(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ot(e)||Et(8),Nt(e)&&(e=un(e));const t=Qt(this),n=ln(e,void 0);return n[It].isManual_=!0,Yt(t),n}finishDraft(e,t){const n=e&&e[It];n&&n.isManual_||Et(9);const{scope_:r}=n;return qt(r,t),$t(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Ht("Patches").applyPatches_;return Nt(e)?r(e,t):this.produce(e,e=>r(e,t))}},pn=hn.produce;const fn=["reducerPath"];var mn="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?vt:vt.apply(null,arguments)};"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function gn(e,t){function n(){if(t){let n=t(...arguments);if(!n)throw new Error(ur(0));return M(M({type:e,payload:n.payload},"meta"in n&&{meta:n.meta}),"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=()=>"".concat(e),n.type=e,n.match=t=>bt(t)&&t.type===e,n}var yn=class e extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return super.concat.apply(this,t)}prepend(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return 1===n.length&&Array.isArray(n[0])?new e(...n[0].concat(this)):new e(...n.concat(this))}};function vn(e){return Ot(e)?pn(e,()=>{}):e}function bn(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var xn="RTK_autoBatch",wn=e=>t=>{setTimeout(t,e)},kn=e=>function(t){const{autoBatch:n=!0}=null!==t&&void 0!==t?t:{};let r=new yn(e);return n&&r.push(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"raf"};return t=>function(){const n=t(...arguments);let r=!0,a=!1,o=!1;const i=new Set,s="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:wn(10):"callback"===e.type?e.queueNotification:wn(e.timeout),c=()=>{o=!1,a&&(a=!1,i.forEach(e=>e()))};return Object.assign({},n,{subscribe(e){const t=n.subscribe(()=>r&&e());return i.add(e),()=>{t(),i.delete(e)}},dispatch(e){try{var t;return r=!(null!==e&&void 0!==e&&null!==(t=e.meta)&&void 0!==t&&t[xn]),a=!r,a&&(o||(o=!0,s(c))),n.dispatch(e)}finally{r=!0}}})}}("object"===typeof n?n:void 0)),r};function Sn(e){const t=function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=null!==e&&void 0!==e?e:{};let o=new yn;return t&&("boolean"===typeof t?o.push(wt):o.push(kt(t.extraArgument))),o},{reducer:n,middleware:r,devTools:a=!0,duplicateMiddlewareCheck:o=!0,preloadedState:i,enhancers:s}=e||{};let c,l;if("function"===typeof n)c=n;else{if(!mt(n))throw new Error(ur(1));c=yt(n)}l="function"===typeof r?r(t):t();let u=vt;a&&(u=mn(M({trace:!1},"object"===typeof a&&a)));const d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>(n,r)=>{const a=e(n,r);let o=()=>{throw new Error(dt(15))};const i={getState:a.getState,dispatch:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o(e,...n)}},s=t.map(e=>e(i));return o=vt(...s)(a.dispatch),M(M({},a),{},{dispatch:o})}}(...l),h=kn(d);return gt(c,i,u(..."function"===typeof s?s(h):h()))}function Cn(e){const t={},n=[];let r;const a={addCase(e,n){const r="string"===typeof e?e:e.type;if(!r)throw new Error(ur(28));if(r in t)throw new Error(ur(29));return t[r]=n,a},addAsyncThunk:(e,r)=>(r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),a),addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),a),addDefaultCase:e=>(r=e,a)};return e(a),[t,n,r]}var In=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e};var En=Symbol.for("rtk-slice-createasyncthunk");function Tn(e,t){return"".concat(e,"/").concat(t)}function Nn(){var e;let{creators:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=null===t||void 0===t||null===(e=t.asyncThunk)||void 0===e?void 0:e[En];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error(ur(11));const a=("function"===typeof e.reducers?e.reducers(function(){function e(e,t){return M({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name](){return e(...arguments)}}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},o=Object.keys(a),i={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){const n="string"===typeof e?e:e.type;if(!n)throw new Error(ur(12));if(n in i.sliceCaseReducersByType)throw new Error(ur(13));return i.sliceCaseReducersByType[n]=t,s},addMatcher:(e,t)=>(i.sliceMatchers.push({matcher:e,reducer:t}),s),exposeAction:(e,t)=>(i.actionCreators[e]=t,s),exposeCaseReducer:(e,t)=>(i.sliceCaseReducersByName[e]=t,s)};function c(){const[t={},n=[],r]="function"===typeof e.extraReducers?Cn(e.extraReducers):[e.extraReducers],a=M(M({},t),i.sliceCaseReducersByType);return function(e,t){let n,[r,a,o]=Cn(t);if("function"===typeof e)n=()=>vn(e());else{const t=vn(e);n=()=>t}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(),t=arguments.length>1?arguments[1]:void 0,i=[r[t.type],...a.filter(e=>{let{matcher:n}=e;return n(t)}).map(e=>{let{reducer:t}=e;return t})];return 0===i.filter(e=>!!e).length&&(i=[o]),i.reduce((e,n)=>{if(n){if(Nt(e)){const r=n(e,t);return void 0===r?e:r}if(Ot(e))return pn(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return i.getInitialState=n,i}(e.initialState,e=>{for(let t in a)e.addCase(t,a[t]);for(let t of i.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}o.forEach(r=>{const o=a[r],i={reducerName:r,type:Tn(t,r),createNotation:"function"===typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(o)?function(e,t,n){let r,a,{type:o,reducerName:i,createNotation:s}=e;if("reducer"in t){if(s&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(t))throw new Error(ur(17));r=t.reducer,a=t.prepare}else r=t;n.addCase(o,r).exposeCaseReducer(i,r).exposeAction(i,a?gn(o,a):gn(o))}(i,o,s):function(e,t,n,r){let{type:a,reducerName:o}=e;if(!r)throw new Error(ur(18));const{payloadCreator:i,fulfilled:s,pending:c,rejected:l,settled:u,options:d}=t,h=r(a,i,d);n.exposeAction(o,h),s&&n.addCase(h.fulfilled,s);c&&n.addCase(h.pending,c);l&&n.addCase(h.rejected,l);u&&n.addMatcher(h.settled,u);n.exposeCaseReducer(o,{fulfilled:s||_n,pending:c||_n,rejected:l||_n,settled:u||_n})}(i,o,s,n)});const l=e=>e,u=new Map,d=new WeakMap;let h;function p(e,t){return h||(h=c()),h(e,t)}function f(){return h||(h=c()),h.getInitialState()}function m(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(e){let a=e[t];return"undefined"===typeof a&&n&&(a=bn(d,r,f)),a}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;const r=bn(u,n,()=>new WeakMap);return bn(r,t,()=>{const r={};for(const[o,i]of Object.entries(null!==(a=e.selectors)&&void 0!==a?a:{})){var a;r[o]=On(i,t,()=>bn(d,t,f),n)}return r})}return{reducerPath:t,getSelectors:a,get selectors(){return a(r)},selectSlice:r}}const g=M(M({name:t,reducer:p,actions:i.actionCreators,caseReducers:i.sliceCaseReducersByName,getInitialState:f},m(r)),{},{injectInto(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{reducerPath:n}=t,a=fe(t,fn);const o=null!==n&&void 0!==n?n:r;return e.inject({reducerPath:o,reducer:p},a),M(M({},g),m(o,!0))}});return g}}function On(e,t,n,r){function a(a){let o=t(a);"undefined"===typeof o&&r&&(o=n());for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];return e(o,...s)}return a.unwrapped=e,a}var An=Nn();function _n(){}var Rn="listener",Pn="completed",Dn="cancelled",Mn="task-".concat(Dn),Fn="task-".concat(Pn),Ln="".concat(Rn,"-").concat(Dn),zn="".concat(Rn,"-").concat(Pn),Bn=class{constructor(e){P(this,"name","TaskAbortError"),P(this,"message",void 0),this.code=e,this.message="".concat("task"," ").concat(Dn," (reason: ").concat(e,")")}},jn=(e,t)=>{if("function"!==typeof e)throw new TypeError(ur(32))},Wn=()=>{},Un=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;return e.catch(t),e},Vn=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Gn=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Hn=e=>{if(e.aborted){const{reason:t}=e;throw new Bn(t)}};function Kn(e,t){let n=Wn;return new Promise((r,a)=>{const o=()=>a(new Bn(e.reason));e.aborted?o():(n=Vn(e,o),t.finally(()=>n()).then(r,a))}).finally(()=>{n=Wn})}var qn=e=>t=>Un(Kn(e,t).then(t=>(Hn(e),t))),Xn=e=>{const t=qn(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:Yn}=Object,Qn={},Zn="listenerMiddleware",$n=(e,t)=>(n,r)=>{jn(n);const a=new AbortController;var o;o=a,Vn(e,()=>Gn(o,e.reason));const i=(async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Bn?"cancelled":"rejected",error:n}}finally{null===t||void 0===t||t()}})(async()=>{Hn(e),Hn(a.signal);const t=await n({pause:qn(a.signal),delay:Xn(a.signal),signal:a.signal});return Hn(a.signal),t},()=>Gn(a,Fn));return null!==r&&void 0!==r&&r.autoJoin&&t.push(i.catch(Wn)),{result:qn(e)(i),cancel(){Gn(a,Mn)}}},Jn=(e,t)=>(n,r)=>Un((async(n,r)=>{Hn(t);let a=()=>{};const o=[new Promise((t,r)=>{let o=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});a=()=>{o(),r()}})];null!=r&&o.push(new Promise(e=>setTimeout(e,r,null)));try{const e=await Kn(t,Promise.race(o));return Hn(t),e}finally{a()}})(n,r)),er=e=>{let{type:t,actionCreator:n,matcher:r,predicate:a,effect:o}=e;if(t)a=gn(t).match;else if(n)t=n.type,a=n.match;else if(r)a=r;else if(!a)throw new Error(ur(21));return jn(o),{predicate:a,type:t,effect:o}},tr=Yn(e=>{const{type:t,predicate:n,effect:r}=er(e);return{id:In(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(ur(22))}}},{withTypes:()=>tr}),nr=(e,t)=>{const{type:n,effect:r,predicate:a}=er(t);return Array.from(e.values()).find(e=>("string"===typeof n?e.type===n:e.predicate===a)&&e.effect===r)},rr=e=>{e.pending.forEach(e=>{Gn(e,Ln)})},ar=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},or=Yn(gn("".concat(Zn,"/add")),{withTypes:()=>or}),ir=gn("".concat(Zn,"/removeAll")),sr=Yn(gn("".concat(Zn,"/remove")),{withTypes:()=>sr}),cr=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.error("".concat(Zn,"/error"),...t)},lr=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map,{extra:n,onError:r=cr}=e;jn(r);const a=e=>{var n;return(e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),null!==t&&void 0!==t&&t.cancelActive&&rr(e)}))(null!==(n=nr(t,e))&&void 0!==n?n:tr(e))};Yn(a,{withTypes:()=>a});const o=e=>{const n=nr(t,e);return n&&(n.unsubscribe(),e.cancelActive&&rr(n)),!!n};Yn(o,{withTypes:()=>o});const i=async(e,o,i,s)=>{const c=new AbortController,l=Jn(a,c.signal),u=[];try{e.pending.add(c),await Promise.resolve(e.effect(o,Yn({},i,{getOriginalState:s,condition:(e,t)=>l(e,t).then(Boolean),take:l,delay:Xn(c.signal),pause:qn(c.signal),extra:n,signal:c.signal,fork:$n(c.signal,u),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==c&&(Gn(e,Ln),n.delete(e))})},cancel:()=>{Gn(c,Ln),e.pending.delete(c)},throwIfCancelled:()=>{Hn(c.signal)}})))}catch(d){d instanceof Bn||ar(r,d,{raisedBy:"effect"})}finally{await Promise.all(u),Gn(c,zn),e.pending.delete(c)}},s=(e=>()=>{e.forEach(rr),e.clear()})(t);return{middleware:e=>n=>c=>{if(!bt(c))return n(c);if(or.match(c))return a(c.payload);if(ir.match(c))return void s();if(sr.match(c))return o(c.payload);let l=e.getState();const u=()=>{if(l===Qn)throw new Error(ur(23));return l};let d;try{if(d=n(c),t.size>0){const n=e.getState(),a=Array.from(t.values());for(const t of a){let a=!1;try{a=t.predicate(c,n,l)}catch(h){a=!1,ar(r,h,{raisedBy:"predicate"})}a&&i(t,c,e,u)}}}finally{l=Qn}return d},startListening:a,stopListening:o,clearListeners:s}};Symbol.for("rtk-state-proxy-original");function ur(e){return"Minified Redux Toolkit error #".concat(e,"; visit https://redux-toolkit.js.org/Errors?code=").concat(e," for the full message or use the non-minified dev environment for full errors. ")}function dr(e,t){if(t){var n=Number.parseInt(t,10);if(!qe(n))return null===e||void 0===e?void 0:e[n]}}var hr=An({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),pr=hr.reducer,{createEventEmitter:fr}=hr.actions;n(7237);function mr(e){e()}var gr={notify(){},get:()=>[]};function yr(e,t){let n,r=gr,a=0,o=!1;function i(){l.onStateChange&&l.onStateChange()}function s(){a++,n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){mr(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){r&&null!==e&&(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}())}function c(){a--,n&&0===a&&(n(),n=void 0,r.clear(),r=gr)}const l={addNestedSub:function(e){s();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),c())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,s())},tryUnsubscribe:function(){o&&(o=!1,c())},getListeners:()=>r};return l}var vr=(()=>!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement))(),br=(()=>"undefined"!==typeof navigator&&"ReactNative"===navigator.product)(),xr=(()=>vr||br?N.useLayoutEffect:N.useEffect)();Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var wr=Symbol.for("react-redux-context"),kr="undefined"!==typeof globalThis?globalThis:{};function Sr(){var e;if(!N.createContext)return{};const t=null!==(e=kr[wr])&&void 0!==e?e:kr[wr]=new Map;let n=t.get(N.createContext);return n||(n=N.createContext(null),t.set(N.createContext,n)),n}var Cr=Sr();var Ir=function(e){const{children:t,context:n,serverState:r,store:a}=e,o=N.useMemo(()=>{const e=yr(a);return{store:a,subscription:e,getServerState:r?()=>r:void 0}},[a,r]),i=N.useMemo(()=>a.getState(),[a]);xr(()=>{const{subscription:e}=o;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),i!==a.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[o,i]);const s=n||Cr;return N.createElement(s.Provider,{value:o},t)};var Er=Symbol.for("immer-nothing"),Tr=Symbol.for("immer-draftable"),Nr=Symbol.for("immer-state");function Or(e){throw new Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var Ar=Object.getPrototypeOf;function _r(e){return!!e&&!!e[Nr]}function Rr(e){var t;return!!e&&(Dr(e)||Array.isArray(e)||!!e[Tr]||!(null===(t=e.constructor)||void 0===t||!t[Tr])||Br(e)||jr(e))}var Pr=Object.prototype.constructor.toString();function Dr(e){if(!e||"object"!==typeof e)return!1;const t=Ar(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Pr}function Mr(e,t){0===Fr(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Fr(e){const t=e[Nr];return t?t.type_:Array.isArray(e)?1:Br(e)?2:jr(e)?3:0}function Lr(e,t){return 2===Fr(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function zr(e,t,n){const r=Fr(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Br(e){return e instanceof Map}function jr(e){return e instanceof Set}function Wr(e){return e.copy_||e.base_}function Ur(e,t){if(Br(e))return new Map(e);if(jr(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Dr(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Nr];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const a=n[r],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Ar(e),t)}{const t=Ar(e);if(null!==t&&n)return M({},e);const r=Object.create(t);return Object.assign(r,e)}}function Vr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Hr(e)||_r(e)||!Rr(e)||(Fr(e)>1&&Object.defineProperties(e,{set:{value:Gr},add:{value:Gr},clear:{value:Gr},delete:{value:Gr}}),Object.freeze(e),t&&Object.values(e).forEach(e=>Vr(e,!0))),e}function Gr(){Or(2)}function Hr(e){return Object.isFrozen(e)}var Kr,qr={};function Xr(e){const t=qr[e];return t||Or(0),t}function Yr(){return Kr}function Qr(e,t){t&&(Xr("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Zr(e){$r(e),e.drafts_.forEach(ea),e.drafts_=null}function $r(e){e===Kr&&(Kr=e.parent_)}function Jr(e){return Kr={drafts_:[],parent_:Kr,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ea(e){const t=e[Nr];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function ta(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Nr].modified_&&(Zr(t),Or(4)),Rr(e)&&(e=na(t,e),t.parent_||aa(t,e)),t.patches_&&Xr("Patches").generateReplacementPatches_(n[Nr].base_,e,t.patches_,t.inversePatches_)):e=na(t,n,[]),Zr(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Er?e:void 0}function na(e,t,n){if(Hr(t))return t;const r=t[Nr];if(!r)return Mr(t,(a,o)=>ra(e,r,t,a,o,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return aa(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let a=t,o=!1;3===r.type_&&(a=new Set(t),t.clear(),o=!0),Mr(a,(a,i)=>ra(e,r,t,a,i,n,o)),aa(e,t,!1),n&&e.patches_&&Xr("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function ra(e,t,n,r,a,o,i){if(_r(a)){const i=na(e,a,o&&t&&3!==t.type_&&!Lr(t.assigned_,r)?o.concat(r):void 0);if(zr(n,r,i),!_r(i))return;e.canAutoFreeze_=!1}else i&&n.add(a);if(Rr(a)&&!Hr(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;na(e,a),t&&t.scope_.parent_||"symbol"===typeof r||!(Br(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))||aa(e,a)}}function aa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Vr(t,n)}var oa={get(e,t){if(t===Nr)return e;const n=Wr(e);if(!Lr(n,t))return function(e,t,n){var r;const a=ca(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!Rr(r)?r:r===sa(e.base_,t)?(ua(e),e.copy_[t]=da(r,e)):r},has:(e,t)=>t in Wr(e),ownKeys:e=>Reflect.ownKeys(Wr(e)),set(e,t,n){const r=ca(Wr(e),t);if(null!==r&&void 0!==r&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=sa(Wr(e),t),i=null===r||void 0===r?void 0:r[Nr];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((a=n)===(o=r)?0!==a||1/a===1/o:a!==a&&o!==o)&&(void 0!==n||Lr(e.base_,t)))return!0;ua(e),la(e)}var a,o;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==sa(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,ua(e),la(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Wr(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Or(11)},getPrototypeOf:e=>Ar(e.base_),setPrototypeOf(){Or(12)}},ia={};function sa(e,t){const n=e[Nr];return(n?Wr(n):e)[t]}function ca(e,t){if(!(t in e))return;let n=Ar(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Ar(n)}}function la(e){e.modified_||(e.modified_=!0,e.parent_&&la(e.parent_))}function ua(e){e.copy_||(e.copy_=Ur(e.base_,e.scope_.immer_.useStrictShallowCopy_))}Mr(oa,(e,t)=>{ia[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ia.deleteProperty=function(e,t){return ia.set.call(this,e,t,void 0)},ia.set=function(e,t,n){return oa.set.call(this,e[0],t,n,e[0])};function da(e,t){const n=Br(e)?Xr("MapSet").proxyMap_(e,t):jr(e)?Xr("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Yr(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,o=oa;n&&(a=[r],o=ia);const{revoke:i,proxy:s}=Proxy.revocable(a,o);return r.draft_=s,r.revoke_=i,s}(e,t);return(t?t.scope_:Yr()).drafts_.push(n),n}function ha(e){if(!Rr(e)||Hr(e))return e;const t=e[Nr];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Ur(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Ur(e,!0);return Mr(n,(e,t)=>{zr(n,e,ha(t))}),t&&(t.finalized_=!1),n}var pa=new class{constructor(e){var t=this;this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"===typeof e&&"function"!==typeof t){const n=t;t=e;const r=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var a=arguments.length,o=new Array(a>1?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];return r.produce(e,e=>t.call(this,e,...o))}}let r;if("function"!==typeof t&&Or(6),void 0!==n&&"function"!==typeof n&&Or(7),Rr(e)){const a=Jr(this),o=da(e,void 0);let i=!0;try{r=t(o),i=!1}finally{i?Zr(a):$r(a)}return Qr(a,n),ta(r,a)}if(!e||"object"!==typeof e){if(r=t(e),void 0===r&&(r=e),r===Er&&(r=void 0),this.autoFreeze_&&Vr(r,!0),n){const t=[],a=[];Xr("Patches").generateReplacementPatches_(e,r,t,a),n(t,a)}return r}Or(1)},this.produceWithPatches=(e,n)=>{if("function"===typeof e)return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return t.produceWithPatches(n,t=>e(t,...a))};let r,a;return[this.produce(e,n,(e,t)=>{r=e,a=t}),r,a]},"boolean"===typeof(null===e||void 0===e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"===typeof(null===e||void 0===e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Rr(e)||Or(8),_r(e)&&(e=function(e){_r(e)||Or(10);return ha(e)}(e));const t=Jr(this),n=da(e,void 0);return n[Nr].isManual_=!0,$r(t),n}finishDraft(e,t){const n=e&&e[Nr];n&&n.isManual_||Or(9);const{scope_:r}=n;return Qr(r,t),ta(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Xr("Patches").applyPatches_;return _r(e)?r(e,t):this.produce(e,e=>r(e,t))}};pa.produce;var fa={active:!1,index:null,dataKey:void 0,coordinate:void 0},ma=An({name:"tooltip",initialState:{itemInteraction:{click:fa,hover:fa},axisInteraction:{click:fa,hover:fa},keyboardInteraction:fa,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var n=un(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:ga,removeTooltipEntrySettings:ya,setTooltipSettingsState:va,setActiveMouseOverItemIndex:ba,mouseLeaveItem:xa,mouseLeaveChart:wa,setActiveClickItemIndex:ka,setMouseOverAxisIndex:Sa,setMouseClickAxisIndex:Ca,setSyncInteraction:Ia,setKeyboardInteraction:Ea}=ma.actions,Ta=ma.reducer,Na=An({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload)return e.dataStartIndex=0,void(e.dataEndIndex=0);t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;null!=n&&(e.dataStartIndex=n),null!=r&&(e.dataEndIndex=r)}}}),{setChartData:Oa,setDataStartEndIndexes:Aa,setComputedData:_a}=Na.actions,Ra=Na.reducer,Pa=An({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,a,o;e.margin.top=null!==(n=t.payload.top)&&void 0!==n?n:0,e.margin.right=null!==(r=t.payload.right)&&void 0!==r?r:0,e.margin.bottom=null!==(a=t.payload.bottom)&&void 0!==a?a:0,e.margin.left=null!==(o=t.payload.left)&&void 0!==o?o:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Da,setLayout:Ma,setChartSize:Fa,setScale:La}=Pa.actions,za=Pa.reducer;function Ba(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received ".concat(typeof e);if("function"!==typeof e)throw new TypeError(t)}var ja=e=>Array.isArray(e)?e:[e];function Wa(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every(e=>"function"===typeof e)){const n=e.map(e=>"function"===typeof e?"function ".concat(e.name||"unnamed","()"):typeof e).join(", ");throw new TypeError("".concat(t,"[").concat(n,"]"))}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var Ua="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Va(){return{s:0,v:void 0,o:null,p:null}}function Ga(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let a,o=0;function i(){let t=n;const{length:i}=arguments;for(let e=0,n=i;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=Va(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=Va(),e.set(n,t)):t=r}}const s=t;let c;if(1===t.s)c=t.v;else if(c=e.apply(null,arguments),o++,r){var l,u,d;const e=null!==(l=null===(u=a)||void 0===u||null===(d=u.deref)||void 0===d?void 0:d.call(u))&&void 0!==l?l:a;null!=e&&r(e,c)&&(c=e,0!==o&&o--);a="object"===typeof c&&null!==c||"function"===typeof c?new Ua(c):c}return s.s=1,s.v=c,c}return i.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},i.resetResultsCount()},i.resultsCount=()=>o,i.resetResultsCount=()=>{o=0},i}function Ha(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a="function"===typeof e?{memoize:e,memoizeOptions:n}:e,o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,o=0,i=0,s={},c=t.pop();"object"===typeof c&&(s=c,c=t.pop()),Ba(c,"createSelector expects an output function after the inputs, but received: [".concat(typeof c,"]"));const l=M(M({},a),s),{memoize:u,memoizeOptions:d=[],argsMemoize:h=Ga,argsMemoizeOptions:p=[],devModeChecks:f={}}=l,m=ja(d),g=ja(p),y=Wa(t),v=u(function(){return o++,c.apply(null,arguments)},...m);const b=h(function(){i++;const e=function(e,t){const n=[],{length:r}=e;for(let a=0;a<r;a++)n.push(e[a].apply(null,t));return n}(y,arguments);return r=v.apply(null,e),r},...g);return Object.assign(b,{resultFunc:c,memoizedResultFunc:v,dependencies:y,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>r,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:u,argsMemoize:h})};return Object.assign(o,{withTypes:()=>o}),o}var Ka=Ha(Ga),qa=Object.assign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ka;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received ".concat(typeof e);if("object"!==typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ".concat(typeof e));const n=Object.keys(e),r=t(n.map(t=>e[t]),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t,r)=>(e[n[r]]=t,e),{})});return r},{withTypes:()=>qa}),Xa=n(8443),Ya=(0,N.createContext)(null),Qa=e=>e,Za=()=>{var e=(0,N.useContext)(Ya);return e?e.store.dispatch:Qa},$a=()=>{},Ja=()=>$a,eo=(e,t)=>e===t;function to(e){var t=(0,N.useContext)(Ya);return(0,Xa.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:Ja,t?t.store.getState:$a,t?t.store.getState:$a,t?e:$a,eo)}var no=n(3821),ro=n.n(no),ao=e=>e.legend.settings;Ka([e=>e.legend.payload,ao],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?ro()(r,n):r});function oo(e,t){if((a=e.length)>1)for(var n,r,a,o=1,i=e[t[0]],s=i.length;o<a;++o)for(r=i,i=e[t[o]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}Array.prototype.slice;function io(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function so(e){return function(){return e}}function co(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function lo(e,t){return e[t]}function uo(e){const t=[];return t.key=e,t}function ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function po(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ho(Object(n),!0).forEach(function(t){fo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ho(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mo=Math.PI/180,go=e=>180*e/Math.PI,yo=(e,t,n,r)=>({x:e+Math.cos(-mo*r)*n,y:t+Math.sin(-mo*r)*n}),vo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},bo=(e,t)=>{var{x:n,y:r}=e,{cx:a,cy:o}=t,i=((e,t)=>{var{x:n,y:r}=e,{x:a,y:o}=t;return Math.sqrt((n-a)**2+(r-o)**2)})({x:n,y:r},{x:a,y:o});if(i<=0)return{radius:i,angle:0};var s=(n-a)/i,c=Math.acos(s);return r>o&&(c=2*Math.PI-c),{radius:i,angle:go(c),angleInRadian:c}},xo=(e,t)=>{var{startAngle:n,endAngle:r}=t,a=Math.floor(n/360),o=Math.floor(r/360);return e+360*Math.min(a,o)},wo=(e,t)=>{var{x:n,y:r}=e,{radius:a,angle:o}=bo({x:n,y:r},t),{innerRadius:i,outerRadius:s}=t;if(a<i||a>s)return null;if(0===a)return null;var c,{startAngle:l,endAngle:u}=(e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),a=Math.floor(n/360),o=Math.min(r,a);return{startAngle:t-360*o,endAngle:n-360*o}})(t),d=o;if(l<=u){for(;d>u;)d-=360;for(;d<l;)d+=360;c=d>=l&&d<=u}else{for(;d>l;)d-=360;for(;d<u;)d+=360;c=d>=u&&d<=l}return c?po(po({},t),{},{radius:a,angle:xo(d,t)}):null};function ko(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function So(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?So(Object(n),!0).forEach(function(t){Io(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):So(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Io(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eo(e,t,n){return at(e)||at(t)?n:Qe(t)?He()(e,t,n):"function"===typeof t?t(e):n}var To=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,No=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var a,o,i=e.map(e=>(e.coordinate===t&&(a=!0),e.coordinate===n&&(o=!0),e.coordinate));return a||i.push(t),o||i.push(n),i},Oo=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:a,range:o,scale:i,realScaleType:s,isCategorical:c,categoricalDomain:l,tickCount:u,ticks:d,niceTicks:h,axisType:p}=e;if(!i)return null;var f="scaleBand"===s&&i.bandwidth?i.bandwidth()/2:2,m=(t||n)&&"category"===a&&i.bandwidth?i.bandwidth()/f:0;return m="angleAxis"===p&&o&&o.length>=2?2*Ke(o[0]-o[1])*m:m,t&&(d||h)?(d||h||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:i(n)+m,value:e,offset:m,index:t}}).filter(e=>!qe(e.coordinate)):c&&l?l.map((e,t)=>({coordinate:i(e)+m,value:e,index:t,offset:m})):i.ticks&&!n&&null!=u?i.ticks(u).map((e,t)=>({coordinate:i(e)+m,value:e,offset:m,index:t})):i.domain().map((e,t)=>({coordinate:i(e)+m,value:r?r[e]:e,index:t,offset:m}))},Ao=1e-4,_o=(e,t)=>{if(!t||2!==t.length||!Ye(t[0])||!Ye(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Ye(e[0])||e[0]<n)&&(a[0]=n),(!Ye(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},Ro={sign:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0,i=0;i<t;++i){var s=qe(e[i][n][1])?e[i][n][0]:e[i][n][1];s>=0?(e[i][n][0]=a,e[i][n][1]=a+s,a=e[i][n][1]):(e[i][n][0]=o,e[i][n][1]=o+s,o=e[i][n][1])}},expand:function(e,t){if((r=e.length)>0){for(var n,r,a,o=0,i=e[0].length;o<i;++o){for(a=n=0;n<r;++n)a+=e[n][o][1]||0;if(a)for(n=0;n<r;++n)e[n][o][1]/=a}oo(e,t)}},none:oo,silhouette:function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],o=a.length;r<o;++r){for(var i=0,s=0;i<n;++i)s+=e[i][r][1]||0;a[r][1]+=a[r][0]=-s/2}oo(e,t)}},wiggle:function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,o=0,i=1;i<r;++i){for(var s=0,c=0,l=0;s<a;++s){for(var u=e[t[s]],d=u[i][1]||0,h=(d-(u[i-1][1]||0))/2,p=0;p<s;++p){var f=e[t[p]];h+=(f[i][1]||0)-(f[i-1][1]||0)}c+=d,l+=h*d}n[i-1][1]+=n[i-1][0]=o,c&&(o-=l/c)}n[i-1][1]+=n[i-1][0]=o,oo(e,t)}},positive:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,o=0;o<t;++o){var i=qe(e[o][n][1])?e[o][n][0]:e[o][n][1];i>=0?(e[o][n][0]=a,e[o][n][1]=a+i,a=e[o][n][1]):(e[o][n][0]=0,e[o][n][1]=0)}}},Po=(e,t,n)=>{var r=Ro[n],a=function(){var e=so([]),t=co,n=oo,r=lo;function a(a){var o,i,s=Array.from(e.apply(this,arguments),uo),c=s.length,l=-1;for(const e of a)for(o=0,++l;o<c;++o)(s[o][l]=[0,+r(e,s[o].key,l,a)]).data=e;for(o=0,i=io(t(s));o<c;++o)s[i[o]].index=o;return n(s,i),s}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:so(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:so(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?co:"function"===typeof e?e:so(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?oo:e,a):n},a}().keys(t).value((e,t)=>+Eo(e,t,0)).order(co).offset(r);return a(e)};function Do(e){return null==e?void 0:String(e)}function Mo(e){var{axis:t,ticks:n,bandSize:r,entry:a,index:o,dataKey:i}=e;if("category"===t.type){if(!t.allowDuplicatedCategory&&t.dataKey&&!at(a[t.dataKey])){var s=rt(n,"value",a[t.dataKey]);if(s)return s.coordinate+r/2}return n[o]?n[o].coordinate+r/2:null}var c=Eo(a,at(i)?t.dataKey:i);return at(c)?null:t.scale(c)}var Fo=e=>{var{axis:t,ticks:n,offset:r,bandSize:a,entry:o,index:i}=e;if("category"===t.type)return n[i]?n[i].coordinate+r:null;var s=Eo(o,t.dataKey,t.scale.domain()[i]);return at(s)?null:t.scale(s)-a/2+r},Lo=e=>{var{numericAxis:t}=e,n=t.scale.domain();if("number"===t.type){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},zo=(e,t,n)=>{var r;if(null!=e)return r=Object.keys(e).reduce((r,a)=>{var o=e[a],{stackedData:i}=o,s=i.reduce((e,r)=>{var a=(e=>{var t=e.flat(2).filter(Ye);return[Math.min(...t),Math.max(...t)]})(ko(r,t,n));return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(s[0],r[0]),Math.max(s[1],r[1])]},[1/0,-1/0]),[r[0]===1/0?0:r[0],r[1]===-1/0?0:r[1]]},Bo=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jo=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Wo=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=ro()(t,e=>e.coordinate),o=1/0,i=1,s=a.length;i<s;i++){var c=a[i],l=a[i-1];o=Math.min((c.coordinate||0)-(l.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0};function Uo(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:a,name:o}=e;return Co(Co({},t),{},{dataKey:n,payload:r,value:a,name:o})}function Vo(e,t){return e?String(e):"string"===typeof t?t:void 0}var Go=e=>e.layout.width,Ho=e=>e.layout.height,Ko=e=>e.layout.scale,qo=e=>e.layout.margin,Xo=Ka(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Yo=Ka(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Qo="data-recharts-item-index",Zo="data-recharts-item-data-key";function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach(function(t){ei(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ei(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ti=Ka([Go,Ho,qo,e=>e.brush.height,function(e){return Yo(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return Yo(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"===typeof t.width?t.width:60),0)},function(e){return Xo(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return Xo(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},ao,e=>e.legend.size],(e,t,n,r,a,o,i,s,c,l)=>{var u={left:(n.left||0)+a,right:(n.right||0)+o},d=Jo(Jo({},{top:(n.top||0)+i,bottom:(n.bottom||0)+s}),u),h=d.bottom;d.bottom+=r,d=((e,t,n)=>{if(t&&n){var{width:r,height:a}=n,{align:o,verticalAlign:i,layout:s}=t;if(("vertical"===s||"horizontal"===s&&"middle"===i)&&"center"!==o&&Ye(e[o]))return Co(Co({},e),{},{[o]:e[o]+(r||0)});if(("horizontal"===s||"vertical"===s&&"center"===o)&&"middle"!==i&&Ye(e[i]))return Co(Co({},e),{},{[i]:e[i]+(a||0)})}return e})(d,c,l);var p=e-d.left-d.right,f=t-d.top-d.bottom;return Jo(Jo({brushBottom:h},d),{},{width:Math.max(p,0),height:Math.max(f,0)})}),ni=Ka(ti,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ri=Ka(Go,Ho,(e,t)=>({x:0,y:0,width:e,height:t})),ai=(0,N.createContext)(null),oi=()=>null!=(0,N.useContext)(ai),ii=e=>e.brush,si=Ka([ii,ti,qo],(e,t,n)=>({height:e.height,x:Ye(e.x)?e.x:t.left,y:Ye(e.y)?e.y:t.top+t.height+t.brushBottom-((null===n||void 0===n?void 0:n.bottom)||0),width:Ye(e.width)?e.width:t.width})),ci=()=>{var e,t=oi(),n=to(ni),r=to(si),a=null===(e=to(ii))||void 0===e?void 0:e.padding;return t&&r&&a?{width:r.width-a.left-a.right,height:r.height-a.top-a.bottom,x:a.left,y:a.top}:n},li={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ui=()=>{var e;return null!==(e=to(ti))&&void 0!==e?e:li},di=()=>to(Go),hi=()=>to(Ho),pi=e=>e.layout.layoutType,fi=()=>to(pi),mi=n(9859),gi=n.n(mi);function yi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function vi(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}class bi extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Si;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(xi(this,e))}has(e){return super.has(xi(this,e))}set(e,t){return super.set(wi(this,e),t)}delete(e){return super.delete(ki(this,e))}}Set;function xi(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):t}function wi(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)?n.get(a):(n.set(a,t),t)}function ki(e,t){let{_intern:n,_key:r}=e;const a=r(t);return n.has(a)&&(t=n.get(a),n.delete(a)),t}function Si(e){return null!==e&&"object"===typeof e?e.valueOf():e}const Ci=Symbol("implicit");function Ii(){var e=new bi,t=[],n=[],r=Ci;function a(a){let o=e.get(a);if(void 0===o){if(r!==Ci)return r;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new bi;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return Ii(t,n).unknown(r)},yi.apply(a,arguments),a}function Ei(){var e,t,n=Ii().unknown(void 0),r=n.domain,a=n.range,o=0,i=1,s=!1,c=0,l=0,u=.5;function d(){var n=r().length,d=i<o,h=d?i:o,p=d?o:i;e=(p-h)/Math.max(1,n-c+2*l),s&&(e=Math.floor(e)),h+=(p-h-e*(n-c))*u,t=e*(1-c),s&&(h=Math.round(h),t=Math.round(t));var f=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(a);++r<a;)o[r]=e+r*n;return o}(n).map(function(t){return h+e*t});return a(d?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),d()):r()},n.range=function(e){return arguments.length?([o,i]=e,o=+o,i=+i,d()):[o,i]},n.rangeRound=function(e){return[o,i]=e,o=+o,i=+i,s=!0,d()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,d()):s},n.padding=function(e){return arguments.length?(c=Math.min(1,l=+e),d()):c},n.paddingInner=function(e){return arguments.length?(c=Math.min(1,e),d()):c},n.paddingOuter=function(e){return arguments.length?(l=+e,d()):l},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return Ei(r(),[o,i]).round(s).paddingInner(c).paddingOuter(l).align(u)},yi.apply(d(),arguments)}function Ti(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Ti(t())},e}function Ni(){return Ti(Ei.apply(null,arguments).paddingInner(1))}const Oi=Math.sqrt(50),Ai=Math.sqrt(10),_i=Math.sqrt(2);function Ri(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=Oi?10:o>=Ai?5:o>=_i?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=Math.pow(10,a)*i,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?Ri(e,t,2*n):[s,c,l]}function Pi(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[a,o,i]=r?Ri(t,e,n):Ri(e,t,n);if(!(o>=a))return[];const s=o-a+1,c=new Array(s);if(r)if(i<0)for(let l=0;l<s;++l)c[l]=(o-l)/-i;else for(let l=0;l<s;++l)c[l]=(o-l)*i;else if(i<0)for(let l=0;l<s;++l)c[l]=(a+l)/-i;else for(let l=0;l<s;++l)c[l]=(a+l)*i;return c}function Di(e,t,n){return Ri(e=+e,t=+t,n=+n)[2]}function Mi(e,t,n){n=+n;const r=(t=+t)<(e=+e),a=r?Di(t,e,n):Di(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function Fi(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Li(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function zi(e){let t,n,r;function a(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<o){if(0!==t(r,r))return o;do{const t=a+o>>>1;n(e[t],r)<0?a=t+1:o=t}while(a<o)}return a}return 2!==e.length?(t=Fi,n=(t,n)=>Fi(e(t),n),r=(t,n)=>e(t)-n):(t=e===Fi||e===Li?e:Bi,n=e,r=e),{left:a,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<o){if(0!==t(r,r))return o;do{const t=a+o>>>1;n(e[t],r)<=0?a=t+1:o=t}while(a<o)}return a}}}function Bi(){return 0}function ji(e){return null===e?NaN:+e}const Wi=zi(Fi),Ui=Wi.right,Vi=(Wi.left,zi(ji).center,Ui);function Gi(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Hi(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ki(){}var qi=.7,Xi=1/qi,Yi="\\s*([+-]?\\d+)\\s*",Qi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$i=/^#([0-9a-f]{3,8})$/,Ji=new RegExp("^rgb\\(".concat(Yi,",").concat(Yi,",").concat(Yi,"\\)$")),es=new RegExp("^rgb\\(".concat(Zi,",").concat(Zi,",").concat(Zi,"\\)$")),ts=new RegExp("^rgba\\(".concat(Yi,",").concat(Yi,",").concat(Yi,",").concat(Qi,"\\)$")),ns=new RegExp("^rgba\\(".concat(Zi,",").concat(Zi,",").concat(Zi,",").concat(Qi,"\\)$")),rs=new RegExp("^hsl\\(".concat(Qi,",").concat(Zi,",").concat(Zi,"\\)$")),as=new RegExp("^hsla\\(".concat(Qi,",").concat(Zi,",").concat(Zi,",").concat(Qi,"\\)$")),os={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function is(){return this.rgb().formatHex()}function ss(){return this.rgb().formatRgb()}function cs(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=$i.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ls(t):3===n?new hs(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?us(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?us(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ji.exec(e))?new hs(t[1],t[2],t[3],1):(t=es.exec(e))?new hs(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ts.exec(e))?us(t[1],t[2],t[3],t[4]):(t=ns.exec(e))?us(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=rs.exec(e))?vs(t[1],t[2]/100,t[3]/100,1):(t=as.exec(e))?vs(t[1],t[2]/100,t[3]/100,t[4]):os.hasOwnProperty(e)?ls(os[e]):"transparent"===e?new hs(NaN,NaN,NaN,0):null}function ls(e){return new hs(e>>16&255,e>>8&255,255&e,1)}function us(e,t,n,r){return r<=0&&(e=t=n=NaN),new hs(e,t,n,r)}function ds(e,t,n,r){return 1===arguments.length?((a=e)instanceof Ki||(a=cs(a)),a?new hs((a=a.rgb()).r,a.g,a.b,a.opacity):new hs):new hs(e,t,n,null==r?1:r);var a}function hs(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ps(){return"#".concat(ys(this.r)).concat(ys(this.g)).concat(ys(this.b))}function fs(){const e=ms(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(gs(this.r),", ").concat(gs(this.g),", ").concat(gs(this.b)).concat(1===e?")":", ".concat(e,")"))}function ms(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function gs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ys(e){return((e=gs(e))<16?"0":"")+e.toString(16)}function vs(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new xs(e,t,n,r)}function bs(e){if(e instanceof xs)return new xs(e.h,e.s,e.l,e.opacity);if(e instanceof Ki||(e=cs(e)),!e)return new xs;if(e instanceof xs)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,s=o-a,c=(o+a)/2;return s?(i=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=c<.5?o+a:2-o-a,i*=60):s=c>0&&c<1?0:i,new xs(i,s,c,e.opacity)}function xs(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ws(e){return(e=(e||0)%360)<0?e+360:e}function ks(e){return Math.max(0,Math.min(1,e||0))}function Ss(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Cs(e,t,n,r,a){var o=e*e,i=o*e;return((1-3*e+3*o-i)*t+(4-6*o+3*i)*n+(1+3*e+3*o-3*i)*r+i*a)/6}Gi(Ki,cs,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:is,formatHex:is,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return bs(this).formatHsl()},formatRgb:ss,toString:ss}),Gi(hs,ds,Hi(Ki,{brighter(e){return e=null==e?Xi:Math.pow(Xi,e),new hs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?qi:Math.pow(qi,e),new hs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hs(gs(this.r),gs(this.g),gs(this.b),ms(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ps,formatHex:ps,formatHex8:function(){return"#".concat(ys(this.r)).concat(ys(this.g)).concat(ys(this.b)).concat(ys(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:fs,toString:fs})),Gi(xs,function(e,t,n,r){return 1===arguments.length?bs(e):new xs(e,t,n,null==r?1:r)},Hi(Ki,{brighter(e){return e=null==e?Xi:Math.pow(Xi,e),new xs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?qi:Math.pow(qi,e),new xs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new hs(Ss(e>=240?e-240:e+120,a,r),Ss(e,a,r),Ss(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new xs(ws(this.h),ks(this.s),ks(this.l),ms(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ms(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(ws(this.h),", ").concat(100*ks(this.s),"%, ").concat(100*ks(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Is=e=>()=>e;function Es(e,t){return function(n){return e+n*t}}function Ts(e){return 1===(e=+e)?Ns:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Is(isNaN(t)?n:t)}}function Ns(e,t){var n=t-e;return n?Es(e,n):Is(isNaN(e)?t:e)}const Os=function e(t){var n=Ts(t);function r(e,t){var r=n((e=ds(e)).r,(t=ds(t)).r),a=n(e.g,t.g),o=n(e.b,t.b),i=Ns(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=o(t),e.opacity=i(t),e+""}}return r.gamma=e,r}(1);function As(e){return function(t){var n,r,a=t.length,o=new Array(a),i=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=ds(t[n]),o[n]=r.r||0,i[n]=r.g||0,s[n]=r.b||0;return o=e(o),i=e(i),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=i(e),r.b=s(e),r+""}}}As(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],o=e[r+1],i=r>0?e[r-1]:2*a-o,s=r<t-1?e[r+2]:2*o-a;return Cs((n-r/t)*t,i,a,o,s)}}),As(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],o=e[r%t],i=e[(r+1)%t],s=e[(r+2)%t];return Cs((n-r/t)*t,a,o,i,s)}});function _s(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,o=new Array(a),i=new Array(r);for(n=0;n<a;++n)o[n]=Bs(e[n],t[n]);for(;n<r;++n)i[n]=t[n];return function(e){for(n=0;n<a;++n)i[n]=o[n](e);return i}}function Rs(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ps(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Ds(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Bs(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var Ms=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fs=new RegExp(Ms.source,"g");function Ls(e,t){var n,r,a,o=Ms.lastIndex=Fs.lastIndex=0,i=-1,s=[],c=[];for(e+="",t+="";(n=Ms.exec(e))&&(r=Fs.exec(t));)(a=r.index)>o&&(a=t.slice(o,a),s[i]?s[i]+=a:s[++i]=a),(n=n[0])===(r=r[0])?s[i]?s[i]+=r:s[++i]=r:(s[++i]=null,c.push({i:i,x:Ps(n,r)})),o=Fs.lastIndex;return o<t.length&&(a=t.slice(o),s[i]?s[i]+=a:s[++i]=a),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})}function zs(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(o){for(n=0;n<r;++n)a[n]=e[n]*(1-o)+t[n]*o;return a}}function Bs(e,t){var n,r,a=typeof t;return null==t||"boolean"===a?Is(t):("number"===a?Ps:"string"===a?(n=cs(t))?(t=n,Os):Ls:t instanceof cs?Os:t instanceof Date?Rs:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?_s:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Ds:Ps:zs))(e,t)}function js(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Ws(e){return+e}var Us=[0,1];function Vs(e){return e}function Gs(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Hs(e,t,n){var r=e[0],a=e[1],o=t[0],i=t[1];return a<r?(r=Gs(a,r),o=n(i,o)):(r=Gs(r,a),o=n(o,i)),function(e){return o(r(e))}}function Ks(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=Gs(e[i],e[i+1]),o[i]=n(t[i],t[i+1]);return function(t){var n=Vi(e,t,1,r)-1;return o[n](a[n](t))}}function qs(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xs(){var e,t,n,r,a,o,i=Us,s=Us,c=Bs,l=Vs;function u(){var e=Math.min(i.length,s.length);return l!==Vs&&(l=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(i[0],i[e-1])),r=e>2?Ks:Hs,a=o=null,d}function d(t){return null==t||isNaN(t=+t)?n:(a||(a=r(i.map(e),s,c)))(e(l(t)))}return d.invert=function(n){return l(t((o||(o=r(s,i.map(e),Ps)))(n)))},d.domain=function(e){return arguments.length?(i=Array.from(e,Ws),u()):i.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),c=js,u()},d.clamp=function(e){return arguments.length?(l=!!e||Vs,u()):l!==Vs},d.interpolate=function(e){return arguments.length?(c=e,u()):c},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}function Ys(){return Xs()(Vs,Vs)}var Qs,Zs=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $s(e){if(!(t=Zs.exec(e)))throw new Error("invalid format: "+e);var t;return new Js({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Js(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function ec(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function tc(e){return(e=ec(Math.abs(e)))?e[1]:NaN}function nc(e,t){var n=ec(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}$s.prototype=Js.prototype,Js.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const rc={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>nc(100*e,t),r:nc,s:function(e,t){var n=ec(e,t);if(!n)return e+"";var r=n[0],a=n[1],o=a-(Qs=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ec(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ac(e){return e}var oc,ic,sc,cc=Array.prototype.map,lc=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function uc(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ac:(t=cc.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,o=[],i=0,s=t[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(e.substring(a-=s,a+s)),!((c+=s+1)>r));)s=t[i=(i+1)%t.length];return o.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?ac:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(cc.call(e.numerals,String)),c=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=$s(e)).fill,n=e.align,d=e.sign,h=e.symbol,p=e.zero,f=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):rc[v]||(void 0===g&&(g=12),y=!0,v="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var b="$"===h?a:"#"===h&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===h?o:/[%p]/.test(v)?c:"",w=rc[v],k=/[defgprs%]/.test(v);function S(e){var a,o,c,h=b,S=x;if("c"===v)S=w(e)+S,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),y&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==d&&(C=!1),h=(C?"("===d?d:l:"-"===d||"("===d?"":d)+h,S=("s"===v?lc[8+Qs/3]:"")+S+(C&&"("===d?")":""),k)for(a=-1,o=e.length;++a<o;)if(48>(c=e.charCodeAt(a))||c>57){S=(46===c?i+e.slice(a+1):e.slice(a))+S,e=e.slice(0,a);break}}m&&!p&&(e=r(e,1/0));var I=h.length+e.length+S.length,E=I<f?new Array(f-I+1).join(t):"";switch(m&&p&&(e=r(E+e,E.length?f-S.length:1/0),E=""),n){case"<":e=h+e+S+E;break;case"=":e=h+E+e+S;break;case"^":e=E.slice(0,I=E.length>>1)+h+e+S+E.slice(I);break;default:e=E+h+e+S}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:d,formatPrefix:function(e,t){var n=d(((e=$s(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(tc(t)/3))),a=Math.pow(10,-r),o=lc[8+r/3];return function(e){return n(a*e)+o}}}}function dc(e,t,n,r){var a,o=Mi(e,t,n);switch((r=$s(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tc(t)/3)))-tc(Math.abs(e)))}(o,i))||(r.precision=a),sc(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,tc(t)-tc(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-tc(Math.abs(e)))}(o))||(r.precision=a-2*("%"===r.type))}return ic(r)}function hc(e){var t=e.domain;return e.ticks=function(e){var n=t();return Pi(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return dc(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,o=t(),i=0,s=o.length-1,c=o[i],l=o[s],u=10;for(l<c&&(a=c,c=l,l=a,a=i,i=s,s=a);u-- >0;){if((a=Di(c,l,n))===r)return o[i]=c,o[s]=l,t(o);if(a>0)c=Math.floor(c/a)*a,l=Math.ceil(l/a)*a;else{if(!(a<0))break;c=Math.ceil(c*a)/a,l=Math.floor(l*a)/a}r=a}return e},e}function pc(){var e=Ys();return e.copy=function(){return qs(e,pc())},yi.apply(e,arguments),hc(e)}function fc(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,Ws),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return fc(e).unknown(t)},e=arguments.length?Array.from(e,Ws):[0,1],hc(n)}function mc(e,t){var n,r=0,a=(e=e.slice()).length-1,o=e[r],i=e[a];return i<o&&(n=r,r=a,a=n,n=o,o=i,i=n),e[r]=t.floor(o),e[a]=t.ceil(i),e}function gc(e){return Math.log(e)}function yc(e){return Math.exp(e)}function vc(e){return-Math.log(-e)}function bc(e){return-Math.exp(-e)}function xc(e){return isFinite(e)?+("1e"+e):e<0?0:e}function wc(e){return(t,n)=>-e(-t,n)}function kc(e){const t=e(gc,yc),n=t.domain;let r,a,o=10;function i(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(o),a=function(e){return 10===e?xc:e===Math.E?Math.exp:t=>Math.pow(e,t)}(o),n()[0]<0?(r=wc(r),a=wc(a),e(vc,bc)):e(gc,yc),t}return t.base=function(e){return arguments.length?(o=+e,i()):o},t.domain=function(e){return arguments.length?(n(e),i()):n()},t.ticks=e=>{const t=n();let i=t[0],s=t[t.length-1];const c=s<i;c&&([i,s]=[s,i]);let l,u,d=r(i),h=r(s);const p=null==e?10:+e;let f=[];if(!(o%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),i>0){for(;d<=h;++d)for(l=1;l<o;++l)if(u=d<0?l/a(-d):l*a(d),!(u<i)){if(u>s)break;f.push(u)}}else for(;d<=h;++d)for(l=o-1;l>=1;--l)if(u=d>0?l/a(-d):l*a(d),!(u<i)){if(u>s)break;f.push(u)}2*f.length<p&&(f=Pi(i,s,p))}else f=Pi(d,h,Math.min(h-d,p)).map(a);return c?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===o?"s":","),"function"!==typeof n&&(o%1||null!=(n=$s(n)).precision||(n.trim=!0),n=ic(n)),e===1/0)return n;const i=Math.max(1,o*e/t.ticks().length);return e=>{let t=e/a(Math.round(r(e)));return t*o<o-.5&&(t*=o),t<=i?n(e):""}},t.nice=()=>n(mc(n(),{floor:e=>a(Math.floor(r(e))),ceil:e=>a(Math.ceil(r(e)))})),t}function Sc(){const e=kc(Xs()).domain([1,10]);return e.copy=()=>qs(e,Sc()).base(e.base()),yi.apply(e,arguments),e}function Cc(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ic(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ec(e){var t=1,n=e(Cc(t),Ic(t));return n.constant=function(n){return arguments.length?e(Cc(t=+n),Ic(t)):t},hc(n)}function Tc(){var e=Ec(Xs());return e.copy=function(){return qs(e,Tc()).constant(e.constant())},yi.apply(e,arguments)}function Nc(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Oc(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ac(e){return e<0?-e*e:e*e}function _c(e){var t=e(Vs,Vs),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Vs,Vs):.5===n?e(Oc,Ac):e(Nc(n),Nc(1/n)):n},hc(t)}function Rc(){var e=_c(Xs());return e.copy=function(){return qs(e,Rc()).exponent(e.exponent())},yi.apply(e,arguments),e}function Pc(){return Rc.apply(null,arguments).exponent(.5)}function Dc(e){return Math.sign(e)*e*e}function Mc(){var e,t=Ys(),n=[0,1],r=!1;function a(n){var a=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(Dc(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,Ws)).map(Dc)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Mc(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},yi.apply(a,arguments),hc(a)}function Fc(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function Lc(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function zc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fi;if(e===Fi)return Bc;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function Bc(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function jc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=void 0===a?Bc:zc(a);r>n;){if(r-n>600){const o=r-n+1,i=t-n+1,s=Math.log(o),c=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*c*(o-c)/o)*(i-o/2<0?-1:1);jc(e,t,Math.max(n,Math.floor(t-i*c/o+l)),Math.min(r,Math.floor(t+(o-i)*c/o+l)),a)}const o=e[t];let i=n,s=r;for(Wc(e,n,t),a(e[r],o)>0&&Wc(e,n,r);i<s;){for(Wc(e,i,s),++i,--s;a(e[i],o)<0;)++i;for(;a(e[s],o)>0;)--s}0===a(e[n],o)?Wc(e,n,s):(++s,Wc(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function Wc(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Uc(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return Lc(e);if(t>=1)return Fc(e);var r,a=(r-1)*t,o=Math.floor(a),i=Fc(jc(e,o).subarray(0,o+1));return i+(Lc(e.subarray(o+1))-i)*(a-o)}}function Vc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ji;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,o=Math.floor(a),i=+n(e[o],o,e);return i+(+n(e[o+1],o+1,e)-i)*(a-o)}}function Gc(){var e,t=[],n=[],r=[];function a(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=Vc(t,e/a);return o}function o(t){return null==t||isNaN(t=+t)?e:n[Vi(r,t)]}return o.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(Fi),a()},o.range=function(e){return arguments.length?(n=Array.from(e),a()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return Gc().domain(t).range(n).unknown(e)},yi.apply(o,arguments)}function Hc(){var e,t=0,n=1,r=1,a=[.5],o=[0,1];function i(t){return null!=t&&t<=t?o[Vi(a,t,0,r)]:e}function s(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return i}return i.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},i.range=function(e){return arguments.length?(r=(o=Array.from(e)).length-1,s()):o.slice()},i.invertExtent=function(e){var i=o.indexOf(e);return i<0?[NaN,NaN]:i<1?[t,a[0]]:i>=r?[a[r-1],n]:[a[i-1],a[i]]},i.unknown=function(t){return arguments.length?(e=t,i):i},i.thresholds=function(){return a.slice()},i.copy=function(){return Hc().domain([t,n]).range(o).unknown(e)},yi.apply(hc(i),arguments)}function Kc(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[Vi(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return Kc().domain(t).range(n).unknown(e)},yi.apply(a,arguments)}oc=uc({thousands:",",grouping:[3],currency:["$",""]}),ic=oc.format,sc=oc.formatPrefix;const qc=1e3,Xc=6e4,Yc=36e5,Qc=864e5,Zc=6048e5,$c=2592e6,Jc=31536e6,el=new Date,tl=new Date;function nl(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,r,o)=>{const i=[];if(n=a.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return i;let s;do{i.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return i},a.filter=n=>nl(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(a.count=(t,r)=>(el.setTime(+t),tl.setTime(+r),e(el),e(tl),Math.floor(n(el,tl))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?t=>r(t)%e===0:t=>a.count(0,t)%e===0):a:null)),a}const rl=nl(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);rl.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?nl(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):rl:null);rl.range;const al=nl(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*qc)},(e,t)=>(t-e)/qc,e=>e.getUTCSeconds()),ol=(al.range,nl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qc)},(e,t)=>{e.setTime(+e+t*Xc)},(e,t)=>(t-e)/Xc,e=>e.getMinutes())),il=(ol.range,nl(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Xc)},(e,t)=>(t-e)/Xc,e=>e.getUTCMinutes())),sl=(il.range,nl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*qc-e.getMinutes()*Xc)},(e,t)=>{e.setTime(+e+t*Yc)},(e,t)=>(t-e)/Yc,e=>e.getHours())),cl=(sl.range,nl(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Yc)},(e,t)=>(t-e)/Yc,e=>e.getUTCHours())),ll=(cl.range,nl(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xc)/Qc,e=>e.getDate()-1)),ul=(ll.range,nl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qc,e=>e.getUTCDate()-1)),dl=(ul.range,nl(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qc,e=>Math.floor(e/Qc)));dl.range;function hl(e){return nl(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Xc)/Zc)}const pl=hl(0),fl=hl(1),ml=hl(2),gl=hl(3),yl=hl(4),vl=hl(5),bl=hl(6);pl.range,fl.range,ml.range,gl.range,yl.range,vl.range,bl.range;function xl(e){return nl(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/Zc)}const wl=xl(0),kl=xl(1),Sl=xl(2),Cl=xl(3),Il=xl(4),El=xl(5),Tl=xl(6),Nl=(wl.range,kl.range,Sl.range,Cl.range,Il.range,El.range,Tl.range,nl(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),Ol=(Nl.range,nl(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),Al=(Ol.range,nl(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));Al.every=e=>isFinite(e=Math.floor(e))&&e>0?nl(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null;Al.range;const _l=nl(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_l.every=e=>isFinite(e=Math.floor(e))&&e>0?nl(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null;_l.range;function Rl(e,t,n,r,a,o){const i=[[al,1,qc],[al,5,5e3],[al,15,15e3],[al,30,3e4],[o,1,Xc],[o,5,3e5],[o,15,9e5],[o,30,18e5],[a,1,Yc],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,Qc],[r,2,1728e5],[n,1,Zc],[t,1,$c],[t,3,7776e6],[e,1,Jc]];function s(t,n,r){const a=Math.abs(n-t)/r,o=zi(e=>{let[,,t]=e;return t}).right(i,a);if(o===i.length)return e.every(Mi(t/Jc,n/Jc,r));if(0===o)return rl.every(Math.max(Mi(t,n,r),1));const[s,c]=i[a/i[o-1][2]<i[o][2]/a?o-1:o];return s.every(c)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const a=n&&"function"===typeof n.range?n:s(e,t,n),o=a?a.range(e,+t+1):[];return r?o.reverse():o},s]}const[Pl,Dl]=Rl(_l,Ol,wl,dl,cl,il),[Ml,Fl]=Rl(Al,Nl,pl,ll,sl,ol);function Ll(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zl(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Bl(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var jl,Wl,Ul,Vl={"-":"",_:" ",0:"0"},Gl=/^\s*\d+/,Hl=/^%/,Kl=/[\\^$*+?|[\]().{}]/g;function ql(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(t)+a:a)}function Xl(e){return e.replace(Kl,"\\$&")}function Yl(e){return new RegExp("^(?:"+e.map(Xl).join("|")+")","i")}function Ql(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Zl(e,t,n){var r=Gl.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function $l(e,t,n){var r=Gl.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Jl(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function eu(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function tu(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function nu(e,t,n){var r=Gl.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function ru(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function au(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ou(e,t,n){var r=Gl.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function iu(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function su(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function cu(e,t,n){var r=Gl.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function lu(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function uu(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function du(e,t,n){var r=Gl.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function hu(e,t,n){var r=Gl.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function pu(e,t,n){var r=Gl.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function fu(e,t,n){var r=Hl.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function mu(e,t,n){var r=Gl.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function gu(e,t,n){var r=Gl.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function yu(e,t){return ql(e.getDate(),t,2)}function vu(e,t){return ql(e.getHours(),t,2)}function bu(e,t){return ql(e.getHours()%12||12,t,2)}function xu(e,t){return ql(1+ll.count(Al(e),e),t,3)}function wu(e,t){return ql(e.getMilliseconds(),t,3)}function ku(e,t){return wu(e,t)+"000"}function Su(e,t){return ql(e.getMonth()+1,t,2)}function Cu(e,t){return ql(e.getMinutes(),t,2)}function Iu(e,t){return ql(e.getSeconds(),t,2)}function Eu(e){var t=e.getDay();return 0===t?7:t}function Tu(e,t){return ql(pl.count(Al(e)-1,e),t,2)}function Nu(e){var t=e.getDay();return t>=4||0===t?yl(e):yl.ceil(e)}function Ou(e,t){return e=Nu(e),ql(yl.count(Al(e),e)+(4===Al(e).getDay()),t,2)}function Au(e){return e.getDay()}function _u(e,t){return ql(fl.count(Al(e)-1,e),t,2)}function Ru(e,t){return ql(e.getFullYear()%100,t,2)}function Pu(e,t){return ql((e=Nu(e)).getFullYear()%100,t,2)}function Du(e,t){return ql(e.getFullYear()%1e4,t,4)}function Mu(e,t){var n=e.getDay();return ql((e=n>=4||0===n?yl(e):yl.ceil(e)).getFullYear()%1e4,t,4)}function Fu(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ql(t/60|0,"0",2)+ql(t%60,"0",2)}function Lu(e,t){return ql(e.getUTCDate(),t,2)}function zu(e,t){return ql(e.getUTCHours(),t,2)}function Bu(e,t){return ql(e.getUTCHours()%12||12,t,2)}function ju(e,t){return ql(1+ul.count(_l(e),e),t,3)}function Wu(e,t){return ql(e.getUTCMilliseconds(),t,3)}function Uu(e,t){return Wu(e,t)+"000"}function Vu(e,t){return ql(e.getUTCMonth()+1,t,2)}function Gu(e,t){return ql(e.getUTCMinutes(),t,2)}function Hu(e,t){return ql(e.getUTCSeconds(),t,2)}function Ku(e){var t=e.getUTCDay();return 0===t?7:t}function qu(e,t){return ql(wl.count(_l(e)-1,e),t,2)}function Xu(e){var t=e.getUTCDay();return t>=4||0===t?Il(e):Il.ceil(e)}function Yu(e,t){return e=Xu(e),ql(Il.count(_l(e),e)+(4===_l(e).getUTCDay()),t,2)}function Qu(e){return e.getUTCDay()}function Zu(e,t){return ql(kl.count(_l(e)-1,e),t,2)}function $u(e,t){return ql(e.getUTCFullYear()%100,t,2)}function Ju(e,t){return ql((e=Xu(e)).getUTCFullYear()%100,t,2)}function ed(e,t){return ql(e.getUTCFullYear()%1e4,t,4)}function td(e,t){var n=e.getUTCDay();return ql((e=n>=4||0===n?Il(e):Il.ceil(e)).getUTCFullYear()%1e4,t,4)}function nd(){return"+0000"}function rd(){return"%"}function ad(e){return+e}function od(e){return Math.floor(+e/1e3)}function id(e){return new Date(e)}function sd(e){return e instanceof Date?+e:+new Date(+e)}function cd(e,t,n,r,a,o,i,s,c,l){var u=Ys(),d=u.invert,h=u.domain,p=l(".%L"),f=l(":%S"),m=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(e){return(c(e)<e?p:s(e)<e?f:i(e)<e?m:o(e)<e?g:r(e)<e?a(e)<e?y:v:n(e)<e?b:x)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?h(Array.from(e,sd)):h().map(id)},u.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?w:l(t)},u.nice=function(e){var n=h();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(mc(n,e)):u},u.copy=function(){return qs(u,cd(e,t,n,r,a,o,i,s,c,l))},u}function ld(){return yi.apply(cd(Ml,Fl,Al,Nl,pl,ll,sl,ol,al,Wl).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ud(){return yi.apply(cd(Pl,Dl,_l,Ol,wl,ul,cl,il,al,Ul).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dd(){var e,t,n,r,a,o=0,i=1,s=Vs,c=!1;function l(t){return null==t||isNaN(t=+t)?a:s(0===n?.5:(t=(r(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),l):[s(0),s(1)]}}return l.domain=function(a){return arguments.length?([o,i]=a,e=r(o=+o),t=r(i=+i),n=e===t?0:1/(t-e),l):[o,i]},l.clamp=function(e){return arguments.length?(c=!!e,l):c},l.interpolator=function(e){return arguments.length?(s=e,l):s},l.range=u(Bs),l.rangeRound=u(js),l.unknown=function(e){return arguments.length?(a=e,l):a},function(a){return r=a,e=a(o),t=a(i),n=e===t?0:1/(t-e),l}}function hd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function pd(){var e=hc(dd()(Vs));return e.copy=function(){return hd(e,pd())},vi.apply(e,arguments)}function fd(){var e=kc(dd()).domain([1,10]);return e.copy=function(){return hd(e,fd()).base(e.base())},vi.apply(e,arguments)}function md(){var e=Ec(dd());return e.copy=function(){return hd(e,md()).constant(e.constant())},vi.apply(e,arguments)}function gd(){var e=_c(dd());return e.copy=function(){return hd(e,gd()).exponent(e.exponent())},vi.apply(e,arguments)}function yd(){return gd.apply(null,arguments).exponent(.5)}function vd(){var e=[],t=Vs;function n(n){if(null!=n&&!isNaN(n=+n))return t((Vi(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(Fi),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>Uc(e,r/t))},n.copy=function(){return vd(t).domain(e)},vi.apply(n,arguments)}function bd(){var e,t,n,r,a,o,i,s=0,c=.5,l=1,u=1,d=Vs,h=!1;function p(e){return isNaN(e=+e)?i:(e=.5+((e=+o(e))-t)*(u*e<u*t?r:a),d(h?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,a;return arguments.length?([n,r,a]=t,d=function(e,t){void 0===t&&(t=e,e=Bs);for(var n=0,r=t.length-1,a=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return o[t](e-t)}}(e,[n,r,a]),p):[d(0),d(.5),d(1)]}}return p.domain=function(i){return arguments.length?([s,c,l]=i,e=o(s=+s),t=o(c=+c),n=o(l=+l),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),u=t<e?-1:1,p):[s,c,l]},p.clamp=function(e){return arguments.length?(h=!!e,p):h},p.interpolator=function(e){return arguments.length?(d=e,p):d},p.range=f(Bs),p.rangeRound=f(js),p.unknown=function(e){return arguments.length?(i=e,p):i},function(i){return o=i,e=i(s),t=i(c),n=i(l),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),u=t<e?-1:1,p}}function xd(){var e=hc(bd()(Vs));return e.copy=function(){return hd(e,xd())},vi.apply(e,arguments)}function wd(){var e=kc(bd()).domain([.1,1,10]);return e.copy=function(){return hd(e,wd()).base(e.base())},vi.apply(e,arguments)}function kd(){var e=Ec(bd());return e.copy=function(){return hd(e,kd()).constant(e.constant())},vi.apply(e,arguments)}function Sd(){var e=_c(bd());return e.copy=function(){return hd(e,Sd()).exponent(e.exponent())},vi.apply(e,arguments)}function Cd(){return Sd.apply(null,arguments).exponent(.5)}!function(e){jl=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,o=e.days,i=e.shortDays,s=e.months,c=e.shortMonths,l=Yl(a),u=Ql(a),d=Yl(o),h=Ql(o),p=Yl(i),f=Ql(i),m=Yl(s),g=Ql(s),y=Yl(c),v=Ql(c),b={a:function(e){return i[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:yu,e:yu,f:ku,g:Pu,G:Mu,H:vu,I:bu,j:xu,L:wu,m:Su,M:Cu,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ad,s:od,S:Iu,u:Eu,U:Tu,V:Ou,w:Au,W:_u,x:null,X:null,y:Ru,Y:Du,Z:Fu,"%":rd},x={a:function(e){return i[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Lu,e:Lu,f:Uu,g:Ju,G:td,H:zu,I:Bu,j:ju,L:Wu,m:Vu,M:Gu,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ad,s:od,S:Hu,u:Ku,U:qu,V:Yu,w:Qu,W:Zu,x:null,X:null,y:$u,Y:ed,Z:nd,"%":rd},w={a:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=y.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:su,e:su,f:pu,g:ru,G:nu,H:lu,I:lu,j:cu,L:hu,m:iu,M:uu,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:ou,Q:mu,s:gu,S:du,u:$l,U:Jl,V:eu,w:Zl,W:tu,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:ru,Y:nu,Z:au,"%":fu};function k(e,t){return function(n){var r,a,o,i=[],s=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(i.push(e.slice(c,s)),null!=(a=Vl[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(o=t[r])&&(r=o(n,a)),i.push(r),c=s+1);return i.push(e.slice(c,s)),i.join("")}}function S(e,t){return function(n){var r,a,o=Bl(1900,void 0,1);if(C(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(a=(r=zl(Bl(o.y,0,1))).getUTCDay(),r=a>4||0===a?kl.ceil(r):kl(r),r=ul.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(a=(r=Ll(Bl(o.y,0,1))).getDay(),r=a>4||0===a?fl.ceil(r):fl(r),r=ll.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),a="Z"in o?zl(Bl(o.y,0,1)).getUTCDay():Ll(Bl(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(a+5)%7:o.w+7*o.U-(a+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,zl(o)):Ll(o)}}function C(e,t,n,r){for(var a,o,i=0,s=t.length,c=n.length;i<s;){if(r>=c)return-1;if(37===(a=t.charCodeAt(i++))){if(a=t.charAt(i++),!(o=w[a in Vl?t.charAt(i++):a])||(r=o(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(t,b),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}(e),Wl=jl.format,jl.parse,Ul=jl.utcFormat,jl.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Id=e=>e.chartData,Ed=Ka([Id],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Td=(e,t,n,r)=>r?Ed(e):Id(e);function Nd(e){return Number.isFinite(e)}function Od(e){return"number"===typeof e&&e>0&&Number.isFinite(e)}function Ad(e){if(Array.isArray(e)&&2===e.length){var[t,n]=e;if(Nd(t)&&Nd(n))return!0}return!1}function _d(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}var Rd=n(8210),Pd=n.n(Rd),Dd=e=>e,Md={"@@functional/placeholder":!0},Fd=e=>e===Md,Ld=e=>function t(){return 0===arguments.length||1===arguments.length&&Fd(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},zd=(e,t)=>1===e?t:Ld(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=r.filter(e=>e!==Md).length;return o>=e?t(...r):zd(e-o,Ld(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var o=r.map(e=>Fd(e)?n.shift():e);return t(...o,...n)}))}),Bd=e=>zd(e.length,e),jd=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Wd=Bd((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)),Ud=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Vd=e=>{var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t&&a.every((e,n)=>{var r;return e===(null===(r=t)||void 0===r?void 0:r[n])})?n:(t=a,n=e(...a))}};function Gd(e){return 0===e?1:Math.floor(new(Pd())(e).abs().log(10).toNumber())+1}function Hd(e,t,n){for(var r=new(Pd())(e),a=0,o=[];r.lt(t)&&a<1e5;)o.push(r.toNumber()),r=r.add(n),a++;return o}Bd((e,t,n)=>{var r=+e;return r+n*(+t-r)}),Bd((e,t,n)=>{var r=t-+e;return(n-e)/(r=r||1/0)}),Bd((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var Kd=e=>{var[t,n]=e,[r,a]=[t,n];return t>n&&([r,a]=[n,t]),[r,a]},qd=(e,t,n)=>{if(e.lte(0))return new(Pd())(0);var r=Gd(e.toNumber()),a=new(Pd())(10).pow(r),o=e.div(a),i=1!==r?.05:.1,s=new(Pd())(Math.ceil(o.div(i).toNumber())).add(n).mul(i).mul(a);return t?new(Pd())(s.toNumber()):new(Pd())(Math.ceil(s.toNumber()))},Xd=(e,t,n)=>{var r=new(Pd())(1),a=new(Pd())(e);if(!a.isint()&&n){var o=Math.abs(e);o<1?(r=new(Pd())(10).pow(Gd(e)-1),a=new(Pd())(Math.floor(a.div(r).toNumber())).mul(r)):o>1&&(a=new(Pd())(Math.floor(e)))}else 0===e?a=new(Pd())(Math.floor((t-1)/2)):n||(a=new(Pd())(Math.floor(e)));var i=Math.floor((t-1)/2);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return Dd;var r=t.reverse(),a=r[0],o=r.slice(1);return function(){return o.reduce((e,t)=>t(e),a(...arguments))}}(Wd(e=>a.add(new(Pd())(e-i).mul(r)).toNumber()),jd)(0,t)},Yd=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new(Pd())(0),tickMin:new(Pd())(0),tickMax:new(Pd())(0)};var o,i=qd(new(Pd())(t).sub(e).div(n-1),r,a);o=e<=0&&t>=0?new(Pd())(0):(o=new(Pd())(e).add(t).div(2)).sub(new(Pd())(o).mod(i));var s=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new(Pd())(t).sub(o).div(i).toNumber()),l=s+c+1;return l>n?Yd(e,t,n,r,a+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:i,tickMin:o.sub(new(Pd())(s).mul(i)),tickMax:o.add(new(Pd())(c).mul(i))})};var Qd=Vd(function(e){var[t,n]=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Math.max(r,2),[i,s]=Kd([t,n]);if(i===-1/0||s===1/0){var c=s===1/0?[i,...jd(0,r-1).map(()=>1/0)]:[...jd(0,r-1).map(()=>-1/0),s];return t>n?Ud(c):c}if(i===s)return Xd(i,r,a);var{step:l,tickMin:u,tickMax:d}=Yd(i,s,o,a,0),h=Hd(u,d.add(new(Pd())(.1).mul(l)),l);return t>n?Ud(h):h}),Zd=Vd(function(e,t){var[n,r]=e,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],[o,i]=Kd([n,r]);if(o===-1/0||i===1/0)return[n,r];if(o===i)return[o];var s=Math.max(t,2),c=qd(new(Pd())(i).sub(o).div(s-1),a,0),l=[...Hd(new(Pd())(o),new(Pd())(i),c),i];return!1===a&&(l=l.map(e=>Math.round(e))),n>r?Ud(l):l}),$d=e=>e.rootProps.maxBarSize,Jd=e=>e.rootProps.barGap,eh=e=>e.rootProps.barCategoryGap,th=e=>e.rootProps.barSize,nh=e=>e.rootProps.stackOffset,rh=e=>e.options.chartName,ah=e=>e.rootProps.syncId,oh=e=>e.rootProps.syncMethod,ih=e=>e.options.eventEmitter,sh=0,ch="auto",lh=!0,uh=!1,dh=!0,hh=0,ph="auto",fh=!0,mh=5,gh=(e,t)=>{if(e&&t)return null!==e&&void 0!==e&&e.reversed?[t[1],t[0]]:t},yh={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:sh,includeHidden:!1,name:void 0,reversed:!1,scale:ch,tick:lh,tickCount:void 0,ticks:void 0,type:"category",unit:void 0},vh={allowDataOverflow:uh,allowDecimals:!1,allowDuplicatedCategory:dh,dataKey:void 0,domain:void 0,id:hh,includeHidden:!1,name:void 0,reversed:!1,scale:ph,tick:fh,tickCount:mh,ticks:void 0,type:"number",unit:void 0},bh={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,dataKey:void 0,domain:void 0,id:sh,includeHidden:!1,name:void 0,reversed:!1,scale:ch,tick:lh,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},xh={allowDataOverflow:uh,allowDecimals:!1,allowDuplicatedCategory:dh,dataKey:void 0,domain:void 0,id:hh,includeHidden:!1,name:void 0,reversed:!1,scale:ph,tick:fh,tickCount:mh,ticks:void 0,type:"category",unit:void 0},wh=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?bh:yh,kh=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?xh:vh,Sh=e=>e.polarOptions,Ch=Ka([Go,Ho,ti],vo),Ih=Ka([Sh,Ch],(e,t)=>{if(null!=e)return Je(e.innerRadius,t,0)}),Eh=Ka([Sh,Ch],(e,t)=>{if(null!=e)return Je(e.outerRadius,t,.8*t)}),Th=Ka([Sh],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]}),Nh=Ka([wh,Th],gh),Oh=Ka([Ch,Ih,Eh],(e,t,n)=>{if(null!=e&&null!=t&&null!=n)return[t,n]}),Ah=Ka([kh,Oh],gh),_h=Ka([pi,Sh,Ih,Eh,Go,Ho],(e,t,n,r,a,o)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=n&&null!=r){var{cx:i,cy:s,startAngle:c,endAngle:l}=t;return{cx:Je(i,a,a/2),cy:Je(s,o,o/2),innerRadius:n,outerRadius:r,startAngle:c,endAngle:l,clockWise:!1}}}),Rh=(e,t)=>t,Ph=(e,t,n)=>n;function Dh(e){return null===e||void 0===e?void 0:e.id}var Mh=e=>{var t=pi(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},Fh=e=>e.tooltip.settings.axisId,Lh=e=>{var t=Mh(e),n=Fh(e);return ep(e,t,n)},zh=Ka([Lh],e=>null===e||void 0===e?void 0:e.dataKey);function Bh(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:a,dataKey:o}=n,i=new Map;return e.forEach(e=>{var t,n=null!==(t=e.data)&&void 0!==t?t:r;if(null!=n&&0!==n.length){var s=Dh(e);n.forEach((t,n)=>{var r,c=null==o||a?n:String(Eo(t,o,null)),l=Eo(t,e.dataKey,0);r=i.has(c)?i.get(c):{},Object.assign(r,{[s]:l}),i.set(c,r)})}}),Array.from(i.values())}function jh(e){return null!=e.stackId&&null!=e.dataKey}function Wh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Uh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wh(Object(n),!0).forEach(function(t){Vh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Vh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gh=[0,"auto"],Hh={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Kh=(e,t)=>e.cartesianAxis.xAxis[t],qh=(e,t)=>{var n=Kh(e,t);return null==n?Hh:n},Xh={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Gh,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},Yh=(e,t)=>e.cartesianAxis.yAxis[t],Qh=(e,t)=>{var n=Yh(e,t);return null==n?Xh:n},Zh={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},$h=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return null==n?Zh:n},Jh=(e,t,n)=>{switch(t){case"xAxis":return qh(e,n);case"yAxis":return Qh(e,n);case"zAxis":return $h(e,n);case"angleAxis":return wh(e,n);case"radiusAxis":return kh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},ep=(e,t,n)=>{switch(t){case"xAxis":return qh(e,n);case"yAxis":return Qh(e,n);case"angleAxis":return wh(e,n);case"radiusAxis":return kh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},tp=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function np(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var rp=e=>e.graphicalItems.cartesianItems,ap=Ka([Rh,Ph],np),op=(e,t,n)=>e.filter(n).filter(e=>!0===(null===t||void 0===t?void 0:t.includeHidden)||!e.hide),ip=Ka([rp,Jh,ap],op),sp=Ka([ip],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(jh)),cp=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),lp=Ka([ip],cp),up=e=>e.map(e=>e.data).filter(Boolean).flat(1),dp=Ka([ip],up),hp=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:a}=t;return e.length>0?e:n.slice(r,a+1)},pp=Ka([dp,Td],hp),fp=(e,t,n)=>null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:Eo(e,t.dataKey)})):n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:Eo(e,t)}))):e.map(e=>({value:e})),mp=Ka([pp,Jh,ip],fp);function gp(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function yp(e){return e.filter(e=>Qe(e)||e instanceof Date).map(Number).filter(e=>!1===qe(e))}function vp(e,t,n){return!n||"number"!==typeof t||qe(t)?[]:n.length?yp(n.flatMap(n=>{var r,a,o=Eo(e,n.dataKey);if(Array.isArray(o)?[r,a]=o:r=a=o,Nd(r)&&Nd(a))return[t-r,t+a]})):[]}var bp=Ka([sp,Td,Lh],Bh),xp=(e,t,n)=>{var r=t.reduce((e,t)=>(null==t.stackId||(null==e[t.stackId]&&(e[t.stackId]=[]),e[t.stackId].push(t)),e),{});return Object.fromEntries(Object.entries(r).map(t=>{var[r,a]=t,o=a.map(Dh);return[r,{stackedData:Po(e,o,n),graphicalItems:a}]}))},wp=Ka([bp,sp,nh],xp),kp=(e,t,n)=>{var{dataStartIndex:r,dataEndIndex:a}=t;if("zAxis"!==n){var o=zo(e,r,a);if(null==o||0!==o[0]||0!==o[1])return o}},Sp=Ka([wp,Id,Rh],kp),Cp=(e,t,n,r,a)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var o,i,s=null===(o=r[n.id])||void 0===o?void 0:o.filter(e=>gp(a,e)),c=Eo(e,null!==(i=t.dataKey)&&void 0!==i?i:n.dataKey);return{value:c,errorDomain:vp(e,c,s)}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:Eo(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]})),Ip=e=>e.errorBars,Ep=(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>gp(n,e)),Tp=(Ka([lp,Ip,Rh],Ep),Ka([pp,Jh,lp,Ip,Rh],Cp));function Np(e){var{value:t}=e;if(Qe(t)||t instanceof Date)return t}var Op=e=>{var t=yp(e.flatMap(e=>[e.value,e.errorDomain]).flat(1));if(0!==t.length)return[Math.min(...t),Math.max(...t)]},Ap=e=>{var t;if(null==e||!("domain"in e))return Gh;if(null!=e.domain)return e.domain;if(null!=e.ticks){if("number"===e.type){var n=yp(e.ticks);return[Math.min(...n),Math.max(...n)]}if("category"===e.type)return e.ticks.map(String)}return null!==(t=null===e||void 0===e?void 0:e.domain)&&void 0!==t?t:Gh},_p=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);if(0!==r.length){var a=r.flat();return[Math.min(...a),Math.max(...a)]}},Rp=e=>e.referenceElements.dots,Pp=(e,t,n)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===n:e.yAxisId===n),Dp=Ka([Rp,Rh,Ph],Pp),Mp=e=>e.referenceElements.areas,Fp=Ka([Mp,Rh,Ph],Pp),Lp=e=>e.referenceElements.lines,zp=Ka([Lp,Rh,Ph],Pp),Bp=(e,t)=>{var n=yp(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},jp=Ka(Dp,Rh,Bp),Wp=(e,t)=>{var n=yp(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Up=Ka([Fp,Rh],Wp),Vp=(e,t)=>{var n=yp(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==n.length)return[Math.min(...n),Math.max(...n)]},Gp=Ka(zp,Rh,Vp),Hp=Ka(jp,Gp,Up,(e,t,n)=>_p(e,n,t)),Kp=Ka([Jh],Ap),qp=(e,t,n,r,a,o,i)=>{var s=function(e,t){if(t&&"function"!==typeof e&&Array.isArray(e)&&2===e.length){var n,r,[a,o]=e;if(Nd(a))n=a;else if("function"===typeof a)return;if(Nd(o))r=o;else if("function"===typeof o)return;var i=[n,r];if(Ad(i))return i}}(t,e.allowDataOverflow);return null!=s?s:function(e,t,n){if(n||null!=t){if("function"===typeof e&&null!=t)try{var r=e(t,n);if(Ad(r))return _d(r,t,n)}catch(p){}if(Array.isArray(e)&&2===e.length){var a,o,[i,s]=e;if("auto"===i)null!=t&&(a=Math.min(...t));else if(Ye(i))a=i;else if("function"===typeof i)try{null!=t&&(a=i(null===t||void 0===t?void 0:t[0]))}catch(f){}else if("string"===typeof i&&Bo.test(i)){var c=Bo.exec(i);if(null==c||null==t)a=void 0;else{var l=+c[1];a=t[0]-l}}else a=null===t||void 0===t?void 0:t[0];if("auto"===s)null!=t&&(o=Math.max(...t));else if(Ye(s))o=s;else if("function"===typeof s)try{null!=t&&(o=s(null===t||void 0===t?void 0:t[1]))}catch(m){}else if("string"===typeof s&&jo.test(s)){var u=jo.exec(s);if(null==u||null==t)o=void 0;else{var d=+u[1];o=t[1]+d}}else o=null===t||void 0===t?void 0:t[1];var h=[a,o];if(Ad(h))return null==t?h:_d(h,t,n)}}}(t,"vertical"===o&&"xAxis"===i||"horizontal"===o&&"yAxis"===i?_p(n,a,Op(r)):_p(a,Op(r)),e.allowDataOverflow)},Xp=Ka([Jh,Kp,Sp,Tp,Hp,pi,Rh],qp),Yp=[0,1],Qp=(e,t,n,r,a,o,i)=>{if(null!=e&&null!=n&&0!==n.length||void 0!==i){var{dataKey:s,type:c}=e,l=To(t,o);return l&&null==s?gi()(0,n.length):"category"===c?((e,t,n)=>{var r=e.map(Np).filter(e=>null!=e);return n&&(null==t.dataKey||t.allowDuplicatedCategory&&et(r))?gi()(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))})(r,e,l):"expand"===a?Yp:i}},Zp=Ka([Jh,pi,pp,mp,nh,Rh,Xp],Qp),$p=(t,n,r,a,o)=>{if(null!=t){var{scale:i,type:s}=t;if("auto"===i)return"radial"===n&&"radiusAxis"===o?"band":"radial"===n&&"angleAxis"===o?"linear":"category"===s&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":"category"===s?"band":"linear";if("string"===typeof i){var c="scale".concat(ot(i));return c in e?c:"point"}}},Jp=Ka([Jh,pi,tp,rh,Rh],$p);function ef(t,n,r,a){if(null!=r&&null!=a){if("function"===typeof t.scale)return t.scale.copy().domain(r).range(a);var o=function(t){if(null!=t){if(t in e)return e[t]();var n="scale".concat(ot(t));return n in e?e[n]():void 0}}(n);if(null!=o){var i=o.domain(r).range(a);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-Ao,o=Math.max(r[0],r[1])+Ao,i=e(t[0]),s=e(t[n-1]);(i<a||i>o||s<a||s>o)&&e.domain([t[0],t[n-1]])}})(i),i}}}var tf=(e,t,n)=>{var r=Ap(t);if("auto"===n||"linear"===n)return null!=t&&t.tickCount&&Array.isArray(r)&&("auto"===r[0]||"auto"===r[1])&&Ad(e)?Qd(e,t.tickCount,t.allowDecimals):null!=t&&t.tickCount&&"number"===t.type&&Ad(e)?Zd(e,t.tickCount,t.allowDecimals):void 0},nf=Ka([Zp,ep,Jp],tf),rf=(e,t,n,r)=>{if("angleAxis"!==r&&"number"===(null===e||void 0===e?void 0:e.type)&&Ad(t)&&Array.isArray(n)&&n.length>0){var a=t[0],o=n[0],i=t[1],s=n[n.length-1];return[Math.min(a,o),Math.max(i,s)]}return t},af=Ka([Jh,Zp,nf,Rh],rf),of=Ka(mp,Jh,(e,t)=>{if(t&&"number"===t.type){var n=1/0,r=Array.from(yp(e.map(e=>e.value))).sort((e,t)=>e-t);if(r.length<2)return 1/0;var a=r[r.length-1]-r[0];if(0===a)return 1/0;for(var o=0;o<r.length-1;o++){var i=r[o+1]-r[o];n=Math.min(n,i)}return n/a}}),sf=Ka(of,pi,eh,ti,(e,t,n,r)=>r,(e,t,n,r,a)=>{if(!Nd(e))return 0;var o="vertical"===t?r.height:r.width;if("gap"===a)return e*o/2;if("no-gap"===a){var i=Je(n,e*o),s=e*o/2;return s-i-(s-i)/o*i}return 0}),cf=Ka(qh,(e,t)=>{var n=qh(e,t);return null==n||"string"!==typeof n.padding?0:sf(e,"xAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{left:0,right:0};var{padding:a}=e;return"string"===typeof a?{left:t,right:t}:{left:(null!==(n=a.left)&&void 0!==n?n:0)+t,right:(null!==(r=a.right)&&void 0!==r?r:0)+t}}),lf=Ka(Qh,(e,t)=>{var n=Qh(e,t);return null==n||"string"!==typeof n.padding?0:sf(e,"yAxis",t,n.padding)},(e,t)=>{var n,r;if(null==e)return{top:0,bottom:0};var{padding:a}=e;return"string"===typeof a?{top:t,bottom:t}:{top:(null!==(n=a.top)&&void 0!==n?n:0)+t,bottom:(null!==(r=a.bottom)&&void 0!==r?r:0)+t}}),uf=Ka([ti,cf,si,ii,(e,t,n)=>n],(e,t,n,r,a)=>{var{padding:o}=r;return a?[o.left,n.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),df=Ka([ti,pi,lf,si,ii,(e,t,n)=>n],(e,t,n,r,a,o)=>{var{padding:i}=a;return o?[r.height-i.bottom,i.top]:"horizontal"===t?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),hf=(e,t,n,r)=>{var a;switch(t){case"xAxis":return uf(e,n,r);case"yAxis":return df(e,n,r);case"zAxis":return null===(a=$h(e,n))||void 0===a?void 0:a.range;case"angleAxis":return Th(e);case"radiusAxis":return Oh(e,n);default:return}},pf=Ka([Jh,hf],gh),ff=Ka([Jh,Jp,af,pf],ef);Ka([ip,Ip,Rh],Ep);function mf(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var gf=(e,t)=>t,yf=(e,t,n)=>n,vf=Ka(Xo,gf,yf,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(mf)),bf=Ka(Yo,gf,yf,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(mf)),xf=(e,t)=>({width:e.width,height:t.height}),wf=Ka(ti,qh,xf),kf=Ka(Ho,ti,vf,gf,yf,(e,t,n,r,a)=>{var o,i={};return n.forEach(n=>{var s=xf(t,n);null==o&&(o=((e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}})(t,r,e));var c="top"===r&&!a||"bottom"===r&&a;i[n.id]=o-Number(c)*s.height,o+=(c?-1:1)*s.height}),i}),Sf=Ka(Go,ti,bf,gf,yf,(e,t,n,r,a)=>{var o,i={};return n.forEach(n=>{var s=((e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height}))(t,n);null==o&&(o=((e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}})(t,r,e));var c="left"===r&&!a||"right"===r&&a;i[n.id]=o-Number(c)*s.width,o+=(c?-1:1)*s.width}),i}),Cf=Ka([ti,qh,(e,t)=>{var n=qh(e,t);if(null!=n)return kf(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null===n||void 0===n?void 0:n[r];return null==a?{x:e.left,y:0}:{x:e.left,y:a}}}),If=Ka([ti,Qh,(e,t)=>{var n=Qh(e,t);if(null!=n)return Sf(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(null!=t){var a=null===n||void 0===n?void 0:n[r];return null==a?{x:0,y:e.top}:{x:a,y:e.top}}}),Ef=Ka(ti,Qh,(e,t)=>({width:"number"===typeof t.width?t.width:60,height:e.height})),Tf=(e,t,n)=>{switch(t){case"xAxis":return wf(e,n).width;case"yAxis":return Ef(e,n).height;default:return}},Nf=(e,t,n,r)=>{if(null!=n){var{allowDuplicatedCategory:a,type:o,dataKey:i}=n,s=To(e,r),c=t.map(e=>e.value);return i&&s&&"category"===o&&a&&et(c)?c:void 0}},Of=Ka([pi,mp,Jh,Rh],Nf),Af=(e,t,n,r)=>{if(null!=n&&null!=n.dataKey){var{type:a,scale:o}=n;return!To(e,r)||"number"!==a&&"auto"===o?void 0:t.map(e=>e.value)}},_f=Ka([pi,mp,ep,Rh],Af),Rf=Ka([pi,(e,t,n)=>{switch(t){case"xAxis":return qh(e,n);case"yAxis":return Qh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Jp,ff,Of,_f,hf,nf,Rh],(e,t,n,r,a,o,i,s,c)=>{if(null==t)return null;var l=To(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:o,duplicateDomain:a,isCategorical:l,niceTicks:s,range:i,realScaleType:n,scale:r}}),Pf=(e,t,n,r,a,o,i,s,c)=>{if(null!=t&&null!=r){var l=To(e,c),{type:u,ticks:d,tickCount:h}=t,p="scaleBand"===n&&"function"===typeof r.bandwidth?r.bandwidth()/2:2,f="category"===u&&r.bandwidth?r.bandwidth()/p:0;f="angleAxis"===c&&null!=o&&o.length>=2?2*Ke(o[0]-o[1])*f:f;var m=d||a;return m?m.map((e,t)=>{var n=i?i.indexOf(e):e;return{index:t,coordinate:r(n)+f,value:e,offset:f}}).filter(e=>!qe(e.coordinate)):l&&s?s.map((e,t)=>({coordinate:r(e)+f,value:e,index:t,offset:f})):r.ticks?r.ticks(h).map(e=>({coordinate:r(e)+f,value:e,offset:f})):r.domain().map((e,t)=>({coordinate:r(e)+f,value:i?i[e]:e,index:t,offset:f}))}},Df=Ka([pi,ep,Jp,ff,nf,hf,Of,_f,Rh],Pf),Mf=(e,t,n,r,a,o,i)=>{if(null!=t&&null!=n&&null!=r&&r[0]!==r[1]){var s=To(e,i),{tickCount:c}=t,l=0;return l="angleAxis"===i&&(null===r||void 0===r?void 0:r.length)>=2?2*Ke(r[0]-r[1])*l:l,s&&o?o.map((e,t)=>({coordinate:n(e)+l,value:e,index:t,offset:l})):n.ticks?n.ticks(c).map(e=>({coordinate:n(e)+l,value:e,offset:l})):n.domain().map((e,t)=>({coordinate:n(e)+l,value:a?a[e]:e,index:t,offset:l}))}},Ff=Ka([pi,ep,ff,hf,Of,_f,Rh],Mf),Lf=Ka(Jh,ff,(e,t)=>{if(null!=e&&null!=t)return Uh(Uh({},e),{},{scale:t})}),zf=Ka([Jh,Jp,Zp,pf],ef),Bf=(Ka((e,t,n)=>$h(e,n),zf,(e,t)=>{if(null!=e&&null!=t)return Uh(Uh({},e),{},{scale:t})}),Ka([pi,Xo,Yo],(e,t,n)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})),jf=e=>e.options.defaultTooltipEventType,Wf=e=>e.options.validateTooltipEventTypes;function Uf(e,t,n){if(null==e)return t;var r=e?"axis":"item";return null==n?t:n.includes(r)?r:t}function Vf(e,t){return Uf(t,jf(e),Wf(e))}var Gf=(e,t)=>{var n,r=Number(t);if(!qe(r)&&null!=t)return r>=0?null===e||void 0===e||null===(n=e[r])||void 0===n?void 0:n.value:void 0};function Hf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Kf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hf(Object(n),!0).forEach(function(t){qf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function qf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xf=(e,t,n,r)=>{if(null==t)return fa;var a=function(e,t,n){return"axis"===t?"click"===n?e.axisInteraction.click:e.axisInteraction.hover:"click"===n?e.itemInteraction.click:e.itemInteraction.hover}(e,t,n);if(null==a)return fa;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var o=!0===e.settings.active;if(null!=a.index){if(o)return Kf(Kf({},a),{},{active:!0})}else if(null!=r)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return Kf(Kf({},fa),{},{coordinate:a.coordinate})},Yf=(e,t)=>{var n=null===e||void 0===e?void 0:e.index;if(null==n)return null;var r=Number(n);if(!Nd(r))return n;var a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(0,Math.min(r,a)))},Qf=(e,t,n,r,a,o,i,s)=>{if(null!=o&&null!=s){var c=i[0],l=null==c?void 0:s(c.positions,o);if(null!=l)return l;var u=null===a||void 0===a?void 0:a[Number(o)];if(u)return"horizontal"===n?{x:u.coordinate,y:(r.top+t)/2}:{x:(r.left+e)/2,y:u.coordinate}}},Zf=(e,t,n,r)=>{return"axis"===t?e.tooltipItemPayloads:0===e.tooltipItemPayloads.length?[]:null==(a="hover"===n?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey)&&null!=r?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>{var t;return(null===(t=e.settings)||void 0===t?void 0:t.dataKey)===a});var a},$f=e=>e.options.tooltipPayloadSearcher,Jf=e=>e.tooltip;function em(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?em(Object(n),!0).forEach(function(t){nm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):em(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rm=(e,t,n,r,a,o,i)=>{if(null!=t&&null!=o){var{chartData:s,computedData:c,dataStartIndex:l,dataEndIndex:u}=n;return e.reduce((e,n)=>{var d,h,p,{dataDefinedOnItem:f,settings:m}=n,g=function(e,t){return null!=e?e:t}(f,s),y=Array.isArray(g)?ko(g,l,u):g,v=null!==(d=null===m||void 0===m?void 0:m.dataKey)&&void 0!==d?d:r,b=null===m||void 0===m?void 0:m.nameKey;(h=r&&Array.isArray(y)&&!Array.isArray(y[0])&&"axis"===i?rt(y,r,a):o(y,t,c,b),Array.isArray(h))?h.forEach(t=>{var n=tm(tm({},m),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(Uo({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:Eo(t.payload,t.dataKey),name:t.name}))}):e.push(Uo({tooltipEntrySettings:m,dataKey:v,payload:h,value:Eo(h,v),name:null!==(p=Eo(h,b))&&void 0!==p?p:null===m||void 0===m?void 0:m.name}));return e},[])}},am=Ka([Lh,pi,tp,rh,Mh],$p),om=Ka([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),im=Ka([Mh,Fh],np),sm=Ka([om,Lh,im],op),cm=Ka([sm],e=>e.filter(jh)),lm=Ka([sm],up),um=Ka([lm,Id],hp),dm=Ka([cm,Id,Lh],Bh),hm=Ka([um,Lh,sm],fp),pm=Ka([Lh],Ap),fm=Ka([sm],e=>e.filter(jh)),mm=Ka([dm,fm,nh],xp),gm=Ka([mm,Id,Mh],kp),ym=Ka([sm],cp),vm=Ka([um,Lh,ym,Ip,Mh],Cp),bm=Ka([Rp,Mh,Fh],Pp),xm=Ka([bm,Mh],Bp),wm=Ka([Mp,Mh,Fh],Pp),km=Ka([wm,Mh],Wp),Sm=Ka([Lp,Mh,Fh],Pp),Cm=Ka([Sm,Mh],Vp),Im=Ka([xm,Cm,km],_p),Em=Ka([Lh,pm,gm,vm,Im,pi,Mh],qp),Tm=Ka([Lh,pi,um,hm,nh,Mh,Em],Qp),Nm=Ka([Tm,Lh,am],tf),Om=Ka([Lh,Tm,Nm,Mh],rf),Am=e=>{var t=Mh(e),n=Fh(e);return hf(e,t,n,!1)},_m=Ka([Lh,Am],gh),Rm=Ka([Lh,am,Om,_m],ef),Pm=Ka([pi,hm,Lh,Mh],Nf),Dm=Ka([pi,hm,Lh,Mh],Af),Mm=Ka([pi,Lh,am,Rm,Am,Pm,Dm,Mh],(e,t,n,r,a,o,i,s)=>{if(t){var{type:c}=t,l=To(e,s);if(r){var u="scaleBand"===n&&r.bandwidth?r.bandwidth()/2:2,d="category"===c&&r.bandwidth?r.bandwidth()/u:0;return d="angleAxis"===s&&null!=a&&(null===a||void 0===a?void 0:a.length)>=2?2*Ke(a[0]-a[1])*d:d,l&&i?i.map((e,t)=>({coordinate:r(e)+d,value:e,index:t,offset:d})):r.domain().map((e,t)=>({coordinate:r(e)+d,value:o?o[e]:e,index:t,offset:d}))}}}),Fm=Ka([jf,Wf,e=>e.tooltip.settings],(e,t,n)=>Uf(n.shared,e,t)),Lm=e=>e.tooltip.settings.trigger,zm=e=>e.tooltip.settings.defaultIndex,Bm=Ka([Jf,Fm,Lm,zm],Xf),jm=Ka([Bm,um],Yf),Wm=Ka([Mm,jm],Gf),Um=Ka([Bm],e=>{if(e)return e.dataKey}),Vm=Ka([Jf,Fm,Lm,zm],Zf),Gm=Ka([Go,Ho,pi,ti,Mm,zm,Vm,$f],Qf),Hm=Ka([Bm,Gm],(e,t)=>null!==e&&void 0!==e&&e.coordinate?e.coordinate:t),Km=Ka([Bm],e=>e.active),qm=Ka([Vm,jm,Id,zh,Wm,$f,Fm],rm),Xm=Ka([qm],e=>{if(null!=e){var t=e.map(e=>e.payload).filter(e=>null!=e);return Array.from(new Set(t))}}),Ym=()=>to(rh),Qm=(e,t)=>t,Zm=(e,t,n)=>n,$m=(e,t,n,r)=>r,Jm=Ka(Mm,e=>ro()(e,e=>e.coordinate)),eg=Ka([Jf,Qm,Zm,$m],Xf),tg=Ka([eg,um],Yf),ng=Ka([Jf,Qm,Zm,$m],Zf),rg=Ka([Go,Ho,pi,ti,Mm,$m,ng,$f],Qf),ag=Ka([eg,rg],(e,t)=>{var n;return null!==(n=e.coordinate)&&void 0!==n?n:t}),og=Ka(Mm,tg,Gf),ig=Ka([ng,tg,Id,zh,og,$f,Qm],rm),sg=Ka([eg],e=>({isActive:e.active,activeIndex:e.index})),cg=Ka([(e,t)=>t,pi,_h,Mh,_m,Mm,Jm,ti],(e,t,n,r,a,o,i,s)=>{if(e&&t&&r&&a&&o){var c=function(e,t,n,r,a){return"horizontal"===n||"vertical"===n?e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height?{x:e,y:t}:null:r?wo({x:e,y:t},r):null}(e.chartX,e.chartY,t,n,s);if(c){var l=((e,t)=>"horizontal"===t?e.x:"vertical"===t?e.y:"centric"===t?e.angle:e.radius)(c,t),u=((e,t,n,r,a)=>{var o,i=-1,s=null!==(o=null===t||void 0===t?void 0:t.length)&&void 0!==o?o:0;if(s<=1||null==e)return 0;if("angleAxis"===r&&null!=a&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<s;c++){var l=c>0?n[c-1].coordinate:n[s-1].coordinate,u=n[c].coordinate,d=c>=s-1?n[0].coordinate:n[c+1].coordinate,h=void 0;if(Ke(u-l)!==Ke(d-u)){var p=[];if(Ke(d-u)===Ke(a[1]-a[0])){h=d;var f=u+a[1]-a[0];p[0]=Math.min(f,(f+l)/2),p[1]=Math.max(f,(f+l)/2)}else{h=l;var m=d+a[1]-a[0];p[0]=Math.min(u,(m+u)/2),p[1]=Math.max(u,(m+u)/2)}var g=[Math.min(u,(h+u)/2),Math.max(u,(h+u)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){({index:i}=n[c]);break}}else{var y=Math.min(l,d),v=Math.max(l,d);if(e>(y+u)/2&&e<=(v+u)/2){({index:i}=n[c]);break}}}else if(t)for(var b=0;b<s;b++)if(0===b&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:i}=t[b]);break}return i})(l,i,o,r,a),d=((e,t,n,r)=>{var a=t.find(e=>e&&e.index===n);if(a){if("horizontal"===e)return{x:a.coordinate,y:r.y};if("vertical"===e)return{x:r.x,y:a.coordinate};if("centric"===e){var o=a.coordinate,{radius:i}=r;return Co(Co(Co({},r),yo(r.cx,r.cy,i,o)),{},{angle:o,radius:i})}var s=a.coordinate,{angle:c}=r;return Co(Co(Co({},r),yo(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return{x:0,y:0}})(t,o,u,c);return{activeIndex:String(u),activeCoordinate:d}}}}),lg=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},ug=gn("mouseClick"),dg=lr();dg.startListening({actionCreator:ug,effect:(e,t)=>{var n=e.payload,r=cg(t.getState(),lg(n));null!=(null===r||void 0===r?void 0:r.activeIndex)&&t.dispatch(Ca({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var hg=gn("mouseMove"),pg=lr();function fg(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}function mg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mg(Object(n),!0).forEach(function(t){yg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function yg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}pg.startListening({actionCreator:hg,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=Vf(r,r.tooltip.settings.shared),o=cg(r,lg(n));"axis"===a&&(null!=(null===o||void 0===o?void 0:o.activeIndex)?t.dispatch(Sa({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(wa()))}});var vg=An({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload;e.yAxis[n]&&(e.yAxis[n]=gg(gg({},e.yAxis[n]),{},{width:r}))}}}),{addXAxis:bg,removeXAxis:xg,addYAxis:wg,removeYAxis:kg,addZAxis:Sg,removeZAxis:Cg,updateYAxisWidth:Ig}=vg.actions,Eg=vg.reducer,Tg=An({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:n,next:r}=t.payload,a=un(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=r)},removeCartesianGraphicalItem(e,t){var n=un(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var n=un(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:Ng,replaceCartesianGraphicalItem:Og,removeCartesianGraphicalItem:Ag,addPolarGraphicalItem:_g,removePolarGraphicalItem:Rg}=Tg.actions,Pg=Tg.reducer,Dg=An({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=un(e).dots.findIndex(e=>e===t.payload);-1!==n&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=un(e).areas.findIndex(e=>e===t.payload);-1!==n&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=un(e).lines.findIndex(e=>e===t.payload);-1!==n&&e.lines.splice(n,1)}}}),{addDot:Mg,removeDot:Fg,addArea:Lg,removeArea:zg,addLine:Bg,removeLine:jg}=Dg.actions,Wg=Dg.reducer,Ug={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Vg=An({name:"brush",initialState:Ug,reducers:{setBrushSettings:(e,t)=>null==t.payload?Ug:t.payload}}),{setBrushSettings:Gg}=Vg.actions,Hg=Vg.reducer,Kg=An({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var n=un(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)}}}),{setLegendSize:qg,setLegendSettings:Xg,addLegendPayload:Yg,removeLegendPayload:Qg}=Kg.actions,Zg=Kg.reducer,$g={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Jg=An({name:"rootProps",initialState:$g,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!==(n=t.payload.barGap)&&void 0!==n?n:$g.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),ey=Jg.reducer,{updateOptions:ty}=Jg.actions,ny=An({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:ry,removeRadiusAxis:ay,addAngleAxis:oy,removeAngleAxis:iy}=ny.actions,sy=ny.reducer,cy=An({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:ly}=cy.actions,uy=cy.reducer,dy=gn("keyDown"),hy=gn("focus"),py=lr();py.startListening({actionCreator:dy,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip,a=e.payload;if("ArrowRight"===a||"ArrowLeft"===a||"Enter"===a){var o=Number(Yf(r,um(n))),i=Mm(n);if("Enter"!==a){var s=o+("ArrowRight"===a?1:-1)*("left-to-right"===Bf(n)?1:-1);if(!(null==i||s>=i.length||s<0)){var c=rg(n,"axis","hover",String(s));t.dispatch(Ea({active:!0,activeIndex:s.toString(),activeDataKey:void 0,activeCoordinate:c}))}}else{var l=rg(n,"axis","hover",String(r.index));t.dispatch(Ea({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:l}))}}}}}),py.startListening({actionCreator:hy,effect:(e,t)=>{var n=t.getState();if(!1!==n.rootProps.accessibilityLayer){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&null==r.index){var a=rg(n,"axis","hover",String("0"));t.dispatch(Ea({activeDataKey:void 0,active:!0,activeIndex:"0",activeCoordinate:a}))}}}});var fy=gn("externalEvent"),my=lr();my.startListening({actionCreator:fy,effect:(e,t)=>{if(null!=e.payload.handler){var n=t.getState(),r={activeCoordinate:Hm(n),activeDataKey:Um(n),activeIndex:jm(n),activeLabel:Wm(n),activeTooltipIndex:jm(n),isTooltipActive:Km(n)};e.payload.handler(r,e.payload.reactEvent)}}});var gy=Ka([Jf],e=>e.tooltipItemPayloads),yy=Ka([gy,$f,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var a=e.find(e=>e.settings.dataKey===r);if(null!=a){var{positions:o}=a;if(null!=o)return t(o,n)}}),vy=gn("touchMove"),by=lr();by.startListening({actionCreator:vy,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=Vf(r,r.tooltip.settings.shared);if("axis"===a){var o=cg(r,lg({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));null!=(null===o||void 0===o?void 0:o.activeIndex)&&t.dispatch(Sa({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if("item"===a){var i,s=n.touches[0],c=document.elementFromPoint(s.clientX,s.clientY);if(!c||!c.getAttribute)return;var l=c.getAttribute(Qo),u=null!==(i=c.getAttribute(Zo))&&void 0!==i?i:void 0,d=yy(t.getState(),l,u);t.dispatch(ba({activeDataKey:u,activeIndex:l,activeCoordinate:d}))}}});var xy=An({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:a}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?a:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:wy,replaceErrorBar:ky,removeErrorBar:Sy}=xy.actions,Cy=xy.reducer,Iy=!1,Ey=!("undefined"!==typeof window&&window.document&&Boolean(window.document.createElement)&&window.setTimeout),Ty=yt({brush:Hg,cartesianAxis:Eg,chartData:Ra,errorBars:Cy,graphicalItems:Pg,layout:za,legend:Zg,options:pr,polarAxis:sy,polarOptions:uy,referenceElements:Wg,rootProps:ey,tooltip:Ta});function Ny(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,a=oi(),o=(0,N.useRef)(null);if(a)return n;null==o.current&&(o.current=function(e){return Sn({reducer:Ty,preloadedState:e,middleware:e=>e({serializableCheck:!1}).concat([dg.middleware,pg.middleware,py.middleware,my.middleware,by.middleware]),devTools:Iy&&{serialize:{replacer:fg},name:"recharts-".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart")}})}(t,r));var i=Ya;return N.createElement(Ir,{context:i,store:o.current},n)}var Oy=e=>{var{chartData:t}=e,n=Za(),r=oi();return(0,N.useEffect)(()=>r?()=>{}:(n(Oa(t)),()=>{n(Oa(void 0))}),[t,n,r]),null};function Ay(e){var{layout:t,width:n,height:r,margin:a}=e,o=Za(),i=oi();return(0,N.useEffect)(()=>{i||(o(Ma(t)),o(Fa({width:n,height:r})),o(Da(a)))},[o,i,t,n,r,a]),null}function _y(e){var t=Za();return(0,N.useEffect)(()=>{t(ty(e))},[t,e]),null}var Ry=()=>to(e=>e.rootProps.accessibilityLayer),Py=n(528),Dy=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function My(e){return"string"===typeof e&&Dy.includes(e)}var Fy=["points","pathLength"],Ly={svg:["viewBox","children"],polygon:Fy,polyline:Fy},zy=(e,t)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var n=e;if((0,N.isValidElement)(e)&&(n=e.props),"object"!==typeof n&&"function"!==typeof n)return null;var r={};return Object.keys(n).forEach(e=>{My(e)&&(r[e]=t||(t=>n[e](n,t)))}),r},By=(e,t,n)=>{if(null===e||"object"!==typeof e&&"function"!==typeof e)return null;var r=null;return Object.keys(e).forEach(a=>{var o=e[a];My(a)&&"function"===typeof o&&(r||(r={}),r[a]=((e,t,n)=>r=>(e(t,n,r),null))(o,t,n))}),r},jy=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Wy(e){return"string"===typeof e&&jy.includes(e)}function Uy(e){var t=Object.entries(e).filter(e=>{var[t]=e;return Wy(t)});return Object.fromEntries(t)}var Vy=e=>"string"===typeof e?e:e?e.displayName||e.name||"Component":"",Gy=null,Hy=null,Ky=e=>{if(e===Gy&&Array.isArray(Hy))return Hy;var t=[];return N.Children.forEach(e,e=>{at(e)||((0,Py.zv)(e)?t=t.concat(Ky(e.props.children)):t.push(e))}),Hy=t,Gy=e,t};function qy(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(e=>Vy(e)):[Vy(t)],Ky(e).forEach(e=>{var t=He()(e,"type.displayName")||He()(e,"type.name");-1!==r.indexOf(t)&&n.push(e)}),n}var Xy=e=>!e||"object"!==typeof e||!("clipDot"in e)||Boolean(e.clipDot),Yy=(e,t,n)=>{if(!e||"function"===typeof e||"boolean"===typeof e)return null;var r=e;if((0,N.isValidElement)(e)&&(r=e.props),"object"!==typeof r&&"function"!==typeof r)return null;var a={};return Object.keys(r).forEach(e=>{var o;((e,t,n,r)=>{var a;if("symbol"===typeof t||"number"===typeof t)return!0;var o=null!==(a=r&&(null===Ly||void 0===Ly?void 0:Ly[r]))&&void 0!==a?a:[],i=t.startsWith("data-"),s="function"!==typeof e&&(Boolean(r)&&o.includes(t)||Wy(t)),c=Boolean(n)&&My(t);return i||s||c})(null===(o=r)||void 0===o?void 0:o[e],e,t,n)&&(a[e]=r[e])}),a},Qy=["children","width","height","viewBox","className","style","title","desc"];function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zy.apply(null,arguments)}var $y=(0,N.forwardRef)((e,t)=>{var{children:n,width:r,height:a,viewBox:o,className:i,style:s,title:c,desc:l}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Qy),d=o||{width:r,height:a,x:0,y:0},h=We("recharts-surface",i);return N.createElement("svg",Zy({},Yy(u,!0,"svg"),{className:h,width:r,height:a,style:s,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:t}),N.createElement("title",null,c),N.createElement("desc",null,l),n)}),Jy=["children"];function ev(){return ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ev.apply(null,arguments)}var tv={width:"100%",height:"100%"},nv=(0,N.forwardRef)((e,t)=>{var n=di(),r=hi(),a=Ry();if(!Od(n)||!Od(r))return null;var o,i,{children:s,otherAttributes:c,title:l,desc:u}=e;return o="number"===typeof c.tabIndex?c.tabIndex:a?0:void 0,i="string"===typeof c.role?c.role:a?"application":void 0,N.createElement($y,ev({},c,{title:l,desc:u,role:i,tabIndex:o,width:n,height:r,style:tv,ref:t}),s)}),rv=e=>{var{children:t}=e,n=to(si);if(!n)return null;var{width:r,height:a,y:o,x:i}=n;return N.createElement($y,{width:r,height:a,x:i,y:o},t)},av=(0,N.forwardRef)((e,t)=>{var{children:n}=e,r=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Jy);return oi()?N.createElement(rv,null,n):N.createElement(nv,ev({ref:t},r),n)});var ov=new(n(7283)),iv="recharts.syncEvent.tooltip",sv="recharts.syncEvent.brush";function cv(e){return e.tooltip.syncInteraction}var lv=["x","y"];function uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uv(Object(n),!0).forEach(function(t){hv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pv=()=>{};function fv(){var e=to(ah),t=to(ih),n=Za(),r=to(oh),a=to(Mm),o=fi(),i=ci(),s=to(e=>e.rootProps.className);(0,N.useEffect)(()=>{if(null==e)return pv;var s=(s,c,l)=>{var u;if(t!==l&&e===s)if("index"!==r){if(null!=a){var d;if("function"===typeof r){var h={activeTooltipIndex:null==c.payload.index?void 0:Number(c.payload.index),isTooltipActive:c.payload.active,activeIndex:null==c.payload.index?void 0:Number(c.payload.index),activeLabel:c.payload.label,activeDataKey:c.payload.dataKey,activeCoordinate:c.payload.coordinate},p=r(a,h);d=a[p]}else"value"===r&&(d=a.find(e=>String(e.value)===c.payload.label));var{coordinate:f}=c.payload;if(null!=d&&!1!==c.payload.active&&null!=f&&null!=i){var{x:m,y:g}=f,y=Math.min(m,i.x+i.width),v=Math.min(g,i.y+i.height),b={x:"horizontal"===o?d.coordinate:y,y:"horizontal"===o?v:d.coordinate},x=Ia({active:c.payload.active,coordinate:b,dataKey:c.payload.dataKey,index:String(d.index),label:c.payload.label});n(x)}else n(Ia({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}))}}else if(i&&null!==c&&void 0!==c&&null!==(u=c.payload)&&void 0!==u&&u.coordinate){var w=c.payload.coordinate,{x:k,y:S}=w,C=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(w,lv),I=dv(dv(dv({},C),"number"===typeof k&&{x:Math.max(i.x,Math.min(k,i.x+i.width))}),"number"===typeof S&&{y:Math.max(i.y,Math.min(S,i.y+i.height))}),E=dv(dv({},c),{},{payload:dv(dv({},c.payload),{},{coordinate:I})});n(E)}else n(c)};return ov.on(iv,s),()=>{ov.off(iv,s)}},[s,n,t,e,r,a,o,i])}function mv(){var e=Za();(0,N.useEffect)(()=>{e(fr())},[e]),fv(),function(){var e=to(ah),t=to(ih),n=Za();(0,N.useEffect)(()=>{if(null==e)return pv;var r=(r,a,o)=>{t!==o&&e===r&&n(Aa(a))};return ov.on(sv,r),()=>{ov.off(sv,r)}},[n,t,e])}()}function gv(e,t,n,r,a,o){var i=to(n=>((e,t,n)=>{if(null!=t){var r=Jf(e);return"axis"===t?"hover"===n?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:"hover"===n?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}})(n,e,t)),s=to(ih),c=to(ah),l=to(oh),u=to(cv),d=null===u||void 0===u?void 0:u.active;(0,N.useEffect)(()=>{if(!d&&null!=c&&null!=s){var e=Ia({active:o,coordinate:n,dataKey:i,index:a,label:"number"===typeof r?String(r):r});ov.emit(iv,c,e,s)}},[d,n,i,a,r,s,c,l,o])}var yv=(0,N.createContext)(null),vv=(0,N.createContext)(null);function bv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bv(Object(n),!0).forEach(function(t){wv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kv=(0,N.forwardRef)((e,t)=>{var{children:n,className:r,height:a,onClick:o,onContextMenu:i,onDoubleClick:s,onMouseDown:c,onMouseEnter:l,onMouseLeave:u,onMouseMove:d,onMouseUp:h,onTouchEnd:p,onTouchMove:f,onTouchStart:m,style:g,width:y}=e,v=Za(),[b,x]=(0,N.useState)(null),[w,k]=(0,N.useState)(null);mv();var S=function(){var e=Za(),[t,n]=(0,N.useState)(null),r=to(Ko);return(0,N.useEffect)(()=>{if(null!=t){var n=t.getBoundingClientRect().width/t.offsetWidth;Nd(n)&&n!==r&&e(La(n))}},[t,e,r]),n}(),C=(0,N.useCallback)(e=>{S(e),"function"===typeof t&&t(e),x(e),k(e)},[S,t,x,k]),I=(0,N.useCallback)(e=>{v(ug(e)),v(fy({handler:o,reactEvent:e}))},[v,o]),E=(0,N.useCallback)(e=>{v(hg(e)),v(fy({handler:l,reactEvent:e}))},[v,l]),T=(0,N.useCallback)(e=>{v(wa()),v(fy({handler:u,reactEvent:e}))},[v,u]),O=(0,N.useCallback)(e=>{v(hg(e)),v(fy({handler:d,reactEvent:e}))},[v,d]),A=(0,N.useCallback)(()=>{v(hy())},[v]),_=(0,N.useCallback)(e=>{v(dy(e.key))},[v]),R=(0,N.useCallback)(e=>{v(fy({handler:i,reactEvent:e}))},[v,i]),P=(0,N.useCallback)(e=>{v(fy({handler:s,reactEvent:e}))},[v,s]),D=(0,N.useCallback)(e=>{v(fy({handler:c,reactEvent:e}))},[v,c]),M=(0,N.useCallback)(e=>{v(fy({handler:h,reactEvent:e}))},[v,h]),F=(0,N.useCallback)(e=>{v(fy({handler:m,reactEvent:e}))},[v,m]),L=(0,N.useCallback)(e=>{v(vy(e)),v(fy({handler:f,reactEvent:e}))},[v,f]),z=(0,N.useCallback)(e=>{v(fy({handler:p,reactEvent:e}))},[v,p]);return N.createElement(yv.Provider,{value:b},N.createElement(vv.Provider,{value:w},N.createElement("div",{className:We("recharts-wrapper",r),style:xv({position:"relative",cursor:"default",width:y,height:a},g),onClick:I,onContextMenu:R,onDoubleClick:P,onFocus:A,onKeyDown:_,onMouseDown:D,onMouseEnter:E,onMouseLeave:T,onMouseMove:O,onMouseUp:M,onTouchEnd:z,onTouchMove:L,onTouchStart:F,ref:C},n)))}),Sv=Ka([ti],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Cv=Ka([Sv,Go,Ho],(e,t,n)=>{if(e&&null!=t&&null!=n)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),Iv=()=>to(Cv),Ev=(0,N.createContext)(void 0),Tv=e=>{var{children:t}=e,[n]=(0,N.useState)("".concat($e("recharts"),"-clip")),r=Iv();if(null==r)return null;var{x:a,y:o,width:i,height:s}=r;return N.createElement(Ev.Provider,{value:n},N.createElement("defs",null,N.createElement("clipPath",{id:n},N.createElement("rect",{x:a,y:o,height:s,width:i}))),t)},Nv=["children","className","width","height","style","compact","title","desc"];var Ov=(0,N.forwardRef)((e,t)=>{var{children:n,className:r,width:a,height:o,style:i,compact:s,title:c,desc:l}=e,u=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Nv),d=Uy(u);return s?N.createElement(av,{otherAttributes:d,title:c,desc:l},n):N.createElement(kv,{className:r,style:i,width:a,height:o,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},N.createElement(av,{otherAttributes:d,title:c,desc:l,ref:t},N.createElement(Tv,null,n)))});function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _v(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rv(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Av(Object(n),!0).forEach(function(t){_v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e),r=t;return Object.keys(t).reduce((e,t)=>(void 0===e[t]&&void 0!==r[t]&&(e[t]=r[t]),e),n)}var Pv=["width","height"];function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Dv.apply(null,arguments)}var Mv={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},Fv=(0,N.forwardRef)(function(e,t){var n,r=Rv(e.categoricalChartProps,Mv),{width:a,height:o}=r,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,Pv);if(!Od(a)||!Od(o))return null;var{chartName:s,defaultTooltipEventType:c,validateTooltipEventTypes:l,tooltipPayloadSearcher:u,categoricalChartProps:d}=e,h={chartName:s,defaultTooltipEventType:c,validateTooltipEventTypes:l,tooltipPayloadSearcher:u,eventEmitter:void 0};return N.createElement(Ny,{preloadedState:{options:h},reduxStoreName:null!==(n=d.id)&&void 0!==n?n:s},N.createElement(Oy,{chartData:d.data}),N.createElement(Ay,{width:a,height:o,layout:r.layout,margin:r.margin}),N.createElement(_y,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),N.createElement(Ov,Dv({},i,{width:a,height:o,ref:t})))}),Lv=["axis","item"],zv=(0,N.forwardRef)((e,t)=>N.createElement(Fv,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Lv,tooltipPayloadSearcher:dr,categoricalChartProps:e,ref:t}));function Bv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jv(Object(n),!0).forEach(function(t){Uv(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Uv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vv=Wv({},{cacheSize:2e3,enableCache:!0}),Gv=new class{constructor(e){Bv(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(Vv.cacheSize),Hv={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Kv="recharts_measurement_span";var qv=(e,t)=>{try{var n=document.getElementById(Kv);n||((n=document.createElement("span")).setAttribute("id",Kv),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,Hv,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch(a){return{width:0,height:0}}},Xv=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e||Ey)return{width:0,height:0};if(!Vv.enableCache)return qv(e,t);var n=function(e,t){var n=t.fontSize||"",r=t.fontFamily||"",a=t.fontWeight||"",o=t.fontStyle||"",i=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(a,"|").concat(o,"|").concat(i,"|").concat(s)}(e,t),r=Gv.get(n);if(r)return r;var a=qv(e,t);return Gv.set(n,a),a};function Yv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Qv{static create(e){return new Qv(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0!==e){if(n)switch(n){case"start":default:return this.scale(e);case"middle":var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case"end":var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}if(t){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+o}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}}Yv(Qv,"EPS",1e-4);function Zv(e,t,n){if(t<1)return[];if(1===t&&void 0===n)return e;for(var r=[],a=0;a<e.length;a+=t){if(void 0!==n&&!0!==n(e[a]))return;r.push(e[a])}return r}function $v(e,t,n){return function(e){var{width:t,height:n}=e,r=function(e){return(e%180+180)%180}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),a=r*Math.PI/180,o=Math.atan(n/t),i=a>o&&a<Math.PI-o?n/Math.sin(a):t/Math.cos(a);return Math.abs(i)}({width:e.width+t.width,height:e.height+t.height},n)}function Jv(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var o=n();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-a)<=0}function eb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eb(Object(n),!0).forEach(function(t){nb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rb(e,t,n){var r,{tick:a,ticks:o,viewBox:i,minTickGap:s,orientation:c,interval:l,tickFormatter:u,unit:d,angle:h}=e;if(!o||!o.length||!a)return[];if(Ye(l)||Ey)return null!==(r=function(e,t){return Zv(e,t+1)}(o,Ye(l)?l:0))&&void 0!==r?r:[];var p=[],f="top"===c||"bottom"===c?"width":"height",m=d&&"width"===f?Xv(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(e,r)=>{var a="function"===typeof u?u(e.value,r):e.value;return"width"===f?$v(Xv(a,{fontSize:t,letterSpacing:n}),m,h):Xv(a,{fontSize:t,letterSpacing:n})[f]},y=o.length>=2?Ke(o[1].coordinate-o[0].coordinate):1,v=function(e,t,n){var r="width"===n,{x:a,y:o,width:i,height:s}=e;return 1===t?{start:r?a:o,end:r?a+i:o+s}:{start:r?a+i:o+s,end:r?a:o}}(i,y,f);return"equidistantPreserveStart"===l?function(e,t,n,r,a){for(var o,i=(r||[]).slice(),{start:s,end:c}=t,l=0,u=1,d=s,h=function(){var t=null===r||void 0===r?void 0:r[l];if(void 0===t)return{v:Zv(r,u)};var o,i=l,h=()=>(void 0===o&&(o=n(t,i)),o),p=t.coordinate,f=0===l||Jv(e,p,h,d,c);f||(l=0,d=s,u+=1),f&&(d=p+e*(h()/2+a),l+=u)};u<=i.length;)if(o=h())return o.v;return[]}(y,v,g,o,s):(p="preserveStart"===l||"preserveStartEnd"===l?function(e,t,n,r,a,o){var i=(r||[]).slice(),s=i.length,{start:c,end:l}=t;if(o){var u=r[s-1],d=n(u,s-1),h=e*(u.coordinate+e*d/2-l);i[s-1]=u=tb(tb({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate}),Jv(e,u.tickCoord,()=>d,c,l)&&(l=u.tickCoord-e*(d/2+a),i[s-1]=tb(tb({},u),{},{isShow:!0}))}for(var p=o?s-1:s,f=function(t){var r,o=i[t],s=()=>(void 0===r&&(r=n(o,t)),r);if(0===t){var u=e*(o.coordinate-e*s()/2-c);i[t]=o=tb(tb({},o),{},{tickCoord:u<0?o.coordinate-u*e:o.coordinate})}else i[t]=o=tb(tb({},o),{},{tickCoord:o.coordinate});Jv(e,o.tickCoord,s,c,l)&&(c=o.tickCoord+e*(s()/2+a),i[t]=tb(tb({},o),{},{isShow:!0}))},m=0;m<p;m++)f(m);return i}(y,v,g,o,s,"preserveStartEnd"===l):function(e,t,n,r,a){for(var o=(r||[]).slice(),i=o.length,{start:s}=t,{end:c}=t,l=function(t){var r,l=o[t],u=()=>(void 0===r&&(r=n(l,t)),r);if(t===i-1){var d=e*(l.coordinate+e*u()/2-c);o[t]=l=tb(tb({},l),{},{tickCoord:d>0?l.coordinate-d*e:l.coordinate})}else o[t]=l=tb(tb({},l),{},{tickCoord:l.coordinate});Jv(e,l.tickCoord,u,s,c)&&(c=l.tickCoord-e*(u()/2+a),o[t]=tb(tb({},l),{},{isShow:!0}))},u=i-1;u>=0;u--)l(u);return o}(y,v,g,o,s),p.filter(e=>e.isShow))}function ab(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}var ob=["children","className"];function ib(){return ib=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ib.apply(null,arguments)}var sb=N.forwardRef((e,t)=>{var{children:n,className:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,ob),o=We("recharts-layer",r);return N.createElement("g",ib({className:o},Yy(a,!0),{ref:t}),n)}),cb=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,lb=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ub=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,db=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,hb={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},pb=Object.keys(hb),fb="NaN";class mb{static parse(e){var t,[,n,r]=null!==(t=db.exec(e))&&void 0!==t?t:[];return new mb(parseFloat(n),null!==r&&void 0!==r?r:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,qe(e)&&(this.unit=""),""===t||ub.test(t)||(this.num=NaN,this.unit=""),pb.includes(t)&&(this.num=function(e,t){return e*hb[t]}(e,t),this.unit="px")}add(e){return this.unit!==e.unit?new mb(NaN,""):new mb(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new mb(NaN,""):new mb(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new mb(NaN,""):new mb(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new mb(NaN,""):new mb(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return qe(this.num)}}function gb(e){if(e.includes(fb))return fb;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,a,o]=null!==(n=cb.exec(t))&&void 0!==n?n:[],i=mb.parse(null!==r&&void 0!==r?r:""),s=mb.parse(null!==o&&void 0!==o?o:""),c="*"===a?i.multiply(s):i.divide(s);if(c.isNaN())return fb;t=t.replace(cb,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var l,[,u,d,h]=null!==(l=lb.exec(t))&&void 0!==l?l:[],p=mb.parse(null!==u&&void 0!==u?u:""),f=mb.parse(null!==h&&void 0!==h?h:""),m="+"===d?p.add(f):p.subtract(f);if(m.isNaN())return fb;t=t.replace(lb,m.toString())}return t}var yb=/\(([^()]*)\)/;function vb(e){var t=e.replace(/\s+/g,"");return t=function(e){for(var t,n=e;null!=(t=yb.exec(n));){var[,r]=t;n=n.replace(yb,gb(r))}return n}(t),t=gb(t)}function bb(e){var t=function(e){try{return vb(e)}catch(t){return fb}}(e.slice(5,-1));return t===fb?"":t}var xb=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],wb=["dx","dy","angle","className","breakAll"];function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kb.apply(null,arguments)}function Sb(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Cb=/[ \f\n\r\t\v\u2028\u2029]+/,Ib=e=>{var{children:t,breakAll:n,style:r}=e;try{var a=[];return at(t)||(a=n?t.toString().split(""):t.toString().split(Cb)),{wordsWithComputedWidth:a.map(e=>({word:e,width:Xv(e,r).width})),spaceWidth:n?0:Xv("\xa0",r).width}}catch(o){return null}},Eb=e=>[{words:at(e)?[]:e.toString().split(Cb)}],Tb=e=>{var{width:t,scaleToFit:n,children:r,style:a,breakAll:o,maxLines:i}=e;if((t||n)&&!Ey){var s=Ib({breakAll:o,children:r,style:a});if(!s)return Eb(r);var{wordsWithComputedWidth:c,spaceWidth:l}=s;return((e,t,n,r,a)=>{var{maxLines:o,children:i,style:s,breakAll:c}=e,l=Ye(o),u=i,d=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((e,t)=>{var{word:o,width:i}=t,s=e[e.length-1];if(s&&(null==r||a||s.width+i+n<Number(r)))s.words.push(o),s.width+=i+n;else{var c={words:[o],width:i};e.push(c)}return e},[])},h=d(t),p=e=>e.reduce((e,t)=>e.width>t.width?e:t);if(!l||a)return h;if(!(h.length>o||p(h).width>Number(r)))return h;for(var f,m=e=>{var t=u.slice(0,e),n=Ib({breakAll:c,style:s,children:t+"\u2026"}).wordsWithComputedWidth,a=d(n);return[a.length>o||p(a).width>Number(r),a]},g=0,y=u.length-1,v=0;g<=y&&v<=u.length-1;){var b=Math.floor((g+y)/2),x=b-1,[w,k]=m(x),[S]=m(b);if(w||S||(g=b+1),w&&S&&(y=b-1),!w&&S){f=k;break}v++}return f||h})({breakAll:o,children:r,maxLines:i,style:a},c,l,t,n)}return Eb(r)},Nb="#808080",Ob=(0,N.forwardRef)((e,t)=>{var{x:n=0,y:r=0,lineHeight:a="1em",capHeight:o="0.71em",scaleToFit:i=!1,textAnchor:s="start",verticalAnchor:c="end",fill:l=Nb}=e,u=Sb(e,xb),d=(0,N.useMemo)(()=>Tb({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:i,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,i,u.style,u.width]),{dx:h,dy:p,angle:f,className:m,breakAll:g}=u,y=Sb(u,wb);if(!Qe(n)||!Qe(r)||0===d.length)return null;var v,b=n+(Ye(h)?h:0),x=r+(Ye(p)?p:0);switch(c){case"start":v=bb("calc(".concat(o,")"));break;case"middle":v=bb("calc(".concat((d.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:v=bb("calc(".concat(d.length-1," * -").concat(a,")"))}var w=[];if(i){var k=d[0].width,{width:S}=u;w.push("scale(".concat(Ye(S)?S/k:1,")"))}return f&&w.push("rotate(".concat(f,", ").concat(b,", ").concat(x,")")),w.length&&(y.transform=w.join(" ")),N.createElement("text",kb({},Yy(y,!0),{ref:t,x:b,y:x,className:We("recharts-text",m),textAnchor:s,fill:l.includes("url")?Nb:l}),d.map((e,t)=>{var n=e.words.join(g?"":" ");return N.createElement("tspan",{x:b,dy:0===t?v:a,key:"".concat(n,"-").concat(t)},n)}))});Ob.displayName="Text";var Ab=["labelRef"];function _b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Rb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_b(Object(n),!0).forEach(function(t){Pb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Db.apply(null,arguments)}var Mb=(0,N.createContext)(null),Fb=e=>{var{x:t,y:n,width:r,height:a,children:o}=e,i=(0,N.useMemo)(()=>({x:t,y:n,width:r,height:a}),[t,n,r,a]);return N.createElement(Mb.Provider,{value:i},o)},Lb=()=>{var e=(0,N.useContext)(Mb),t=ci();return e||t},zb=(0,N.createContext)(null),Bb=()=>{var e=(0,N.useContext)(zb),t=to(_h);return e||t},jb=e=>null!=e&&"function"===typeof e,Wb=(e,t,n,r,a)=>{var o,i,{offset:s,className:c}=e,{cx:l,cy:u,innerRadius:d,outerRadius:h,startAngle:p,endAngle:f,clockWise:m}=a,g=(d+h)/2,y=((e,t)=>Ke(t-e)*Math.min(Math.abs(t-e),360))(p,f),v=y>=0?1:-1;switch(t){case"insideStart":o=p+v*s,i=m;break;case"insideEnd":o=f-v*s,i=!m;break;case"end":o=f+v*s,i=m;break;default:throw new Error("Unsupported position ".concat(t))}i=y<=0?i:!i;var b=yo(l,u,g,o),x=yo(l,u,g,o+359*(i?1:-1)),w="M".concat(b.x,",").concat(b.y,"\n    A").concat(g,",").concat(g,",0,1,").concat(i?0:1,",\n    ").concat(x.x,",").concat(x.y),k=at(e.id)?$e("recharts-radial-line-"):e.id;return N.createElement("text",Db({},r,{dominantBaseline:"central",className:We("recharts-radial-bar-label",c)}),N.createElement("defs",null,N.createElement("path",{id:k,d:w})),N.createElement("textPath",{xlinkHref:"#".concat(k)},n))},Ub=e=>"cx"in e&&Ye(e.cx),Vb={offset:5};function Gb(e){var t=Rv(e,Vb),{viewBox:n,position:r,value:a,children:o,content:i,className:s="",textBreakAll:c,labelRef:l}=t,u=Bb(),d=Lb(),h=n||("center"===r?d:null!==u&&void 0!==u?u:d);if(!h||at(a)&&at(o)&&!(0,N.isValidElement)(i)&&"function"!==typeof i)return null;var p,f=Rb(Rb({},t),{},{viewBox:h});if((0,N.isValidElement)(i)){var{labelRef:m}=f,g=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(f,Ab);return(0,N.cloneElement)(i,g)}if("function"===typeof i){if(p=(0,N.createElement)(i,f),(0,N.isValidElement)(p))return p}else p=(e=>{var{value:t,formatter:n}=e,r=at(e.children)?t:e.children;return"function"===typeof n?n(r):r})(t);var y=Ub(h),v=Yy(t,!0);if(y&&("insideStart"===r||"insideEnd"===r||"end"===r))return Wb(t,r,p,v,h);var b=y?((e,t,n)=>{var{cx:r,cy:a,innerRadius:o,outerRadius:i,startAngle:s,endAngle:c}=e,l=(s+c)/2;if("outside"===n){var{x:u,y:d}=yo(r,a,i+t,l);return{x:u,y:d,textAnchor:u>=r?"start":"end",verticalAnchor:"middle"}}if("center"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===n)return{x:r,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(o+i)/2,{x:p,y:f}=yo(r,a,h,l);return{x:p,y:f,textAnchor:"middle",verticalAnchor:"middle"}})(h,t.offset,t.position):((e,t)=>{var n,{parentViewBox:r,offset:a,position:o}=e;null==r||Ub(r)||(n=r);var{x:i,y:s,width:c,height:l}=t,u=l>=0?1:-1,d=u*a,h=u>0?"end":"start",p=u>0?"start":"end",f=c>=0?1:-1,m=f*a,g=f>0?"end":"start",y=f>0?"start":"end";if("top"===o)return Rb(Rb({},{x:i+c/2,y:s-u*a,textAnchor:"middle",verticalAnchor:h}),n?{height:Math.max(s-n.y,0),width:c}:{});if("bottom"===o)return Rb(Rb({},{x:i+c/2,y:s+l+d,textAnchor:"middle",verticalAnchor:p}),n?{height:Math.max(n.y+n.height-(s+l),0),width:c}:{});if("left"===o){var v={x:i-m,y:s+l/2,textAnchor:g,verticalAnchor:"middle"};return Rb(Rb({},v),n?{width:Math.max(v.x-n.x,0),height:l}:{})}if("right"===o){var b={x:i+c+m,y:s+l/2,textAnchor:y,verticalAnchor:"middle"};return Rb(Rb({},b),n?{width:Math.max(n.x+n.width-b.x,0),height:l}:{})}var x=n?{width:c,height:l}:{};return"insideLeft"===o?Rb({x:i+m,y:s+l/2,textAnchor:y,verticalAnchor:"middle"},x):"insideRight"===o?Rb({x:i+c-m,y:s+l/2,textAnchor:g,verticalAnchor:"middle"},x):"insideTop"===o?Rb({x:i+c/2,y:s+d,textAnchor:"middle",verticalAnchor:p},x):"insideBottom"===o?Rb({x:i+c/2,y:s+l-d,textAnchor:"middle",verticalAnchor:h},x):"insideTopLeft"===o?Rb({x:i+m,y:s+d,textAnchor:y,verticalAnchor:p},x):"insideTopRight"===o?Rb({x:i+c-m,y:s+d,textAnchor:g,verticalAnchor:p},x):"insideBottomLeft"===o?Rb({x:i+m,y:s+l-d,textAnchor:y,verticalAnchor:h},x):"insideBottomRight"===o?Rb({x:i+c-m,y:s+l-d,textAnchor:g,verticalAnchor:h},x):o&&"object"===typeof o&&(Ye(o.x)||Xe(o.x))&&(Ye(o.y)||Xe(o.y))?Rb({x:i+Je(o.x,c),y:s+Je(o.y,l),textAnchor:"end",verticalAnchor:"end"},x):Rb({x:i+c/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},x)})(t,h);return N.createElement(Ob,Db({ref:l,className:We("recharts-label",s)},v,b,{breakAll:c}),p)}Gb.displayName="Label";var Hb=(e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return!0===e?N.createElement(Gb,Db({key:"label-implicit"},r)):Qe(e)?N.createElement(Gb,Db({key:"label-implicit",value:e},r)):(0,N.isValidElement)(e)?e.type===Gb?(0,N.cloneElement)(e,Rb({key:"label-implicit"},r)):N.createElement(Gb,Db({key:"label-implicit",content:e},r)):jb(e)?N.createElement(Gb,Db({key:"label-implicit",content:e},r)):e&&"object"===typeof e?N.createElement(Gb,Db({},e,{key:"label-implicit"},r)):null};function Kb(e){var{label:t}=e,n=Lb();return Hb(t,n)||null}var qb=["axisLine","width","height","className","hide","ticks"],Xb=["viewBox"],Yb=["viewBox"];function Qb(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Zb(){return Zb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zb.apply(null,arguments)}function $b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$b(Object(n),!0).forEach(function(t){ex(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ex(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tx={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function nx(e){var{x:t,y:n,width:r,height:a,orientation:o,mirror:i,axisLine:s,otherSvgProps:c}=e;if(!s)return null;var l=Jb(Jb(Jb({},c),Yy(s,!1)),{},{fill:"none"});if("top"===o||"bottom"===o){var u=+("top"===o&&!i||"bottom"===o&&i);l=Jb(Jb({},l),{},{x1:t,y1:n+u*a,x2:t+r,y2:n+u*a})}else{var d=+("left"===o&&!i||"right"===o&&i);l=Jb(Jb({},l),{},{x1:t+d*r,y1:n,x2:t+d*r,y2:n+a})}return N.createElement("line",Zb({},l,{className:We("recharts-cartesian-axis-line",He()(s,"className"))}))}function rx(e){var t,{option:n,tickProps:r,value:a}=e,o=We(r.className,"recharts-cartesian-axis-tick-value");if(N.isValidElement(n))t=N.cloneElement(n,Jb(Jb({},r),{},{className:o}));else if("function"===typeof n)t=n(Jb(Jb({},r),{},{className:o}));else{var i="recharts-cartesian-axis-tick-value";"boolean"!==typeof n&&(i=We(i,null===n||void 0===n?void 0:n.className)),t=N.createElement(Ob,Zb({},r,{className:i}),a)}return t}function ax(e){var{ticks:t=[],tick:n,tickLine:r,stroke:a,tickFormatter:o,unit:i,padding:s,tickTextProps:c,orientation:l,mirror:u,x:d,y:h,width:p,height:f,tickSize:m,tickMargin:g,fontSize:y,letterSpacing:v,getTicksConfig:b,events:x}=e,w=rb(Jb(Jb({},b),{},{ticks:t}),y,v),k=function(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}(l,u),S=function(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}(l,u),C=Uy(b),I=Yy(n,!1),E=Jb(Jb({},C),{},{fill:"none"},Yy(r,!1)),T=w.map((e,t)=>{var{line:y,tick:v}=function(e,t,n,r,a,o,i,s,c){var l,u,d,h,p,f,m=s?-1:1,g=e.tickSize||i,y=Ye(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":l=u=e.coordinate,f=(d=(h=n+ +!s*a)-m*g)-m*c,p=y;break;case"left":d=h=e.coordinate,p=(l=(u=t+ +!s*r)-m*g)-m*c,f=y;break;case"right":d=h=e.coordinate,p=(l=(u=t+ +s*r)+m*g)+m*c,f=y;break;default:l=u=e.coordinate,f=(d=(h=n+ +s*a)+m*g)+m*c,p=y}return{line:{x1:l,y1:d,x2:u,y2:h},tick:{x:p,y:f}}}(e,d,h,p,f,l,m,u,g),b=Jb(Jb(Jb(Jb({textAnchor:k,verticalAnchor:S},C),{},{stroke:"none",fill:a},I),v),{},{index:t,payload:e,visibleTicksCount:w.length,tickFormatter:o,padding:s},c);return N.createElement(sb,Zb({className:"recharts-cartesian-axis-tick",key:"tick-".concat(e.value,"-").concat(e.coordinate,"-").concat(e.tickCoord)},By(x,e,t)),r&&N.createElement("line",Zb({},E,y,{className:We("recharts-cartesian-axis-tick-line",He()(r,"className"))})),n&&N.createElement(rx,{option:n,tickProps:b,value:"".concat("function"===typeof o?o(e.value,t):e.value).concat(i||"")}))});return T.length>0?N.createElement("g",{className:"recharts-cartesian-axis-ticks"},T):null}var ox=(0,N.forwardRef)((e,t)=>{var{axisLine:n,width:r,height:a,className:o,hide:i,ticks:s}=e,c=Qb(e,qb),[l,u]=(0,N.useState)(""),[d,h]=(0,N.useState)(""),p=(0,N.useRef)([]);(0,N.useImperativeHandle)(t,()=>({getCalculatedWidth:()=>{var t;return(e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:a=0,tickMargin:o=0}=e,i=0;if(t){t.forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>i&&(i=t.width)}});var s=n?n.getBoundingClientRect().width:0,c=i+(a+o)+s+(n?r:0);return Math.round(c)}return 0})({ticks:p.current,label:null===(t=e.labelRef)||void 0===t?void 0:t.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var f=(0,N.useCallback)(e=>{if(e){var t=e.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(t);var n=t[0];if(n){var r=window.getComputedStyle(n),a=r.fontSize,o=r.letterSpacing;a===l&&o===d||(u(a),h(o))}}},[l,d]);return i||null!=r&&r<=0||null!=a&&a<=0?null:N.createElement(sb,{className:We("recharts-cartesian-axis",o),ref:f},N.createElement(nx,{x:e.x,y:e.y,width:r,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:Uy(e)}),N.createElement(ax,{ticks:s,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:l,letterSpacing:d,getTicksConfig:e,events:c}),N.createElement(Fb,{x:e.x,y:e.y,width:e.width,height:e.height},N.createElement(Kb,{label:e.label}),e.children))}),ix=N.memo(ox,(e,t)=>{var{viewBox:n}=e,r=Qb(e,Xb),{viewBox:a}=t,o=Qb(t,Yb);return ab(n,a)&&ab(r,o)}),sx=N.forwardRef((e,t)=>{var n=Rv(e,tx);return N.createElement(ix,Zb({},n,{ref:t}))});sx.displayName="CartesianAxis";var cx=["x1","y1","x2","y2","key"],lx=["offset"],ux=["xAxisId","yAxisId"],dx=["xAxisId","yAxisId"];function hx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function px(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hx(Object(n),!0).forEach(function(t){fx(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fx(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mx.apply(null,arguments)}function gx(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var yx=e=>{var{fill:t}=e;if(!t||"none"===t)return null;var{fillOpacity:n,x:r,y:a,width:o,height:i,ry:s}=e;return N.createElement("rect",{x:r,y:a,ry:s,width:o,height:i,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function vx(e,t){var n;if(N.isValidElement(e))n=N.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var{x1:r,y1:a,x2:o,y2:i,key:s}=t,c=Uy(gx(t,cx)),{offset:l}=c,u=gx(c,lx);n=N.createElement("line",mx({},u,{x1:r,y1:a,x2:o,y2:i,fill:"none",key:s}))}return n}function bx(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:a}=e;if(!r||!a||!a.length)return null;var{xAxisId:o,yAxisId:i}=e,s=gx(e,ux),c=a.map((e,a)=>{var o=px(px({},s),{},{x1:t,y1:e,x2:t+n,y2:e,key:"line-".concat(a),index:a});return vx(r,o)});return N.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function xx(e){var{y:t,height:n,vertical:r=!0,verticalPoints:a}=e;if(!r||!a||!a.length)return null;var{xAxisId:o,yAxisId:i}=e,s=gx(e,dx),c=a.map((e,a)=>{var o=px(px({},s),{},{x1:e,y1:t,x2:e,y2:t+n,key:"line-".concat(a),index:a});return vx(r,o)});return N.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function wx(e){var{horizontalFill:t,fillOpacity:n,x:r,y:a,width:o,height:i,horizontalPoints:s,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var l=s.map(e=>Math.round(e+a-a)).sort((e,t)=>e-t);a!==l[0]&&l.unshift(0);var u=l.map((e,s)=>{var c=!l[s+1]?a+i-e:l[s+1]-e;if(c<=0)return null;var u=s%t.length;return N.createElement("rect",{key:"react-".concat(s),y:e,x:r,height:c,width:o,stroke:"none",fill:t[u],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function kx(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:a,y:o,width:i,height:s,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var l=c.map(e=>Math.round(e+a-a)).sort((e,t)=>e-t);a!==l[0]&&l.unshift(0);var u=l.map((e,t)=>{var c=!l[t+1]?a+i-e:l[t+1]-e;if(c<=0)return null;var u=t%n.length;return N.createElement("rect",{key:"react-".concat(t),x:e,y:o,width:c,height:s,stroke:"none",fill:n[u],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var Sx=(e,t)=>{var{xAxis:n,width:r,height:a,offset:o}=e;return No(rb(px(px(px({},tx),n),{},{ticks:Oo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.left,o.left+o.width,t)},Cx=(e,t)=>{var{yAxis:n,width:r,height:a,offset:o}=e;return No(rb(px(px(px({},tx),n),{},{ticks:Oo(n,!0),viewBox:{x:0,y:0,width:r,height:a}})),o.top,o.top+o.height,t)},Ix={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Ex(e){var t=di(),n=hi(),r=ui(),a=px(px({},Rv(e,Ix)),{},{x:Ye(e.x)?e.x:r.left,y:Ye(e.y)?e.y:r.top,width:Ye(e.width)?e.width:r.width,height:Ye(e.height)?e.height:r.height}),{xAxisId:o,yAxisId:i,x:s,y:c,width:l,height:u,syncWithTicks:d,horizontalValues:h,verticalValues:p}=a,f=oi(),m=to(e=>Rf(e,"xAxis",o,f)),g=to(e=>Rf(e,"yAxis",i,f));if(!Ye(l)||l<=0||!Ye(u)||u<=0||!Ye(s)||s!==+s||!Ye(c)||c!==+c)return null;var y=a.verticalCoordinatesGenerator||Sx,v=a.horizontalCoordinatesGenerator||Cx,{horizontalPoints:b,verticalPoints:x}=a;if((!b||!b.length)&&"function"===typeof v){var w=h&&h.length,k=v({yAxis:g?px(px({},g),{},{ticks:w?h:g.ticks}):void 0,width:t,height:n,offset:r},!!w||d);it(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(b=k)}if((!x||!x.length)&&"function"===typeof y){var S=p&&p.length,C=y({xAxis:m?px(px({},m),{},{ticks:S?p:m.ticks}):void 0,width:t,height:n,offset:r},!!S||d);it(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(x=C)}return N.createElement("g",{className:"recharts-cartesian-grid"},N.createElement(yx,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),N.createElement(wx,mx({},a,{horizontalPoints:b})),N.createElement(kx,mx({},a,{verticalPoints:x})),N.createElement(bx,mx({},a,{offset:r,horizontalPoints:b,xAxis:m,yAxis:g})),N.createElement(xx,mx({},a,{offset:r,verticalPoints:x,xAxis:m,yAxis:g})))}Ex.displayName="CartesianGrid";var Tx=["dangerouslySetInnerHTML","ticks"],Nx=["id"],Ox=["domain"],Ax=["domain"];function _x(){return _x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_x.apply(null,arguments)}function Rx(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Px(e){var t=Za();return(0,N.useEffect)(()=>(t(bg(e)),()=>{t(xg(e))}),[e,t]),null}var Dx=e=>{var{xAxisId:t,className:n}=e,r=to(ri),a=oi(),o="xAxis",i=to(e=>ff(e,o,t,a)),s=to(e=>Df(e,o,t,a)),c=to(e=>wf(e,t)),l=to(e=>Cf(e,t)),u=to(e=>Kh(e,t));if(null==c||null==l||null==u)return null;var{dangerouslySetInnerHTML:d,ticks:h}=e,p=Rx(e,Tx),{id:f}=u,m=Rx(u,Nx);return N.createElement(sx,_x({},p,m,{scale:i,x:l.x,y:l.y,width:c.width,height:c.height,className:We("recharts-".concat(o," ").concat(o),n),viewBox:r,ticks:s}))},Mx={allowDataOverflow:Hh.allowDataOverflow,allowDecimals:Hh.allowDecimals,allowDuplicatedCategory:Hh.allowDuplicatedCategory,height:Hh.height,hide:!1,mirror:Hh.mirror,orientation:Hh.orientation,padding:Hh.padding,reversed:Hh.reversed,scale:Hh.scale,tickCount:Hh.tickCount,type:Hh.type,xAxisId:0},Fx=e=>{var t,n,r,a,o,i=Rv(e,Mx);return N.createElement(N.Fragment,null,N.createElement(Px,{interval:null!==(t=i.interval)&&void 0!==t?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:null!==(n=i.includeHidden)&&void 0!==n&&n,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:null!==(r=i.angle)&&void 0!==r?r:0,minTickGap:null!==(a=i.minTickGap)&&void 0!==a?a:5,tick:null===(o=i.tick)||void 0===o||o,tickFormatter:i.tickFormatter}),N.createElement(Dx,i))},Lx=(e,t)=>{var{domain:n}=e,r=Rx(e,Ox),{domain:a}=t;return!!ab(r,Rx(t,Ax))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:ab({domain:n},{domain:a}))},zx=N.memo(Fx,Lx);zx.displayName="XAxis";var Bx=["dangerouslySetInnerHTML","ticks"],jx=["id"],Wx=["domain"],Ux=["domain"];function Vx(){return Vx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vx.apply(null,arguments)}function Gx(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Hx(e){var t=Za();return(0,N.useEffect)(()=>(t(wg(e)),()=>{t(kg(e))}),[e,t]),null}var Kx=e=>{var{yAxisId:t,className:n,width:r,label:a}=e,o=(0,N.useRef)(null),i=(0,N.useRef)(null),s=to(ri),c=oi(),l=Za(),u="yAxis",d=to(e=>ff(e,u,t,c)),h=to(e=>Ef(e,t)),p=to(e=>If(e,t)),f=to(e=>Df(e,u,t,c)),m=to(e=>Yh(e,t));if((0,N.useLayoutEffect)(()=>{if("auto"===r&&h&&!jb(a)&&!(0,N.isValidElement)(a)&&null!=m){var e=o.current;if(e){var n=e.getCalculatedWidth();Math.round(h.width)!==Math.round(n)&&l(Ig({id:t,width:n}))}}},[f,h,l,a,t,r,m]),null==h||null==p||null==m)return null;var{dangerouslySetInnerHTML:g,ticks:y}=e,v=Gx(e,Bx),{id:b}=m,x=Gx(m,jx);return N.createElement(sx,Vx({},v,x,{ref:o,labelRef:i,scale:d,x:p.x,y:p.y,tickTextProps:"auto"===r?{width:void 0}:{width:r},width:h.width,height:h.height,className:We("recharts-".concat(u," ").concat(u),n),viewBox:s,ticks:f}))},qx={allowDataOverflow:Xh.allowDataOverflow,allowDecimals:Xh.allowDecimals,allowDuplicatedCategory:Xh.allowDuplicatedCategory,hide:!1,mirror:Xh.mirror,orientation:Xh.orientation,padding:Xh.padding,reversed:Xh.reversed,scale:Xh.scale,tickCount:Xh.tickCount,type:Xh.type,width:Xh.width,yAxisId:0},Xx=e=>{var t,n,r,a,o,i=Rv(e,qx);return N.createElement(N.Fragment,null,N.createElement(Hx,{interval:null!==(t=i.interval)&&void 0!==t?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:null!==(n=i.includeHidden)&&void 0!==n&&n,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:null!==(r=i.angle)&&void 0!==r?r:0,minTickGap:null!==(a=i.minTickGap)&&void 0!==a?a:5,tick:null===(o=i.tick)||void 0===o||o,tickFormatter:i.tickFormatter}),N.createElement(Kx,i))},Yx=(e,t)=>{var{domain:n}=e,r=Gx(e,Wx),{domain:a}=t;return!!ab(r,Gx(t,Ux))&&(Array.isArray(n)&&2===n.length&&Array.isArray(a)&&2===a.length?n[0]===a[0]&&n[1]===a[1]:ab({domain:n},{domain:a}))},Qx=N.memo(Xx,Yx);Qx.displayName="YAxis";var Zx=n(7950);function $x(){return $x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$x.apply(null,arguments)}function Jx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ew(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jx(Object(n),!0).forEach(function(t){tw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function tw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nw(e){return Array.isArray(e)&&Qe(e[0])&&Qe(e[1])?e.join(" ~ "):e}var rw=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:r={},labelStyle:a={},payload:o,formatter:i,itemSorter:s,wrapperClassName:c,labelClassName:l,label:u,labelFormatter:d,accessibilityLayer:h=!1}=e,p=ew({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),f=ew({margin:0},a),m=!at(u),g=m?u:"",y=We("recharts-default-tooltip",c),v=We("recharts-tooltip-label",l);m&&d&&void 0!==o&&null!==o&&(g=d(u,o));var b=h?{role:"status","aria-live":"assertive"}:{};return N.createElement("div",$x({className:y,style:p},b),N.createElement("p",{className:v,style:f},N.isValidElement(g)?g:"".concat(g)),(()=>{if(o&&o.length){var e=(s?ro()(o,s):o).map((e,n)=>{if("none"===e.type)return null;var a=e.formatter||i||nw,{value:s,name:c}=e,l=s,u=c;if(a){var d=a(s,c,e,n,o);if(Array.isArray(d))[l,u]=d;else{if(null==d)return null;l=d}}var h=ew({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},r);return N.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(n),style:h},Qe(u)?N.createElement("span",{className:"recharts-tooltip-item-name"},u):null,Qe(u)?N.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,N.createElement("span",{className:"recharts-tooltip-item-value"},l),N.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return N.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},aw="recharts-tooltip-wrapper",ow={visibility:"hidden"};function iw(e){var{coordinate:t,translateX:n,translateY:r}=e;return We(aw,{["".concat(aw,"-right")]:Ye(n)&&t&&Ye(t.x)&&n>=t.x,["".concat(aw,"-left")]:Ye(n)&&t&&Ye(t.x)&&n<t.x,["".concat(aw,"-bottom")]:Ye(r)&&t&&Ye(t.y)&&r>=t.y,["".concat(aw,"-top")]:Ye(r)&&t&&Ye(t.y)&&r<t.y})}function sw(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:a,position:o,reverseDirection:i,tooltipDimension:s,viewBox:c,viewBoxDimension:l}=e;if(o&&Ye(o[r]))return o[r];var u=n[r]-s-(a>0?a:0),d=n[r]+a;if(t[r])return i[r]?u:d;var h=c[r];return null==h?0:i[r]?u<h?Math.max(d,h):Math.max(u,h):null==l?0:d+s>h+l?Math.max(u,h):Math.max(d,h)}function cw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cw(Object(n),!0).forEach(function(t){uw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cw(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function uw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dw extends N.PureComponent{constructor(){super(...arguments),uw(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),uw(this,"handleKeyDown",e=>{var t,n,r,a;"Escape"===e.key&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!==(t=null===(n=this.props.coordinate)||void 0===n?void 0:n.x)&&void 0!==t?t:0,y:null!==(r=null===(a=this.props.coordinate)||void 0===a?void 0:a.y)&&void 0!==r?r:0}})})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null===(e=this.props.coordinate)||void 0===e?void 0:e.x)===this.state.dismissedAtCoordinate.x&&(null===(t=this.props.coordinate)||void 0===t?void 0:t.y)===this.state.dismissedAtCoordinate.y||(this.state.dismissed=!1))}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:r,children:a,coordinate:o,hasPayload:i,isAnimationActive:s,offset:c,position:l,reverseDirection:u,useTranslate3d:d,viewBox:h,wrapperStyle:p,lastBoundingBox:f,innerRef:m,hasPortalFromProps:g}=this.props,{cssClasses:y,cssProperties:v}=function(e){var t,n,r,{allowEscapeViewBox:a,coordinate:o,offsetTopLeft:i,position:s,reverseDirection:c,tooltipBox:l,useTranslate3d:u,viewBox:d}=e;return t=l.height>0&&l.width>0&&o?function(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}({translateX:n=sw({allowEscapeViewBox:a,coordinate:o,key:"x",offsetTopLeft:i,position:s,reverseDirection:c,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),translateY:r=sw({allowEscapeViewBox:a,coordinate:o,key:"y",offsetTopLeft:i,position:s,reverseDirection:c,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),useTranslate3d:u}):ow,{cssProperties:t,cssClasses:iw({translateX:n,translateY:r,coordinate:o})}}({allowEscapeViewBox:t,coordinate:o,offsetTopLeft:c,position:l,reverseDirection:u,tooltipBox:{height:f.height,width:f.width},useTranslate3d:d,viewBox:h}),b=g?{}:lw(lw({transition:s&&e?"transform ".concat(n,"ms ").concat(r):void 0},v),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&i?"visible":"hidden",position:"absolute",top:0,left:0}),x=lw(lw({},b),{},{visibility:!this.state.dismissed&&e&&i?"visible":"hidden"},p);return N.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:x,ref:m},a)}}var hw=n(4332),pw=n.n(hw);var fw,mw,gw,yw,vw,bw,xw,ww,kw,Sw,Cw,Iw,Ew,Tw;function Nw(){}function Ow(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Aw(e){this._context=e}function _w(e){this._context=e}function Rw(e){this._context=e}Aw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ow(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ow(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},_w.prototype={areaStart:Nw,areaEnd:Nw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ow(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Rw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ow(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class Pw{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function Dw(e){this._context=e}function Mw(e){this._context=e}function Fw(e){return new Mw(e)}function Lw(e){return e<0?-1:1}function zw(e,t,n){var r=e._x1-e._x0,a=t-e._x1,o=(e._y1-e._y0)/(r||a<0&&-0),i=(n-e._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(Lw(o)+Lw(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function Bw(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function jw(e,t,n){var r=e._x0,a=e._y0,o=e._x1,i=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,a+s*t,o-s,i-s*n,o,i)}function Ww(e){this._context=e}function Uw(e){this._context=new Vw(e)}function Vw(e){this._context=e}function Gw(e){this._context=e}function Hw(e){var t,n,r=e.length-1,a=new Array(r),o=new Array(r),i=new Array(r);for(a[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,o[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/o[t-1],o[t]-=n,i[t]-=n*i[t-1];for(a[r-1]=i[r-1]/o[r-1],t=r-2;t>=0;--t)a[t]=(i[t]-a[t+1])/o[t];for(o[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-a[t+1];return[a,o]}function Kw(e,t){this._context=e,this._t=t}function qw(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Dw.prototype={areaStart:Nw,areaEnd:Nw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Mw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Ww.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jw(this,this._t0,Bw(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,jw(this,Bw(this,n=zw(this,e,t)),n);break;default:jw(this,this._t0,n=zw(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Uw.prototype=Object.create(Ww.prototype)).point=function(e,t){Ww.prototype.point.call(this,t,e)},Vw.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,o){this._context.bezierCurveTo(t,e,r,n,o,a)}},Gw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Hw(e),a=Hw(t),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],e[i],t[i]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Kw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const Xw=Math.PI,Yw=2*Xw,Qw=1e-6,Zw=Yw-Qw;function $w(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class Jw{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?$w:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return $w;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(fw||(fw=qw(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(mw||(mw=qw(["Z"]))))}lineTo(e,t){this._append(gw||(gw=qw(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(yw||(yw=qw(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,a,o){this._append(vw||(vw=qw(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+o)}arcTo(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));let o=this._x1,i=this._y1,s=n-e,c=r-t,l=o-e,u=i-t,d=l*l+u*u;if(null===this._x1)this._append(bw||(bw=qw(["M",",",""])),this._x1=e,this._y1=t);else if(d>Qw)if(Math.abs(u*s-c*l)>Qw&&a){let h=n-o,p=r-i,f=s*s+c*c,m=h*h+p*p,g=Math.sqrt(f),y=Math.sqrt(d),v=a*Math.tan((Xw-Math.acos((f+d-m)/(2*g*y)))/2),b=v/y,x=v/g;Math.abs(b-1)>Qw&&this._append(ww||(ww=qw(["L",",",""])),e+b*l,t+b*u),this._append(kw||(kw=qw(["A",",",",0,0,",",",",",""])),a,a,+(u*h>l*p),this._x1=e+x*s,this._y1=t+x*c)}else this._append(xw||(xw=qw(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,a,o){if(e=+e,t=+t,o=!!o,(n=+n)<0)throw new Error("negative radius: ".concat(n));let i=n*Math.cos(r),s=n*Math.sin(r),c=e+i,l=t+s,u=1^o,d=o?r-a:a-r;null===this._x1?this._append(Sw||(Sw=qw(["M",",",""])),c,l):(Math.abs(this._x1-c)>Qw||Math.abs(this._y1-l)>Qw)&&this._append(Cw||(Cw=qw(["L",",",""])),c,l),n&&(d<0&&(d=d%Yw+Yw),d>Zw?this._append(Iw||(Iw=qw(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-i,t-s,n,n,u,this._x1=c,this._y1=l):d>Qw&&this._append(Ew||(Ew=qw(["A",",",",0,",",",",",",",""])),n,n,+(d>=Xw),u,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}rect(e,t,n,r){this._append(Tw||(Tw=qw(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function ek(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new Jw(t)}function tk(e){return e[0]}function nk(e){return e[1]}function rk(e,t){var n=so(!0),r=null,a=Fw,o=null,i=ek(s);function s(s){var c,l,u,d=(s=io(s)).length,h=!1;for(null==r&&(o=a(u=i())),c=0;c<=d;++c)!(c<d&&n(l=s[c],c,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(l,c,s),+t(l,c,s));if(u)return o=null,u+""||null}return e="function"===typeof e?e:void 0===e?tk:so(e),t="function"===typeof t?t:void 0===t?nk:so(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:so(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:so(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:so(!!e),s):n},s.curve=function(e){return arguments.length?(a=e,null!=r&&(o=a(r)),s):a},s.context=function(e){return arguments.length?(null==e?r=o=null:o=a(r=e),s):r},s}function ak(e,t,n){var r=null,a=so(!0),o=null,i=Fw,s=null,c=ek(l);function l(l){var u,d,h,p,f,m=(l=io(l)).length,g=!1,y=new Array(m),v=new Array(m);for(null==o&&(s=i(f=c())),u=0;u<=m;++u){if(!(u<m&&a(p=l[u],u,l))===g)if(g=!g)d=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=d;--h)s.point(y[h],v[h]);s.lineEnd(),s.areaEnd()}g&&(y[u]=+e(p,u,l),v[u]=+t(p,u,l),s.point(r?+r(p,u,l):y[u],n?+n(p,u,l):v[u]))}if(f)return s=null,f+""||null}function u(){return rk().defined(a).curve(i).context(o)}return e="function"===typeof e?e:void 0===e?tk:so(+e),t="function"===typeof t?t:so(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?nk:so(+n),l.x=function(t){return arguments.length?(e="function"===typeof t?t:so(+t),r=null,l):e},l.x0=function(t){return arguments.length?(e="function"===typeof t?t:so(+t),l):e},l.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:so(+e),l):r},l.y=function(e){return arguments.length?(t="function"===typeof e?e:so(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t="function"===typeof e?e:so(+e),l):t},l.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:so(+e),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(e){return arguments.length?(a="function"===typeof e?e:so(!!e),l):a},l.curve=function(e){return arguments.length?(i=e,null!=o&&(s=i(o)),l):i},l.context=function(e){return arguments.length?(null==e?o=s=null:s=i(o=e),l):o},l}function ok(){return ok=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ok.apply(null,arguments)}function ik(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function sk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ik(Object(n),!0).forEach(function(t){ck(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ik(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ck(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lk={curveBasisClosed:function(e){return new _w(e)},curveBasisOpen:function(e){return new Rw(e)},curveBasis:function(e){return new Aw(e)},curveBumpX:function(e){return new Pw(e,!0)},curveBumpY:function(e){return new Pw(e,!1)},curveLinearClosed:function(e){return new Dw(e)},curveLinear:Fw,curveMonotoneX:function(e){return new Ww(e)},curveMonotoneY:function(e){return new Uw(e)},curveNatural:function(e){return new Gw(e)},curveStep:function(e){return new Kw(e,.5)},curveStepAfter:function(e){return new Kw(e,1)},curveStepBefore:function(e){return new Kw(e,0)}},uk=e=>Nd(e.x)&&Nd(e.y),dk=e=>e.x,hk=e=>e.y,pk=e=>{var t,{type:n="linear",points:r=[],baseLine:a,layout:o,connectNulls:i=!1}=e,s=((e,t)=>{if("function"===typeof e)return e;var n="curve".concat(ot(e));return"curveMonotone"!==n&&"curveBump"!==n||!t?lk[n]||Fw:lk["".concat(n).concat("vertical"===t?"Y":"X")]})(n,o),c=i?r.filter(uk):r;if(Array.isArray(a)){var l=i?a.filter(e=>uk(e)):a,u=c.map((e,t)=>sk(sk({},e),{},{base:l[t]}));return(t="vertical"===o?ak().y(hk).x1(dk).x0(e=>e.base.x):ak().x(dk).y1(hk).y0(e=>e.base.y)).defined(uk).curve(s),t(u)}return(t="vertical"===o&&Ye(a)?ak().y(hk).x1(dk).x0(a):Ye(a)?ak().x(dk).y1(hk).y0(a):rk().x(dk).y(hk)).defined(uk).curve(s),t(c)},fk=e=>{var{className:t,points:n,path:r,pathRef:a}=e;if((!n||!n.length)&&!r)return null;var o=n&&n.length?pk(e):r;return N.createElement("path",ok({},Uy(e),zy(e),{className:We("recharts-curve",t),d:null===o?void 0:o,ref:a}))},mk=["x","y","top","left","width","height","className"];function gk(){return gk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gk.apply(null,arguments)}function yk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bk=(e,t,n,r,a,o)=>"M".concat(e,",").concat(a,"v").concat(r,"M").concat(o,",").concat(t,"h").concat(n),xk=e=>{var{x:t=0,y:n=0,top:r=0,left:a=0,width:o=0,height:i=0,className:s}=e,c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,mk),l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yk(Object(n),!0).forEach(function(t){vk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({x:t,y:n,top:r,left:a,width:o,height:i},c);return Ye(t)&&Ye(n)&&Ye(o)&&Ye(i)&&Ye(r)&&Ye(a)?N.createElement("path",gk({},Yy(l,!0),{className:We("recharts-cross",s),d:bk(t,n,o,i,r,a)})):null};function wk(){}function kk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kk(Object(n),!0).forEach(function(t){Ck(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ck(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ik=(e,t,n)=>e.map(e=>{return"".concat((r=e,r.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())))," ").concat(t,"ms ").concat(n);var r}).join(","),Ek=(e,t)=>Object.keys(t).reduce((n,r)=>Sk(Sk({},n),{},{[r]:e(r,t[r])}),{});function Tk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tk(Object(n),!0).forEach(function(t){Ok(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ok(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ak=(e,t,n)=>e+(t-e)*n,_k=e=>{var{from:t,to:n}=e;return t!==n},Rk=(e,t,n)=>{var r=Ek((t,n)=>{if(_k(n)){var[r,a]=e(n.from,n.to,n.velocity);return Nk(Nk({},n),{},{from:r,velocity:a})}return n},t);return n<1?Ek((e,t)=>_k(t)?Nk(Nk({},t),{},{velocity:Ak(t.velocity,r[e].velocity,n),from:Ak(t.from,r[e].from,n)}):t,t):Rk(e,r,n-1)};function Pk(e,t,n,r,a,o){var i,s=r.reduce((n,r)=>Nk(Nk({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),c=null,l=r=>{i||(i=r);var u=(r-i)/n.dt;s=Rk(n,s,u),a(Nk(Nk(Nk({},e),t),Ek((e,t)=>t.from,s))),i=r,Object.values(s).filter(_k).length&&(c=o.setTimeout(l))};return()=>(c=o.setTimeout(l),()=>{c()})}const Dk=(e,t,n,r,a,o)=>{var i,s,c=(i=e,s=t,[Object.keys(i),Object.keys(s)].reduce((e,t)=>e.filter(e=>t.includes(e))));return!0===n.isStepper?Pk(e,t,n,c,a,o):function(e,t,n,r,a,o,i){var s,c=null,l=a.reduce((n,r)=>Nk(Nk({},n),{},{[r]:[e[r],t[r]]}),{}),u=a=>{s||(s=a);var d=(a-s)/r,h=Ek((e,t)=>Ak(...t,n(d)),l);if(o(Nk(Nk(Nk({},e),t),h)),d<1)c=i.setTimeout(u);else{var p=Ek((e,t)=>Ak(...t,n(1)),l);o(Nk(Nk(Nk({},e),t),p))}};return()=>(c=i.setTimeout(u),()=>{c()})}(e,t,n,r,c,a,o)};var Mk=1e-4,Fk=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Lk=(e,t)=>e.map((e,n)=>e*t**n).reduce((e,t)=>e+t),zk=(e,t)=>n=>{var r=Fk(e,t);return Lk(r,n)},Bk=function(){for(var e,t,n,r,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];if(1===o.length)switch(o[0]){case"linear":[e,n,t,r]=[0,0,1,1];break;case"ease":[e,n,t,r]=[.25,.1,.25,1];break;case"ease-in":[e,n,t,r]=[.42,0,1,1];break;case"ease-out":[e,n,t,r]=[.42,0,.58,1];break;case"ease-in-out":[e,n,t,r]=[0,0,.58,1];break;default:var s=o[0].split("(");"cubic-bezier"===s[0]&&4===s[1].split(")")[0].split(",").length&&([e,n,t,r]=s[1].split(")")[0].split(",").map(e=>parseFloat(e)))}else 4===o.length&&([e,n,t,r]=o);var c,l,u=zk(e,t),d=zk(n,r),h=(c=e,l=t,e=>{var t=[...Fk(c,l).map((e,t)=>e*t).slice(1),0];return Lk(t,e)}),p=e=>e>1?1:e<0?0:e,f=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var a=u(n)-t,o=h(n);if(Math.abs(a-t)<Mk||o<Mk)return d(n);n=p(n-a/o)}return d(n)};return f.isStepper=!1,f},jk=e=>{if("string"===typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Bk(e);case"spring":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:n=8,dt:r=17}=e,a=(e,a,o)=>{var i=o+(-(e-a)*t-o*n)*r/1e3,s=o*r/1e3+e;return Math.abs(s-a)<Mk&&Math.abs(i)<Mk?[a,0]:[s,i]};return a.isStepper=!0,a.dt=r,a}();default:if("cubic-bezier"===e.split("(")[0])return Bk(e)}return"function"===typeof e?e:null};class Wk{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=performance.now(),r=null,a=o=>{o-n>=t?e(o):"function"===typeof requestAnimationFrame&&(r=requestAnimationFrame(a))};return r=requestAnimationFrame(a),()=>{cancelAnimationFrame(r)}}}function Uk(){return function(e){var t=()=>null,n=!1,r=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var i=o,[s,...c]=i;return"number"===typeof s?void(r=e.setTimeout(a.bind(null,c),s)):(a(s),void(r=e.setTimeout(a.bind(null,c))))}"string"===typeof o&&t(o),"object"===typeof o&&t(o),"function"===typeof o&&o()}};return{stop:()=>{n=!0},start:e=>{n=!1,r&&(r(),r=null),a(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e}}(new Wk)}var Vk=(0,N.createContext)(Uk);var Gk={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Hk={t:0},Kk={t:1};function qk(e){var t=Rv(e,Gk),{isActive:n,canBegin:r,duration:a,easing:o,begin:i,onAnimationEnd:s,onAnimationStart:c,children:l}=t,u=function(e,t){var n=(0,N.useContext)(Vk);return(0,N.useMemo)(()=>null!==t&&void 0!==t?t:n(e),[e,t,n])}(t.animationId,t.animationManager),[d,h]=(0,N.useState)(n?Hk:Kk),p=(0,N.useRef)(null);return(0,N.useEffect)(()=>{n||h(Kk)},[n]),(0,N.useEffect)(()=>{if(!n||!r)return wk;var e=Dk(Hk,Kk,jk(o),a,h,u.getTimeoutController());return u.start([c,i,()=>{p.current=e()},a,s]),()=>{u.stop(),p.current&&p.current(),s()}},[n,r,a,o,i,c,s,u]),l(d.t)}function Xk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",n=(0,N.useRef)($e(t)),r=(0,N.useRef)(e);return r.current!==e&&(n.current=$e(t),r.current=e),n.current}function Yk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Qk(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yk(Object(n),!0).forEach(function(t){Zk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Zk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $k(){return $k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$k.apply(null,arguments)}var Jk=(e,t,n,r,a)=>{var o,i=Math.min(Math.abs(n)/2,Math.abs(r)/2),s=r>=0?1:-1,c=n>=0?1:-1,l=r>=0&&n>=0||r<0&&n<0?1:0;if(i>0&&a instanceof Array){for(var u=[0,0,0,0],d=0;d<4;d++)u[d]=a[d]>i?i:a[d];o="M".concat(e,",").concat(t+s*u[0]),u[0]>0&&(o+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(e+c*u[0],",").concat(t)),o+="L ".concat(e+n-c*u[1],",").concat(t),u[1]>0&&(o+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,",\n        ").concat(e+n,",").concat(t+s*u[1])),o+="L ".concat(e+n,",").concat(t+r-s*u[2]),u[2]>0&&(o+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,",\n        ").concat(e+n-c*u[2],",").concat(t+r)),o+="L ".concat(e+c*u[3],",").concat(t+r),u[3]>0&&(o+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,",\n        ").concat(e,",").concat(t+r-s*u[3])),o+="Z"}else if(i>0&&a===+a&&a>0){var h=Math.min(i,a);o="M ".concat(e,",").concat(t+s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(l,",").concat(e+c*h,",").concat(t,"\n            L ").concat(e+n-c*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(l,",").concat(e+n,",").concat(t+s*h,"\n            L ").concat(e+n,",").concat(t+r-s*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(l,",").concat(e+n-c*h,",").concat(t+r,"\n            L ").concat(e+c*h,",").concat(t+r,"\n            A ").concat(h,",").concat(h,",0,0,").concat(l,",").concat(e,",").concat(t+r-s*h," Z")}else o="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return o},eS={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tS=e=>{var t=Rv(e,eS),n=(0,N.useRef)(null),[r,a]=(0,N.useState)(-1);(0,N.useEffect)(()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&a(e)}catch(t){}},[]);var{x:o,y:i,width:s,height:c,radius:l,className:u}=t,{animationEasing:d,animationDuration:h,animationBegin:p,isAnimationActive:f,isUpdateAnimationActive:m}=t,g=(0,N.useRef)(s),y=(0,N.useRef)(c),v=(0,N.useRef)(o),b=(0,N.useRef)(i),x=Xk((0,N.useMemo)(()=>({x:o,y:i,width:s,height:c,radius:l}),[o,i,s,c,l]),"rectangle-");if(o!==+o||i!==+i||s!==+s||c!==+c||0===s||0===c)return null;var w=We("recharts-rectangle",u);if(!m)return N.createElement("path",$k({},Yy(t,!0),{className:w,d:Jk(o,i,s,c,l)}));var k=g.current,S=y.current,C=v.current,I=b.current,E="0px ".concat(-1===r?1:r,"px"),T="".concat(r,"px 0px"),O=Ik(["strokeDasharray"],h,"string"===typeof d?d:void 0);return N.createElement(qk,{animationId:x,key:x,canBegin:r>0,duration:h,easing:d,isActive:m,begin:p},e=>{var r,a=nt(k,s,e),u=nt(S,c,e),d=nt(C,o,e),h=nt(I,i,e);return n.current&&(g.current=a,y.current=u,v.current=d,b.current=h),r=f?e>0?{transition:O,strokeDasharray:T}:{strokeDasharray:E}:{strokeDasharray:T},N.createElement("path",$k({},Yy(t,!0),{className:w,d:Jk(d,h,a,u,l),ref:n,style:Qk(Qk({},r),t.style)}))})};function nS(e){var{cx:t,cy:n,radius:r,startAngle:a,endAngle:o}=e;return{points:[yo(t,n,r,a),yo(t,n,r,o)],cx:t,cy:n,radius:r,startAngle:a,endAngle:o}}function rS(){return rS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rS.apply(null,arguments)}var aS=e=>{var{cx:t,cy:n,radius:r,angle:a,sign:o,isExternal:i,cornerRadius:s,cornerIsExternal:c}=e,l=s*(i?1:-1)+r,u=Math.asin(s/l)/mo,d=c?a:a+o*u,h=c?a-o*u:a;return{center:yo(t,n,l,d),circleTangency:yo(t,n,r,d),lineTangency:yo(t,n,l*Math.cos(u*mo),h),theta:u}},oS=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:o,endAngle:i}=e,s=((e,t)=>Ke(t-e)*Math.min(Math.abs(t-e),359.999))(o,i),c=o+s,l=yo(t,n,a,o),u=yo(t,n,a,c),d="M ".concat(l.x,",").concat(l.y,"\n    A ").concat(a,",").concat(a,",0,\n    ").concat(+(Math.abs(s)>180),",").concat(+(o>c),",\n    ").concat(u.x,",").concat(u.y,"\n  ");if(r>0){var h=yo(t,n,r,o),p=yo(t,n,r,c);d+="L ".concat(p.x,",").concat(p.y,"\n            A ").concat(r,",").concat(r,",0,\n            ").concat(+(Math.abs(s)>180),",").concat(+(o<=c),",\n            ").concat(h.x,",").concat(h.y," Z")}else d+="L ".concat(t,",").concat(n," Z");return d},iS={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},sS=e=>{var t=Rv(e,iS),{cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u,className:d}=t;if(o<a||l===u)return null;var h,p=We("recharts-sector",d),f=o-a,m=Je(i,f,0,!0);return h=m>0&&Math.abs(l-u)<360?(e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,cornerRadius:o,forceCornerRadius:i,cornerIsExternal:s,startAngle:c,endAngle:l}=e,u=Ke(l-c),{circleTangency:d,lineTangency:h,theta:p}=aS({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:o,cornerIsExternal:s}),{circleTangency:f,lineTangency:m,theta:g}=aS({cx:t,cy:n,radius:a,angle:l,sign:-u,cornerRadius:o,cornerIsExternal:s}),y=s?Math.abs(c-l):Math.abs(c-l)-p-g;if(y<0)return i?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(o,",").concat(o,",0,0,1,").concat(2*o,",0\n        a").concat(o,",").concat(o,",0,0,1,").concat(2*-o,",0\n      "):oS({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:c,endAngle:l});var v="M ".concat(h.x,",").concat(h.y,"\n    A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(d.x,",").concat(d.y,"\n    A").concat(a,",").concat(a,",0,").concat(+(y>180),",").concat(+(u<0),",").concat(f.x,",").concat(f.y,"\n    A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(m.x,",").concat(m.y,"\n  ");if(r>0){var{circleTangency:b,lineTangency:x,theta:w}=aS({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),{circleTangency:k,lineTangency:S,theta:C}=aS({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),I=s?Math.abs(c-l):Math.abs(c-l)-w-C;if(I<0&&0===o)return"".concat(v,"L").concat(t,",").concat(n,"Z");v+="L".concat(S.x,",").concat(S.y,"\n      A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(k.x,",").concat(k.y,"\n      A").concat(r,",").concat(r,",0,").concat(+(I>180),",").concat(+(u>0),",").concat(b.x,",").concat(b.y,"\n      A").concat(o,",").concat(o,",0,0,").concat(+(u<0),",").concat(x.x,",").concat(x.y,"Z")}else v+="L".concat(t,",").concat(n,"Z");return v})({cx:n,cy:r,innerRadius:a,outerRadius:o,cornerRadius:Math.min(m,f/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):oS({cx:n,cy:r,innerRadius:a,outerRadius:o,startAngle:l,endAngle:u}),N.createElement("path",rS({},Yy(t,!0),{className:p,d:h}))};function cS(e,t,n){var r,a,o,i;if("horizontal"===e)o=r=t.x,a=n.top,i=n.top+n.height;else if("vertical"===e)i=a=t.y,r=n.left,o=n.left+n.width;else if(null!=t.cx&&null!=t.cy){if("centric"!==e)return nS(t);var{cx:s,cy:c,innerRadius:l,outerRadius:u,angle:d}=t,h=yo(s,c,l,d),p=yo(s,c,u,d);r=h.x,a=h.y,o=p.x,i=p.y}return[{x:r,y:a},{x:o,y:i}]}function lS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lS(Object(n),!0).forEach(function(t){dS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function dS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hS=()=>{var e=to(Lh),t=to(Mm),n=to(Rm);return Wo(uS(uS({},e),{},{scale:n}),t)};function pS(){return pS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pS.apply(null,arguments)}function fS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fS(Object(n),!0).forEach(function(t){gS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function gS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yS(e){var t,n,{coordinate:r,payload:a,index:o,offset:i,tooltipAxisBandSize:s,layout:c,cursor:l,tooltipEventType:u,chartName:d}=e,h=r,p=a,f=o;if(!l||!h||"ScatterChart"!==d&&"axis"!==u)return null;if("ScatterChart"===d)t=h,n=xk;else if("BarChart"===d)t=function(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:"horizontal"===e?t.x-a:n.left+.5,y:"horizontal"===e?n.top+.5:t.y-a,width:"horizontal"===e?r:n.width-1,height:"horizontal"===e?n.height-1:r}}(c,h,i,s),n=tS;else if("radial"===c){var{cx:m,cy:g,radius:y,startAngle:v,endAngle:b}=nS(h);t={cx:m,cy:g,startAngle:v,endAngle:b,innerRadius:y,outerRadius:y},n=sS}else t={points:cS(c,h,i)},n=fk;var x="object"===typeof l&&"className"in l?l.className:void 0,w=mS(mS(mS(mS({stroke:"#ccc",pointerEvents:"none"},i),t),Yy(l,!1)),{},{payload:p,payloadIndex:f,className:We("recharts-tooltip-cursor",x)});return(0,N.isValidElement)(l)?(0,N.cloneElement)(l,w):(0,N.createElement)(n,w)}function vS(e){var t=hS(),n=ui(),r=fi(),a=Ym();return N.createElement(yS,pS({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:a}))}function bS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bS(Object(n),!0).forEach(function(t){wS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kS(e){return e.dataKey}var SS=[],CS={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ey,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function IS(e){var t=Rv(e,CS),{active:n,allowEscapeViewBox:r,animationDuration:a,animationEasing:o,content:i,filterNull:s,isAnimationActive:c,offset:l,payloadUniqBy:u,position:d,reverseDirection:h,useTranslate3d:p,wrapperStyle:f,cursor:m,shared:g,trigger:y,defaultIndex:v,portal:b,axisId:x}=t,w=Za(),k="number"===typeof v?String(v):v;(0,N.useEffect)(()=>{w(va({shared:g,trigger:y,axisId:x,active:n,defaultIndex:k}))},[w,g,y,x,n,k]);var S=ci(),C=Ry(),I=function(e){return to(t=>Vf(t,e))}(g),{activeIndex:E,isActive:T}=to(e=>sg(e,I,y,k)),O=to(e=>ig(e,I,y,k)),A=to(e=>og(e,I,y,k)),_=to(e=>ag(e,I,y,k)),R=O,P=(0,N.useContext)(yv),D=null!==n&&void 0!==n?n:T,[M,F]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=(0,N.useState)({height:0,left:0,top:0,width:0}),r=(0,N.useCallback)(e=>{if(null!=e){var r=e.getBoundingClientRect(),a={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(a.height-t.height)>1||Math.abs(a.left-t.left)>1||Math.abs(a.top-t.top)>1||Math.abs(a.width-t.width)>1)&&n({height:a.height,left:a.left,top:a.top,width:a.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}([R,D]),L="axis"===I?A:void 0;gv(I,y,_,L,E,D);var z=null!==b&&void 0!==b?b:P;if(null==z)return null;var B=null!==R&&void 0!==R?R:SS;D||(B=SS),s&&B.length&&(B=function(e,t,n){return!0===t?pw()(e,n):"function"===typeof t?pw()(e,t):e}(R.filter(e=>null!=e.value&&(!0!==e.hide||t.includeHidden)),u,kS));var j=B.length>0,W=N.createElement(dw,{allowEscapeViewBox:r,animationDuration:a,animationEasing:o,isAnimationActive:c,active:D,coordinate:_,hasPayload:j,offset:l,position:d,reverseDirection:h,useTranslate3d:p,viewBox:S,wrapperStyle:f,lastBoundingBox:M,innerRef:F,hasPortalFromProps:Boolean(b)},function(e,t){return N.isValidElement(e)?N.cloneElement(e,t):"function"===typeof e?N.createElement(e,t):N.createElement(rw,t)}(i,xS(xS({},t),{},{payload:B,label:L,active:D,coordinate:_,accessibilityLayer:C})));return N.createElement(N.Fragment,null,(0,Zx.createPortal)(W,z),D&&N.createElement(vS,{cursor:m,tooltipEventType:I,coordinate:_,payload:R,index:E}))}var ES=e=>null;ES.displayName="Cell";var TS=n(356),NS=n.n(TS),OS=["valueAccessor"],AS=["dataKey","clockWise","id","textBreakAll"];function _S(){return _S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_S.apply(null,arguments)}function RS(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var PS=e=>Array.isArray(e.value)?NS()(e.value):e.value,DS=(0,N.createContext)(void 0),MS=DS.Provider,FS=(0,N.createContext)(void 0),LS=FS.Provider;function zS(e){var{valueAccessor:t=PS}=e,n=RS(e,OS),{dataKey:r,clockWise:a,id:o,textBreakAll:i}=n,s=RS(n,AS),c=(0,N.useContext)(DS),l=(0,N.useContext)(FS),u=c||l;return u&&u.length?N.createElement(sb,{className:"recharts-label-list"},u.map((e,a)=>{var c,l=at(r)?t(e,a):Eo(e&&e.payload,r),u=at(o)?{}:{id:"".concat(o,"-").concat(a)};return N.createElement(Gb,_S({},Yy(e,!0),s,u,{fill:null!==(c=n.fill)&&void 0!==c?c:e.fill,parentViewBox:e.parentViewBox,value:l,textBreakAll:i,viewBox:e.viewBox,key:"label-".concat(a),index:a}))})):null}function BS(e){var{label:t}=e;return t?!0===t?N.createElement(zS,{key:"labelList-implicit"}):N.isValidElement(t)||jb(t)?N.createElement(zS,{key:"labelList-implicit",content:t}):"object"===typeof t?N.createElement(zS,_S({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}zS.displayName="LabelList";var jS="Invariant failed";var WS=n(9397),US=n.n(WS);function VS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VS(Object(n),!0).forEach(function(t){HS(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function HS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KS(){return KS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KS.apply(null,arguments)}var qS=(e,t,n,r,a)=>{var o,i=n-r;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+n,",").concat(t),o+="L ".concat(e+n-i/2,",").concat(t+a),o+="L ".concat(e+n-i/2-r,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z")},XS={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},YS=e=>{var t=Rv(e,XS),{x:n,y:r,upperWidth:a,lowerWidth:o,height:i,className:s}=t,{animationEasing:c,animationDuration:l,animationBegin:u,isUpdateAnimationActive:d}=t,h=(0,N.useRef)(),[p,f]=(0,N.useState)(-1),m=(0,N.useRef)(a),g=(0,N.useRef)(o),y=(0,N.useRef)(i),v=(0,N.useRef)(n),b=(0,N.useRef)(r),x=Xk(e,"trapezoid-");if((0,N.useEffect)(()=>{if(h.current&&h.current.getTotalLength)try{var e=h.current.getTotalLength();e&&f(e)}catch(t){}},[]),n!==+n||r!==+r||a!==+a||o!==+o||i!==+i||0===a&&0===o||0===i)return null;var w=We("recharts-trapezoid",s);if(!d)return N.createElement("g",null,N.createElement("path",KS({},Yy(t,!0),{className:w,d:qS(n,r,a,o,i)})));var k=m.current,S=g.current,C=y.current,I=v.current,E=b.current,T="0px ".concat(-1===p?1:p,"px"),O="".concat(p,"px 0px"),A=Ik(["strokeDasharray"],l,c);return N.createElement(qk,{animationId:x,key:x,canBegin:p>0,duration:l,easing:c,isActive:d,begin:u},e=>{var s=nt(k,a,e),c=nt(S,o,e),l=nt(C,i,e),u=nt(I,n,e),d=nt(E,r,e);h.current&&(m.current=s,g.current=c,y.current=l,v.current=u,b.current=d);var p=e>0?{transition:A,strokeDasharray:O}:{strokeDasharray:T};return N.createElement("path",KS({},Yy(t,!0),{className:w,d:qS(u,d,s,c,l),ref:h,style:GS(GS({},p),t.style)}))})};Math.abs,Math.atan2;const QS=Math.cos,ZS=(Math.max,Math.min,Math.sin),$S=Math.sqrt,JS=Math.PI,eC=2*JS;const tC={draw(e,t){const n=$S(t/JS);e.moveTo(n,0),e.arc(0,0,n,0,eC)}},nC={draw(e,t){const n=$S(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},rC=$S(1/3),aC=2*rC,oC={draw(e,t){const n=$S(t/aC),r=n*rC;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},iC={draw(e,t){const n=$S(t),r=-n/2;e.rect(r,r,n,n)}},sC=ZS(JS/10)/ZS(7*JS/10),cC=ZS(eC/10)*sC,lC=-QS(eC/10)*sC,uC={draw(e,t){const n=$S(.8908130915292852*t),r=cC*n,a=lC*n;e.moveTo(0,-n),e.lineTo(r,a);for(let o=1;o<5;++o){const t=eC*o/5,i=QS(t),s=ZS(t);e.lineTo(s*n,-i*n),e.lineTo(i*r-s*a,s*r+i*a)}e.closePath()}},dC=$S(3),hC={draw(e,t){const n=-$S(t/(3*dC));e.moveTo(0,2*n),e.lineTo(-dC*n,-n),e.lineTo(dC*n,-n),e.closePath()}},pC=-.5,fC=$S(3)/2,mC=1/$S(12),gC=3*(mC/2+1),yC={draw(e,t){const n=$S(t/gC),r=n/2,a=n*mC,o=r,i=n*mC+n,s=-o,c=i;e.moveTo(r,a),e.lineTo(o,i),e.lineTo(s,c),e.lineTo(pC*r-fC*a,fC*r+pC*a),e.lineTo(pC*o-fC*i,fC*o+pC*i),e.lineTo(pC*s-fC*c,fC*s+pC*c),e.lineTo(pC*r+fC*a,pC*a-fC*r),e.lineTo(pC*o+fC*i,pC*i-fC*o),e.lineTo(pC*s+fC*c,pC*c-fC*s),e.closePath()}};$S(3),$S(3);var vC=["type","size","sizeType"];function bC(){return bC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bC.apply(null,arguments)}function xC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xC(Object(n),!0).forEach(function(t){kC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function kC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var SC={symbolCircle:tC,symbolCross:nC,symbolDiamond:oC,symbolSquare:iC,symbolStar:uC,symbolTriangle:hC,symbolWye:yC},CC=Math.PI/180,IC=e=>{var{type:t="circle",size:n=64,sizeType:r="area"}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,vC),o=wC(wC({},a),{},{type:t,size:n,sizeType:r}),i="circle";"string"===typeof t&&(i=t);var{className:s,cx:c,cy:l}=o,u=Yy(o,!0);return c===+c&&l===+l&&n===+n?N.createElement("path",bC({},u,{className:We("recharts-symbols",s),transform:"translate(".concat(c,", ").concat(l,")"),d:(()=>{var e=(e=>{var t="symbol".concat(ot(e));return SC[t]||tC})(i),t=function(e,t){let n=null,r=ek(a);function a(){let a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:so(e||tC),t="function"===typeof t?t:so(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:so(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:so(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type(e).size(((e,t,n)=>{if("area"===t)return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return.5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var r=18*CC;return 1.25*e*e*(Math.tan(r)-Math.tan(2*r)*Math.tan(r)**2);case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(n,r,i));return t()})()})):null};IC.registerSymbol=(e,t)=>{SC["symbol".concat(ot(e))]=t};var EC=["option","shapeType","propTransformer","activeClassName","isActive"];function TC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function NC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TC(Object(n),!0).forEach(function(t){OC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function OC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AC(e,t){return NC(NC({},t),e)}function _C(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return N.createElement(tS,n);case"trapezoid":return N.createElement(YS,n);case"sector":return N.createElement(sS,n);case"symbols":if(function(e){return"symbols"===e}(t))return N.createElement(IC,n);break;default:return null}}function RC(e){var t,{option:n,shapeType:r,propTransformer:a=AC,activeClassName:o="recharts-active-shape",isActive:i}=e,s=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,EC);if((0,N.isValidElement)(n))t=(0,N.cloneElement)(n,NC(NC({},s),function(e){return(0,N.isValidElement)(e)?e.props:e}(n)));else if("function"===typeof n)t=n(s);else if(US()(n)&&"boolean"!==typeof n){var c=a(n,s);t=N.createElement(_C,{shapeType:r,elementProps:c})}else{var l=s;t=N.createElement(_C,{shapeType:r,elementProps:l})}return i?N.createElement(sb,{className:o},t):t}var PC=["x","y"];function DC(){return DC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DC.apply(null,arguments)}function MC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function FC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?MC(Object(n),!0).forEach(function(t){LC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function LC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zC(e,t){var{x:n,y:r}=e,a=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,PC),o="".concat(n),i=parseInt(o,10),s="".concat(r),c=parseInt(s,10),l="".concat(t.height||a.height),u=parseInt(l,10),d="".concat(t.width||a.width),h=parseInt(d,10);return FC(FC(FC(FC(FC({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function BC(e){return N.createElement(RC,DC({shapeType:"rectangle",propTransformer:zC,activeClassName:"recharts-active-bar"},e))}var jC=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(n,r)=>{if(Ye(e))return e;var a=Ye(n)||at(n);return a?e(n,r):(a||function(e){if(!e)throw new Error(jS)}(!1),t)}},WC=(e,t)=>{var n=Za();return(r,a)=>o=>{null===e||void 0===e||e(r,a,o),n(ba({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},UC=e=>{var t=Za();return(n,r)=>a=>{null===e||void 0===e||e(n,r,a),t(xa())}},VC=(e,t)=>{var n=Za();return(r,a)=>o=>{null===e||void 0===e||e(r,a,o),n(ka({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function GC(e){var{fn:t,args:n}=e,r=Za(),a=oi();return(0,N.useEffect)(()=>{if(!a){var e=t(n);return r(ga(e)),()=>{r(ya(e))}}},[t,n,r,a]),null}var HC=["children"];var KC={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},qC=(0,N.createContext)(KC);function XC(e){var{children:t}=e,n=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,HC);return N.createElement(qC.Provider,{value:n},t)}function YC(e,t){var n,r,a=to(t=>qh(t,e)),o=to(e=>Qh(e,t)),i=null!==(n=null===a||void 0===a?void 0:a.allowDataOverflow)&&void 0!==n?n:Hh.allowDataOverflow,s=null!==(r=null===o||void 0===o?void 0:o.allowDataOverflow)&&void 0!==r?r:Xh.allowDataOverflow;return{needClip:i||s,needClipX:i,needClipY:s}}function QC(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,a=Iv(),{needClipX:o,needClipY:i,needClip:s}=YC(t,n);if(!s)return null;var{x:c,y:l,width:u,height:d}=a;return N.createElement("clipPath",{id:"clipPath-".concat(r)},N.createElement("rect",{x:o?c:c-u/2,y:i?l:l-d/2,width:o?u:2*u,height:i?d:2*d}))}function ZC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZC(Object(n),!0).forEach(function(t){JC(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function JC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eI=Ka([rp,(e,t,n,r,a)=>a],(e,t)=>e.filter(e=>"bar"===e.type).find(e=>e.id===t)),tI=Ka([eI],e=>null===e||void 0===e?void 0:e.maxBarSize),nI=(e,t,n)=>{var r=null!==n&&void 0!==n?n:e;if(!at(r))return Je(r,t,0)},rI=Ka([pi,rp,(e,t)=>t,(e,t,n)=>n,(e,t,n,r)=>r],(e,t,n,r,a)=>t.filter(t=>"horizontal"===e?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===a).filter(e=>!1===e.hide).filter(e=>"bar"===e.type)),aI=(e,t,n)=>{var r=e.filter(jh),a=e.filter(e=>null==e.stackId),o=r.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),{}),i=Object.entries(o).map(e=>{var[r,a]=e;return{stackId:r,dataKeys:a.map(e=>e.dataKey),barSize:nI(t,n,a[0].barSize)}});return[...i,...a.map(e=>({stackId:void 0,dataKeys:[e.dataKey].filter(e=>null!=e),barSize:nI(t,n,e.barSize)}))]},oI=Ka([rI,th,(e,t,n)=>"horizontal"===pi(e)?Tf(e,"xAxis",t):Tf(e,"yAxis",n)],aI),iI=(e,t,n,r)=>{var a,o;return"horizontal"===pi(e)?(a=Lf(e,"xAxis",t,r),o=Ff(e,"xAxis",t,r)):(a=Lf(e,"yAxis",n,r),o=Ff(e,"yAxis",n,r)),Wo(a,o)};var sI,cI=(e,t,n,r,a,o,i)=>{var s=at(i)?t:i,c=function(e,t,n,r,a){var o=r.length;if(!(o<1)){var i,s=Je(e,n,0,!0),c=[];if(Nd(r[0].barSize)){var l=!1,u=n/o,d=r.reduce((e,t)=>e+(t.barSize||0),0);(d+=(o-1)*s)>=n&&(d-=(o-1)*s,s=0),d>=n&&u>0&&(l=!0,d=o*(u*=.9));var h={offset:((n-d)/2|0)-s,size:0};i=r.reduce((e,t)=>{var n,r=[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:h.offset+h.size+s,size:l?u:null!==(n=t.barSize)&&void 0!==n?n:0}}];return h=r[r.length-1].position,r},c)}else{var p=Je(t,n,0,!0);n-2*p-(o-1)*s<=0&&(s=0);var f=(n-2*p-(o-1)*s)/o;f>1&&(f>>=0);var m=Nd(a)?Math.min(f,a):f;i=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:p+(f+s)*n+(f-m)/2,size:m}}],c)}return i}}(n,r,a!==o?a:o,e,s);return a!==o&&null!=c&&(c=c.map(e=>$C($C({},e),{},{position:$C($C({},e.position),{},{offset:e.position.offset-a/2})}))),c},lI=Ka([oI,$d,Jd,eh,(e,t,n,r,a)=>{var o,i,s=eI(e,t,n,r,a);if(null!=s){var c,l,u=pi(e),d=$d(e),{maxBarSize:h}=s,p=at(h)?d:h;return"horizontal"===u?(c=Lf(e,"xAxis",t,r),l=Ff(e,"xAxis",t,r)):(c=Lf(e,"yAxis",n,r),l=Ff(e,"yAxis",n,r)),null!==(o=null!==(i=Wo(c,l,!0))&&void 0!==i?i:p)&&void 0!==o?o:0}},iI,tI],cI),uI=Ka([lI,eI],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),dI=(e,t)=>{var n=Dh(t);if(e&&null!=n&&null!=t){var{stackId:r}=t;if(null!=r){var a=e[r];if(a){var{stackedData:o}=a;if(o)return o.find(e=>e.key===n)}}}},hI=Ka([(e,t,n,r)=>"horizontal"===pi(e)?wp(e,"yAxis",n,r):wp(e,"xAxis",t,r),eI],dI),pI=Ka([ti,ri,(e,t,n,r)=>Lf(e,"xAxis",t,r),(e,t,n,r)=>Lf(e,"yAxis",n,r),(e,t,n,r)=>Ff(e,"xAxis",t,r),(e,t,n,r)=>Ff(e,"yAxis",n,r),uI,pi,Td,iI,hI,eI,(e,t,n,r,a,o)=>o],(e,t,n,r,a,o,i,s,c,l,u,d,h)=>{var{chartData:p,dataStartIndex:f,dataEndIndex:m}=c;if(null!=d&&null!=i&&null!=t&&("horizontal"===s||"vertical"===s)&&null!=n&&null!=r&&null!=a&&null!=o&&null!=l){var g,{data:y}=d;if(null!=(g=null!=y&&y.length>0?y:null===p||void 0===p?void 0:p.slice(f,m+1)))return function(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:a,bandSize:o,xAxis:i,yAxis:s,xAxisTicks:c,yAxisTicks:l,stackedData:u,displayedData:d,offset:h,cells:p,parentViewBox:f}=e,m="horizontal"===t?s:i,g=u?m.scale.domain():null,y=Lo({numericAxis:m});return d.map((e,d)=>{var m,v,b,x,w,k;u?m=_o(u[d],g):(m=Eo(e,n),Array.isArray(m)||(m=[y,m]));var S=jC(r,jI)(m[1],d);if("horizontal"===t){var C,[I,E]=[s.scale(m[0]),s.scale(m[1])];v=Fo({axis:i,ticks:c,bandSize:o,offset:a.offset,entry:e,index:d}),b=null!==(C=null!==E&&void 0!==E?E:I)&&void 0!==C?C:void 0,x=a.size;var T=I-E;if(w=qe(T)?0:T,k={x:v,y:h.top,width:x,height:h.height},Math.abs(S)>0&&Math.abs(w)<Math.abs(S)){var N=Ke(w||S)*(Math.abs(S)-Math.abs(w));b-=N,w+=N}}else{var[O,A]=[i.scale(m[0]),i.scale(m[1])];if(v=O,b=Fo({axis:s,ticks:l,bandSize:o,offset:a.offset,entry:e,index:d}),x=A-O,w=a.size,k={x:h.left,y:b,width:h.width,height:w},Math.abs(S)>0&&Math.abs(x)<Math.abs(S))x+=Ke(x||S)*(Math.abs(S)-Math.abs(x))}return null==v||null==b||null==x||null==w?null:NI(NI({},e),{},{x:v,y:b,width:x,height:w,value:u?m:m[1],payload:e,background:k,tooltipPosition:{x:v+x/2,y:b+w/2},parentViewBox:f},p&&p[d]&&p[d].props)}).filter(Boolean)}({layout:s,barSettings:d,pos:i,parentViewBox:t,bandSize:l,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:o,stackedData:u,displayedData:g,offset:e,cells:h})}}),fI=()=>{};function mI(e){var{legendPayload:t}=e,n=Za(),r=oi();return(0,N.useEffect)(()=>r?fI:(n(Yg(t)),()=>{n(Qg(t))}),[n,r,t]),null}function gI(e){var{legendPayload:t}=e,n=Za(),r=to(pi);return(0,N.useEffect)(()=>"centric"!==r&&"radial"!==r?fI:(n(Yg(t)),()=>{n(Qg(t))}),[n,r,t]),null}var yI=null!==(sI=O["useId".toString()])&&void 0!==sI?sI:()=>{var[e]=N.useState(()=>$e("uid-"));return e};var vI=(0,N.createContext)(void 0),bI=e=>{var{id:t,type:n,children:r}=e,a=function(e,t){var n=yI();return t||(e?"".concat(e,"-").concat(n):n)}("recharts-".concat(n),t);return N.createElement(vI.Provider,{value:a},r(a))};function xI(e){var t=Za(),n=(0,N.useRef)(null);return(0,N.useEffect)(()=>{null===n.current?t(Ng(e)):n.current!==e&&t(Og({prev:n.current,next:e})),n.current=e},[t,e]),(0,N.useEffect)(()=>()=>{n.current&&(t(Ag(n.current)),n.current=null)},[t]),null}function wI(e){var t=Za();return(0,N.useEffect)(()=>(t(_g(e)),()=>{t(Rg(e))}),[t,e]),null}var kI=["onMouseEnter","onMouseLeave","onClick"],SI=["value","background","tooltipPosition"],CI=["id"],II=["onMouseEnter","onClick","onMouseLeave"];function EI(){return EI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},EI.apply(null,arguments)}function TI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function NI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TI(Object(n),!0).forEach(function(t){OI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function OI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AI(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var _I=e=>{var{dataKey:t,name:n,fill:r,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:r,value:Vo(n,t),payload:e}]};function RI(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:a,name:o,hide:i,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:a,dataKey:t,nameKey:void 0,name:Vo(o,t),hide:i,type:e.tooltipType,color:e.fill,unit:s}}}function PI(e){var t=to(jm),{data:n,dataKey:r,background:a,allOtherBarProps:o}=e,{onMouseEnter:i,onMouseLeave:s,onClick:c}=o,l=AI(o,kI),u=WC(i,r),d=UC(s),h=VC(c,r);if(!a||null==n)return null;var p=Yy(a,!1);return N.createElement(N.Fragment,null,n.map((e,n)=>{var{value:o,background:i,tooltipPosition:s}=e,c=AI(e,SI);if(!i)return null;var f=u(e,n),m=d(e,n),g=h(e,n),y=NI(NI(NI(NI(NI({option:a,isActive:String(n)===t},c),{},{fill:"#eee"},i),p),By(l,e,n)),{},{onMouseEnter:f,onMouseLeave:m,onClick:g,dataKey:r,index:n,className:"recharts-bar-background-rectangle"});return N.createElement(BC,EI({key:"background-bar-".concat(y.index)},y))}))}function DI(e){var{showLabels:t,children:n,rects:r}=e,a=null===r||void 0===r?void 0:r.map(e=>{var t={x:e.x,y:e.y,width:e.width,height:e.height};return NI(NI({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return N.createElement(MS,{value:t?a:void 0},n)}function MI(e){var{shape:t,activeBar:n,baseProps:r,entry:a,index:o,dataKey:i}=e,s=to(jm),c=to(Um),l=n&&String(o)===s&&(null==c||i===c),u=l?n:t;return N.createElement(BC,EI({},r,a,{isActive:l,option:u,index:o,dataKey:i}))}function FI(e){var{shape:t,baseProps:n,entry:r,index:a,dataKey:o}=e;return N.createElement(BC,EI({},n,r,{isActive:!1,option:t,index:a,dataKey:o}))}function LI(e){var{data:t,props:n}=e,r=Uy(n),{id:a}=r,o=AI(r,CI),{shape:i,dataKey:s,activeBar:c}=n,{onMouseEnter:l,onClick:u,onMouseLeave:d}=n,h=AI(n,II),p=WC(l,s),f=UC(d),m=VC(u,s);return t?N.createElement(N.Fragment,null,t.map((e,t)=>N.createElement(sb,EI({className:"recharts-bar-rectangle"},By(h,e,t),{onMouseEnter:p(e,t),onMouseLeave:f(e,t),onClick:m(e,t),key:"rectangle-".concat(null===e||void 0===e?void 0:e.x,"-").concat(null===e||void 0===e?void 0:e.y,"-").concat(null===e||void 0===e?void 0:e.value,"-").concat(t)}),c?N.createElement(MI,{shape:i,activeBar:c,baseProps:o,entry:e,index:t,dataKey:s}):N.createElement(FI,{shape:i,baseProps:o,entry:e,index:t,dataKey:s})))):null}function zI(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:a,isAnimationActive:o,animationBegin:i,animationDuration:s,animationEasing:c,onAnimationEnd:l,onAnimationStart:u}=t,d=n.current,h=Xk(t,"recharts-bar-"),[p,f]=(0,N.useState)(!1),m=!p,g=(0,N.useCallback)(()=>{"function"===typeof l&&l(),f(!1)},[l]),y=(0,N.useCallback)(()=>{"function"===typeof u&&u(),f(!0)},[u]);return N.createElement(DI,{showLabels:m,rects:r},N.createElement(qk,{animationId:h,begin:i,duration:s,isActive:o,easing:c,onAnimationEnd:g,onAnimationStart:y,key:h},e=>{var o=1===e?r:null===r||void 0===r?void 0:r.map((t,n)=>{var r=d&&d[n];if(r)return NI(NI({},t),{},{x:nt(r.x,t.x,e),y:nt(r.y,t.y,e),width:nt(r.width,t.width,e),height:nt(r.height,t.height,e)});if("horizontal"===a){var o=nt(0,t.height,e);return NI(NI({},t),{},{y:t.y+t.height-o,height:o})}var i=nt(0,t.width,e);return NI(NI({},t),{},{width:i})});return e>0&&(n.current=null!==o&&void 0!==o?o:null),null==o?null:N.createElement(sb,null,N.createElement(LI,{props:t,data:o}))}),N.createElement(BS,{label:t.label}),t.children)}function BI(e){var t=(0,N.useRef)(null);return N.createElement(zI,{previousRectanglesRef:t,props:e})}var jI=0,WI=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Eo(e,t)}};class UI extends N.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:r,xAxisId:a,yAxisId:o,needClip:i,background:s,id:c}=this.props;if(e||null==t)return null;var l=We("recharts-bar",r),u=c;return N.createElement(sb,{className:l,id:c},i&&N.createElement("defs",null,N.createElement(QC,{clipPathId:u,xAxisId:a,yAxisId:o})),N.createElement(sb,{className:"recharts-bar-rectangles",clipPath:i?"url(#clipPath-".concat(u,")"):void 0},N.createElement(PI,{data:t,dataKey:n,background:s,allOtherBarProps:this.props}),N.createElement(BI,this.props)))}}var VI={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ey,legendType:"rect",minPointSize:jI,xAxisId:0,yAxisId:0};function GI(e){var t,{xAxisId:n,yAxisId:r,hide:a,legendType:o,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:l,animationEasing:u,isAnimationActive:d}=e,{needClip:h}=YC(n,r),p=fi(),f=oi(),m=qy(e.children,ES),g=to(t=>pI(t,n,r,f,e.id,m));if("vertical"!==p&&"horizontal"!==p)return null;var y=null===g||void 0===g?void 0:g[0];return t=null==y||null==y.height||null==y.width?0:"vertical"===p?y.height/2:y.width/2,N.createElement(XC,{xAxisId:n,yAxisId:r,data:g,dataPointFormatter:WI,errorBarOffset:t},N.createElement(UI,EI({},e,{layout:p,needClip:h,data:g,xAxisId:n,yAxisId:r,hide:a,legendType:o,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:l,animationEasing:u,isAnimationActive:d})))}function HI(e){var t=Rv(e,VI),n=oi();return N.createElement(bI,{id:t.id,type:"bar"},e=>N.createElement(N.Fragment,null,N.createElement(mI,{legendPayload:_I(t)}),N.createElement(GC,{fn:RI,args:t}),N.createElement(xI,{type:"bar",id:e,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:Do(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),N.createElement(GI,EI({},t,{id:e}))))}var KI=N.memo(HI);KI.displayName="Bar";var qI=["axis"],XI=(0,N.forwardRef)((e,t)=>N.createElement(Fv,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:qI,tooltipPayloadSearcher:dr,categoricalChartProps:e,ref:t}));function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YI.apply(null,arguments)}var QI=e=>{var{cx:t,cy:n,r:r,className:a}=e,o=We("recharts-dot",a);return t===+t&&n===+n&&r===+r?N.createElement("circle",YI({},Uy(e),zy(e),{className:o,cx:t,cy:n,r:r})):null};function ZI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZI(Object(n),!0).forEach(function(t){JI(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function JI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eE(e){var{points:t,mainColor:n,activeDot:r,itemDataKey:a}=e,o=to(jm),i=to(Xm);if(null==t||null==i)return null;var s=t.find(e=>i.includes(e.payload));return at(s)?null:(e=>{var{point:t,childIndex:n,mainColor:r,activeDot:a,dataKey:o}=e;if(!1===a||null==t.x||null==t.y)return null;var i,s=$I($I({index:n,dataKey:o,cx:t.x,cy:t.y,r:4,fill:null!==r&&void 0!==r?r:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Yy(a,!1)),zy(a));return i=(0,N.isValidElement)(a)?(0,N.cloneElement)(a,s):"function"===typeof a?a(s):N.createElement(QI,s),N.createElement(sb,{className:"recharts-active-dot"},i)})({point:s,childIndex:Number(o),mainColor:n,dataKey:a,activeDot:r})}var tE=(e,t,n,r)=>Lf(e,"xAxis",t,r),nE=(e,t,n,r)=>Ff(e,"xAxis",t,r),rE=(e,t,n,r)=>Lf(e,"yAxis",n,r),aE=(e,t,n,r)=>Ff(e,"yAxis",n,r),oE=Ka([pi,tE,rE,nE,aE],(e,t,n,r,a)=>To(e,"xAxis")?Wo(t,r,!1):Wo(n,a,!1)),iE=Ka([rp,(e,t,n,r,a)=>a],(e,t)=>e.filter(e=>"area"===e.type).find(e=>e.id===t)),sE=Ka([pi,tE,rE,nE,aE,(e,t,n,r,a)=>{var o,i=iE(e,t,n,r,a);if(null!=i){var s,c=pi(e);if(null!=(s=To(c,"xAxis")?wp(e,"yAxis",n,r):wp(e,"xAxis",t,r))){var{stackId:l}=i,u=Dh(i);if(null!=l&&null!=u){var d=null===(o=s[l])||void 0===o?void 0:o.stackedData;return null===d||void 0===d?void 0:d.find(e=>e.key===u)}}}},Td,oE,iE],(e,t,n,r,a,o,i,s,c)=>{var{chartData:l,dataStartIndex:u,dataEndIndex:d}=i;if(null!=c&&("horizontal"===e||"vertical"===e)&&null!=t&&null!=n&&null!=r&&null!=a&&0!==r.length&&0!==a.length&&null!=s){var h,{data:p}=c;if(null!=(h=p&&p.length>0?p:null===l||void 0===l?void 0:l.slice(u,d+1))){return function(e){var t,{areaSettings:{connectNulls:n,baseValue:r,dataKey:a},stackedData:o,layout:i,chartBaseValue:s,xAxis:c,yAxis:l,displayedData:u,dataStartIndex:d,xAxisTicks:h,yAxisTicks:p,bandSize:f}=e,m=o&&o.length,g=OE(i,s,r,c,l),y="horizontal"===i,v=!1,b=u.map((e,t)=>{var r;m?r=o[d+t]:(r=Eo(e,a),Array.isArray(r)?v=!0:r=[g,r]);var i=null==r[1]||m&&!n&&null==Eo(e,a);return y?{x:Mo({axis:c,ticks:h,bandSize:f,entry:e,index:t}),y:i?null:l.scale(r[1]),value:r,payload:e}:{x:i?null:c.scale(r[1]),y:Mo({axis:l,ticks:p,bandSize:f,entry:e,index:t}),value:r,payload:e}});t=m||v?b.map(e=>{var t=Array.isArray(e.value)?e.value[0]:null;return y?{x:e.x,y:null!=t&&null!=e.y?l.scale(t):null,payload:e.payload}:{x:null!=t?c.scale(t):null,y:e.y,payload:e.payload}}):y?l.scale(g):c.scale(g);return{points:b,baseLine:t,isRange:v}}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataStartIndex:u,areaSettings:c,stackedData:o,displayedData:h,chartBaseValue:undefined,bandSize:s})}}}),cE=["id"],lE=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function uE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function dE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dE(Object(n),!0).forEach(function(t){pE(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fE(){return fE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fE.apply(null,arguments)}function mE(e,t){return e&&"none"!==e?e:t}var gE=e=>{var{dataKey:t,name:n,stroke:r,fill:a,legendType:o,hide:i}=e;return[{inactive:i,dataKey:t,type:o,color:mE(r,a),value:Vo(n,t),payload:e}]};function yE(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:o,name:i,hide:s,unit:c}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:o,dataKey:t,nameKey:void 0,name:Vo(i,t),hide:s,type:e.tooltipType,color:mE(r,o),unit:c}}}function vE(e){var{clipPathId:t,points:n,props:r}=e,{needClip:a,dot:o,dataKey:i}=r;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(n,o))return null;var s=Xy(o),c=Uy(r),l=Yy(o,!0),u=n.map((e,t)=>{var r=hE(hE(hE({key:"dot-".concat(t),r:3},c),l),{},{index:t,cx:e.x,cy:e.y,dataKey:i,value:e.value,payload:e.payload,points:n});return((e,t)=>{var n;if(N.isValidElement(e))n=N.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var r=We("recharts-area-dot","boolean"!==typeof e?e.className:"");n=N.createElement(QI,fE({},t,{className:r}))}return n})(o,r)}),d={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):void 0};return N.createElement(sb,fE({className:"recharts-area-dots"},d),u)}function bE(e){var{showLabels:t,children:n,points:r}=e,a=r.map(e=>{var t={x:e.x,y:e.y,width:0,height:0};return hE(hE({},t),{},{value:e.value,payload:e.payload,parentViewBox:void 0,viewBox:t,fill:void 0})});return N.createElement(MS,{value:t?a:null},n)}function xE(e){var{points:t,baseLine:n,needClip:r,clipPathId:a,props:o}=e,{layout:i,type:s,stroke:c,connectNulls:l,isRange:u}=o,{id:d}=o,h=uE(o,cE),p=Uy(h);return N.createElement(N.Fragment,null,(null===t||void 0===t?void 0:t.length)>1&&N.createElement(sb,{clipPath:r?"url(#clipPath-".concat(a,")"):void 0},N.createElement(fk,fE({},p,{id:d,points:t,connectNulls:l,type:s,baseLine:n,layout:i,stroke:"none",className:"recharts-area-area"})),"none"!==c&&N.createElement(fk,fE({},p,{className:"recharts-area-curve",layout:i,type:s,connectNulls:l,fill:"none",points:t})),"none"!==c&&u&&N.createElement(fk,fE({},p,{className:"recharts-area-curve",layout:i,type:s,connectNulls:l,fill:"none",points:n}))),N.createElement(vE,{points:t,props:h,clipPathId:a}))}function wE(e){var{alpha:t,baseLine:n,points:r,strokeWidth:a}=e,o=r[0].y,i=r[r.length-1].y;if(!Nd(o)||!Nd(i))return null;var s=t*Math.abs(o-i),c=Math.max(...r.map(e=>e.x||0));return Ye(n)?c=Math.max(n,c):n&&Array.isArray(n)&&n.length&&(c=Math.max(...n.map(e=>e.x||0),c)),Ye(c)?N.createElement("rect",{x:0,y:o<i?o:o-s,width:c+(a?parseInt("".concat(a),10):1),height:Math.floor(s)}):null}function kE(e){var{alpha:t,baseLine:n,points:r,strokeWidth:a}=e,o=r[0].x,i=r[r.length-1].x;if(!Nd(o)||!Nd(i))return null;var s=t*Math.abs(o-i),c=Math.max(...r.map(e=>e.y||0));return Ye(n)?c=Math.max(n,c):n&&Array.isArray(n)&&n.length&&(c=Math.max(...n.map(e=>e.y||0),c)),Ye(c)?N.createElement("rect",{x:o<i?o:o-s,y:0,width:s,height:Math.floor(c+(a?parseInt("".concat(a),10):1))}):null}function SE(e){var{alpha:t,layout:n,points:r,baseLine:a,strokeWidth:o}=e;return"vertical"===n?N.createElement(wE,{alpha:t,points:r,baseLine:a,strokeWidth:o}):N.createElement(kE,{alpha:t,points:r,baseLine:a,strokeWidth:o})}function CE(e){var{needClip:t,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:o}=e,{points:i,baseLine:s,isAnimationActive:c,animationBegin:l,animationDuration:u,animationEasing:d,onAnimationStart:h,onAnimationEnd:p}=r,f=Xk(r,"recharts-area-"),[m,g]=(0,N.useState)(!1),y=!m,v=(0,N.useCallback)(()=>{"function"===typeof p&&p(),g(!1)},[p]),b=(0,N.useCallback)(()=>{"function"===typeof h&&h(),g(!0)},[h]),x=a.current,w=o.current;return N.createElement(bE,{showLabels:y,points:i},r.children,N.createElement(qk,{animationId:f,begin:l,duration:u,isActive:c,easing:d,onAnimationEnd:v,onAnimationStart:b,key:f},e=>{if(x){var l,u=x.length/i.length,d=1===e?i:i.map((t,n)=>{var r=Math.floor(n*u);if(x[r]){var a=x[r];return hE(hE({},t),{},{x:nt(a.x,t.x,e),y:nt(a.y,t.y,e)})}return t});return l=Ye(s)?nt(w,s,e):at(s)||qe(s)?nt(w,0,e):s.map((t,n)=>{var r=Math.floor(n*u);if(Array.isArray(w)&&w[r]){var a=w[r];return hE(hE({},t),{},{x:nt(a.x,t.x,e),y:nt(a.y,t.y,e)})}return t}),e>0&&(a.current=d,o.current=l),N.createElement(xE,{points:d,baseLine:l,needClip:t,clipPathId:n,props:r})}return e>0&&(a.current=i,o.current=s),N.createElement(sb,null,c&&N.createElement("defs",null,N.createElement("clipPath",{id:"animationClipPath-".concat(n)},N.createElement(SE,{alpha:e,points:i,baseLine:s,layout:r.layout,strokeWidth:r.strokeWidth}))),N.createElement(sb,{clipPath:"url(#animationClipPath-".concat(n,")")},N.createElement(xE,{points:i,baseLine:s,needClip:t,clipPathId:n,props:r})))}),N.createElement(BS,{label:r.label}))}function IE(e){var{needClip:t,clipPathId:n,props:r}=e,a=(0,N.useRef)(null),o=(0,N.useRef)();return N.createElement(CE,{needClip:t,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:o})}class EE extends N.PureComponent{render(){var e,{hide:t,dot:n,points:r,className:a,top:o,left:i,needClip:s,xAxisId:c,yAxisId:l,width:u,height:d,id:h,baseLine:p}=this.props;if(t)return null;var f=We("recharts-area",a),m=h,{r:g=3,strokeWidth:y=2}=null!==(e=Yy(n,!1))&&void 0!==e?e:{r:3,strokeWidth:2},v=Xy(n),b=2*g+y;return N.createElement(N.Fragment,null,N.createElement(sb,{className:f},s&&N.createElement("defs",null,N.createElement(QC,{clipPathId:m,xAxisId:c,yAxisId:l}),!v&&N.createElement("clipPath",{id:"clipPath-dots-".concat(m)},N.createElement("rect",{x:i-b/2,y:o-b/2,width:u+b,height:d+b}))),N.createElement(IE,{needClip:s,clipPathId:m,props:this.props})),N.createElement(eE,{points:r,mainColor:mE(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(p)&&N.createElement(eE,{points:p,mainColor:mE(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var TE={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Ey,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function NE(e){var t,n=Rv(e,TE),{activeDot:r,animationBegin:a,animationDuration:o,animationEasing:i,connectNulls:s,dot:c,fill:l,fillOpacity:u,hide:d,isAnimationActive:h,legendType:p,stroke:f,xAxisId:m,yAxisId:g}=n,y=uE(n,lE),v=fi(),b=Ym(),{needClip:x}=YC(m,g),w=oi(),{points:k,isRange:S,baseLine:C}=null!==(t=to(t=>sE(t,m,g,w,e.id)))&&void 0!==t?t:{},I=Iv();if("horizontal"!==v&&"vertical"!==v||null==I)return null;if("AreaChart"!==b&&"ComposedChart"!==b)return null;var{height:E,width:T,x:O,y:A}=I;return k&&k.length?N.createElement(EE,fE({},y,{activeDot:r,animationBegin:a,animationDuration:o,animationEasing:i,baseLine:C,connectNulls:s,dot:c,fill:l,fillOpacity:u,height:E,hide:d,layout:v,isAnimationActive:h,isRange:S,legendType:p,needClip:x,points:k,stroke:f,width:T,left:O,top:A,xAxisId:m,yAxisId:g})):null}var OE=(e,t,n,r,a)=>{var o=null!==n&&void 0!==n?n:t;if(Ye(o))return o;var i="horizontal"===e?a:r,s=i.scale.domain();if("number"===i.type){var c=Math.max(s[0],s[1]),l=Math.min(s[0],s[1]);return"dataMin"===o?l:"dataMax"===o||c<0?c:Math.max(Math.min(s[0],s[1]),0)}return"dataMin"===o?s[0]:"dataMax"===o?s[1]:s[0]};function AE(e){var t=Rv(e,TE),n=oi();return N.createElement(bI,{id:t.id,type:"area"},e=>N.createElement(N.Fragment,null,N.createElement(mI,{legendPayload:gE(t)}),N.createElement(GC,{fn:yE,args:t}),N.createElement(xI,{type:"area",id:e,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:Do(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:n,connectNulls:t.connectNulls}),N.createElement(NE,fE({},t,{id:e}))))}var _E=N.memo(AE);function RE(e){var t=Za();return(0,N.useEffect)(()=>{t(ly(e))},[t,e]),null}_E.displayName="Area";var PE=["width","height","layout"];function DE(){return DE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DE.apply(null,arguments)}var ME={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",layout:"radial"},FE=(0,N.forwardRef)(function(e,t){var n,r=Rv(e.categoricalChartProps,ME),{width:a,height:o,layout:i}=r,s=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r,PE);if(!Od(a)||!Od(o))return null;var{chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=e,h={chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return N.createElement(Ny,{preloadedState:{options:h},reduxStoreName:null!==(n=r.id)&&void 0!==n?n:c},N.createElement(Oy,{chartData:r.data}),N.createElement(Ay,{width:a,height:o,layout:i,margin:r.margin}),N.createElement(_y,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),N.createElement(RE,{cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius}),N.createElement(Ov,DE({width:a,height:o},s,{ref:t})))}),LE=["item"],zE={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},BE=(0,N.forwardRef)((e,t)=>{var n=Rv(e,zE);return N.createElement(FE,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:LE,tooltipPayloadSearcher:dr,categoricalChartProps:n,ref:t})}),jE=e=>e.graphicalItems.polarItems,WE=Ka([Rh,Ph],np),UE=Ka([jE,Jh,WE],op),VE=Ka([UE],up),GE=Ka([VE,Ed],hp),HE=Ka([GE,Jh,UE],fp),KE=Ka([GE,Jh,UE],(e,t,n)=>n.length>0?e.flatMap(e=>n.flatMap(n=>{var r;return{value:Eo(e,null!==(r=t.dataKey)&&void 0!==r?r:n.dataKey),errorDomain:[]}})).filter(Boolean):null!=(null===t||void 0===t?void 0:t.dataKey)?e.map(e=>({value:Eo(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]}))),qE=()=>{},XE=Ka([Jh,Kp,qE,KE,qE,pi,Rh],qp),YE=Ka([Jh,pi,GE,HE,nh,Rh,XE],Qp),QE=Ka([YE,Jh,Jp],tf),ZE=Ka([Jh,YE,QE,Rh],rf);function $E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$E(Object(n),!0).forEach(function(t){eT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$E(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tT=Ka([jE,(e,t)=>t],(e,t)=>e.filter(e=>"pie"===e.type).find(e=>e.id===t)),nT=[],rT=(e,t,n)=>0===(null===n||void 0===n?void 0:n.length)?nT:n,aT=Ka([Ed,tT,rT],(e,t,n)=>{var r,{chartData:a}=e;if(null!=t&&((r=null!=(null===t||void 0===t?void 0:t.data)&&t.data.length>0?t.data:a)&&r.length||null==n||(r=n.map(e=>JE(JE({},t.presentationProps),e.props))),null!=r))return r}),oT=Ka([aT,tT,rT],(e,t,n)=>{if(null!=e&&null!=t)return e.map((e,r)=>{var a,o,i=Eo(e,t.nameKey,t.name);return o=null!==n&&void 0!==n&&null!==(a=n[r])&&void 0!==a&&null!==(a=a.props)&&void 0!==a&&a.fill?n[r].props.fill:"object"===typeof e&&null!=e&&"fill"in e?e.fill:t.fill,{value:Vo(i,t.dataKey),color:o,payload:e,type:t.legendType}})}),iT=Ka([aT,tT,rT,ti],(e,t,n,r)=>{if(null!=t&&null!=e)return function(e){var t,n,r,{pieSettings:a,displayedData:o,cells:i,offset:s}=e,{cornerRadius:c,startAngle:l,endAngle:u,dataKey:d,nameKey:h,tooltipType:p}=a,f=Math.abs(a.minAngle),m=vT(l,u),g=Math.abs(m),y=o.length<=1?0:null!==(t=a.paddingAngle)&&void 0!==t?t:0,v=o.filter(e=>0!==Eo(e,d,0)).length,b=g-v*f-(g>=360?v:v-1)*y,x=o.reduce((e,t)=>{var n=Eo(t,d,0);return e+(Ye(n)?n:0)},0);x>0&&(n=o.map((e,t)=>{var n,o=Eo(e,d,0),u=Eo(e,h,t),g=yT(a,s,e),v=(Ye(o)?o:0)/x,w=hT(hT({},e),i&&i[t]&&i[t].props),k=(n=t?r.endAngle+Ke(m)*y*(0!==o?1:0):l)+Ke(m)*((0!==o?f:0)+v*b),S=(n+k)/2,C=(g.innerRadius+g.outerRadius)/2,I=[{name:u,value:o,payload:w,dataKey:d,type:p}],E=yo(g.cx,g.cy,C,S);return r=hT(hT(hT(hT({},a.presentationProps),{},{percent:v,cornerRadius:c,name:u,tooltipPayload:I,midAngle:S,middleRadius:C,tooltipPosition:E},w),g),{},{value:o,startAngle:n,endAngle:k,payload:w,paddingAngle:Ke(m)*y})}));return n}({offset:r,pieSettings:t,displayedData:e,cells:n})}),sT=["onMouseEnter","onClick","onMouseLeave"],cT=["id"],lT=["id"];function uT(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function dT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dT(Object(n),!0).forEach(function(t){pT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fT(){return fT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fT.apply(null,arguments)}function mT(e){var t=(0,N.useMemo)(()=>qy(e.children,ES),[e.children]),n=to(n=>oT(n,e.id,t));return null==n?null:N.createElement(gI,{legendPayload:n})}function gT(e){var{dataKey:t,nameKey:n,sectors:r,stroke:a,strokeWidth:o,fill:i,name:s,hide:c,tooltipType:l}=e;return{dataDefinedOnItem:r.map(e=>e.tooltipPayload),positions:r.map(e=>e.tooltipPosition),settings:{stroke:a,strokeWidth:o,fill:i,dataKey:t,nameKey:n,name:Vo(s,t),hide:c,type:l,color:i,unit:""}}}var yT=(e,t,n)=>{var{top:r,left:a,width:o,height:i}=t,s=vo(o,i),c=a+Je(e.cx,o,o/2),l=r+Je(e.cy,i,i/2),u=Je(e.innerRadius,s,0),d=((e,t,n)=>Je("function"===typeof t?t(e):t,n,.8*n))(n,e.outerRadius,s);return{cx:c,cy:l,innerRadius:u,outerRadius:d,maxRadius:e.maxRadius||Math.sqrt(o*o+i*i)/2}},vT=(e,t)=>Ke(t-e)*Math.min(Math.abs(t-e),360);function bT(e){var{sectors:t,props:n,showLabels:r}=e,{label:a,labelLine:o,dataKey:i}=n;if(!r||!a||!t)return null;var s=Uy(n),c=Yy(a,!1),l=Yy(o,!1),u="object"===typeof a&&"offsetRadius"in a&&"number"===typeof a.offsetRadius&&a.offsetRadius||20,d=t.map((e,t)=>{var n,r,d=(e.startAngle+e.endAngle)/2,h=yo(e.cx,e.cy,e.outerRadius+u,d),p=hT(hT(hT(hT({},s),e),{},{stroke:"none"},c),{},{index:t,textAnchor:(n=h.x,r=e.cx,n>r?"start":n<r?"end":"middle")},h),f=hT(hT(hT(hT({},s),e),{},{fill:"none",stroke:e.fill},l),{},{index:t,points:[yo(e.cx,e.cy,e.outerRadius,d),h],key:"line"});return N.createElement(sb,{key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(t)},o&&((e,t)=>{if(N.isValidElement(e))return N.cloneElement(e,t);if("function"===typeof e)return e(t);var n=We("recharts-pie-label-line","boolean"!==typeof e?e.className:"");return N.createElement(fk,fT({},t,{type:"linear",className:n}))})(o,f),((e,t,n)=>{if(N.isValidElement(e))return N.cloneElement(e,t);var r=n;if("function"===typeof e&&(r=e(t),N.isValidElement(r)))return r;var a,o=We("recharts-pie-label-text",(a=e)&&"object"===typeof a&&"className"in a&&"string"===typeof a.className?a.className:"");return N.createElement(Ob,fT({},t,{alignmentBaseline:"middle",className:o}),r)})(a,p,Eo(e,i)))});return N.createElement(sb,{className:"recharts-pie-labels"},d)}function xT(e){var{sectors:t,props:n,showLabels:r}=e,{label:a}=n;return"object"===typeof a&&null!=a&&"position"in a?N.createElement(BS,{label:a}):N.createElement(bT,{sectors:t,props:n,showLabels:r})}function wT(e){var{sectors:t,activeShape:n,inactiveShape:r,allOtherPieProps:a}=e,o=to(jm),{onMouseEnter:i,onClick:s,onMouseLeave:c}=a,l=uT(a,sT),u=WC(i,a.dataKey),d=UC(c),h=VC(s,a.dataKey);return null==t||0===t.length?null:N.createElement(N.Fragment,null,t.map((e,i)=>{if(0===(null===e||void 0===e?void 0:e.startAngle)&&0===(null===e||void 0===e?void 0:e.endAngle)&&1!==t.length)return null;var s=n&&String(i)===o,c=s?n:o?r:null,p=hT(hT({},e),{},{stroke:e.stroke,tabIndex:-1,[Qo]:i,[Zo]:a.dataKey});return N.createElement(sb,fT({tabIndex:-1,className:"recharts-pie-sector"},By(l,e,i),{onMouseEnter:u(e,i),onMouseLeave:d(e,i),onClick:h(e,i),key:"sector-".concat(null===e||void 0===e?void 0:e.startAngle,"-").concat(null===e||void 0===e?void 0:e.endAngle,"-").concat(e.midAngle,"-").concat(i)}),N.createElement(RC,fT({option:c,isActive:s,shapeType:"sector"},p)))}))}function kT(e){var{showLabels:t,sectors:n,children:r}=e,a=(0,N.useMemo)(()=>t&&n?n.map(e=>({value:e.value,payload:e.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:e.cx,cy:e.cy,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clockWise:!1},fill:e.fill})):[],[n,t]);return N.createElement(LS,{value:t?a:void 0},r)}function ST(e){var{props:t,previousSectorsRef:n}=e,{sectors:r,isAnimationActive:a,animationBegin:o,animationDuration:i,animationEasing:s,activeShape:c,inactiveShape:l,onAnimationStart:u,onAnimationEnd:d}=t,h=Xk(t,"recharts-pie-"),p=n.current,[f,m]=(0,N.useState)(!1),g=(0,N.useCallback)(()=>{"function"===typeof d&&d(),m(!1)},[d]),y=(0,N.useCallback)(()=>{"function"===typeof u&&u(),m(!0)},[u]);return N.createElement(kT,{showLabels:!f,sectors:r},N.createElement(qk,{animationId:h,begin:o,duration:i,isActive:a,easing:s,onAnimationStart:y,onAnimationEnd:g,key:h},e=>{var a=[],o=r&&r[0],i=null===o||void 0===o?void 0:o.startAngle;return null===r||void 0===r||r.forEach((t,n)=>{var r=p&&p[n],o=n>0?He()(t,"paddingAngle",0):0;if(r){var s=nt(r.endAngle-r.startAngle,t.endAngle-t.startAngle,e),c=hT(hT({},t),{},{startAngle:i+o,endAngle:i+s+o});a.push(c),i=c.endAngle}else{var{endAngle:l,startAngle:u}=t,d=nt(0,l-u,e),h=hT(hT({},t),{},{startAngle:i+o,endAngle:i+d+o});a.push(h),i=h.endAngle}}),n.current=a,N.createElement(sb,null,N.createElement(wT,{sectors:a,activeShape:c,inactiveShape:l,allOtherPieProps:t}))}),N.createElement(xT,{showLabels:!f,sectors:r,props:t}),t.children)}var CT={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ey,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function IT(e){var{id:t}=e,n=uT(e,cT),{hide:r,className:a,rootTabIndex:o}=e,i=(0,N.useMemo)(()=>qy(e.children,ES),[e.children]),s=to(e=>iT(e,t,i)),c=(0,N.useRef)(null),l=We("recharts-pie",a);return r||null==s?(c.current=null,N.createElement(sb,{tabIndex:o,className:l})):N.createElement(N.Fragment,null,N.createElement(GC,{fn:gT,args:hT(hT({},e),{},{sectors:s})}),N.createElement(sb,{tabIndex:o,className:l},N.createElement(ST,{props:hT(hT({},n),{},{sectors:s}),previousSectorsRef:c})))}function ET(e){var t=Rv(e,CT),{id:n}=t,r=uT(t,lT),a=Uy(r);return N.createElement(bI,{id:n,type:"pie"},e=>N.createElement(N.Fragment,null,N.createElement(wI,{type:"pie",id:e,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),N.createElement(mT,fT({},r,{id:e})),N.createElement(IT,fT({},r,{id:e}))))}ET.displayName="Pie";var TT=["axis"],NT=(0,N.forwardRef)((e,t)=>N.createElement(Fv,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:TT,tooltipPayloadSearcher:dr,categoricalChartProps:e,ref:t})),OT=(e,t,n,r)=>Lf(e,"xAxis",t,r),AT=(e,t,n,r)=>Ff(e,"xAxis",t,r),_T=(e,t,n,r)=>Lf(e,"yAxis",n,r),RT=(e,t,n,r)=>Ff(e,"yAxis",n,r),PT=Ka([pi,OT,_T,AT,RT],(e,t,n,r,a)=>To(e,"xAxis")?Wo(t,r,!1):Wo(n,a,!1));function DT(e){return"line"===e.type}var MT=Ka([rp,(e,t,n,r,a)=>a],(e,t)=>e.filter(DT).find(e=>e.id===t)),FT=Ka([pi,OT,_T,AT,RT,MT,PT,Td],(e,t,n,r,a,o,i,s)=>{var{chartData:c,dataStartIndex:l,dataEndIndex:u}=s;if(null!=o&&null!=t&&null!=n&&null!=r&&null!=a&&0!==r.length&&0!==a.length&&null!=i){var d,{dataKey:h,data:p}=o;if(null!=(d=null!=p&&p.length>0?p:null===c||void 0===c?void 0:c.slice(l,u+1)))return function(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:o,dataKey:i,bandSize:s,displayedData:c}=e;return c.map((e,c)=>{var l=Eo(e,i);if("horizontal"===t)return{x:Mo({axis:n,ticks:a,bandSize:s,entry:e,index:c}),y:at(l)?null:r.scale(l),value:l,payload:e};var u=at(l)?null:n.scale(l),d=Mo({axis:r,ticks:o,bandSize:s,entry:e,index:c});return null==u||null==d?null:{x:u,y:d,value:l,payload:e}}).filter(Boolean)}({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataKey:h,bandSize:i,displayedData:d})}}),LT=["id"],zT=["type","layout","connectNulls","needClip"],BT=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function jT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function WT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jT(Object(n),!0).forEach(function(t){UT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function UT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VT(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function GT(){return GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GT.apply(null,arguments)}var HT=e=>{var{dataKey:t,name:n,stroke:r,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:r,value:Vo(n,t),payload:e}]};function KT(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:o,name:i,hide:s,unit:c}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:o,dataKey:t,nameKey:void 0,name:Vo(i,t),hide:s,type:e.tooltipType,color:e.stroke,unit:c}}}var qT=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function XT(e,t){for(var n=e.length%2!==0?[...e,0]:e,r=[],a=0;a<t;++a)r=[...r,...n];return r}function YT(e){var{clipPathId:t,points:n,props:r}=e,{dot:a,dataKey:o,needClip:i}=r;if(!function(e,t){return null!=e&&(!!t||1===e.length)}(n,a))return null;var{id:s}=r,c=VT(r,LT),l=Xy(a),u=Uy(c),d=Yy(a,!0),h=n.map((e,t)=>{var r=WT(WT(WT({key:"dot-".concat(t),r:3},u),d),{},{index:t,cx:e.x,cy:e.y,dataKey:o,value:e.value,payload:e.payload,points:n});return function(e,t){var n;if(N.isValidElement(e))n=N.cloneElement(e,t);else if("function"===typeof e)n=e(t);else{var r=We("recharts-line-dot","boolean"!==typeof e?e.className:"");n=N.createElement(QI,GT({},t,{className:r}))}return n}(a,r)}),p={clipPath:i?"url(#clipPath-".concat(l?"":"dots-").concat(t,")"):void 0};return N.createElement(sb,GT({className:"recharts-line-dots",key:"dots"},p),h)}function QT(e){var{showLabels:t,children:n,points:r}=e,a=(0,N.useMemo)(()=>null===r||void 0===r?void 0:r.map(e=>{var t={x:e.x,y:e.y,width:0,height:0};return WT(WT({},t),{},{value:e.value,payload:e.payload,viewBox:t,parentViewBox:void 0,fill:void 0})}),[r]);return N.createElement(MS,{value:t?a:null},n)}function ZT(e){var{clipPathId:t,pathRef:n,points:r,strokeDasharray:a,props:o}=e,{type:i,layout:s,connectNulls:c,needClip:l}=o,u=VT(o,zT),d=WT(WT({},Yy(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(t,")"):void 0,points:r,type:i,layout:s,connectNulls:c,strokeDasharray:null!==a&&void 0!==a?a:o.strokeDasharray});return N.createElement(N.Fragment,null,(null===r||void 0===r?void 0:r.length)>1&&N.createElement(fk,GT({},d,{pathRef:n})),N.createElement(YT,{points:r,clipPathId:t,props:o}))}function $T(e){var{clipPathId:t,props:n,pathRef:r,previousPointsRef:a,longestAnimatedLengthRef:o}=e,{points:i,strokeDasharray:s,isAnimationActive:c,animationBegin:l,animationDuration:u,animationEasing:d,animateNewValues:h,width:p,height:f,onAnimationEnd:m,onAnimationStart:g}=n,y=a.current,v=Xk(n,"recharts-line-"),[b,x]=(0,N.useState)(!1),w=!b,k=(0,N.useCallback)(()=>{"function"===typeof m&&m(),x(!1)},[m]),S=(0,N.useCallback)(()=>{"function"===typeof g&&g(),x(!0)},[g]),C=function(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}(r.current),I=o.current;return N.createElement(QT,{points:i,showLabels:w},n.children,N.createElement(qk,{animationId:v,begin:l,duration:u,isActive:c,easing:d,onAnimationEnd:k,onAnimationStart:S,key:v},e=>{var l,u=nt(I,C+I,e),d=Math.min(u,C);if(c)if(s){var m="".concat(s).split(/[,\s]+/gim).map(e=>parseFloat(e));l=((e,t,n)=>{var r=n.reduce((e,t)=>e+t);if(!r)return qT(t,e);for(var a=Math.floor(e/r),o=e%r,i=t-e,s=[],c=0,l=0;c<n.length;l+=n[c],++c)if(l+n[c]>o){s=[...n.slice(0,c),o-l];break}var u=s.length%2===0?[0,i]:[i];return[...XT(n,a),...s,...u].map(e=>"".concat(e,"px")).join(", ")})(d,C,m)}else l=qT(C,d);else l=null==s?void 0:String(s);if(y){var g=y.length/i.length,v=1===e?i:i.map((t,n)=>{var r=Math.floor(n*g);if(y[r]){var a=y[r];return WT(WT({},t),{},{x:nt(a.x,t.x,e),y:nt(a.y,t.y,e)})}return WT(WT({},t),{},h?{x:nt(2*p,t.x,e),y:nt(f/2,t.y,e)}:{x:t.x,y:t.y})});return a.current=v,N.createElement(ZT,{props:n,points:v,clipPathId:t,pathRef:r,strokeDasharray:l})}return e>0&&C>0&&(a.current=i,o.current=d),N.createElement(ZT,{props:n,points:i,clipPathId:t,pathRef:r,strokeDasharray:l})}),N.createElement(BS,{label:n.label}))}function JT(e){var{clipPathId:t,props:n}=e,r=(0,N.useRef)(null),a=(0,N.useRef)(0),o=(0,N.useRef)(null);return N.createElement($T,{props:n,clipPathId:t,previousPointsRef:r,longestAnimatedLengthRef:a,pathRef:o})}var eN=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Eo(e.payload,t)});class tN extends N.Component{render(){var e,{hide:t,dot:n,points:r,className:a,xAxisId:o,yAxisId:i,top:s,left:c,width:l,height:u,id:d,needClip:h}=this.props;if(t)return null;var p=We("recharts-line",a),f=d,{r:m=3,strokeWidth:g=2}=null!==(e=Yy(n,!1))&&void 0!==e?e:{r:3,strokeWidth:2},y=Xy(n),v=2*m+g;return N.createElement(N.Fragment,null,N.createElement(sb,{className:p},h&&N.createElement("defs",null,N.createElement(QC,{clipPathId:f,xAxisId:o,yAxisId:i}),!y&&N.createElement("clipPath",{id:"clipPath-dots-".concat(f)},N.createElement("rect",{x:c-v/2,y:s-v/2,width:l+v,height:u+v}))),N.createElement(XC,{xAxisId:o,yAxisId:i,data:r,dataPointFormatter:eN,errorBarOffset:0},N.createElement(JT,{props:this.props,clipPathId:f}))),N.createElement(eE,{activeDot:this.props.activeDot,points:r,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var nN={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ey,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function rN(e){var t=Rv(e,nN),{activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:o,animationEasing:i,connectNulls:s,dot:c,hide:l,isAnimationActive:u,label:d,legendType:h,xAxisId:p,yAxisId:f,id:m}=t,g=VT(t,BT),{needClip:y}=YC(p,f),v=Iv(),b=fi(),x=oi(),w=to(e=>FT(e,p,f,x,m));if("horizontal"!==b&&"vertical"!==b||null==w||null==v)return null;var{height:k,width:S,x:C,y:I}=v;return N.createElement(tN,GT({},g,{id:m,connectNulls:s,dot:c,activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:o,animationEasing:i,isAnimationActive:u,hide:l,label:d,legendType:h,xAxisId:p,yAxisId:f,points:w,layout:b,height:k,width:S,left:C,top:I,needClip:y}))}function aN(e){var t=Rv(e,nN),n=oi();return N.createElement(bI,{id:t.id,type:"line"},e=>N.createElement(N.Fragment,null,N.createElement(mI,{legendPayload:HT(t)}),N.createElement(GC,{fn:KT,args:t}),N.createElement(xI,{type:"line",id:e,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),N.createElement(rN,GT({},t,{id:e}))))}var oN=N.memo(aN);oN.displayName="Line";var iN=["axis","item"],sN={layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},cN=(0,N.forwardRef)((e,t)=>{var n=Rv(e,sN);return N.createElement(FE,{chartName:"RadialBarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:iN,tooltipPayloadSearcher:dr,categoricalChartProps:n,ref:t})});function lN(){return lN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lN.apply(null,arguments)}function uN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uN(Object(n),!0).forEach(function(t){hN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pN(e){return"string"===typeof e?parseInt(e,10):e}function fN(e,t){var n="".concat(t.cx||e.cx),r=Number(n),a="".concat(t.cy||e.cy),o=Number(a);return dN(dN(dN({},t),e),{},{cx:r,cy:o})}function mN(e){return N.createElement(RC,lN({shapeType:"sector",propTransformer:fN},e))}var gN=(e,t,n)=>{switch(t){case"angleAxis":return wh(e,n);case"radiusAxis":return kh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},yN=(e,t,n)=>{switch(t){case"angleAxis":return Nh(e,n);case"radiusAxis":return Ah(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},vN=Ka([gN,Jp,ZE,yN],ef),bN=Ka([pi,HE,ep,Rh],Af),xN=Ka([pi,gN,Jp,vN,QE,yN,Of,bN,Rh],Pf),wN=Ka([pi,gN,vN,yN,Of,bN,Rh],Mf);function kN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function SN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kN(Object(n),!0).forEach(function(t){CN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function CN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var IN=Ka([(e,t)=>kh(e,t),(e,t)=>vN(e,"radiusAxis",t)],(e,t)=>{if(null!=e&&null!=t)return SN(SN({},e),{},{scale:t})}),EN=(e,t,n,r)=>wN(e,"radiusAxis",t,r),TN=Ka([(e,t,n)=>wh(e,n),(e,t,n)=>vN(e,"angleAxis",n)],(e,t)=>{if(null!=e&&null!=t)return SN(SN({},e),{},{scale:t})}),NN=(e,t,n,r)=>xN(e,"angleAxis",n,r),ON=Ka([jE,(e,t,n,r)=>r],(e,t)=>{if(e.some(e=>"radialBar"===e.type&&t.dataKey===e.dataKey&&t.stackId===e.stackId))return t}),AN=Ka([pi,IN,EN,TN,NN],(e,t,n,r,a)=>To(e,"radiusAxis")?Wo(t,n,!1):Wo(r,a,!1)),_N=Ka([TN,IN,pi],(e,t,n)=>{var r="radial"===n?e:t;if(null!=r&&null!=r.scale)return Lo({numericAxis:r})}),RN=(e,t,n,r,a)=>r.maxBarSize,PN=Ka([pi,jE,(e,t,n,r,a)=>n,(e,t,n,r,a)=>t],(e,t,n,r)=>t.filter(t=>"centric"===e?t.angleAxisId===n:t.radiusAxisId===r).filter(e=>!1===e.hide).filter(e=>"radialBar"===e.type)),DN=Ka([PN,th,()=>{}],aI),MN=Ka([pi,$d,TN,NN,IN,EN,RN],(e,t,n,r,a,o,i)=>{var s,c,l,u,d=at(i)?t:i;return"centric"===e?null!==(l=null!==(u=Wo(n,r,!0))&&void 0!==u?u:d)&&void 0!==l?l:0:null!==(s=null!==(c=Wo(a,o,!0))&&void 0!==c?c:d)&&void 0!==s?s:0}),FN=Ka([DN,$d,Jd,eh,MN,AN,RN],cI),LN=Ka([FN,ON],(e,t)=>{if(null!=e&&null!=t){var n=e.find(e=>e.stackId===t.stackId&&null!=t.dataKey&&e.dataKeys.includes(t.dataKey));if(null!=n)return n.position}}),zN=Ka([UE],e=>e.filter(e=>"radialBar"===e.type).filter(jh)),BN=Ka([zN,Ed,Lh],Bh),jN=Ka([BN,zN,nh],xp),WN=Ka([(e,t,n)=>"centric"===pi(e)?jN(e,"radiusAxis",t):jN(e,"angleAxis",n),ON],dI),UN=Ka([TN,NN,IN,EN,Id,ON,AN,pi,_N,_h,(e,t,n,r,a)=>a,LN,WN],(e,t,n,r,a,o,i,s,c,l,u,d,h)=>{var{chartData:p,dataStartIndex:f,dataEndIndex:m}=a;if(null==o||null==n||null==e||null==p||null==i||null==d||"centric"!==s&&"radial"!==s||null==r)return[];var{dataKey:g,minPointSize:y}=o,{cx:v,cy:b,startAngle:x,endAngle:w}=l;return function(e){var{displayedData:t,stackedData:n,dataStartIndex:r,stackedDomain:a,dataKey:o,baseValue:i,layout:s,radiusAxis:c,radiusAxisTicks:l,bandSize:u,pos:d,angleAxis:h,minPointSize:p,cx:f,cy:m,angleAxisTicks:g,cells:y,startAngle:v,endAngle:b}=e;return(null!==t&&void 0!==t?t:[]).map((e,t)=>{var x,w,k,S,C,I;if(n?x=_o(n[r+t],a):(x=Eo(e,o),Array.isArray(x)||(x=[i,x])),"radial"===s){w=Fo({axis:c,ticks:l,bandSize:u,offset:d.offset,entry:e,index:t}),C=h.scale(x[1]),S=h.scale(x[0]),k=(null!==w&&void 0!==w?w:0)+d.size;var E=C-S;if(Math.abs(p)>0&&Math.abs(E)<Math.abs(p))C+=Ke(E||p)*(Math.abs(p)-Math.abs(E));I={background:{cx:f,cy:m,innerRadius:w,outerRadius:k,startAngle:v,endAngle:b}}}else{w=c.scale(x[0]),k=c.scale(x[1]),C=(null!==(S=Fo({axis:h,ticks:g,bandSize:u,offset:d.offset,entry:e,index:t}))&&void 0!==S?S:0)+d.size;var T=k-w;if(Math.abs(p)>0&&Math.abs(T)<Math.abs(p))k+=Ke(T||p)*(Math.abs(p)-Math.abs(T))}return YN(YN(YN({},e),I),{},{payload:e,value:n?x:x[1],cx:f,cy:m,innerRadius:w,outerRadius:k,startAngle:S,endAngle:C},y&&y[t]&&y[t].props)})}({angleAxis:e,angleAxisTicks:t,bandSize:i,baseValue:c,cells:u,cx:v,cy:b,dataKey:g,dataStartIndex:f,displayedData:p.slice(f,m+1),endAngle:w,layout:s,minPointSize:y,pos:d,radiusAxis:n,radiusAxisTicks:r,stackedData:h,stackedDomain:h?("centric"===s?n:e).scale.domain():null,startAngle:x})}),VN=Ka([Ed,(e,t)=>t],(e,t)=>{var{chartData:n,dataStartIndex:r,dataEndIndex:a}=e;if(null==n)return[];var o=n.slice(r,a+1);return 0===o.length?[]:o.map(e=>({type:t,value:e.name,color:e.fill,payload:e}))}),GN=["shape","activeShape","cornerRadius","id"],HN=["onMouseEnter","onClick","onMouseLeave"],KN=["value","background"];function qN(){return qN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qN.apply(null,arguments)}function XN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function YN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?XN(Object(n),!0).forEach(function(t){QN(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function QN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZN(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var $N=[];function JN(e){var{showLabels:t,sectors:n,children:r}=e,a=n.map(e=>({value:e.value,payload:e.payload,parentViewBox:void 0,clockWise:!1,viewBox:{cx:e.cx,cy:e.cy,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clockWise:!1},fill:e.fill}));return N.createElement(LS,{value:t?a:null},r)}function eO(e){var{sectors:t,allOtherRadialBarProps:n,showLabels:r}=e,{shape:a,activeShape:o,cornerRadius:i,id:s}=n,c=ZN(n,GN),l=Uy(c),u=to(jm),{onMouseEnter:d,onClick:h,onMouseLeave:p}=n,f=ZN(n,HN),m=WC(d,n.dataKey),g=UC(p),y=VC(h,n.dataKey);return null==t?null:N.createElement(JN,{showLabels:r,sectors:t},t.map((e,t)=>{var n=o&&u===String(t),r=m(e,t),s=g(e,t),d=y(e,t),h=YN(YN(YN(YN({},l),{},{cornerRadius:pN(i)},e),By(f,e,t)),{},{onMouseEnter:r,onMouseLeave:s,onClick:d,key:"sector-".concat(t),className:"recharts-radial-bar-sector ".concat(e.className),forceCornerRadius:c.forceCornerRadius,cornerIsExternal:c.cornerIsExternal,isActive:n,option:n?o:a});return N.createElement(mN,h)}),N.createElement(BS,{label:n.label}),n.children)}function tO(e){var{props:t,previousSectorsRef:n}=e,{data:r,isAnimationActive:a,animationBegin:o,animationDuration:i,animationEasing:s,onAnimationEnd:c,onAnimationStart:l}=t,u=Xk(t,"recharts-radialbar-"),d=n.current,[h,p]=(0,N.useState)(!1),f=(0,N.useCallback)(()=>{"function"===typeof c&&c(),p(!1)},[c]),m=(0,N.useCallback)(()=>{"function"===typeof l&&l(),p(!0)},[l]);return N.createElement(qk,{animationId:u,begin:o,duration:i,isActive:a,easing:s,onAnimationStart:m,onAnimationEnd:f,key:u},e=>{var a=1===e?r:(null!==r&&void 0!==r?r:$N).map((t,n)=>{var r=d&&d[n];if(r){var a=tt(r.startAngle,t.startAngle),o=tt(r.endAngle,t.endAngle);return YN(YN({},t),{},{startAngle:a(e),endAngle:o(e)})}var{endAngle:i,startAngle:s}=t,c=tt(s,i);return YN(YN({},t),{},{endAngle:c(e)})});return e>0&&(n.current=null!==a&&void 0!==a?a:null),N.createElement(sb,null,N.createElement(eO,{sectors:null!==a&&void 0!==a?a:$N,allOtherRadialBarProps:t,showLabels:!h}))})}function nO(e){var t=(0,N.useRef)(null);return N.createElement(tO,{props:e,previousSectorsRef:t})}function rO(e){var t=to(t=>VN(t,e.legendType));return N.createElement(gI,{legendPayload:null!==t&&void 0!==t?t:[]})}function aO(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,name:o,hide:i,fill:s,tooltipType:c}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:s,nameKey:void 0,dataKey:t,name:Vo(o,t),hide:i,type:c,color:s,unit:""}}}class oO extends N.PureComponent{renderBackground(e){if(null==e)return null;var{cornerRadius:t}=this.props,n=Yy(this.props.background,!1);return e.map((e,r)=>{var{value:a,background:o}=e,i=ZN(e,KN);if(!o)return null;var s=YN(YN(YN(YN(YN({cornerRadius:pN(t)},i),{},{fill:"#eee"},o),n),By(this.props,e,r)),{},{index:r,key:"sector-".concat(r),className:We("recharts-radial-bar-background-sector",null===n||void 0===n?void 0:n.className),option:o,isActive:!1});return N.createElement(mN,s)})}render(){var{hide:e,data:t,className:n,background:r}=this.props;if(e)return null;var a=We("recharts-area",n);return N.createElement(sb,{className:a},r&&N.createElement(sb,{className:"recharts-radial-bar-background"},this.renderBackground(t)),N.createElement(sb,{className:"recharts-radial-bar-sectors"},N.createElement(nO,this.props)))}}function iO(e){var t,n=qy(e.children,ES),r={data:void 0,hide:!1,id:e.id,dataKey:e.dataKey,minPointSize:e.minPointSize,stackId:Do(e.stackId),maxBarSize:e.maxBarSize,barSize:e.barSize,type:"radialBar",angleAxisId:e.angleAxisId,radiusAxisId:e.radiusAxisId},a=null!==(t=to(t=>UN(t,e.radiusAxisId,e.angleAxisId,r,n)))&&void 0!==t?t:$N;return N.createElement(N.Fragment,null,N.createElement(GC,{fn:aO,args:YN(YN({},e),{},{data:a})}),N.createElement(oO,qN({},e,{data:a})))}var sO={angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!Ey,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1};class cO extends N.PureComponent{render(){return N.createElement(bI,{id:this.props.id,type:"radialBar"},e=>{var t,n,r;return N.createElement(N.Fragment,null,N.createElement(wI,{type:"radialBar",id:e,data:void 0,dataKey:this.props.dataKey,hide:null!==(t=this.props.hide)&&void 0!==t?t:sO.hide,angleAxisId:null!==(n=this.props.angleAxisId)&&void 0!==n?n:sO.angleAxisId,radiusAxisId:null!==(r=this.props.radiusAxisId)&&void 0!==r?r:sO.radiusAxisId,stackId:Do(this.props.stackId),barSize:this.props.barSize,minPointSize:this.props.minPointSize,maxBarSize:this.props.maxBarSize}),N.createElement(rO,this.props),N.createElement(iO,qN({},this.props,{id:e})))})}}QN(cO,"displayName","RadialBar"),QN(cO,"defaultProps",sO);const lO=(e,t)=>"var(".concat(e,", ").concat(t,")"),uO=[{day:"Mon",breaks:5,target:5},{day:"Tue",breaks:3,target:5},{day:"Wed",breaks:7,target:5},{day:"Thu",breaks:4,target:5},{day:"Fri",breaks:6,target:5},{day:"Sat",breaks:2,target:5},{day:"Sun",breaks:1,target:5}],dO=[{month:"Jan",score:65},{month:"Feb",score:71},{month:"Mar",score:68},{month:"Apr",score:78},{month:"May",score:82},{month:"Jun",score:85}],hO=[{name:"Posture",value:85,color:lO("--chart-1","#115ea3")},{name:"Monitor",value:92,color:lO("--chart-2","#0f6cbd")},{name:"Lighting",value:78,color:lO("--chart-3","#3b88d4")},{name:"Breaks",value:66,color:lO("--chart-4","#6cb8f6")}],pO=[{time:"9AM",activity:90},{time:"10AM",activity:85},{time:"11AM",activity:75},{time:"12PM",activity:20},{time:"1PM",activity:95},{time:"2PM",activity:88},{time:"3PM",activity:70},{time:"4PM",activity:82},{time:"5PM",activity:60}];function fO(){const{isDark:e}=Be(),t=lO("--neutral-text",e?"#ffffff":"#201f1e"),n=lO("--neutral-border",e?"#3b3a39":"#d1d1d1"),r=lO("--chart-2","#0f6cbd"),a=lO("--chart-5","#9fd5fa");return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:16,padding:20,boxShadow:"var(--shadow-md)"},children:[(0,F.jsx)("h3",{style:{color:"var(--color-primary)",marginBottom:16,fontSize:18,fontWeight:600},children:"Weekly Break Pattern"}),(0,F.jsx)(ut,{width:"100%",height:200,children:(0,F.jsxs)(zv,{data:uO,children:[(0,F.jsx)(Ex,{strokeDasharray:"3 3",stroke:n}),(0,F.jsx)(zx,{dataKey:"day",stroke:t,fontSize:12}),(0,F.jsx)(Qx,{stroke:t,fontSize:12}),(0,F.jsx)(IS,{contentStyle:{background:"var(--color-surface-alt)",border:"1px solid var(--color-primary)",borderRadius:8,color:t}}),(0,F.jsx)(KI,{dataKey:"breaks",fill:r,radius:4}),(0,F.jsx)(KI,{dataKey:"target",fill:a,radius:4})]})})]})}function mO(){const{isDark:e}=Be(),t=lO("--neutral-text",e?"#ffffff":"#201f1e"),n=lO("--neutral-border",e?"#3b3a39":"#d1d1d1"),r=lO("--chart-1","#115ea3");return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:16,padding:20,boxShadow:"var(--shadow-md)"},children:[(0,F.jsx)("h3",{style:{color:"var(--color-primary)",marginBottom:16,fontSize:18,fontWeight:600},children:"6-Month Progress Trend"}),(0,F.jsx)(ut,{width:"100%",height:200,children:(0,F.jsxs)(XI,{data:dO,children:[(0,F.jsx)(Ex,{strokeDasharray:"3 3",stroke:n}),(0,F.jsx)(zx,{dataKey:"month",stroke:t,fontSize:12}),(0,F.jsx)(Qx,{stroke:t,fontSize:12}),(0,F.jsx)(IS,{contentStyle:{background:"var(--color-surface-alt)",border:"1px solid var(--color-primary)",borderRadius:8,color:t}}),(0,F.jsx)(_E,{type:"monotone",dataKey:"score",stroke:r,fill:"url(#colorGradient)",strokeWidth:3}),(0,F.jsx)("defs",{children:(0,F.jsxs)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,F.jsx)("stop",{offset:"5%",stopColor:r,stopOpacity:.8}),(0,F.jsx)("stop",{offset:"95%",stopColor:r,stopOpacity:.1})]})})]})})]})}function gO(){return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:16,padding:20,boxShadow:"var(--shadow-md)"},children:[(0,F.jsx)("h3",{style:{color:"var(--color-primary)",marginBottom:16,fontSize:18,fontWeight:600},children:"Ergonomic Categories"}),(0,F.jsx)(ut,{width:"100%",height:200,children:(0,F.jsxs)(BE,{children:[(0,F.jsx)(ET,{data:hO,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:hO.map((e,t)=>(0,F.jsx)(ES,{fill:e.color},"cell-".concat(t)))}),(0,F.jsx)(IS,{contentStyle:{background:"var(--color-surface-alt)",border:"1px solid var(--color-primary)",borderRadius:8,color:"var(--color-text)"}})]})}),(0,F.jsx)("div",{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:12,marginTop:12},children:hO.map((e,t)=>(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,F.jsx)("div",{style:{width:12,height:12,borderRadius:"50%",background:e.color}}),(0,F.jsxs)("span",{style:{fontSize:12,color:"var(--color-text-soft)"},children:[e.name,": ",e.value,"%"]})]},t))})]})}function yO(){const{isDark:e}=Be(),t=lO("--neutral-text",e?"#ffffff":"#201f1e"),n=lO("--neutral-border",e?"#3b3a39":"#d1d1d1"),r=lO("--chart-2","#0f6cbd"),a=lO("--chart-3","#3b88d4");return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:16,padding:20,boxShadow:"var(--shadow-md)"},children:[(0,F.jsx)("h3",{style:{color:"var(--color-primary)",marginBottom:16,fontSize:18,fontWeight:600},children:"Today's Activity Level"}),(0,F.jsx)(ut,{width:"100%",height:180,children:(0,F.jsxs)(NT,{data:pO,children:[(0,F.jsx)(Ex,{strokeDasharray:"3 3",stroke:n}),(0,F.jsx)(zx,{dataKey:"time",stroke:t,fontSize:12}),(0,F.jsx)(Qx,{stroke:t,fontSize:12}),(0,F.jsx)(IS,{contentStyle:{background:"var(--color-surface-alt)",border:"1px solid var(--color-primary)",borderRadius:8,color:t}}),(0,F.jsx)(oN,{type:"monotone",dataKey:"activity",stroke:r,strokeWidth:3,dot:{fill:r,strokeWidth:2,r:4},activeDot:{r:6,fill:a}})]})})]})}function vO(e){let{score:t=82}=e;const n=lO("--chart-1","#115ea3"),r=[{name:"Wellness Score",value:t,fill:n}];return(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:16,padding:20,boxShadow:"var(--shadow-md)",textAlign:"center"},children:[(0,F.jsx)("h3",{style:{color:"var(--color-primary)",marginBottom:16,fontSize:18,fontWeight:600},children:"Overall Wellness Score"}),(0,F.jsxs)("div",{style:{position:"relative",height:200},children:[(0,F.jsx)(ut,{width:"100%",height:200,children:(0,F.jsx)(cN,{cx:"50%",cy:"50%",innerRadius:"60%",outerRadius:"90%",data:r,children:(0,F.jsx)(cO,{dataKey:"value",cornerRadius:10,fill:n})})}),(0,F.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,F.jsxs)("div",{style:{fontSize:32,fontWeight:700,color:"var(--color-primary)",lineHeight:1},children:[t,"%"]}),(0,F.jsx)("div",{style:{fontSize:14,color:"var(--color-text-soft)",marginTop:4,lineHeight:1},children:"Excellent"})]})]})]})}class bO{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class xO{refCount(e){return wO("refCount")}incRef(e){return wO("incRef")}timerAvailable(){return!0}time(e){return wO("time")}read(e){return wO("read")}readSync(e){return wO("readSync")}readToGPU(e,t){return wO("readToGPU")}numDataIds(){return wO("numDataIds")}disposeData(e,t){return wO("disposeData")}write(e,t,n){return wO("write")}move(e,t,n,r,a){return wO("move")}createTensorFromGPUData(e,t,n){return wO("createTensorFromGPUData")}memory(){return wO("memory")}floatPrecision(){return wO("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return wO("dispose")}}function wO(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function kO(e,t,n){return Math.max(e,Math.min(t,n))}function SO(e){return e%2===0?e:e+1}function CO(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function IO(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function EO(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function TO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";EO(_O(e,t),()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}function NO(e){EO(null!=e,()=>"The input to the tensor constructor must be a non-null value.")}function OO(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function AO(e){return 0===e.length}function _O(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function RO(e){return e%1===0}function PO(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function DO(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function MO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((a,o)=>{let i=0;const s=()=>{if(e())return void a();i++;const c=t(i);null!=n&&i>=n?o():null!=r?r(s,c):setTimeout(s,c)};s()})}function FO(e,t){let n=1,r=-1;for(let o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(o));r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found ".concat(e[o]," at dim ").concat(o));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));const a=e.slice();return a[r]=t/n,a}function LO(e,t){const n=t.length;return EO((e=null==e?t.map((e,t)=>t):[].concat(e)).every(e=>e>=-n&&e<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)),EO(e.every(e=>RO(e)),()=>"All values in axis param must be integers but "+"got axis ".concat(e)),e.map(e=>e<0?n+e:e)}function zO(e,t){const n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||a?null:LO(t,e).sort();let i=0;for(let s=0;s<e.length;++s){if(null!=o){if(o[i]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==o[i]||o[i]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),o[i]<=s&&i++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function BO(e,t){return jO(e,t)}function jO(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function WO(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function UO(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function VO(e){return"string"===typeof e||e instanceof String}function GO(e){return Array.isArray(e)?GO(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":function(e){return"number"===typeof e}(e)?"float32":VO(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function HO(e){return!!(e&&e.constructor&&e.call&&e.apply)}function KO(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function qO(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function XO(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new Array;if(1===t.length){const o=t[0]*(r?2:1);for(let t=0;t<o;t++)a[t]=n[e+t]}else{const o=t[0],i=t.slice(1),s=i.reduce((e,t)=>e*t)*(r?2:1);for(let t=0;t<o;t++)a[t]=XO(e+t*s,i,n,r)}return a}function YO(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];const r=e.reduce((e,t)=>e*t)*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return XO(0,e,t,n)}function QO(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function ZO(e,t){const n=$O(e,t);for(let r=0;r<n.length;r++)n[r]=1;return n}function $O(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function JO(e){e.forEach(t=>{EO(Number.isInteger(t)&&t>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"]."))})}function eA(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function tA(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function nA(e){return e&&e.then&&"function"===typeof e.then}const rA="tfjsflags";class aA{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=oA,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(iA().getBool("IS_TEST")||iA().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];iA().getBool("IS_TEST")||iA().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(t,".")),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(nA(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);if(rA in e){e[rA].split(",").forEach(e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){const n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,n)})}}}function oA(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")}),t}function iA(){return cA}let sA,cA=null;function lA(){if(null==sA){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}sA=e}return sA}function uA(e,t){const n=function(){const e=lA();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const dA="Abs",hA="Acos",pA="Acosh",fA="Add",mA="AddN",gA="All",yA="Any",vA="ArgMax",bA="ArgMin",xA="Asin",wA="Asinh",kA="Atan",SA="Atanh",CA="Atan2",IA="AvgPool",EA="AvgPoolGrad",TA="AvgPool3D",NA="AvgPool3DGrad",OA="BatchMatMul",AA="BatchToSpaceND",_A="Bincount",RA="BitwiseAnd",PA="BroadcastArgs",DA="Cast",MA="Ceil",FA="ClipByValue",LA="Complex",zA="ComplexAbs",BA="Concat",jA="Conv2D",WA="Conv2DBackpropFilter",UA="Conv2DBackpropInput",VA="Conv3D",GA="Conv3DBackpropFilterV2",HA="Conv3DBackpropInputV2",KA="Cos",qA="Cosh",XA="Cumprod",YA="Cumsum",QA="CropAndResize",ZA="DenseBincount",$A="DepthToSpace",JA="DepthwiseConv2dNative",e_="DepthwiseConv2dNativeBackpropFilter",t_="DepthwiseConv2dNativeBackpropInput",n_="Diag",r_="Dilation2D",a_="Draw",o_="RealDiv",i_="Einsum",s_="Elu",c_="EluGrad",l_="Erf",u_="Equal",d_="Exp",h_="ExpandDims",p_="Expm1",f_="FFT",m_="Fill",g_="FlipLeftRight",y_="Floor",v_="FloorDiv",b_="FusedBatchNorm",x_="GatherV2",w_="GatherNd",k_="Greater",S_="GreaterEqual",C_="Identity",I_="IFFT",E_="Imag",T_="IsFinite",N_="IsInf",O_="IsNan",A_="LeakyRelu",__="Less",R_="LessEqual",P_="LinSpace",D_="Log",M_="Log1p",F_="LogicalAnd",L_="LogicalNot",z_="LogicalOr",B_="LRN",j_="LRNGrad",W_="Max",U_="Maximum",V_="MaxPool",G_="MaxPoolGrad",H_="MaxPool3D",K_="MaxPool3DGrad",q_="MaxPoolWithArgmax",X_="Mean",Y_="Min",Q_="Minimum",Z_="MirrorPad",$_="Mod",J_="Multinomial",eR="Multiply",tR="Neg",nR="NotEqual",rR="NonMaxSuppressionV3",aR="NonMaxSuppressionV4",oR="NonMaxSuppressionV5",iR="OnesLike",sR="OneHot",cR="Pack",lR="PadV2",uR="Pow",dR="Prelu",hR="Prod",pR="RaggedGather",fR="RaggedRange",mR="RaggedTensorToTensor",gR="Range",yR="Real",vR="Reciprocal",bR="Relu",xR="Reshape",wR="ResizeNearestNeighbor",kR="ResizeNearestNeighborGrad",SR="ResizeBilinear",CR="ResizeBilinearGrad",IR="Relu6",ER="Reverse",TR="Round",NR="Rsqrt",OR="ScatterNd",AR="TensorScatterUpdate",_R="SearchSorted",RR="Select",PR="Selu",DR="Slice",MR="Sin",FR="Sinh",LR="Sign",zR="Sigmoid",BR="Softplus",jR="Sqrt",WR="Sum",UR="SpaceToBatchND",VR="SplitV",GR="Softmax",HR="SparseFillEmptyRows",KR="SparseReshape",qR="SparseSegmentMean",XR="SparseSegmentSum",YR="SparseToDense",QR="SquaredDifference",ZR="Square",$R="StaticRegexReplace",JR="StridedSlice",eP="StringNGrams",tP="StringSplit",nP="StringToHashBucketFast",rP="Sub",aP="Tan",oP="Tanh",iP="Tile",sP="TopK",cP="Transform",lP="Transpose",uP="Unique",dP="Unpack",hP="UnsortedSegmentSum",pP="ZerosLike",fP="Step",mP="FromPixels",gP="RotateWithOffset",yP="_FusedMatMul",vP="FusedConv2D",bP="FusedDepthwiseConv2D";function xP(){iA().getBool("IS_TEST")||iA().getBool("PROD")||console.warn(...arguments)}function wP(){iA().getBool("IS_TEST")||iA().getBool("PROD")||console.log(...arguments)}const kP=uA("kernelRegistry",()=>new Map),SP=uA("gradRegistry",()=>new Map);function CP(e,t){const n=NP(e,t);return kP.get(n)}function IP(e){return SP.get(e)}function EP(e){const t=kP.entries(),n=[];for(;;){const{done:r,value:a}=t.next();if(r)break;const[o,i]=a,[s]=o.split("_");s===e&&n.push(i)}return n}function TP(e){const{kernelName:t,backendName:n}=e,r=NP(t,n);kP.has(r)&&xP("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),kP.set(r,e)}function NP(e,t){return"".concat(t,"_").concat(e)}function OP(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var AP=n(7353);const _P=n.n(AP)()||AP;function RP(e){return _P.fromString(e,!0,16)}const PP=RP("c3a5c85c97cb3127"),DP=RP("b492b66fbe98f273"),MP=RP("9ae16a3b2f90404f");function FP(e){return e.xor(e.shru(47))}function LP(e,t,n){const r=e.slice(t,t+n);return _P.fromBytes(Array.from(r),!0,!0)}function zP(e,t){return LP(e,t,8)}function BP(e,t){return LP(e,t,4)}function jP(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function WP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RP("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));let a=t.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function UP(e,t,n,r){return function(e,t,n,r,a,o){a=a.add(e),o=jP(o.add(a).add(r),21);const i=a;return a=(a=a.add(t)).add(n),o=o.add(jP(a,44)),[a.add(r),o.add(i)]}(zP(e,t),zP(e,t+8),zP(e,t+16),zP(e,t+24),n,r)}function VP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=_P.fromNumber(81,!0);if(t<=32)return t<=16?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){const n=MP.add(2*t),r=zP(e,0).add(MP),a=zP(e,t-8);return WP(jP(a,37).mul(n).add(r),jP(r,25).add(a).mul(n),n)}if(t>=4){const n=MP.add(2*t);return WP(BP(e,0).shl(3).add(t),BP(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return FP(MP.mul(n).xor(PP.mul(r))).mul(MP)}return MP}(e,t):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=MP.add(2*t),r=zP(e,0).mul(DP),a=zP(e,8),o=zP(e,t-8).mul(n),i=zP(e,t-16).mul(MP);return WP(jP(r.add(a),43).add(jP(o,30)).add(i),r.add(jP(a.add(MP),18)).add(o),n)}(e,t);if(t<=64)return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;const n=MP.add(2*t),r=zP(e,0).mul(MP),a=zP(e,8),o=zP(e,t-8).mul(n),i=zP(e,t-16).mul(MP),s=jP(r.add(a),43).add(jP(o,30)).add(i),c=WP(s,r.add(jP(a.add(MP),18)).add(o),n),l=zP(e,16).mul(n),u=zP(e,24),d=s.add(zP(e,t-32)).mul(n),h=c.add(zP(e,t-24)).mul(n);return WP(jP(l.add(u),43).add(jP(d,30)).add(h),l.add(jP(u.add(r),18)).add(d),n)}(e,t);let r=n,a=n.mul(DP).add(113),o=FP(a.mul(MP).add(113)).mul(MP),i=[_P.UZERO,_P.UZERO],s=[_P.UZERO,_P.UZERO];r=r.mul(MP).add(zP(e,0));let c=0;const l=64*(t-1>>6),u=l+(t-1&63)-63;do{r=jP(r.add(a).add(i[0]).add(zP(e,c+8)),37).mul(DP),a=jP(a.add(i[1]).add(zP(e,c+48)),42).mul(DP),r=r.xor(s[1]),a=a.add(i[0]).add(zP(e,c+40)),o=jP(o.add(s[0]),33).mul(DP),i=UP(e,c,i[1].mul(DP),r.add(s[0])),s=UP(e,c+32,o.add(s[1]),a.add(zP(e,c+16))),[o,r]=[r,o],c+=64}while(c!==l);const d=DP.add(o.and(255).shl(1));return c=u,s[0]=s[0].add(t-1&63),i[0]=i[0].add(s[0]),s[0]=s[0].add(i[0]),r=jP(r.add(a).add(i[0]).add(zP(e,c+8)),37).mul(d),a=jP(a.add(i[1]).add(zP(e,c+48)),42).mul(d),r=r.xor(s[1].mul(9)),a=a.add(i[0].mul(9).add(zP(e,c+40))),o=jP(o.add(s[0]),33).mul(d),i=UP(e,c,i[1].mul(d),r.add(s[0])),s=UP(e,c+32,o.add(s[1]),a.add(zP(e,c+16))),[o,r]=[r,o],WP(WP(i[0],s[0],d).add(FP(a).mul(PP)).add(o),WP(i[1],s[1],d).add(r),d)}function GP(e,t){return"string"===t?qP(e):HP([e],t)}function HP(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=QP(e)),iA().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error("Unknown data type ".concat(t))}function KP(){return iA().platform.now()}function qP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",iA().platform.encode(e,t)}function XP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",iA().platform.decode(e,t)}function YP(e){return null!=iA().platform.isTypedArray?iA().platform.isTypedArray(e):OP(e)}function QP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||nA(e)||null==e||YP(e)&&n)t.push(e);else if(Array.isArray(e)||YP(e))for(let r=0;r<e.length;++r)QP(e[r],t,n);else{let r=-1;for(const t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let a=0;a<=r;a++)QP(e[a],t,n)}return t}class ZP{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new JP)}profileKernel(e,t,n){let r;const a=()=>{r=n()};let o;const i=KP();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const e of r)e.dataSync();o=Promise.resolve({kernelMs:KP()-i})}if(iA().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const t=r[s];t.data().then(n=>{$P(n,t.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:o.then(e=>e.kernelMs),extraInfo:o.then(e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:o}=e;n.forEach(e=>{Promise.all([e.data(),r,o]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])})})}}function $P(e,t,n){if("float32"!==t)return!1;for(let r=0;r<e.length;r++){const t=e[r];if(isNaN(t)||!isFinite(t))return console.warn("Found ".concat(t," in the result of '").concat(n,"'")),!0}return!1}class JP{logKernelProfile(e,t,n,r,a,o){const i="number"===typeof r?DO("".concat(r,"ms"),9):r.error,s=DO(e,25),c=t.rank,l=t.size,u=DO(t.shape.toString(),14);let d="";for(const h in a){const e=a[h];if(null!=e){const n=e.shape||t.shape,r=n.length;d+="".concat(h,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(i,"\t%c").concat(c,"D ").concat(u,"\t%c").concat(l,"\t%c").concat(d,"\t%c").concat(o),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function eD(e,t,n,r){const a=qO(t),o=function(e,t,n,r){const a=OO(t),o=r[r.length-1],i=new Array(o).fill(0),s=t.length,c="complex64"===n?aD(e):e;if(s>1)for(let l=0;l<a/o;l++){const e=l*o;for(let t=0;t<o;t++)i[t]=Math.max(i[t],tD(c[e+t],0,n).length)}return i}(e,t,n,a),i=t.length,s=rD(e,t,n,a,o),c=["Tensor"];return r&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(i)),c.push("  shape: [".concat(t,"]")),c.push("  values:")),c.push(s.map(e=>"    "+e).join("\n")),c.join("\n")}function tD(e,t,n){let r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):VO(e)?"'".concat(e,"'"):"bool"===n?nD(e):parseFloat(e.toFixed(7)).toString(),DO(r,t)}function nD(e){return 0===e?"false":"true"}function rD(e,t,n,r,a){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const i="complex64"===n?2:1,s=t[0],c=t.length;if(0===c){if("complex64"===n){return[tD(aD(e)[0],0,n)]}return"bool"===n?[nD(e[0])]:[e[0].toString()]}if(1===c){if(s>20){const t=3*i;let r=Array.from(e.slice(0,t)),o=Array.from(e.slice((s-3)*i,s*i));return"complex64"===n&&(r=aD(r),o=aD(o)),["["+r.map((e,t)=>tD(e,a[t],n)).join(", ")+", ..., "+o.map((e,t)=>tD(e,a[s-3+t],n)).join(", ")+"]"]}return["["+("complex64"===n?aD(e):Array.from(e)).map((e,t)=>tD(e,a[t],n)).join(", ")+"]"]}const l=t.slice(1),u=r.slice(1),d=r[0]*i,h=[];if(s>20){for(let t=0;t<3;t++){const r=t*d,o=r+d;h.push(...rD(e.slice(r,o),l,n,u,a,!1))}h.push("...");for(let t=s-3;t<s;t++){const r=t*d,o=r+d;h.push(...rD(e.slice(r,o),l,n,u,a,t===s-1))}}else for(let m=0;m<s;m++){const t=m*d,r=t+d;h.push(...rD(e.slice(t,r),l,n,u,a,m===s-1))}const p=2===c?",":"";h[0]="["+(s>0?h[0]+p:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=",\n";for(let m=2;m<c;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":f),h}function aD(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class oD{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=OO(e),null!=n){const e=n.length;EO(e===this.size,()=>"Length of values '".concat(e,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||jO(t,this.size),this.strides=qO(e)}set(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),EO(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")"));const a=this.locToIndex(n);this.values[a]=e}get(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);let r=0;for(const o of t){if(o<0||o>=this.shape[r]){const e="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(e)}r++}let a=t[t.length-1];for(let o=0;o<t.length-1;++o)a+=this.strides[o]*t[o];return this.values[a]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return iD().makeTensor(this.values,this.shape,this.dtype)}}let iD=null,sD=null,cD=null;class lD{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=OO(e),this.strides=qO(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return sD.buffer(this.shape,this.dtype,e)}bufferSync(){return sD.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return YO(this.shape,e,"complex64"===this.dtype)}arraySync(){return YO(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=iD().read(this.dataId);if("string"===this.dtype){const n=await e;try{return n.map(e=>XP(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),iD().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=iD().readSync(this.dataId);if("string"===this.dtype)try{return e.map(e=>XP(e))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await iD().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),iD().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return sD.print(this,e)}clone(){return this.throwIfDisposed(),sD.clone(this)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return eD(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),sD.cast(this,e)}variable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),iD().makeVariable(this,e,t,n)}}function uD(){return uA("Tensor",()=>lD)}Object.defineProperty(lD,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),uD();class dD extends lD{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!_O(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));iD().disposeTensor(this),this.dataId=e.dataId,iD().incRef(this,null)}dispose(){iD().disposeVariable(this),this.isDisposedInternal=!0}}var hD,pD,fD,mD,gD;Object.defineProperty(dD,Symbol.hasInstance,{value:e=>e instanceof lD&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(hD||(hD={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(pD||(pD={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(fD||(fD={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(mD||(mD={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(gD||(gD={}));const yD={float32:mD,int32:pD,bool:fD,complex64:gD};function vD(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return yD[e][t]}function bD(e){return vD(e,"int32")}function xD(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function wD(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function kD(e,t){if(e.dtype===t.dtype)return[e,t];const n=vD(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function SD(e){const t=[];return CD(e,t,new Set),t}function CD(e,t,n){if(null==e)return;if(e instanceof lD)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!==typeof r)return;var r;const a=e;for(const o in a){const e=a[o];n.has(e)||(n.add(e),CD(e,t,n))}}function ID(e){return null!=e.kernelName}class ED{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class TD{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ED}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(xP("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error("Backend name '".concat(e,"' not found in registry"));if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ZP(this.backendInstance),!0}setupRegisteredKernels(){EP(this.backendName).forEach(e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){EP(e).forEach(t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{const n=t.factory();if(!n||n instanceof xO||"function"!==typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then(n=>!(t<this.pendingBackendInitId)&&(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,xP("Initialization of backend ".concat(e," failed")),xP(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return xP("Initialization of backend ".concat(e," failed")),xP(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),o=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(r){throw t(),r}}nextTensorId(){return TD.nextTensorId++}nextVariableId(){return TD.nextVariableId++}clone(e){const t=OD.runKernel(C_,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{const t={x:e},n={dtype:"float32"};return OD.runKernel(DA,t,n)}}),[],{}),t}runKernel(e,t,n){null==this.backendName&&this.backend;if(!(null!=CP(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let a=0;n.forEach(e=>{a+="complex64"===e.dtype?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-t-a-o;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(e,"'"))}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;let i,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const c=ID(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(ID(e)){const{kernelName:t,inputs:a,attrs:o}=e;null==this.backendName&&this.backend;const c=CP(t,this.backendName);EO(null!=c,()=>"Cannot find registered kernel '".concat(t,"' for backend '").concat(this.backendName,"'")),i=()=>{const e=this.backend.numDataIds();s=c.kernelFunc({inputs:a,attrs:o,backend:this.backend});const i=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,i);const l=i.map(e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e));if(r){const e=this.getTensorsForGradient(t,a,l);n=this.saveTensorsForBackwardMode(e)}return l}}else{const{forwardFunc:t}=e,a=e=>{r&&(n=e.map(e=>this.keep(this.clone(e))))};i=()=>{const e=this.backend.numDataIds();s=this.tidy(()=>t(this.backend,a));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,n),n}}const{inputs:l,attrs:u}=e,d=ID(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(c,l,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=i()}),r&&this.addTapeNode(c,l,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(e=>null!=l[e]?l[e].shape:null),outputShapes:t.map(e=>e.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(s)?t:t[0]}saveTensorsForBackwardMode(e){const t=e.map(e=>this.keep(this.clone(e)));return t}getTensorsForGradient(e,t,n){const r=IP(e);if(null!=r){const e=r.inputsToSave||[],a=r.outputsToSave||[];let o;r.saveAllInputs?(EO(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(e=>t[e])):o=e.map(e=>t[e]);const i=n.filter((e,t)=>a[t]);return o.concat(i)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&VO(e[0])&&(a=e.map(e=>qP(e)));const o=r.write(a,t,n),i=new lD(t,n,o,this.nextTensorId());if(this.trackTensor(i,r),"string"===n){const e=this.state.tensorInfo.get(o),t=function(e){if(null==e)return 0;let t=0;return e.forEach(e=>t+=e.length),t}(a);this.state.numBytes+=t-e.bytes,e.bytes=t}return i}makeTensorFromDataId(e,t,n,r){const a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:a}=e,o=new lD(r,a,n,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const a=new dD(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*UO(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof dD||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*UO(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,o){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=IP(e);null!=s&&(r=s.gradFunc),null!=r&&(i.gradient=e=>(e=e.map((e,t)=>{if(null==e){const e=n[t],r=$O(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e}),r(e.length>1?e:e[0],a,o))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=SD(e),n=new Set(t.map(e=>e.id));for(let a=0;a<this.state.activeScope.track.length;a++){const e=this.state.activeScope.track[a];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{e.kept||e.scopeId!==r.id||this.track(e)})}gradients(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(EO(t.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));EO(a instanceof lD,()=>"The result y returned by f() must be a tensor.");const o=function(e,t,n){const r={},a={};for(let c=0;c<t.length;c++)r[t[c].id]=!0;for(let c=0;c<e.length;c++){const n=e[c],o=n.inputs;for(const e in o){const i=o[e];let s=!1;for(let e=0;e<t.length;e++)if(r[i.id]){n.outputs.forEach(e=>r[e.id]=!0),s=!0,a[n.id]=!0;break}if(s)break}}const o={};o[n.id]=!0;const i={};for(let c=e.length-1;c>=0;c--){const t=e[c],n=t.inputs;for(let e=0;e<t.outputs.length;e++)if(o[t.outputs[e].id]){for(const e in n)o[n[e].id]=!0,i[t.id]=!0;break}}const s=[];for(let c=0;c<e.length;c++){const t=e[c];if(a[t.id]&&i[t.id]){const e={};for(const a in t.inputs){const n=t.inputs[a];r[n.id]&&(e[a]=n)}const n=Object.assign({},t);n.inputs=e,n.outputs=t.outputs,s.push(n)}}return s}(this.state.activeTape,t,a);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const e={};e[a.id]=null==n?function(e){const t=ZO(OO(e),"float32");return OD.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){const o=t[a],i=[];if(o.outputs.forEach(t=>{const n=e[t.id];null!=n?i.push(n):i.push(null)}),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));const s=o.gradient(i);for(const t in o.inputs){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const a=n(()=>s[t]());if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));const i=o.inputs[t];if(!_O(a.shape,i.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==e[i.id])e[i.id]=a;else{const t=e[i.id];e[i.id]=r(t,a),t.dispose()}}}}(e,o,e=>this.tidy(e),AD);const r=t.map(t=>e[t.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(e=>{for(const t of e.saved)t.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(e){var t=this;return EO(HO(e),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];let o;EO(r.every(e=>e instanceof lD),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const i={};r.forEach((e,t)=>{i[t]=e});return t.runKernelFunc({forwardFunc:(t,n)=>(o=e(...r,n),EO(o.value instanceof lD,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),EO(HO(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),backwardsFunc:(e,t)=>{const n=o.gradFunc(e,t),a=Array.isArray(n)?n:[n];EO(a.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),EO(a.every(e=>e instanceof lD),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const i={};return a.forEach((e,t)=>{i[t]=()=>e}),i},inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=KP(),n=await this.backend.time(e);return n.wallMs=KP()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ED;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function ND(){const e=lA();if(null==e._tfengine){const t=new aA(e);e._tfengine=new TD(t)}var t;return t=e._tfengine.ENV,cA=t,function(e){iD=e}(()=>e._tfengine),e._tfengine}TD.nextTensorId=0,TD.nextVariableId=0;const OD=ND();function AD(e,t){const n={a:e,b:t};return OD.runKernel(fA,n)}let _D;function RD(e){if(void 0!==_D)return _D;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function PD(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const DD=iA();function MD(e,t){let n=e;if(YP(e))return"string"===t?[]:[e.length];if(xD(e)){const t=e.channels||"RGBA";return[e.height,e.width*t.length]}if(wD(e))return[e.buffer.size/(null==t?4:UO(t))];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||YP(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&iA().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&FD(e,r,[]),r}function FD(e,t,n){if(n=n||[],!Array.isArray(e)&&!YP(e))return void EO(0===t.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements"));EO(t.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")),EO(e.length===t[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements"));const r=t.slice(1);for(let a=0;a<e.length;++a)FD(e[a],r,n.concat(a))}function LD(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function zD(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof uD())return LD(r,e.dtype,t,n),e;let a=GO(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),LD(r,a,t,n),null==e||!YP(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){const r=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const o=MD(e,a);YP(e)||Array.isArray(e)||(e=[e]);const i="string"!==a?HP(e,a):QP(e,[],!0);return OD.makeTensor(i,o,a)}function BD(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((e,a)=>zD(e,"".concat(t,"[").concat(a,"]"),n,r))}DD.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),DD.registerFlag("IS_BROWSER",()=>PD()),DD.registerFlag("IS_NODE",()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node),DD.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),DD.registerFlag("IS_SAFARI",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),DD.registerFlag("PROD",()=>!1),DD.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>DD.getBool("DEBUG")),DD.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),DD.registerFlag("IS_TEST",()=>!1),DD.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>DD.getBool("DEBUG")),DD.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),DD.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),DD.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const jD="__op";function WD(e){const t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=jD;const a=function(){OD.startScope(n);try{const e=r(...arguments);return nA(e)&&console.error("Cannot return a Promise inside of tidy."),OD.endScope(e),e}catch(e){throw OD.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}const UD=WD({complex_:function(e,t){const n=zD(e,"real","complex"),r=zD(t,"imag","complex");TO(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const a={real:n,imag:r};return OD.runKernel(LA,a)}});function VD(e,t,n,r){if(null==r)r=GO(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(wD(e)||xD(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return OD.backend.createTensorFromGPUData(e,t||n,r)}if(!YP(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){JO(t);const e=OO(t),r=OO(n);EO(e===r,()=>"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(e," values but has ").concat(r));for(let a=0;a<n.length;++a){const e=n[a],r=a!==n.length-1||e!==OO(t.slice(a));EO(n[a]===t[a]||!r,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). "))}}return YP(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?HP(e,r):QP(e,[],!0),OD.makeTensor(e,t,r)}function GD(e,t,n){return VD(e,t,MD(e,n),n)}const HD={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class KD{static join(e){return new KD(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,null==e)return;if(e instanceof Array||(e=[e]),0===(e=e.map(e=>YP(e)?e.buffer:e)).length)return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){const r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=t+r.byteLength;this.shards.push({buffer:r,start:t,end:a}),t=a}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));const r=new ArrayBuffer(t-e),a=new Uint8Array(r);let o=0;for(let i=n;i<this.shards.length;i++){const n=this.shards[i],r=e+o-n.start,s=o,c=Math.min(t,n.end)-n.start,l=new Uint8Array(n.buffer,r,c-r);if(a.set(l,s),o+=l.length,t<n.end)break}return r}findShardForByte(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(e,t){let n=0,r=e.length;for(;n<=r;){const a=Math.floor((r-n)/2)+n,o=t(e[a]);if(0===o)return a;o<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}function qD(){return OD}function XD(e,t){return OD.tidy(e,t)}function YD(e){SD(e).forEach(e=>e.dispose())}function QD(e){return OD.keep(e)}function ZD(){return OD.backendName}function $D(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return OD.registerBackend(e,t,n)}function JD(){return OD.backend}!function(e){cD=e}(function(e){iA().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")});const eM=4;async function tM(e,t){const n=[],r=[],a=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let o=0;o<a.length;++o){const i=a[o],s=Array.isArray(e)?e[o].tensor:e[i];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(i,"': ").concat(s.dtype));const c={name:i,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const e=new Promise(async e=>{const t=await s.bytes(),n=t.reduce((e,t)=>e+t.length,0)+eM*t.length,r=new Uint8Array(n);let a=0;for(let o=0;o<t.length;o++){const e=t[o],n=new Uint8Array(new Uint32Array([e.length]).buffer);r.set(n,a),a+=eM,r.set(e,a),a+=e.length}e(r)});r.push(e)}else r.push(s.data());null!=t&&(c.group=t),n.push(c)}return{data:cM(await Promise.all(r)),specs:n}}function nM(e,t){const n=new KD(e),r={};let a=0;for(const o of t){const e=rM(o,(e,t)=>n.slice(a+e,a+t));r[o.name]=oM(o,n.slice(a,a+e)),a+=e}return r}function rM(e,t){const n=OO(e.shape);let r;if("quantization"in e){const t=e.quantization;r=HD[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=eM+new Uint32Array(t(e,e+eM))[0];return e}r=HD[e.dtype]}return n*r}async function aM(e,t){const n=OO(e.shape);let r;if("quantization"in e){const t=e.quantization;r=HD[t.dtype]}else{if("string"===e.dtype){let e=0;for(let r=0;r<n;r++)e+=eM+new Uint32Array(await t(e,e+eM))[0];return e}r=HD[e.dtype]}return n*r}function oM(e,t){const n=e.name,r=e.dtype,a=e.shape,o=OO(a);let i,s=0;if("quantization"in e){const a=e.quantization;if("uint8"===a.dtype||"uint16"===a.dtype){if(!("min"in a)||!("scale"in a))throw new Error("Weight ".concat(e.name," with quantization ").concat(a.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==a.dtype)throw new Error("Weight ".concat(e.name," has unknown ")+"quantization dtype ".concat(a.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==r)throw new Error("Weight ".concat(e.name," is quantized with ").concat(a.dtype," ")+"which only supports weights of type float32 not ".concat(r,"."))}const c=HD[a.dtype],l="uint8"===a.dtype?new Uint8Array(t):new Uint16Array(t);if("float32"===r)if("uint8"===a.dtype||"uint16"===a.dtype){i=new Float32Array(l.length);for(let e=0;e<l.length;e++){const t=l[e];i[e]=t*a.scale+a.min}}else{if("float16"!==a.dtype)throw new Error("Unsupported quantization type ".concat(a.dtype," ")+"for weight type float32.");{const e=function(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0===(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const a=new ArrayBuffer(4*r.length),o=new Uint32Array(a);for(let i=0;i<r.length;i++){const a=r[i],s=e[n[a>>10]+(1023&a)]+t[a>>10];o[i]=s}return new Float32Array(a)}}();i=e(l)}}else{if("int32"!==r)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r));if("uint8"!==a.dtype&&"uint16"!==a.dtype)throw new Error("Unsupported quantization type ".concat(a.dtype," ")+"for weight type int32.");i=new Int32Array(l.length);for(let e=0;e<l.length;e++){const t=l[e];i[e]=Math.round(t*a.scale+a.min)}}s+=o*c}else if("string"===r){const n=OO(e.shape);i=[];for(let e=0;e<n;e++){const e=new Uint32Array(t.slice(s,s+eM))[0];s+=eM;const n=new Uint8Array(t.slice(s,s+e));i.push(n),s+=e}}else{const e=HD[r];if("float32"===r)i=new Float32Array(t);else if("int32"===r)i=new Int32Array(t);else{if("bool"!==r){if("complex64"===r){i=new Float32Array(t);const e=new Float32Array(i.length/2),n=new Float32Array(i.length/2);for(let t=0;t<e.length;t++)e[t]=i[2*t],n[t]=i[2*t+1];const r=GD(e,a,"float32"),o=GD(n,a,"float32"),s=UD(r,o);return r.dispose(),o.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(r))}i=new Uint8Array(t)}s+=o*e}return GD(i,a,r)}async function iM(e,t,n){let r=new Uint8Array(t);for(;r.byteLength<n;){const{done:t,value:a}=await e.read();if(t&&null==a){const e=n-r.byteLength;throw new Error("Reader is done but ".concat(e," bytes are still expected"))}const o=new Uint8Array(r.length+a.byteLength);o.set(r,0),o.set(new Uint8Array(a),r.length),r=o}return r.buffer}async function sM(e,t){const n={},r=e.getReader();let a=new ArrayBuffer(0);for(const o of t){const e=await aM(o,async(e,t)=>(a=await iM(r,a,t),a.slice(e,t)));a=await iM(r,a,e);const t=a.slice(0,e);a=a.slice(e);const i=oM(o,t);if(n[o.name]=i,"webgpu"===ZD()){const e=JD();"uploadToGPU"in e&&OO(i.shape)>=iA().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&e.uploadToGPU(i.dataId)}}return n}function cM(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));let t=0;const n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))});const r=new Uint8Array(t);let a=0;return n.forEach(e=>{r.set(new Uint8Array(e.buffer),a),a+=e.byteLength}),r.buffer}const lM="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function uM(e){return lM?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function dM(e){return KD.join(e)}function hM(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function pM(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function fM(e,t,n){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}async function mM(e,t){let n,r;return null!=e.weightsManifest&&([n,r]=await t(e.weightsManifest)),fM(e,n,r)}function gM(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:uM(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:uM(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new KD(e.weightData).byteLength}}function yM(e){const t=[];for(const n of e)t.push(...n.weights);return t}class vM{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==vM.instance&&(vM.instance=new vM),vM.instance}static registerSaveRouter(e){vM.getInstance().saveRouters.push(e)}static registerLoadRouter(e){vM.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return vM.getHandlers(e,"save")}static getLoadHandlers(e,t){return vM.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?vM.getInstance().loadRouters:vM.getInstance().saveRouters).forEach(t=>{const a=t(e,n);null!==a&&r.push(a)}),r}}const bM=e=>vM.registerSaveRouter(e),xM=e=>vM.registerLoadRouter(e),wM=e=>vM.getSaveHandlers(e),kM=(e,t)=>vM.getLoadHandlers(e,t),SM="tensorflowjs",CM="models_store",IM="model_info_store";function EM(){if(!iA().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function TM(e){const t=e.result;t.createObjectStore(CM,{keyPath:"modelPath"}),t.createObjectStore(IM,{keyPath:"modelPath"})}class NM{constructor(e){if(this.indexedDB=EM(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{const r=this.indexedDB.open(SM,1);r.onupgradeneeded=()=>TM(r),r.onsuccess=()=>{const a=r.result;if(null==t){const t=a.transaction(CM,"readonly"),r=t.objectStore(CM).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));e(r.result.modelArtifacts)},r.onerror=e=>(a.close(),n(r.error)),t.oncomplete=()=>a.close()}else{t.weightData=KD.join(t.weightData);const r=gM(t),i=a.transaction(IM,"readwrite");let s,c,l=i.objectStore(IM);try{s=l.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(o){return n(o)}s.onsuccess=()=>{c=a.transaction(CM,"readwrite");const s=c.objectStore(CM);let u;try{u=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(o){return n(o)}u.onsuccess=()=>e({modelArtifactsInfo:r}),u.onerror=e=>{l=i.objectStore(IM);const t=l.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(u.error)),t.onerror=e=>(a.close(),n(u.error))}},s.onerror=e=>(a.close(),n(s.error)),i.oncomplete=()=>{null==c?a.close():c.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)})}}NM.URL_SCHEME="indexeddb://";const OM=e=>{return iA().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(NM.URL_SCHEME)?(t=e.slice(NM.URL_SCHEME.length),new NM(t)):null;var t};vM.registerSaveRouter(OM),vM.registerLoadRouter(OM);class AM{constructor(){this.indexedDB=EM()}async listModels(){return new Promise((e,t)=>{const n=this.indexedDB.open(SM,1);n.onupgradeneeded=()=>TM(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(IM,"readonly"),o=a.objectStore(IM).getAll();o.onsuccess=()=>{const t={};for(const e of o.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},o.onerror=e=>(r.close(),t(o.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)})}async removeModel(e){var t;return e=(t=e).startsWith(NM.URL_SCHEME)?t.slice(NM.URL_SCHEME.length):t,new Promise((t,n)=>{const r=this.indexedDB.open(SM,1);r.onupgradeneeded=()=>TM(r),r.onsuccess=()=>{const a=r.result,o=a.transaction(IM,"readwrite"),i=o.objectStore(IM),s=i.get(e);let c;s.onsuccess=()=>{if(null==s.result)return a.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));{const r=i.delete(e),o=()=>{c=a.transaction(CM,"readwrite");const r=c.objectStore(CM).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=o,r.onerror=e=>(o(),a.close(),n(s.error))}},s.onerror=e=>(a.close(),n(s.error)),o.oncomplete=()=>{null==c?a.close():c.oncomplete=()=>a.close()}},r.onerror=e=>n(r.error)})}}const _M="/",RM="tensorflowjs_models",PM="info",DM="model_topology",MM="weight_specs",FM="weight_data",LM="model_metadata";function zM(e){return{info:[RM,e,PM].join(_M),topology:[RM,e,DM].join(_M),weightSpecs:[RM,e,MM].join(_M),weightData:[RM,e,FM].join(_M),modelMetadata:[RM,e,LM].join(_M)}}function BM(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function jM(e){const t=e.split(_M);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(_M)}class WM{constructor(e){if(!iA().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=zM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=gM(e),o=KD.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(lM)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(o));const t={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(t)),{modelArtifactsInfo:a}}catch(t){throw BM(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const e=JSON.parse(a);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(t.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return t.weightData=function(e){if(lM){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;++r)n.set([t.charCodeAt(r)],r);return n.buffer}(o),t}}WM.URL_SCHEME="localstorage://";const UM=e=>{return iA().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(WM.URL_SCHEME)?(t=e.slice(WM.URL_SCHEME.length),new WM(t)):null;var t};vM.registerSaveRouter(UM),vM.registerLoadRouter(UM);class VM{constructor(){EO(iA().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),EO("undefined"===typeof window||"undefined"!==typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=RM+_M,n=_M+PM;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(t)&&a.endsWith(n)){e[jM(a)]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){var t;const n=zM(e=(t=e).startsWith(WM.URL_SCHEME)?t.slice(WM.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(e,"'"));const r=JSON.parse(this.LS.getItem(n.info));return BM(n),r}}const GM="://";class HM{constructor(){this.managers={}}static getInstance(){return null==HM.instance&&(HM.instance=new HM),HM.instance}static registerManager(e,t){EO(null!=e,()=>"scheme must not be undefined or null."),e.endsWith(GM)&&(e=e.slice(0,e.indexOf(GM))),EO(e.length>0,()=>"scheme must not be an empty string.");const n=HM.getInstance();EO(null==n.managers[e],()=>"A model store manager is already registered for scheme '".concat(e,"'.")),n.managers[e]=t}static getManager(e){const t=HM.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}static getSchemes(){return Object.keys(HM.getInstance().managers)}}function KM(e){if(-1===e.indexOf(GM))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(HM.getSchemes().join(",")));return{scheme:e.split(GM)[0],path:e.split(GM)[1]}}async function qM(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];EO(e!==t,()=>"Old path and new path are the same: '".concat(e,"'"));const r=vM.getLoadHandlers(e);EO(r.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(e,".")),EO(r.length<2,()=>"Copying failed because more than one (".concat(r.length,") ")+"load handlers for source URL ".concat(e,"."));const a=r[0],o=vM.getSaveHandlers(t);EO(o.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(t,".")),EO(o.length<2,()=>"Copying failed because more than one (".concat(r.length,") ")+"save handlers for destination URL ".concat(t,"."));const i=o[0],s=KM(e).scheme,c=KM(e).path,l=s===KM(e).scheme,u=await a.load();n&&l&&await HM.getManager(s).removeModel(c);const d=await i.save(u);return n&&!l&&await HM.getManager(s).removeModel(c),d.modelArtifactsInfo}async function XM(){const e=HM.getSchemes(),t={};for(const n of e){const e=await HM.getManager(n).listModels();for(const r in e){t[n+GM+r]=e[r]}}return t}async function YM(e){const t=KM(e);return HM.getManager(t.scheme).removeModel(t.path)}async function QM(e,t){return qM(e,t,!1)}async function ZM(e,t){return qM(e,t,!0)}class $M{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){"undefined"!==typeof window&&iA().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))):setTimeout(e,t)}isTypedArray(e){return OP(e)}}if(iA().get("IS_BROWSER")){iA().setPlatform("browser",new $M);try{HM.registerManager(WM.URL_SCHEME,new VM)}catch(Qne){}try{HM.registerManager(NM.URL_SCHEME,new AM)}catch(Qne){}}const JM=()=>n(5817);let eF;class tF{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=iA().global.fetch?iA().global.fetch(e,t):(null==eF&&(eF=JM()),eF(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}function nF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",JO(e),new oD(e,t,n)}iA().get("IS_NODE")&&!iA().get("IS_BROWSER")&&iA().setPlatform("node",new tF);const rF=WD({cast_:function(e,t){const n=zD(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:t};return OD.runKernel(DA,r,a)}});const aF=WD({clone_:function(e){const t={x:zD(e,"x","clone","string_or_numeric")};return OD.runKernel(C_,t)}});function oF(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}ND();sD={buffer:nF,cast:rF,clone:aF,print:oF};const iF=WD({add_:function(e,t){let n=zD(e,"a","add"),r=zD(t,"b","add");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(fA,a)}});const sF=WD({floorDiv_:function(e,t){let n=zD(e,"a","floorDiv"),r=zD(t,"b","floorDiv");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(v_,a)}});const cF=WD({div_:function(e,t){let n=zD(e,"a","div"),r=zD(t,"b","div");if([n,r]=kD(n,r),"int32"===n.dtype&&"int32"===r.dtype)return sF(n,r);const a={a:n,b:r};return OD.runKernel(o_,a,{})}});const lF=WD({mul_:function(e,t){let n=zD(e,"a","mul"),r=zD(t,"b","mul");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(eR,a)}});const uF=WD({sqrt_:function(e){const t={x:zD(e,"x","sqrt","float32")};return OD.runKernel(jR,t)}});const dF=WD({square_:function(e){const t=zD(e,"x","square");return OD.runKernel("Square",{x:t},{})}});const hF=WD({zerosLike_:function(e){const t={x:zD(e,"x","zerosLike")};return OD.runKernel(pP,t)}});function pF(e){return OD.customGrad(e)}function fF(e,t){if((YP(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&YP(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return VD(e,[],[],t)}const mF=new Map,gF=new Map;class yF{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class vF{constructor(){this.classNameMap={}}static getMap(){return null==vF.instance&&(vF.instance=new vF),vF.instance}static register(e){vF.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function bF(e,t,n){EO(null!=e.className,()=>"Class being registered does not have the static className property defined."),EO("string"===typeof e.className,()=>"className is required to be a string, but got type "+typeof e.className),EO(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);const r=t+">"+n;return vF.register(e),mF.set(r,e),gF.set(e,r),e}class xF extends yF{minimize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:a}=this.computeGradients(e,n);if(null!=n){const e=n.map(e=>({name:e.name,tensor:a[e.name]}));this.applyGradients(e)}else this.applyGradients(a);return YD(a),t?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return function(e,t){EO(HO(e),()=>"The f passed in variableGrads(f) must be a function"),EO(null==t||Array.isArray(t)&&t.every(e=>e instanceof dD),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=t;if(!n){t=[];for(const e in OD.registeredVariables)t.push(OD.registeredVariables[e])}const r=n?t.filter(e=>!e.trainable):null,a=t.length;t=t.filter(e=>e.trainable),EO(t.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable.");const{value:o,grads:i}=OD.gradients(e,t,null,!0);EO(i.some(e=>null!=e),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),EO(0===o.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(o.rank," tensor"));const s={};return t.forEach((e,t)=>{null!=i[t]&&(s[e.name]=i[t])}),null!=r&&r.forEach(e=>s[e.name]=null),{value:o,grads:s}}(e,t)}dispose(){null!=this.iterations_&&YD(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:fF(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(xF,Symbol.hasInstance,{value:e=>null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients});function wF(e,t,n){JO(e);const r={shape:e,value:t,dtype:n=n||GO(t)};return OD.runKernel(m_,{},r)}const kF=WD({pow_:function(e,t){let n=zD(e,"base","pow"),r=zD(t,"exp","pow");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(uR,a)}});const SF=WD({sub_:function(e,t){let n=zD(e,"a","sub"),r=zD(t,"b","sub");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(rP,a)}});const CF=WD({abs_:function(e){const t=zD(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return OD.runKernel(zA,e)}{const e={x:t};return OD.runKernel(dA,e)}}});function IF(e,t){const n=e.length,r=[];for(let a=0;a<n;a++){const o=n-1-a,i=e[o]||1;(t[t.length-1-a]||1)>1&&1===i&&r.unshift(o)}return r}function EF(e,t){const n=[];for(let r=0;r<t.length;r++){const a=e[e.length-r-1],o=t.length-r-1,i=t[o];(null==a||1===a&&i>1)&&n.unshift(o)}return n}function TF(e,t){const n=Math.max(e.length,t.length),r=new Array(n);for(let a=0;a<n;a++){let o=e[e.length-a-1];null==o&&(o=1);let i=t[t.length-a-1];if(null==i&&(i=1),1===o)r[n-a-1]=i;else if(1===i)r[n-a-1]=o;else{if(o!==i){const n="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(n)}r[n-a-1]=o}}return r}const NF=WD({maximum_:function(e,t){let n=zD(e,"a","maximum"),r=zD(t,"b","maximum");[n,r]=kD(n,r),"bool"===n.dtype&&(n=rF(n,"int32"),r=rF(r,"int32")),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(U_,a)}});class OF extends xF{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);t.forEach((t,n)=>{const r=Array.isArray(e)?e[n].tensor:e[t];if(null==r)return;const a=OD.registeredVariables[t];XD(()=>{const e=iF(lF(this.c,r),a);a.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=QD(fF(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(0!==(e=await this.extractIterations(e)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}const AF=[class extends xF{static get className(){return"Adadelta"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=OD.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=OD.registeredVariables[t],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(t,"/accum_grad"),variable:XD(()=>hF(r).variable(a))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(t,"/accum_var"),variable:XD(()=>hF(r).variable(a))});const o=Array.isArray(e)?e[n].tensor:e[t];if(null==o)return;const i=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;XD(()=>{const e=iF(lF(i,this.rho),lF(dF(o),1-this.rho)),t=lF(cF(uF(iF(s,this.epsilon)),uF(iF(i,this.epsilon))),o),n=iF(lF(s,this.rho),lF(dF(t),1-this.rho));i.assign(e),s.assign(n);const a=iF(lF(t,-this.learningRate),r);r.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(YD(this.accumulatedGrads.map(e=>e.variable)),YD(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){const t=(e=await this.extractIterations(e)).length/2,n=!1;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedUpdates=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},class extends xF{static get className(){return"Adagrad"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=OD.registeredVariables[t];if(null==this.accumulatedGrads[n]){const e=!1;this.accumulatedGrads[n]={originalName:"".concat(t,"/accumulator"),variable:XD(()=>wF(r.shape,this.initialAccumulatorValue).variable(e))}}const a=Array.isArray(e)?e[n].tensor:e[t];if(null==a)return;const o=this.accumulatedGrads[n].variable;XD(()=>{const e=iF(o,dF(a));o.assign(e);const t=iF(lF(cF(a,uF(iF(e,OD.backend.epsilon()))),-this.learningRate),r);r.assign(t)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&YD(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},class extends xF{static get className(){return"Adam"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],XD(()=>{this.accBeta1=fF(t).variable(),this.accBeta2=fF(n).variable()}),null==r&&(this.epsilon=OD.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);XD(()=>{const n=SF(1,this.accBeta1),r=SF(1,this.accBeta2);t.forEach((t,a)=>{const o=OD.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:XD(()=>hF(o).variable(i))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:"".concat(t,"/v"),variable:XD(()=>hF(o).variable(i))});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const c=this.accumulatedFirstMoment[a].variable,l=this.accumulatedSecondMoment[a].variable,u=iF(lF(c,this.beta1),lF(s,1-this.beta1)),d=iF(lF(l,this.beta2),lF(dF(s),1-this.beta2)),h=cF(u,n),p=cF(d,r);c.assign(u),l.assign(d);const f=iF(lF(cF(h,iF(uF(p),this.epsilon)),-this.learningRate),o);o.assign(f)}),this.accBeta1.assign(lF(this.accBeta1,this.beta1)),this.accBeta2.assign(lF(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&YD(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedSecondMoment&&YD(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),XD(()=>{this.accBeta1.assign(kF(this.beta1,this.iterations_+1)),this.accBeta2.assign(kF(this.beta2,this.iterations_+1))});const t=e.length/2,n=!1;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedSecondMoment=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},class extends xF{static get className(){return"Adamax"}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],XD(()=>{this.iteration=fF(0).variable(),this.accBeta1=fF(t).variable()}),null==r&&(this.epsilon=OD.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);XD(()=>{const n=SF(1,this.accBeta1),r=cF(-this.learningRate,iF(lF(this.iteration,this.decay),1));t.forEach((t,a)=>{const o=OD.registeredVariables[t],i=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(t,"/m"),variable:hF(o).variable(i)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:"".concat(t,"/v"),variable:hF(o).variable(i)});const s=Array.isArray(e)?e[a].tensor:e[t];if(null==s)return;const c=this.accumulatedFirstMoment[a].variable,l=this.accumulatedWeightedInfNorm[a].variable,u=iF(lF(c,this.beta1),lF(s,1-this.beta1)),d=lF(l,this.beta2),h=CF(s),p=NF(d,h);c.assign(u),l.assign(p);const f=iF(lF(cF(r,n),cF(u,iF(p,this.epsilon))),o);o.assign(f)}),this.iteration.assign(iF(this.iteration,1)),this.accBeta1.assign(lF(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&YD(this.accumulatedFirstMoment.map(e=>e.variable)),null!=this.accumulatedWeightedInfNorm&&YD(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},class extends OF{static get className(){return"Momentum"}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=fF(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=OD.registeredVariables[t];if(null==this.accumulations[n]){const e=!1;this.accumulations[n]={originalName:"".concat(t,"/momentum"),variable:XD(()=>hF(r).variable(e))}}const a=this.accumulations[n].variable,o=Array.isArray(e)?e[n].tensor:e[t];null!=o&&XD(()=>{let e;const t=iF(lF(this.m,a),o);e=this.useNesterov?iF(lF(this.c,iF(o,lF(t,this.m))),r):iF(lF(this.c,t),r),a.assign(t),r.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&YD(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},class extends xF{static get className(){return"RMSProp"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=OD.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{const r=OD.registeredVariables[t],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(t,"/rms"),variable:XD(()=>hF(r).variable(a))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(t,"/momentum"),variable:XD(()=>hF(r).variable(a))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(t,"/mg"),variable:XD(()=>hF(r).variable(a))});const o=Array.isArray(e)?e[n].tensor:e[t];if(null==o)return;const i=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;XD(()=>{const e=iF(lF(i,this.decay),lF(dF(o),1-this.decay));if(this.centered){const t=this.accumulatedMeanGrads[n].variable,a=iF(lF(t,this.decay),lF(o,1-this.decay)),c=cF(lF(o,this.learningRate),uF(SF(e,iF(dF(a),this.epsilon)))),l=iF(lF(s,this.momentum),c);i.assign(e),t.assign(a),s.assign(l);const u=SF(r,l);r.assign(u)}else{const e=iF(lF(i,this.decay),lF(dF(o),1-this.decay)),t=iF(lF(s,this.momentum),cF(lF(o,this.learningRate),uF(iF(e,this.epsilon))));i.assign(e),s.assign(t);const n=SF(r,t);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&YD(this.accumulatedMeanSquares.map(e=>e.variable)),null!=this.accumulatedMeanGrads&&this.centered&&YD(this.accumulatedMeanGrads.map(e=>e.variable)),null!=this.accumulatedMoments&&YD(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,n=!1;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.accumulatedMoments=e.slice(t,2*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map(e=>({originalName:e.name,variable:e.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},OF];function _F(e){return new Promise(e=>setTimeout(e)).then(e)}class RF{constructor(e){if(!iA().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(RF.URL_SCHEME)&&(e=e.slice(RF.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=KD.join(e.weightData),n=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const t=pM(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(t)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await _F(()=>a.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=n,await _F(()=>e.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:gM(e)}}}}RF.URL_SCHEME="downloads://";class PF{constructor(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a)return void t(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void t(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void e({modelTopology:a});const o=mM(r,e=>this.loadWeights(e));e(o)},n.onerror=e=>t("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(e){const t=[],n=[];for(const o of e)t.push(...o.weights),n.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),a=n.map(e=>this.loadWeightsFile(e,r[e]));return Promise.all(a).then(e=>[t,e])}loadWeightsFile(e,t){return new Promise((n,r)=>{const a=new FileReader;a.onload=e=>{const t=e.target.result;n(t)},a.onerror=t=>r("Failed to weights data from file of path '".concat(e,"'.")),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],n=this.weightsFiles.map(e=>hM(e.name)),r={};for(const a of e)a.paths.forEach(e=>{const a=hM(e);if(-1!==t.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(a,"'"));if(t.push(a),-1===n.indexOf(a))throw new Error("Weight file with basename '".concat(a,"' is not provided."));r[e]=this.weightsFiles[n.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(t.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function DF(e){return new PF(e)}function MF(e,t,n,r){!function(e){EO(null!=e&&Array.isArray(e)&&e.length>0,()=>"promises must be a none empty array")}(e),function(e,t){EO(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)),EO(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)),EO(t>=e,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(e.map(o=>(o.then(o=>{const i=n+ ++a/e.length*(r-n);return t(i),o}),o)))}async function FF(e,t){null==t&&(t={});const n=null==t.fetchFunc?iA().platform.fetch:t.fetchFunc,r=e.map(e=>n(e,t.requestInit,{isBinary:!0})),a=(null==t.onProgress?await Promise.all(r):await MF(r,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return null==t.onProgress?await Promise.all(a):await MF(a,t.onProgress,.5,1)}async function LF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return zF(e=>FF(e,{requestInit:r}))(e,t,n)}function zF(e){return async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const a=t.map(()=>!1),o={},i=null!=r?r.map(()=>!1):[],s=[];if(t.forEach((e,t)=>{let n=0;e.weights.forEach(e=>{const c="quantization"in e?e.quantization.dtype:e.dtype,l=HD[c]*OO(e.shape),u=()=>{a[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:l})};null!=r?r.forEach((t,n)=>{t===e.name&&(u(),i[n]=!0)}):u(),s.push(e.name),n+=l})}),!i.every(e=>e)){const e=r.filter((e,t)=>!i[t]);throw new Error("Could not find weights in manifest with names: "+"".concat(e.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const c=a.reduce((e,t,n)=>(t&&e.push(n),e),[]),l=[];c.forEach(e=>{t[e].paths.forEach(e=>{const t=n+(n.endsWith("/")?"":"/")+e;l.push(t)})});const u=await e(l),d={};let h=0;return c.forEach(e=>{const n=t[e].paths.length,r=new KD(u.slice(h,h+n));o[e].forEach(e=>{const t=nM(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const n in t)d[n]=t[n]}),h+=n}),d}}vM.registerSaveRouter(e=>iA().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(RF.URL_SCHEME)?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new RF(e)}(e.slice(RF.URL_SCHEME.length)):null);class BF{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(EO("function"===typeof t.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=iA().platform.fetch,EO(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&EO(2===e.length,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=pM(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);if(t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData){const n=KD.join(e.weightData);t.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:gM(e),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let t;try{t=await e.json()}catch(a){let e="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();return mM(await this.loadModelJSON(),e=>this.loadWeights(e))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=yM(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>function(e,t){var n;const r=null==t.fetchFunc?iA().platform.fetch:t.fetchFunc;let a,o=0;return null===(n=t.onProgress)||void 0===n||n.call(t,0),new ReadableStream({pull:async n=>{for(var i;o<e.length;){if(!a){const n=(await r(e[o],t.requestInit,{isBinary:!0})).body;a=n.getReader()}const{done:s,value:c}=await a.read();if(!s)return void n.enqueue(c);o++,a=void 0,null===(i=t.onProgress)||void 0===i||i.call(t,o/e.length)}n.close()}})}(t,this.loadOptions)})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),a=n>t?e.substring(n):"";return[r+"/",a]}(t),a=this.weightPathPrefix||n,o=[],i=[];for(const s of e)for(const e of s.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):o.push(a+e+r);return this.weightUrlConverter&&o.push(...await Promise.all(i)),o}async loadWeights(e){const t=await this.getWeightUrls(e);return[yM(e),await FF(t,this.loadOptions)]}}function jF(e){return null!=e.match(BF.URL_SCHEME_REGEX)}BF.URL_SCHEME_REGEX=/^https?:\/\//;const WF=(e,t)=>{if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>jF(e)):jF(e),n)return UF(e,t)}return null};function UF(e,t){return new BF(e,t)}function VF(e,t){return UF(e,t)}vM.registerSaveRouter(WF),vM.registerLoadRouter(WF);class GF{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class HF{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class KF{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function qF(e,t,n,r){return new KF(XF(...arguments))}function XF(e,t,n,r){if(1===arguments.length){return null!=e.modelTopology||null!=e.weightSpecs?new GF(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GF({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new GF({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function YF(e){return new HF(e)}function QF(e){return new HF(e)}function ZF(e,t,n){if(NO(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=MD(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return VD(e,t,r,n)}let $F,JF=!1;function eL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,o=!1,i=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)o=!0;else if(null!=e.getContext)i=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(null!=CP(mP,OD.backendName)){const n={pixels:e},r={numChannels:t};return OD.runKernel(mP,n,r)}const[c,l]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height];let u,d;if(i)u=e.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)u=e.data;else if(o||a||s){if(null==$F)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");$F=new OffscreenCanvas(1,1).getContext("2d")}else $F=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});$F.canvas.width=c,$F.canvas.height=l,$F.drawImage(e,0,0,c,l),u=$F.getImageData(0,0,c,l).data}if(4===t)d=new Int32Array(u);else{const e=c*l;d=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)d[n*t+e]=u[4*n+e]}return ZF(d,[l,c,t],"int32")}function tL(e){if(2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(e.rank,"."));const t=2===e.rank?1:e.shape[2];if(t>4||2===t)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(t));if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error("Unsupported type for toPixels: ".concat(e.dtype,".")+" Please use float32 or int32 tensors.")}async function nL(e,t){let n=zD(e,"img","toPixels");if(!(e instanceof lD)){const e=n;n=rF(e,"int32"),e.dispose()}tL(n);const[r,a]=n.shape.slice(0,2),o=2===n.rank?1:n.shape[2],i=await n.data(),s="float32"===n.dtype?255:1,c=new Uint8ClampedArray(a*r*4);for(let l=0;l<r*a;++l){const e=[0,0,0,255];for(let r=0;r<o;r++){const t=i[l*o+r];if("float32"===n.dtype){if(t<0||t>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(t,"."))}else if("int32"===n.dtype&&(t<0||t>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(t,"."));1===o?(e[0]=t*s,e[1]=t*s,e[2]=t*s):e[r]=t*s}const t=4*l;c[t+0]=Math.round(e[0]),c[t+1]=Math.round(e[1]),c[t+2]=Math.round(e[2]),c[t+3]=Math.round(e[3])}if(null!=t){if(!JF){null!=CP(a_,OD.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),JF=!0)}t.width=a,t.height=r;const e=t.getContext("2d"),n=new ImageData(c,a,r);e.putImageData(n,0,0)}return n!==e&&n.dispose(),c}const rL=WD({fromPixels_:eL}),aL=-2,oL=-1;function iL(e,t,n){const r=e.shape.length;EO(r===t.length,()=>"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")),EO(r===n.length,()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,")."));for(let a=0;a<r;++a)EO(t[a]+n[a]<=e.shape[a],()=>"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")"))}function sL(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function cL(e,t,n){const r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function lL(e,t,n,r){const a=[...e];for(let o=a.length;o<r.length;o++)a.push(1);for(let o=0;o<n;o++)0===o?a[t]=1:(a.splice(t,0,1),a.pop());return a}function uL(e,t,n){return n<=e?n:n-(t-1)}function dL(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function hL(e,t,n,r,a,o,i,s,c){const l=e.length;let u=new Array(l),d=new Array(l),h=new Array(l);if(t.length&&n>0){const c=t[0],l=n+1;u=pL(i,c,l,r,e),d=fL(s,c,l,a,e),h=lL(o,c,l,e)}else for(let p=0;p<l;p++)u[p]=gL(i,r,o,e,p,c),d[p]=yL(s,a,o,e,p,c),h[p]=mL(o,p,c);return{begin:u,end:d,strides:h}}function pL(e,t,n,r,a){const o=[...a],i=dL(n,t);for(let s=0;s<o.length;s++)if(i.indexOf(s)>-1)o[s]=0;else{const a=uL(t,n,s);let i=r[a];e&1<<a&&(i=0),o[s]=i}return o}function fL(e,t,n,r,a){const o=[...a],i=dL(n,t);for(let s=0;s<o.length;s++)if(i.indexOf(s)>-1)o[s]=Number.MAX_SAFE_INTEGER;else{const a=uL(t,n,s);let i=r[a];e&1<<a&&(i=Number.MAX_SAFE_INTEGER),o[s]=i}for(let s=0;s<o.length;s++){const e=a[s];o[s]<0&&(o[s]+=e),o[s]=kO(0,o[s],a[s])}return o}function mL(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function gL(e,t,n,r,a,o){let i=t[a];const s=n[a]||1;(e&1<<a||o&1<<a||null==i)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=r[a];return i<0&&(i+=c),i=kO(0,i,c-1),i}function yL(e,t,n,r,a,o){let i=t[a];const s=n[a]||1;(e&1<<a||o&1<<a||null==i)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=r[a];return i<0&&(i+=c),i=s>0?kO(0,i,c):kO(-1,i,c-1),i}function vL(e,t,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function bL(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function xL(e,t,n){let r;const a=e.shape.length;let o;return r="number"===typeof t?[t,...new Array(a-1).fill(0)]:t.length<a?t.concat(new Array(a-t.length).fill(0)):t.slice(),r.forEach(e=>{EO(-1!==e,()=>"slice() does not support negative begin indexing.")}),o=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,o=o.map((t,n)=>t>=0?t:(EO(-1===t,()=>"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")),e.shape[n]-r[n])),[r,o]}function wL(e,t,n,r,a,o,i,s,c){let l;if(null==r?(l=new Array(t.length),l.fill(1)):l=r,null!=i&&0!==(i&i-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:c};for(let v=0;v<d.dims;v++)u&&0!==(1<<v&s)&&d.numAddAxisAfterEllipsis++,1<<v&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(aL),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(oL),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);let p=!0,f=!0,m=!0;const g=[],y=[];for(let v=0;v<e.length;++v){if(0===h.strides[v])throw Error("strides[".concat(v,"] must be non-zero"));const t=!!(h.shrinkAxisMask&1<<v),n=e[v];if(-1===n){g.push(t?1:-1);continue}const r=[h.beginMask&1<<v,h.endMask&1<<v],a=[h.strides[v]>0?0:-1,h.strides[v]>0?n:n-1];if(t&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[v];const o=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(t){const e=h.begin[v]<0?n+h.begin[v]:h.begin[v];if(h.begin[v]=e,h.end[v]=h.begin[v]+1,e<0||e>=n)throw Error("slice index ".concat(h.begin[v]," of dimension ").concat(v," out of bounds."))}else h.begin[v]=kL(h.begin[v],0,h.strides[v],n,r,a),h.end[v]=kL(h.end[v],1,h.strides[v],n,r,a);const e=1===h.strides[v]&&0===h.begin[v]&&h.end[v]===n;p=p&&e,f=f&&(0===v&&1===h.strides[v]||e)}else p=p&&1===h.strides[v]&&o,f=f&&(0===v&&1===h.strides[v]||o);let i,s=!1;if(h.beginValid&&h.endValid?(i=h.end[v]-h.begin[v],s=!0):t?(i=1,s=!0):o&&n>=0&&(i=h.strides[v]<0?-n:n,s=!0),s){let e;e=0===i||i<0!==h.strides[v]<0?0:Math.trunc(i/h.strides[v])+(i%h.strides[v]!==0?1:0),g.push(e)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const e=h.finalShapeGatherIndices[v];e>=0?y.push(g[e]):e===aL&&y.push(1)}return{finalShapeSparse:y.filter((e,t)=>h.finalShapeGatherIndices[t]!==aL),finalShape:y,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function kL(e,t,n,r,a,o){if(a[t])return n>0?o[t]:o[t+1&1];{const t=e<0?r+e:e;return t<o[0]?o[0]:t>o[1]?o[1]:t}}const SL=WD({acos_:function(e){const t={x:zD(e,"x","acos")};return OD.runKernel(hA,t)}});const CL=WD({acosh_:function(e){const t={x:zD(e,"x","acosh")};return OD.runKernel(pA,t)}});const IL=WD({addN_:function(e){EO(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),EO(e.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length));const t=e.map((e,t)=>zD(e,"tensors".concat(t),"addN")),n=t[0];t.forEach(e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(e=>{if(!_O(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=t;return OD.runKernel(mA,r)}});const EL=WD({all_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:zD(e,"x","all","bool")},a={axis:t,keepDims:n};return OD.runKernel(gA,r,a)}});const TL=WD({any_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:zD(e,"x","any","bool")},a={axis:t,keepDims:n};return OD.runKernel(yA,r,a)}});const NL=WD({argMax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:zD(e,"x","argMax")},r={axis:t};return OD.runKernel(vA,n,r)}});const OL=WD({argMin_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:zD(e,"x","argMin")},r={axis:t};return OD.runKernel(bA,n,r)}});const AL=WD({asin_:function(e){const t={x:zD(e,"x","asin")};return OD.runKernel(xA,t)}});const _L=WD({asinh_:function(e){const t={x:zD(e,"x","asinh")};return OD.runKernel(wA,t)}});const RL=WD({atan_:function(e){const t={x:zD(e,"x","atan")};return OD.runKernel(kA,t)}});const PL=WD({atan2_:function(e,t){let n=zD(e,"a","atan2"),r=zD(t,"b","atan2");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel(CA,a)}});const DL=WD({atanh_:function(e){const t={x:zD(e,"x","atanh")};return OD.runKernel(SA,t)}});function ML(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0;return zL(e,[...t,e[3]],n,o,r,null,null,XL(a))}function FL(e,t,n,r,a,o){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,c]=WL(t);let l;if("channelsLast"===i)l=[s,c,e[3],e[3]];else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));l=[s,c,e[1],e[1]]}return zL(e,l,n,r,a,o,!1,i)}function LL(e,t,n,r,a,o){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,c,l]=UL(t);let u,d;if("NDHWC"===i)d="channelsLast",u=[s,c,l,e[4],e[4]];else{if("NCDHW"!==i)throw new Error("Unknown dataFormat ".concat(i));d="channelsFirst",u=[s,c,l,e[1],e[1]]}return BL(e,u,n,r,a,!1,d,o)}function zL(e,t,n,r,a,o){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,l,u,d]=[-1,-1,-1,-1];if("channelsLast"===s)[c,l,u,d]=e;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[c,d,l,u]=e}const[h,p,,f]=t,[m,g]=WL(n),[y,v]=WL(r),b=VL(h,y),x=VL(p,v),{padInfo:w,outHeight:k,outWidth:S}=function(e,t,n,r,a,o,i,s,c){let l,u,d;if("number"===typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const a=function(e,t,n,r,a){null==r&&(r=jL(e,t,n));const o=e[0],i=e[1],s=GL((o-t+2*r)/n+1,a),c=GL((i-t+2*r)/n+1,a);return[s,c]}([t,n],o,r,e,s);u=a[0],d=a[1]}else if("same"===e){u=Math.ceil(t/r),d=Math.ceil(n/a);const e=Math.max(0,(u-1)*r+o-t),s=Math.max(0,(d-1)*a+i-n),c=Math.floor(e/2),h=e-c,p=Math.floor(s/2);l={top:c,bottom:h,left:p,right:s-p,type:"SAME"}}else if("valid"===e)l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((t-o+1)/r),d=Math.ceil((n-i+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));{const h="channelsLast"===c?e[1][0]:e[2][0],p="channelsLast"===c?e[1][1]:e[2][1],f="channelsLast"===c?e[2][0]:e[3][0],m="channelsLast"===c?e[2][1]:e[3][1];l={top:h,bottom:p,left:f,right:m,type:0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},u=GL((t-o+h+p)/r+1,s),d=GL((n-i+f+m)/a+1,s)}}return{padInfo:l,outHeight:u,outWidth:d}}(a,l,u,m,g,b,x,o,s),C=i?f*d:f;let I;return"channelsFirst"===s?I=[c,C,k,S]:"channelsLast"===s&&(I=[c,k,S,C]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:u,inChannels:d,outHeight:k,outWidth:S,outChannels:C,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:v,inShape:e,outShape:I,filterShape:t}}function BL(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[c,l,u,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===i)[c,l,u,d,h]=e;else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));[c,h,l,u,d]=e}const[p,f,m,,g]=t,[y,v,b]=UL(n),[x,w,k]=UL(r),S=VL(p,x),C=VL(f,w),I=VL(m,k),{padInfo:E,outDepth:T,outHeight:N,outWidth:O}=function(e,t,n,r,a,o,i,s,c,l,u){let d,h,p,f;"valid"===e&&(e=0);if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const m=function(e,t,n,r,a,o){null==a&&(a=jL(e,t[0],r[0]));const i=[0,0,0,n];for(let s=0;s<3;s++)e[s]+2*a>=t[s]&&(i[s]=GL((e[s]-t[s]+2*a)/r[s]+1,o));return i}([t,n,r,1],[s,c,l],1,[a,o,i],e,u);h=m[0],p=m[1],f=m[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));{h=Math.ceil(t/a),p=Math.ceil(n/o),f=Math.ceil(r/i);const e=(h-1)*a+s-t,u=(p-1)*o+c-n,m=(f-1)*i+l-r,g=Math.floor(e/2),y=e-g,v=Math.floor(u/2),b=u-v,x=Math.floor(m/2);d={top:v,bottom:b,left:x,right:m-x,front:g,back:y,type:"SAME"}}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(a,l,u,d,y,v,b,S,C,I,s),A=o?g*h:g;let _;return"channelsFirst"===i?_=[c,A,T,N,O]:"channelsLast"===i&&(_=[c,T,N,O,A]),{batchSize:c,dataFormat:i,inDepth:l,inHeight:u,inWidth:d,inChannels:h,outDepth:T,outHeight:N,outWidth:O,outChannels:A,padInfo:E,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:C,effectiveFilterWidth:I,dilationDepth:x,dilationHeight:w,dilationWidth:k,inShape:e,outShape:_,filterShape:t}}function jL(e,t,n){const r=VL(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function WL(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function UL(e){return"number"===typeof e?[e,e,e]:e}function VL(e,t){return t<=1?e:e+(e-1)*(t-1)}function GL(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function HL(e){const[t,n,r]=WL(e);return 1===t&&1===n&&1===r}function KL(e,t){return HL(e)||HL(t)}function qL(e){return WL(e).every(e=>e>0)}function XL(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function YL(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)EO(RO(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach(t=>{t.forEach(t=>{EO(RO(t),()=>"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."))})})}}}const QL=WD({reshape_:function(e,t){const n={x:zD(e,"x","reshape","string_or_numeric")},r={shape:t};return OD.runKernel(xR,n,r)}});const ZL=WD({avgPool_:function(e,t,n,r,a){const o=zD(e,"x","avgPool","float32");EO(KL(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"));let i=o,s=!1;3===o.rank&&(s=!0,i=QL(o,[1,o.shape[0],o.shape[1],o.shape[2]])),EO(4===i.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(i.rank,".")),YL("avgPool",r,a);const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a};let u=OD.runKernel(IA,c,l);return u=rF(u,o.dtype),s?QL(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const $L=WD({avgPool3d_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=zD(e,"x","avgPool3d","float32");let s=i,c=!1;4===i.rank&&(c=!0,s=QL(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),EO(5===s.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),EO("NDHWC"===o,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),EO("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")),YL("avgPool3d",r,a);const l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:o};let d=OD.runKernel(TA,l,u);return d=rF(d,s.dtype),c?QL(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const JL=WD({concat_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;EO(e.length>=1,()=>"Pass at least one tensor to concat");const n=BD(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(e=>{if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}),1===n.length)return aF(n[0]);const r=n,a={axis:t};return OD.runKernel(BA,r,a)}});const ez=WD({matMul_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=zD(e,"a","matMul"),o=zD(t,"b","matMul");[a,o]=kD(a,o);const i={a:a,b:o},s={transposeA:n,transposeB:r};return OD.runKernel(OA,i,s)}});const tz=WD({sigmoid_:function(e){const t={x:zD(e,"x","sigmoid","float32")};return OD.runKernel(zR,t)}});const nz=WD({slice_:function(e,t,n){const r=zD(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},o={begin:t,size:n};return OD.runKernel(DR,a,o)}});const rz=WD({tanh_:function(e){const t={x:zD(e,"x","tanh","float32")};return OD.runKernel(oP,t)}});const az=WD({basicLSTMCell_:function(e,t,n,r,a,o){const i=zD(e,"forgetBias","basicLSTMCell"),s=zD(t,"lstmKernel","basicLSTMCell"),c=zD(n,"lstmBias","basicLSTMCell"),l=zD(r,"data","basicLSTMCell"),u=zD(a,"c","basicLSTMCell"),d=zD(o,"h","basicLSTMCell"),h=JL([l,d],1),p=ez(h,s),f=iF(p,c),m=f.shape[0],g=f.shape[1]/4,y=[m,g],v=nz(f,[0,0],y),b=nz(f,[0,g],y),x=nz(f,[0,2*g],y),w=nz(f,[0,3*g],y),k=iF(lF(tz(v),rz(b)),lF(u,tz(iF(i,x))));return[k,lF(rz(k),tz(w))]}});const oz=WD({batchToSpaceND_:function(e,t,n){const r=zD(e,"x","batchToSpaceND"),a=t.reduce((e,t)=>e*t);EO(r.rank>=1+t.length,()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)),EO(n.length===t.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)),EO(r.shape[0]%a===0,()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a));const o={x:r},i={blockShape:t,crops:n};return OD.runKernel(AA,o,i)}});const iz=WD({batchNorm_:function(e,t,n,r,a,o){null==o&&(o=.001);const i=zD(e,"x","batchNorm"),s=zD(t,"mean","batchNorm"),c=zD(n,"variance","batchNorm");let l,u;null!=a&&(l=zD(a,"scale","batchNorm")),null!=r&&(u=zD(r,"offset","batchNorm")),EO(s.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),EO(null==u||s.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),EO(null==l||s.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:function(e){let t;return t=0===e.rank||1===e.rank?QL(e,[1,1,1,e.size]):2===e.rank?QL(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?QL(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(i),scale:l,offset:u,mean:s,variance:c},h={varianceEpsilon:o},p=OD.runKernel(b_,d,h);return QL(p,i.shape)}});const sz=WD({batchNorm2d_:function(e,t,n,r,a,o){const i=zD(e,"x","batchNorm"),s=zD(t,"mean","batchNorm"),c=zD(n,"variance","batchNorm");let l,u;return null!=a&&(l=zD(a,"scale","batchNorm")),null!=r&&(u=zD(r,"offset","batchNorm")),EO(2===i.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(i.rank,".")),EO(2===s.rank||1===s.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,".")),EO(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&EO(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&EO(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),iz(i,s,c,u,l,o)}});const cz=WD({batchNorm3d_:function(e,t,n,r,a,o){const i=zD(e,"x","batchNorm"),s=zD(t,"mean","batchNorm"),c=zD(n,"variance","batchNorm");let l,u;return null!=a&&(l=zD(a,"scale","batchNorm")),null!=r&&(u=zD(r,"offset","batchNorm")),EO(3===i.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(i.rank,".")),EO(3===s.rank||1===s.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,".")),EO(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&EO(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&EO(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),iz(i,s,c,u,l,o)}});const lz=WD({batchNorm4d_:function(e,t,n,r,a,o){const i=zD(e,"x","batchNorm"),s=zD(t,"mean","batchNorm"),c=zD(n,"variance","batchNorm");let l,u;return null!=a&&(l=zD(a,"scale","batchNorm")),null!=r&&(u=zD(r,"offset","batchNorm")),EO(4===i.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(i.rank,".")),EO(4===s.rank||1===s.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,".")),EO(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&EO(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&EO(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),iz(i,s,c,u,l,o)}});const uz=WD({bincount_:function(e,t,n){const r=zD(e,"x","bincount"),a=zD(t,"weights","bincount");EO("int32"===r.dtype,()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)),EO(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),EO(a.size===r.size||0===a.size,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,"."));const o={x:r,weights:a},i={size:n};return OD.runKernel(_A,o,i)}});const dz=WD({bitwiseAnd_:function(e,t){const n=zD(e,"x","bitwiseAnd"),r=zD(t,"y","bitwiseAnd");if(!_O(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));const a={a:n,b:r};return OD.runKernel(RA,a)}});const hz=WD({broadcastArgs_:function(e,t){const n=zD(e,"s0","broadcastArgs","int32"),r=zD(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const a={s0:n,s1:r};return OD.runKernel(PA,a)}});const pz=WD({broadcastTo_:function(e,t){let n=zD(e,"broadcastTo","x");const r=n.shape;if(JO(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=QL(n,e)}const a=n.shape,o=Array.from(t);for(let c=t.length-1;c>=0;c--)if(a[c]===t[c])o[c]=1;else if(1!==n.shape[c])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===o.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length)return aF(n);const i={x:n},s={reps:o};return OD.runKernel(iP,i,s)}});const fz=WD({ceil_:function(e){const t={x:zD(e,"x","ceil","float32")};return OD.runKernel(MA,t)}});const mz=WD({clipByValue_:function(e,t,n){const r=zD(e,"x","clipByValue");if(EO(t<=n,()=>"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")),t===n)return wF(r.shape,t,r.dtype);const a={x:r},o={clipValueMin:t,clipValueMax:n};return OD.runKernel(FA,a,o)}});const gz=WD({concat1d_:function(e){return JL(e,0)}});const yz=WD({concat2d_:function(e,t){return JL(e,t)}});const vz=WD({concat3d_:function(e,t){return JL(e,t)}});const bz=WD({concat4d_:function(e,t){return JL(e,t)}});const xz=WD({conv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const s=zD(e,"x","conv2d","float32"),c=zD(t,"filter","conv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=QL(s,[1,s.shape[0],s.shape[1],s.shape[2]])),EO(4===l.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,".")),EO(4===c.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(c.rank,".")),YL("conv2d",r,i);const d="NHWC"===a?l.shape[3]:l.shape[1];EO(d===c.shape[2],()=>"Error in conv2d: depth of input (".concat(d,") must match ")+"input depth for filter ".concat(c.shape[2],".")),EO(KL(n,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")),EO(qL(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),EO(qL(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:l,filter:c},p={strides:n,pad:r,dataFormat:a,dilations:o,dimRoundingMode:i},f=OD.runKernel(jA,h,p);return u?QL(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const wz=WD({conv1d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0;const s=zD(e,"x","conv1d"),c=zD(t,"filter","conv1d");let l=s,u=!1;2===s.rank&&(u=!0,l=QL(s,[1,s.shape[0],s.shape[1]])),EO(3===l.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,".")),EO(3===c.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(c.rank,".")),YL("conv1d",r,i),EO(l.shape[2]===c.shape[1],()=>"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(c.shape[1],".")),EO(KL(n,o),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(o,"'")),EO(qL(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),EO(qL(n),()=>"Error in conv1D: Stride should be larger than 0."),EO("NWC"===a,()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));const d=QL(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=QL(l,[l.shape[0],1,l.shape[1],l.shape[2]]),p=xz(h,d,[1,n],r,"NHWC",[1,o],i);return QL(p,u?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}});const kz=WD({conv2DBackpropInput_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;EO(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let s=e,c=t,l=!1;3===t.rank&&(l=!0,c=QL(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),EO(4===s.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")),EO(4===c.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(c.rank)),EO(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank));const u="NHWC"===o?s[3]:s[1],d="NHWC"===o?c.shape[3]:c.shape[1];EO(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],".")),EO(d===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(d,") must ")+"match output depth for filter ".concat(n.shape[3],".")),YL("conv2dDerInput",a,i);const h={dy:c,filter:n},p={strides:r,pad:a,dataFormat:o,dimRoundingMode:i,inputShape:s},f=OD.runKernel(UA,h,p);return l?QL(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Sz=WD({conv2dTranspose_:function(e,t,n,r,a,o){const i=zD(e,"x","conv2dTranspose"),s=zD(t,"filter","conv2dTranspose");return kz(n,i,s,r,a,"NHWC",o)}});const Cz=WD({conv3d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const i=zD(e,"x","conv3d"),s=zD(t,"filter","conv3d");let c=i,l=!1;4===i.rank&&(l=!0,c=QL(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),EO(5===c.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,".")),EO(5===s.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")),EO(c.shape[4]===s.shape[3],()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")),EO(KL(n,o),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")),EO("NDHWC"===a,()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")),EO(qL(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),EO(qL(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:c,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:o},h=OD.runKernel(VA,u,d);return l?QL(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const Iz=WD({conv3DBackpropInput_:function(e,t,n,r,a){EO(e.length===t.rank,()=>"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match"));let o=e,i=t,s=!1;4===t.rank&&(s=!0,i=QL(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),o=[1,e[0],e[1],e[2],e[3]]);const c=o[4],l=i.shape[4];EO(5===o.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,".")),EO(5===i.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)),EO(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)),EO(c===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[3],".")),EO(l===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],"."));const u={dy:i,filter:n},d={pad:a,strides:r,inputShape:o},h=OD.runKernel(HA,u,d);return s?QL(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const Ez=WD({conv3dTranspose_:function(e,t,n,r,a){const o=zD(e,"x","conv3dTranspose"),i=zD(t,"filter","conv3dTranspose");return Iz(n,o,i,r,a)}});const Tz=WD({cos_:function(e){const t={x:zD(e,"x","cos","float32")};return OD.runKernel(KA,t)}});const Nz=WD({cosh_:function(e){const t={x:zD(e,"x","cosh","float32")};return OD.runKernel(qA,t)}});const Oz=WD({cumprod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:zD(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:r};return OD.runKernel(XA,a,o)}});const Az=WD({cumsum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:zD(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:r};return OD.runKernel(YA,a,o)}});const _z=WD({denseBincount_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=zD(e,"x","denseBincount"),o=zD(t,"weights","denseBincount");EO("int32"===a.dtype,()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)),EO(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")),EO(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),EO(o.size===a.size||0===o.size,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(o.shape,"."));const i={x:a,weights:o},s={size:n,binaryOutput:r};return OD.runKernel(ZA,i,s)}});const Rz=WD({depthToSpace_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=zD(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],i="NHWC"===n?r.shape[3]:r.shape[1];EO(t>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(t)),EO(a*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)),EO(o*t>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)),EO(i%(t*t)===0,()=>"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(i," for depthToSpace with input shape ").concat(r.shape));const s={x:r},c={blockSize:t,dataFormat:n};return OD.runKernel($A,s,c)}});const Pz=WD({depthwiseConv2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0;const s=zD(e,"x","depthwiseConv2d","float32"),c=zD(t,"filter","depthwiseConv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=QL(s,[1,s.shape[0],s.shape[1],s.shape[2]])),EO(4===l.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")),EO(4===c.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(c.rank,"."));const d="NHWC"===a?l.shape[3]:l.shape[1];EO(d===c.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(d,") must match the inChannels dimension in ")+"filter ".concat(c.shape[2],".")),YL("depthwiseConv2d",r,i);const h={x:l,filter:c},p={strides:n,pad:r,dataFormat:a,dilations:o,dimRoundingMode:i},f=OD.runKernel(JA,h,p);return u?QL(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});const Dz=WD({diag_:function(e){const t={x:zD(e,"x","diag")};return OD.runKernel(n_,t)}});const Mz=WD({dilation2d_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const i=zD(e,"x","dilation2d"),s=zD(t,"filter","dilation2d");EO(3===i.rank||4===i.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,".")),EO(3===s.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")),EO("NHWC"===o,()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(o));let c=i,l=!1;3===i.rank&&(c=QL(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=!0),EO(c.shape[3]===s.shape[2],()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(c.shape[3]," vs ").concat(s.shape[2]));const u={x:c,filter:s},d={strides:n,pad:r,dilations:a},h=OD.runKernel(r_,u,d);return l?QL(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const Fz=WD({equal_:function(e,t){let n=zD(e,"a","equal","string_or_numeric"),r=zD(t,"b","equal","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(u_,a)}});const Lz=WD({where_:function(e,t,n){const r=zD(t,"a","where"),a=zD(n,"b","where"),o=zD(e,"condition","where","bool"),i=TF(TF(o.shape,r.shape),a.shape),s={condition:pz(o,i),t:pz(r,i),e:pz(a,i)};return OD.runKernel(RR,s)}});const zz=WD({divNoNan_:function(e,t){let n=zD(e,"a","div"),r=zD(t,"b","div");[n,r]=kD(n,r);const a=cF(n,r),o=hF(a),i=Fz(r,o);return Lz(i,o,a)}});const Bz=WD({dot_:function(e,t){const n=zD(e,"t1","dot"),r=zD(t,"t2","dot");EO((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,"."));const a=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];if(EO(a===o,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(o,".")),1===n.rank&&1===r.rank){const e=QL(n,[1,-1]),t=QL(r,[-1,1]),a=ez(e,t);return QL(a,[])}if(1===n.rank&&2===r.rank){const e=QL(n,[1,-1]),t=QL(r,[r.shape[0],r.shape[1]]),a=ez(e,t);return QL(a,[a.size])}if(2===n.rank&&1===r.rank){const e=QL(r,[-1,1]),t=ez(n,e);return QL(t,[t.size])}{const e=QL(r,[r.shape[0],r.shape[1]]);return ez(n,e)}}});const jz=WD({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map((e,t)=>zD(e,"tensors".concat(t),"einsum")),o={equation:e};return OD.runKernel(i_,a,o)}});const Wz=WD({elu_:function(e){const t={x:zD(e,"x","elu","float32")};return OD.runKernel(s_,t)}});const Uz=WD({ensureShape_:function(e,t){const n=zD(e,"x","ensureShape","string_or_numeric");if(!function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!==e[n]&&null!==t[n]&&e[n]!==t[n])return!1;return!0}(n.shape,t))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(t));return e}});const Vz=WD({erf_:function(e){let t=zD(e,"x","erf");EO("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=rF(t,"float32"));const n={x:t};return OD.runKernel(l_,n)}});function Gz(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Hz(e,t,n){const r=e.length+t.length,a=[];let o=0,i=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[o++]):a.push(t[i++]);return a}function Kz(e,t){const n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map(t=>e[t])]}function qz(e,t){return Hz(e,t.map(e=>1),t)}function Xz(e,t,n){EO(Gz(t,n),()=>"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input."))}function Yz(e,t){if(Gz(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(e=>n.push(e)),n}function Qz(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Zz(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const $z=WD({max_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:zD(e,"x","max")},a={reductionIndices:t,keepDims:n};return OD.runKernel(W_,r,a)}});const Jz=WD({min_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:zD(e,"x","min")},a={axis:t,keepDims:n};return OD.runKernel(Y_,r,a)}});const eB=WD({sum_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=zD(e,"x","sum");"bool"===r.dtype&&(r=rF(r,"int32"));const a={x:r},o={axis:t,keepDims:n};return OD.runKernel(WR,a,o)}});function tB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return CF(e);if(1!==e.rank&&null===n)return tB(QL(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return eB(CF(e),n);if(t===1/0)return $z(CF(e),n);if(t===-1/0)return Jz(CF(e),n);if("euclidean"===t||2===t)return uF(eB(kF(CF(e),fF(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return $z(eB(CF(e),n[0]),n[1]-1);if(t===1/0)return $z(eB(CF(e),n[1]),n[0]);if(t===-1/0)return Jz(eB(CF(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return uF(eB(dF(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}const nB=WD({norm_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=tB(e=zD(e,"x","norm"),t,n);let o=a.shape;if(r){const t=LO(n,e.shape);o=qz(a.shape,t)}return QL(a,o)}});const rB=WD({euclideanNorm_:function(e){return nB(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const aB=WD({exp_:function(e){const t={x:zD(e,"x","exp")};return OD.runKernel(d_,t)}});const oB=WD({expandDims_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=zD(e,"x","expandDims","string_or_numeric");EO(t<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:t};return OD.runKernel(h_,r,a)}});const iB=WD({expm1_:function(e){const t={x:zD(e,"x","expm1")};return OD.runKernel(p_,t)}});const sB=WD({tile_:function(e,t){const n=zD(e,"x","tile","string_or_numeric");EO(n.rank===t.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,"."));const r={x:n},a={reps:t};return OD.runKernel(iP,r,a)}});const cB=WD({eye_:function(e,t,n){null==t&&(t=e);const r=nF([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t;for(let i=0;i<a;++i)r.set(1,i,i);const o=QL(r.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return sB(oB(o,0),[n[0],1,1]);if(2===n.length)return sB(oB(oB(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return sB(oB(oB(oB(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const lB=WD({floor_:function(e){const t={x:zD(e,"x","floor","float32")};return OD.runKernel(y_,t)}});const uB=WD({gather_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a={x:zD(e,"x","gather"),indices:zD(t,"indices","gather","int32")},o={axis:n,batchDims:r};return OD.runKernel(x_,a,o)}});const dB=WD({greater_:function(e,t){let n=zD(e,"a","greater","string_or_numeric"),r=zD(t,"b","greater","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(k_,a)}});const hB=WD({greaterEqual_:function(e,t){let n=zD(e,"a","greaterEqual","string_or_numeric"),r=zD(t,"b","greaterEqual","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(S_,a)}});const pB=WD({imag_:function(e){const t={input:zD(e,"input","imag")};return OD.runKernel(E_,t)}});const fB=WD({isFinite_:function(e){const t={x:zD(e,"x","isFinite")};return OD.runKernel(T_,t)}});const mB=WD({isInf_:function(e){const t={x:zD(e,"x","isInf")};return OD.runKernel(N_,t)}});const gB=WD({isNaN_:function(e){const t={x:zD(e,"x","isNaN")};return OD.runKernel(O_,t)}});const yB=WD({leakyRelu_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:zD(e,"x","leakyRelu")},r={alpha:t};return OD.runKernel(A_,n,r)}});const vB=WD({less_:function(e,t){let n=zD(e,"a","less","string_or_numeric"),r=zD(t,"b","less","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(__,a)}});const bB=WD({lessEqual_:function(e,t){let n=zD(e,"a","lessEqual","string_or_numeric"),r=zD(t,"b","lessEqual","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(R_,a)}});function xB(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return OD.runKernel(P_,{},r)}const wB=WD({localResponseNormalization_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const o=zD(e,"x","localResponseNormalization");EO(4===o.rank||3===o.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(o.rank,".")),EO(RO(t),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,"."));let i=o,s=!1;3===o.rank&&(s=!0,i=QL(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const c={x:i},l={depthRadius:t,bias:n,alpha:r,beta:a},u=OD.runKernel(B_,c,l);return s?QL(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const kB=WD({log_:function(e){const t={x:zD(e,"x","log","float32")};return OD.runKernel(D_,t)}});const SB=WD({log1p_:function(e){const t={x:zD(e,"x","log1p")};return OD.runKernel(M_,t)}});const CB=WD({neg_:function(e){const t={x:zD(e,"x","neg")};return OD.runKernel(tR,t)}});const IB=WD({softplus_:function(e){const t={x:zD(e,"x","softplus")};return OD.runKernel(BR,t)}});const EB=WD({logSigmoid_:function(e){const t=zD(e,"x","logSigmoid");return pF(e=>({value:CB(IB(CB(e))),gradFunc:t=>lF(t,tz(CB(e)))}))(t)}});const TB=WD({logSoftmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=zD(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));const r=pF((e,n)=>{const r=$z(e,t,!0),a=SF(e,r),o=SF(rF(a,"float32"),kB(eB(aB(a),t,!0)));n([o]);return{value:o,gradFunc:(e,n)=>{const[r]=n,a=aB(r);return SF(e,lF(eB(e,t,!0),a))}}});return r(n)}});const NB=WD({logSumExp_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=zD(e,"x","logSumExp"),a=LO(t,r.shape),o=$z(r,a,!0),i=SF(r,o),s=aB(i),c=eB(s,a),l=kB(c),u=iF(QL(o,l.shape),l);if(n){const e=qz(u.shape,a);return QL(u,e)}return u}});const OB=WD({logicalAnd_:function(e,t){const n=zD(e,"a","logicalAnd","bool"),r=zD(t,"b","logicalAnd","bool");TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(F_,a)}});const AB=WD({logicalNot_:function(e){const t={x:zD(e,"x","logicalNot","bool")};return OD.runKernel(L_,t)}});const _B=WD({logicalOr_:function(e,t){const n=zD(e,"a","logicalOr","bool"),r=zD(t,"b","logicalOr","bool");TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(z_,a)}});const RB=WD({logicalXor_:function(e,t){const n=zD(e,"a","logicalXor","bool"),r=zD(t,"b","logicalXor","bool");return TF(n.shape,r.shape),OB(_B(e,t),AB(OB(e,t)))}}),PB=2147483648;const DB=WD({searchSorted_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=zD(e,"sortedSequence","searchSorted"),a=zD(t,"values","searchSorted"),o=r.shape[r.shape.length-1],i=a.shape[a.shape.length-1],s=QL(r,[-1,o]),c=QL(a,[-1,i]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(OO(c.shape)>=PB)throw new Error("values tensor size must less than ".concat(PB));if(s.shape[1]>=PB)throw new Error("trailing dim_size must less than ".concat(PB," for int32 output type, was ").concat(s.shape[1]));const l={sortedSequence:s,values:c},u={side:n};return OD.runKernel(_R,l,u)}});function MB(e,t){return DB(e,t,"left")}const FB=WD({maxPool_:function(e,t,n,r,a){const o=zD(e,"x","maxPool");let i=o,s=!1;3===o.rank&&(s=!0,i=QL(o,[1,o.shape[0],o.shape[1],o.shape[2]])),EO(4===i.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.rank,".")),EO(KL(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")),YL("maxPool",r,a);const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a},u=OD.runKernel(V_,c,l);return s?QL(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const LB=WD({maxPool3d_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const i=zD(e,"x","maxPool3d");let s=i,c=!1;4===i.rank&&(c=!0,s=QL(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),EO(5===s.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),EO("NDHWC"===o,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)),YL("maxPool3d",r,a);const l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:o},d=OD.runKernel(H_,l,u);return c?QL(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const zB=WD({maxPoolWithArgmax_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o={x:zD(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=OD.runKernel(q_,o,i);return{result:s[0],indexes:s[1]}}});const BB=WD({mean_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:zD(e,"x","mean")},a={axis:t,keepDims:n};return OD.runKernel(X_,r,a)}});function jB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(JO(e),"complex64"===t){const t=jB(e,"float32"),n=jB(e,"float32");return UD(t,n)}const n=$O(OO(e),t);return OD.makeTensor(n,e,t)}function WB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(JO(e),"complex64"===t){const t=WB(e,"float32"),n=jB(e,"float32");return UD(t,n)}const n=ZO(OO(e),t);return OD.makeTensor(n,e,t)}function UB(e,t){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===e)return[];let r=zD(e,"x","meshgrid",e instanceof lD?e.dtype:"float32");if(void 0===t)return[r];let a=zD(t,"y","meshgrid",t instanceof lD?t.dtype:"float32");const o=OO(r.shape),i=OO(a.shape);return"xy"===n?(r=QL(r,[1,-1]),a=QL(a,[-1,1]),[ez(WB([i,1],r.dtype),r),ez(a,WB([1,o],a.dtype))]):(r=QL(r,[-1,1]),a=QL(a,[1,-1]),[ez(r,WB([1,i],r.dtype)),ez(WB([o,1],a.dtype),a)])}const VB=WD({minimum_:function(e,t){let n=zD(e,"a","minimum"),r=zD(t,"b","minimum");[n,r]=kD(n,r),"bool"===n.dtype&&(n=rF(n,"int32"),r=rF(r,"int32")),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(Q_,a)}});const GB=WD({mirrorPad_:function(e,t,n){EO("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,"."));const r=zD(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");EO(t.length===r.rank,()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,"."));const a="reflect"===n?1:0;for(let s=0;s<r.rank;s++)EO(2===t[s].length,()=>"Invalid number of paddings. Must be length of 2 each."),EO(t[s][0]>=0&&t[s][0]<=r.shape[s]-a&&t[s][1]>=0&&t[s][1]<=r.shape[s]-a,()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-a," or less than 0 for input of ")+"shape ".concat(r.shape));const o={paddings:t,mode:n},i={x:r};return OD.runKernel(Z_,i,o)}});const HB=WD({mod_:function(e,t){let n=zD(e,"a","mod"),r=zD(t,"b","mod");[n,r]=kD(n,r);const a={a:n,b:r};return OD.runKernel($_,a)}});const KB=WD({moments_:function(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=LO(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=zD(e,"x","moments")).shape),r=BB(e,n,t);let a=r.shape;t||(a=qz(r.shape,n));const o=dF(SF(rF(e,"float32"),QL(r,a)));return{mean:r,variance:BB(o,n,t)}}});const qB=WD({multiRNNCell_:function(e,t,n,r){const a=zD(t,"data","multiRNNCell"),o=BD(n,"c","multiRNNCell"),i=BD(r,"h","multiRNNCell");let s=a;const c=[];for(let d=0;d<e.length;d++){const t=e[d](s,o[d],i[d]);c.push(t[0]),c.push(t[1]),s=t[1]}const l=[],u=[];for(let d=0;d<c.length;d+=2)l.push(c[d]),u.push(c[d+1]);return[l,u]}});const XB=WD({multinomial_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=zD(e,"logits","multinomial"),o=a.size,i=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(o,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));n=n||Math.random();const s={logits:1===i?QL(a,[1,-1]):a},c={numSamples:t,seed:n,normalized:r},l=OD.runKernel(J_,s,c);return 1===i?QL(l,[l.size]):l}});const YB=WD({notEqual_:function(e,t){let n=zD(e,"a","notEqual","string_or_numeric"),r=zD(t,"b","notEqual","string_or_numeric");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(nR,a)}});const QB=WD({oneHot_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));const o={indices:zD(e,"indices","oneHot","int32")},i={dtype:a,depth:t,onValue:n,offValue:r};return OD.runKernel(sR,o,i)}});const ZB=WD({onesLike_:function(e){const t={x:zD(e,"x","onesLike")};return OD.runKernel(iR,t)}});const $B=WD({outerProduct_:function(e,t){const n=zD(e,"v1","outerProduct"),r=zD(t,"v2","outerProduct");EO(1===n.rank&&1===r.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,"."));const a=QL(n,[-1,1]),o=QL(r,[1,-1]);return ez(a,o)}});const JB=WD({pad_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=zD(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:t,constantValue:n},o={x:r};return OD.runKernel(lR,o,a)}});const ej=WD({pad1d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return EO(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),JB(e,[t],n)}});const tj=WD({pad2d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return EO(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),JB(e,t,n)}});const nj=WD({pad3d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return EO(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),JB(e,t,n)}});const rj=WD({pad4d_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return EO(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),JB(e,t,n)}});const aj=WD({spaceToBatchND_:function(e,t,n){const r=zD(e,"x","spaceToBatchND");EO(r.rank>=1+t.length,()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)),EO(n.length===t.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)),EO(r.shape.reduce((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e,!0),()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString()));const a={x:r},o={blockShape:t,paddings:n};return OD.runKernel(UR,a,o)}});const oj=WD({pool_:function(e,t,n,r,a,o,i){null==a&&(a=[1,1]),null==o&&(o=1),0===r&&(r="valid");const s=zD(e,"x","maxPool");let c=s,l=!1;3===s.rank&&(l=!0,c=QL(s,[1,s.shape[0],s.shape[1],s.shape[2]])),EO(KL(o,a),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(a,"'"));const u=FL(c.shape,t,o,a,r),d=[u.dilationHeight,u.dilationWidth];let h;h="same"===r?function(e,t){const n=e.map((e,n)=>e+(e-1)*(t[n]-1)),r=n.map(e=>e-1),a=r.map(e=>Math.floor(e/2)),o=r.map((e,t)=>e-a[t]);return r.map((e,t)=>[a[t],o[t]])}([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[f,m]=function(e,t,n){const r=n.map(e=>e[0]),a=n.map(e=>e[1]),o=e.concat(r,a),i=t.map((e,t)=>(e-o[t]%e)%e),s=a.map((e,t)=>e+i[t]),c=t.map((e,t)=>[r[t],s[t]]),l=t.map((e,t)=>[0,i[t]]);return[c,l]}([u.inHeight,u.inWidth],d,h),g=p?r:"valid",y=p?c:aj(c,d,f),v=("avg"===n?()=>ZL(y,t,o,g,i):()=>FB(y,t,o,g,i))(),b=p?v:oz(v,d,m);return l?QL(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const ij=WD({prelu_:function(e,t){const n={x:zD(e,"x","prelu"),alpha:zD(t,"alpha","prelu")};return OD.runKernel(dR,n)}});const sj=WD({prod_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=zD(e,"x","prod");"bool"===r.dtype&&(r=rF(r,"int32"));const a={x:r},o={axis:t,keepDims:n};return OD.runKernel(hR,a,o)}});const cj=WD({raggedGather_:function(e,t,n,r){const a={paramsNestedSplits:e.map((e,t)=>zD(e,"tensors".concat(t),"raggedGather","int32")),paramsDenseValues:zD(t,"paramsDenseValues","raggedGather"),indices:zD(n,"indices","raggedGather","int32")},o={outputRaggedRank:r},i=OD.runKernel(pR,a,o);return{outputNestedSplits:i.slice(0,i.length-1),outputDenseValues:i[i.length-1]}}});const lj=WD({raggedRange_:function(e,t,n){const r=zD(e,"starts","raggedRange"),a={starts:r,limits:zD(t,"limits","raggedRange",r.dtype),deltas:zD(n,"deltas","raggedRange",r.dtype)},o=OD.runKernel(fR,a);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}});const uj=WD({raggedTensorToTensor_:function(e,t,n,r,a){const o=zD(e,"shape","raggedTensorToTensor","int32"),i=zD(t,"values","raggedTensorToTensor"),s={shape:o,values:i,defaultValue:zD(n,"defaultValue","raggedTensorToTensor",i.dtype),rowPartitionTensors:r.map((e,t)=>zD(e,"tensors".concat(t),"raggedTensorToTensor","int32"))},c={rowPartitionTypes:a};return OD.runKernel(mR,s,c)}});const dj=WD({rand_:function(e,t,n){JO(e);const r=OO(e);let a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(let o=0;o<r;o++)a[o]=t();return OD.makeTensor(a,e,n)}});var hj=n(4334);class pj{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=a||Math.random();this.random=hj.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,a,o;do{r=2*this.random()-1,a=2*this.random()-1,o=r*r+a*a}while(o>=1||0===o);const i=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*i,t=this.mean+this.stdDev*a*i,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class fj{constructor(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;const a=r||Math.random();this.randu=hj.alea(a.toString()),this.randn=new pj(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,n,r,a,o;for(;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,e=r*r,t=1-.331*e*e,n=.5*e+this.d*(1-o+Math.log(o)),a=this.randu(),a<t||Math.log(a)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class mj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(e," - ").concat(t," <= 1 and dtype is not float"));this.random=hj.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const gj=WD({randomGamma_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(JO(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const o=new fj(t,n,r,a),i=nF(e,r);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});const yj=WD({randomNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(JO(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const o=new pj(t,n,r,!1,a),i=nF(e,r);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});const vj=WD({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return yj(e,0,1,t,n)}});const bj=WD({randomUniform_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;JO(e);const o=nF(e,r),i=new mj(t,n,null,a);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const xj=WD({randomUniformInt_:function(e,t,n,r){return bj(e,t,n,"int32",r)}});function wj(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const a={start:e,stop:t,step:n,dtype:r};return OD.runKernel(gR,{},a)}const kj=WD({real_:function(e){const t={input:zD(e,"input","real")};return OD.runKernel(yR,t)}});const Sj=WD({reciprocal_:function(e){const t={x:zD(e,"x","reciprocal")};return OD.runKernel(vR,t)}});const Cj=WD({relu_:function(e){const t={x:zD(e,"x","relu")};return OD.runKernel(bR,t)}});const Ij=WD({relu6_:function(e){const t={x:zD(e,"x","relu6")};return OD.runKernel(IR,t)}});const Ej=WD({reverse_:function(e,t){const n={x:zD(e,"x","reverse")},r={dims:t};return OD.runKernel(ER,n,r)}});const Tj=WD({reverse1d_:function(e){const t=zD(e,"x","reverse");return EO(1===t.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")),Ej(t,0)}});const Nj=WD({reverse2d_:function(e,t){const n=zD(e,"x","reverse");return EO(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),Ej(n,t)}});const Oj=WD({reverse3d_:function(e,t){const n=zD(e,"x","reverse");return EO(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),Ej(n,t)}});const Aj=WD({reverse4d_:function(e,t){const n=zD(e,"x","reverse");return EO(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),Ej(n,t)}});const _j=WD({round_:function(e){const t={x:zD(e,"x","round")};return OD.runKernel(TR,t)}});const Rj=WD({rsqrt_:function(e){const t={x:zD(e,"x","rsqrt","float32")};return OD.runKernel(NR,t)}});const Pj=WD({selu_:function(e){const t={x:zD(e,"x","selu")};return OD.runKernel(PR,t)}});const Dj=WD({separableConv2d_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=zD(e,"x","separableConv2d"),c=zD(t,"depthwiseFilter","separableConv2d"),l=zD(n,"pointwiseFilter","separableConv2d");let u=s,d=!1;if(3===s.rank&&(d=!0,u=QL(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");EO(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,".")),EO(4===c.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")),EO(4===l.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")),EO(1===l.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],".")),EO(1===l.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],"."));const h=c.shape[2],p=c.shape[3];EO(l.shape[2]===h*p,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(h*p,", ")+"but got ".concat(l.shape[2],"."));const f=Pz(u,c,r,a,i,o),m=xz(f,l,1,"valid",i);return d?QL(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const Mj=async function(e,t){const n=zD(e,"x","setdiff1d"),r=zD(t,"y","setdiff1d");EO(n.dtype===r.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,").")),EO(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),EO(1===r.rank,()=>"y should be 1D tensor, but got y (".concat(r.shape,")."));const a=await n.data(),o=await r.data(),i=new Set(o);let s=0;for(let u=0;u<a.length;u++)i.has(a[u])||s++;const c=new oD([s],n.dtype),l=new oD([s],"int32");for(let u=0,d=0;u<a.length;u++)i.has(a[u])||(c.values[d]=a[u],l.values[d]=u,d++);return[c.toTensor(),l.toTensor()]};const Fj=WD({sign_:function(e){const t={x:zD(e,"x","sign")};return OD.runKernel(LR,t)}});const Lj=WD({sin_:function(e){const t={x:zD(e,"x","sin","float32")};return OD.runKernel(MR,t)}});const zj=WD({sinh_:function(e){const t={x:zD(e,"x","sinh")};return OD.runKernel(FR,t)}});const Bj=WD({slice1d_:function(e,t,n){const r=zD(e,"x","slice1d");return EO(1===r.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")),nz(r,[t],[n])}});const jj=WD({slice2d_:function(e,t,n){const r=zD(e,"x","slice2d");return EO(2===r.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")),nz(r,t,n)}});const Wj=WD({slice3d_:function(e,t,n){const r=zD(e,"x","slice3d");return EO(3===r.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")),nz(r,t,n)}});const Uj=WD({slice4d_:function(e,t,n){const r=zD(e,"x","slice4d");return EO(4===r.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")),nz(r,t,n)}});const Vj=WD({softmax_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=zD(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));const r={logits:n},a={dim:t};return OD.runKernel(GR,r,a)}});const Gj=WD({fft_:function(e){EO("complex64"===e.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return OD.runKernel(f_,t)}});const Hj=WD({ifft_:function(e){EO("complex64"===e.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,"."));const t={input:e};return OD.runKernel(I_,t)}});const Kj=WD({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const a=QL(e,[n,t]);r=Hj(a)}else{const a=[n,2*(t-1)],o=QL(kj(e),[n,t]),i=QL(pB(e),[n,t]),s=Ej(nz(o,[0,1],[n,t-2]),1),c=lF(Ej(nz(i,[0,1],[n,t-2]),1),fF(-1)),l=JL([o,s],1),u=JL([i,c],1),d=QL(UD(l,u),[a[0],a[1]]);r=Hj(d)}if(r=kj(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=QL(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});const qj=WD({split_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:zD(e,"x","split")},a={numOrSizeSplits:t,axis:n};return OD.runKernel(VR,r,a)}});const Xj=WD({rfft_:function(e,t){EO("float32"===e.dtype,()=>"The dtype for rfft() must be real value but got ".concat(e.dtype));let n=e.shape[e.shape.length-1];const r=e.size/n;let a;if(null!=t&&t<n){const r=e.shape.map(e=>0),o=e.shape.map(e=>e);o[e.shape.length-1]=t,a=nz(e,r,o),n=t}else if(null!=t&&t>n){const r=e.shape.map(e=>e);r[e.shape.length-1]=t-n,a=JL([e,jB(r)],e.shape.length-1),n=t}else a=e;const o=hF(a),i=QL(UD(a,o),[r,n]),s=Gj(i),c=Math.floor(n/2)+1,l=kj(s),u=pB(s),d=qj(l,[c,n-c],l.shape.length-1),h=qj(u,[c,n-c],u.shape.length-1),p=a.shape.slice();return p[a.shape.length-1]=c,QL(UD(d[0],h[0]),p)}});const Yj=WD({squaredDifference_:function(e,t){let n=zD(e,"a","squaredDifference"),r=zD(t,"b","squaredDifference");[n,r]=kD(n,r),TF(n.shape,r.shape);const a={a:n,b:r};return OD.runKernel(QR,a,{})}});const Qj=WD({squeeze_:function(e,t){const n=zD(e,"x","squeeze","string_or_numeric");return QL(n,zO(n.shape,t).newShape)}});const Zj=WD({stack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=BD(e,"tensors","stack","string_or_numeric");EO(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&EO(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:t};return OD.runKernel(cR,r,a)}});const $j=WD({step_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:zD(e,"x","step")},r={alpha:t};return OD.runKernel(fP,n,r)}});const Jj=WD({stridedSlice_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const l={x:zD(e,"x","stridedSlice","string_or_numeric")},u={begin:t,end:n,strides:r,beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:s,shrinkAxisMask:c};return OD.runKernel(JR,l,u)}});const eW=WD({tan_:function(e){const t={x:zD(e,"x","tan","float32")};return OD.runKernel(aP,t)}});function tW(e,t){NO(e);const n=MD(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return VD(e,null,n,t)}function nW(e,t,n){if(NO(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=MD(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return VD(e,t,r,n)}function rW(e,t,n){if(NO(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=MD(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return VD(e,t,r,n)}function aW(e,t,n){if(NO(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=MD(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return VD(e,t,r,n)}function oW(e,t,n){if(NO(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=MD(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return VD(e,t=t||r,r,n)}function iW(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(o+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(o+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(o+" update.rank != ".concat(a+e.length-r));for(let i=0;i<a;++i)if(n.shape[i]!==t.shape[i])throw new Error(o+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(t.shape[i],")."));for(let i=0;i<n.rank-a;++i)if(n.shape[i+a]!==e[i+r])throw new Error(o+" updates.shape[".concat(i+a,"] (").concat(n.shape[i+a],") != shape[").concat(i+a,"] (").concat(e[i+a],")"))}function sW(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}iW(n,t,e)}function cW(e,t,n){const r=t.shape.length,a=r>1?t.shape[r-1]:1,o=n.length;let i=1;for(let c=a;c<o;++c)i*=n[c];const s=a<1?1:a;return{sliceRank:a,numUpdates:OO(t.shape)/s,sliceSize:i,strides:[...qO(n.slice(0,a)),1],outputSize:OO(n)}}const lW=WD({tensorScatterUpdate_:function(e,t,n){const r=zD(e,"tensor","tensorScatterupdate"),a=zD(t,"indices","tensorScatterupdate","int32"),o=zD(n,"updates","tensorScatterupdate");if(sW(o,a,r.shape),r.dtype!==o.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(o.dtype,"."));const i={tensor:r,indices:a,updates:o};return OD.runKernel(AR,i,{})}});const uW=WD({topk_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=zD(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));const o={x:r},i={k:t,sorted:n},[s,c]=OD.runKernel(sP,o,i);return{values:s,indices:c}}});const dW=WD({truncatedNormal_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(JO(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const o=new pj(t,n,r,!0,a),i=nF(e,r);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});const hW=WD({unique_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=zD(e,"x","unique","string_or_numeric");EO(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:t},[o,i]=OD.runKernel(uP,r,a);return{values:o,indices:i}}});const pW=WD({unsortedSegmentSum_:function(e,t,n){const r=zD(e,"x","unsortedSegmentSum"),a=zD(t,"segmentIds","unsortedSegmentSum","int32");EO(RO(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:a},i={numSegments:n};return OD.runKernel(hP,o,i)}});const fW=WD({unstack_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=zD(e,"x","unstack","string_or_numeric");EO(t>=-n.shape.length&&t<n.shape.length,()=>"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));const r={value:n},a={axis:t};return OD.runKernel(dP,r,a)}});function mW(e,t){return DB(e,t,"right")}function gW(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return OD.makeVariable(e,t,n,r)}function yW(e,t){const n=[];for(let o=0;o<t.length;o++)t[o]&&n.push(o);const r=nF(e,"int32"),a=nF([n.length,e.length],"int32");for(let o=0;o<n.length;o++){const t=r.indexToLoc(n[o]),i=o*e.length;a.values.set(t,i)}return a.toTensor()}const vW=async function(e){const t=zD(e,"condition","whereAsync","bool"),n=await t.data(),r=yW(t.shape,n);return e!==t&&t.dispose(),r};const bW=async function(e,t,n){const r=zD(e,"tensor","boolMask"),a=zD(t,"mask","boolMask","bool"),o=null==n?0:n,i=a.rank,s=r.shape;EO(i>0,()=>"mask cannot be scalar"),TO(s.slice(o,o+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let m=o;m<o+i;m++)c*=s[m];const l=s.slice(0,o).concat([c],s.slice(o+i)),u=QL(r,l),d=QL(a,[-1]),h=await vW(d),p=Qj(h,[1]),f=uB(u,p,o);return e!==r&&r.dispose(),t!==a&&a.dispose(),p.dispose(),u.dispose(),d.dispose(),h.dispose(),f};const xW=WD({transpose_:function(e,t,n){const r=zD(e,"x","transpose");if(null==t&&(t=r.shape.map((e,t)=>t).reverse()),EO(r.rank===t.length,()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")),t.forEach(e=>{EO(e>=0&&e<r.rank,()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t))}),r.rank<=1)return r.clone();const a={x:r},o={perm:t};return"complex64"===r.dtype?XD(()=>{let e=kj(r),t=pB(r);return e=OD.runKernel(lP,{x:e},o),t=OD.runKernel(lP,{x:t},o),n&&(t=CB(t)),UD(e,t)}):OD.runKernel(lP,a,o)}});const wW=WD({movingAverage_:function(e,t,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=zD(e,"v","movingAverage"),i=zD(t,"x","movingAverage"),s=zD(n,"decay","movingAverage");!function(e,t){EO(e.dtype===t.dtype,()=>"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match"))}(o,i),EO(_O(o.shape,i.shape),()=>"Shape mismatch in v and x");const c=fF(1),l=SF(c,s);let u=lF(SF(i,o),l);if(a){EO(null!=r,()=>"When using zeroDebias: true, step is required.");const e=zD(r,"step","movingAverage");u=cF(u,SF(c,kF(s,e)))}return iF(o,u)}});const kW=WD({scatterND_:function(e,t,n){JO(n);const r=zD(e,"indices","scatterND","int32"),a=zD(t,"updates","scatterND");sW(a,r,n);const o={indices:r,updates:a},i={shape:n};return OD.runKernel(OR,o,i)}});const SW=WD({sparseToDense_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;JO(n);const a=zD(e,"sparseIndices","sparseToDense","int32"),o=zD(t,"sparseValues","sparseToDense","string_or_numeric"),i=zD(r,"defaultValue","sparseToDense",o.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));const a=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(o,"."));const i=t.size;if(0!==t.rank&&(1!==t.rank||i!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,o,n,i);const s={sparseIndices:a,sparseValues:o,defaultValue:i},c={outputShape:n};return OD.runKernel(YR,s,c)}});const CW=WD({gatherND_:function(e,t){const n=zD(t,"indices","gatherND","int32"),r={params:zD(e,"x","gatherND","string_or_numeric"),indices:n};return OD.runKernel(w_,r)}});const IW=WD({dropout_:function(e,t,n,r){const a=zD(e,"x","dropout");if(EO("float32"===a.dtype,()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")),EO(t>=0&&t<1,()=>"rate must be a float in the range [0, 1), but got ".concat(t,".")),0===t)return e instanceof lD?a.clone():a;const o=function(e,t){if(null==t)return e.shape.slice();if(_O(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),i=1-t,s=cF(lB(iF(bj(o,0,1,"float32",r),i)),i);return lF(a,s)}});function EW(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function TW(e,t,n){const r=1-e%2,a=new Float32Array(e);for(let o=0;o<e;++o){const i=2*Math.PI*o/(e+r-1);a[o]=t-n*Math.cos(i)}return tW(a,"float32")}const NW=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=zD(e,"predictions","inTopK"),a=zD(t,"targets","inTopK");EO(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank)),EO(r.rank-1===a.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(a.rank)),TO(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];EO(n>0&&n<=o,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(n));const i=await r.data(),s=await a.data(),[c,l]=[i.length/o,o],u=BO("bool",c);for(let d=0;d<c;d++){const e=d*l,t=i.subarray(e,e+l),r=[];for(let n=0;n<t.length;n++)r.push({value:t[n],index:n});r.sort((e,t)=>t.value-e.value),u[d]=0;for(let a=0;a<n;a++)if(r[a].index===s[d]){u[d]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),GD(u,a.shape,"bool")};const OW=WD({conv2DBackpropFilter_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=QL(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=QL(t,[1,t.shape[0],t.shape[1],t.shape[2]])),EO(4===s.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")),EO(4===c.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(c.shape,".")),EO(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,"."));const l="NHWC"===o?s.shape[3]:s.shape[1],u="NHWC"===o?c.shape[3]:c.shape[1];EO(l===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],".")),EO(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],").")),YL("conv2dDerFilter",a,i);const d={x:s,dy:c},h={strides:r,pad:a,dataFormat:o,dimRoundingMode:i,filterShape:n};return OD.runKernel(WA,d,h)}});function AW(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return lF(e,$j(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function _W(e,t){let n=t;const r=EF(e.shape,t.shape);return r.length>0&&(n=eB(n,r)),QL(n,e.shape)}function RW(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Cj(e);if("elu"===t)return Wz(e);if("relu6"===t)return Ij(e);if("prelu"===t)return ij(e,n);if("leakyrelu"===t)return yB(e,r);if("sigmoid"===t)return tz(e);throw new Error("Unknown fused activation ".concat(t,"."))}const PW=(e,t)=>!(e>0)||"linear"===t;const DW=WD({fusedConv2d_:function(e){let{x:t,filter:n,strides:r,pad:a,dataFormat:o="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(l=l||"linear",!1===PW(OD.state.gradientDepth,l)){EO("NHWC"===o,()=>"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let e=xz(t,n,r,a,o,i,s);return null!=c&&(e=iF(e,c)),RW(e,l,u,d)}const h=zD(t,"x","conv2d","float32"),p=zD(n,"filter","conv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=QL(h,[1,h.shape[0],h.shape[1],h.shape[2]])),EO(4===f.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(f.rank,".")),EO(4===p.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")),YL("fused conv2d",a,s);const g="NHWC"===o?f.shape[3]:f.shape[1];EO(p.shape[2]===g,()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],".")),EO(KL(r,i),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(i,"'"));const y=zL(f.shape,p.shape,r,i,a,s);let v,b;if(null!=c&&(v=zD(c,"bias","fused conv2d"),[v]=kD(v,h),"NHWC"===o?TF(y.outShape,v.shape):(EO(v.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(v.shape.length,".")),EO(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],()=>"Error in fused conv2d: bias shape (".concat(v.shape,") is not ")+"compatible with the number of output channels "+"(".concat(y.outChannels,")")))),null!=u){const e=u.shape;if(EO(e.length<=1||3===e.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(e.length,".")),1===e.length)EO(1===e[0]||e[0]===y.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(e,") is not compatible with the number of output ")+"channels (".concat(y.outChannels,")."));else if(3===e.length)try{TF(e,y.outShape)}catch(S){const t="Error in fused conv2d: PReLU activation weights (".concat(e,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(y.outShape,").");throw Error(t)}b=zD(u,"prelu weights","fused conv2d")}const x=(e,t)=>{EO("NHWC"===o,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported."));const[n,s,c,u]=t,d=AW(e,c,l);EO(HL(i),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'"));const h=[kz(s.shape,d,n,r,a),OW(s,d,n.shape,r,a)];if(null!=u){const e=_W(u,d);h.push(e)}return h},w={x:f,filter:p,bias:v,preluActivationWeights:b},k={strides:r,pad:a,dataFormat:o,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:d};if(null==c){const e=pF((e,t,n)=>{let r=OD.runKernel(vP,w,k);return n([t,e,r]),m&&(r=QL(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}});return e(f,p)}{const e=pF((e,t,n,r)=>{let a=OD.runKernel(vP,w,k);return r([t,e,a,n]),m&&(a=QL(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:x}});return e(f,p,v)}}});const MW=WD({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=QL(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=QL(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={x:s,dy:c},u={strides:r,pad:a,dimRoundingMode:i,dilations:o,filterShape:n};return OD.runKernel(e_,l,u)}});const FW=WD({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,s=t,c=!1;3===t.rank&&(c=!0,s=QL(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const l={dy:s,filter:n},u={strides:r,pad:a,dimRoundingMode:i,dilations:o,inputShape:e},d=OD.runKernel(t_,l,u);return c?QL(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const LW=WD({fusedDepthwiseConv2d_:function(e){let{x:t,filter:n,strides:r,pad:a,dataFormat:o="NHWC",dilations:i=[1,1],dimRoundingMode:s,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}=e;if(!1===PW(OD.state.gradientDepth,l)){let e=Pz(t,n,r,a,o,i,s);return null!=c&&(e=iF(e,c)),RW(e,l,u,d)}const h=zD(t,"x","depthwiseConv2d","float32"),p=zD(n,"filter","depthwiseConv2d","float32");let f=h,m=!1;3===h.rank&&(m=!0,f=QL(h,[1,h.shape[0],h.shape[1],h.shape[2]])),EO(4===f.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(f.rank,".")),EO(4===p.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(p.rank,".")),EO(f.shape[3]===p.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(f.shape[3],") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")),null==i&&(i=[1,1]),EO(KL(r,i),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(i,"'")),YL("fused depthwiseConv2d",a,s);const g=zL(f.shape,p.shape,r,i,a,s,!0);let y,v;null!=c&&(y=zD(c,"bias","fused conv2d"),[y]=kD(y,h),TF(g.outShape,y.shape)),null!=u&&(v=zD(u,"prelu weights","fused depthwiseConv2d"));const b=(e,t)=>{EO(HL(i),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(i,"'"));const[n,o,c,u]=t,d=AW(e,c,l),h=FW(o.shape,d,n,r,a,i,s),p=MW(o,d,n.shape,r,a,i,s);if(null!=u){return[h,p,_W(y,d)]}return[h,p]},x={x:f,filter:p,bias:y,preluActivationWeights:v},w={strides:r,pad:a,dataFormat:o,dilations:i,dimRoundingMode:s,activation:l,leakyreluAlpha:d};if(null==c){const e=pF((e,t,n)=>{let r=OD.runKernel(bP,x,w);return n([t,e,r]),m&&(r=QL(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}});return e(f,p)}{const e=pF((e,t,n,r)=>{let a=OD.runKernel(bP,x,w);return r([t,e,a,n]),m&&(a=QL(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}});return e(f,p,y)}}});const zW=WD({fusedMatMul_:function(e){let{a:t,b:n,transposeA:r=!1,transposeB:a=!1,bias:o,activation:i="linear",preluActivationWeights:s,leakyreluAlpha:c=.2}=e;if(!1===PW(OD.state.gradientDepth,i)){let e=ez(t,n,r,a);return null!=o&&(e=iF(e,o)),RW(e,i,s,c)}let l=zD(t,"a","fused matMul"),u=zD(n,"b","fused matMul");[l,u]=kD(l,u);const d=r?l.shape[l.rank-2]:l.shape[l.rank-1],h=a?u.shape[u.rank-1]:u.shape[u.rank-2],p=r?l.shape[l.rank-1]:l.shape[l.rank-2],f=a?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=OO(m),v=OO(g);EO(d===h,()=>"Error in fused matMul: inner shapes (".concat(d,") and (")+"".concat(h,") of Tensors with shapes ").concat(l.shape," and ")+"".concat(u.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const b=TF(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),x=QL(l,r?[y,d,p]:[y,p,d]),w=QL(u,a?[v,f,h]:[v,h,f]);let k,S;null!=o&&(k=zD(o,"bias","fused matMul"),[k]=kD(k,l),TF(b,k.shape)),null!=s&&(S=zD(s,"prelu weights","fused matMul"));const C=(e,t)=>{const[n,s,c,l]=t,u=AW(QL(e,c.shape),c,i);let d,h;if(r||a?!r&&a?(d=ez(u,s,!1,!1),h=ez(u,n,!0,!1)):r&&!a?(d=ez(s,u,!1,!0),h=ez(n,u,!1,!1)):(d=ez(s,u,!0,!0),h=ez(u,n,!0,!0)):(d=ez(u,s,!1,!0),h=ez(n,u,!0,!1)),null!=o){return[d,h,_W(l,u)]}return[d,h]},I={a:x,b:w,bias:k,preluActivationWeights:S},E={transposeA:r,transposeB:a,activation:i,leakyreluAlpha:c};if(null==o){const e=pF((e,t,n)=>{const r=OD.runKernel(yP,I,E);return n([e,t,r]),{value:QL(r,b),gradFunc:C}});return e(x,w)}{const e=pF((e,t,n,r)=>{const a=OD.runKernel(yP,I,E);return r([e,t,a,n]),{value:QL(a,b),gradFunc:C}});return e(x,w,k)}}});const BW=WD({hammingWindow_:function(e){return TW(e,.54,.46)}});const jW=WD({hannWindow_:function(e){return TW(e,.5,.5)}});const WW=WD({frame_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0;const i=[];for(;o+t<=e.size;)i.push(nz(e,o,t)),o+=n;if(r)for(;o<e.size;){const r=o+t-e.size,s=JL([nz(e,o,t-r),wF([r],a)]);i.push(s),o+=n}return 0===i.length?nW([],[0,t]):QL(JL(i),[i.length,t])}});const UW=WD({stft_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:jW;null==r&&(r=EW(t));const o=WW(e,t,n),i=lF(o,a(t));return Xj(i,r)}});const VW=WD({cropAndResize_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=zD(e,"image","cropAndResize"),s=zD(t,"boxes","cropAndResize","float32"),c=zD(n,"boxInd","cropAndResize","int32"),l=s.shape[0];EO(4===i.rank,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")),EO(2===s.rank&&4===s.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(s.shape,".")),EO(1===c.rank&&c.shape[0]===l,()=>"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(s.shape,".")),EO(2===r.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")),EO(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(r)),EO("bilinear"===a||"nearest"===a,()=>"method must be bilinear or nearest, but was ".concat(a));const u={image:i,boxes:s,boxInd:c},d={method:a,extrapolationValue:o,cropSize:r};return OD.runKernel(QA,u,d)}});const GW=WD({flipLeftRight_:function(e){const t=zD(e,"image","flipLeftRight","float32");EO(4===t.rank,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,"."));const n={image:t};return OD.runKernel(g_,n,{})}});const HW=WD({grayscaleToRGB_:function(e){const t=zD(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];EO(t.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),EO(1===r,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,"."));const a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,sB(t,a)}});const KW=WD({rgbToGrayscale_:function(e){const t=zD(e,"image","RGBToGrayscale"),n=t.rank-1,r=t.shape[n];EO(t.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")),EO(3===r,()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,"."));const a=t.dtype,o=rF(t,"float32"),i=tW([.2989,.587,.114]);let s;switch(t.rank){case 2:s=jz("ij,j->i",o,i);break;case 3:s=jz("ijk,k->ij",o,i);break;case 4:s=jz("ijkl,l->ijk",o,i);break;case 5:s=jz("ijklm,m->ijkl",o,i);break;case 6:s=jz("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return s=oB(s,-1),rF(s,a)}});const qW=WD({rotateWithOffset_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=zD(e,"image","rotateWithOffset","float32");EO(4===a.rank,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,"."));const o={image:a},i={radians:t,fillValue:n,center:r};return OD.runKernel(gP,o,i)}});function XW(e,t,n,r,a,o){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==o&&(o=0);const i=e.shape[0];return n=Math.min(n,i),EO(0<=r&&r<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'")),EO(2===e.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")),EO(4===e.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])),EO(1===t.rank,()=>"scores must be a 1D tensor"),EO(t.shape[0]===i,()=>"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(t.shape[0])),EO(0<=o&&o<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(o,"'")),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:o}}const YW=WD({nonMaxSuppression_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const o=zD(e,"boxes","nonMaxSuppression","float32"),i=zD(t,"scores","nonMaxSuppression","float32"),s=XW(o,i,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return OD.runKernel(rR,{boxes:o,scores:i},c)}});function QW(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,a=e.length,o=0,i=!1;for(;r<a;){o=r+(a-r>>>1);const s=n(t,e[o]);s>0?r=o+1:(a=o,i=!s)}return i?r:-r-1}(e,t,n||ZW)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function ZW(e,t){return e>t?1:e<t?-1:0}function $W(e,t,n,r,a){return tU(e,t,n,r,a,0)}function JW(e,t,n,r,a,o){return tU(e,t,n,r,a,0,!1,o,!0)}function eU(e,t,n,r,a,o){return tU(e,t,n,r,a,o,!0)}function tU(e,t,n,r,a,o){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=[];for(let g=0;g<t.length;g++)t[g]>a&&l.push({score:t[g],boxIndex:g,suppressBeginIndex:0});l.sort(aU);const u=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&l.length>0;){const t=l.pop(),{score:n,boxIndex:o,suppressBeginIndex:i}=t;if(n<a)break;let s=!1;for(let c=d.length-1;c>=i;--c){const n=nU(e,o,d[c]);if(n>=r){s=!0;break}if(t.score=t.score*rU(r,u,n),t.score<=a)break}t.suppressBeginIndex=d.length,s||(t.score===n?(d.push(o),h.push(t.score)):t.score>a&&QW(l,t,aU))}const p=d.length,f=n-p;s&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),c&&(m.validOutputs=p),m}function nU(e,t,n){const r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),p=(s-o)*(c-i),f=(d-l)*(h-u);if(p<=0||f<=0)return 0;const m=Math.max(o,l),g=Math.max(i,u),y=Math.min(s,d),v=Math.min(c,h),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(p+f-b)}function rU(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function aU(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const oU=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const o=zD(e,"boxes","nonMaxSuppressionAsync"),i=zD(t,"scores","nonMaxSuppressionAsync"),s=XW(o,i,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const c=await Promise.all([o.data(),i.data()]),l=c[0],u=c[1],{selectedIndices:d}=$W(l,u,n,r,a);return o!==e&&o.dispose(),i!==t&&i.dispose(),tW(d,"int32")};const iU=WD({nonMaxSuppressionWithScore_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=zD(e,"boxes","nonMaxSuppression"),s=zD(t,"scores","nonMaxSuppression"),c=XW(i,s,n,r,a,o);n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,o=c.softNmsSigma;const l={boxes:i,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:o},d=OD.runKernel(oR,l,u);return{selectedIndices:d[0],selectedScores:d[1]}}});const sU=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const i=zD(e,"boxes","nonMaxSuppressionAsync"),s=zD(t,"scores","nonMaxSuppressionAsync"),c=XW(i,s,n,r,a,o);n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,o=c.softNmsSigma;const l=await Promise.all([i.data(),s.data()]),u=l[0],d=l[1],{selectedIndices:h,selectedScores:p}=eU(u,d,n,r,a,o);return i!==e&&i.dispose(),s!==t&&s.dispose(),{selectedIndices:tW(h,"int32"),selectedScores:tW(p)}};const cU=WD({nonMaxSuppressionPadded_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=zD(e,"boxes","nonMaxSuppression"),s=zD(t,"scores","nonMaxSuppression"),c=XW(i,s,n,r,a,null),l={boxes:i,scores:s},u={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:o},d=OD.runKernel(aR,l,u);return{selectedIndices:d[0],validOutputs:d[1]}}});const lU=async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const i=zD(e,"boxes","nonMaxSuppressionAsync"),s=zD(t,"scores","nonMaxSuppressionAsync"),c=XW(i,s,n,r,a,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,[h,p]=await Promise.all([i.data(),s.data()]),{selectedIndices:f,validOutputs:m}=JW(h,p,l,u,d,o);return i!==e&&i.dispose(),s!==t&&s.dispose(),{selectedIndices:tW(f,"int32"),validOutputs:fF(m,"int32")}};const uU=WD({resizeBilinear_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=zD(e,"images","resizeBilinear");EO(3===a.rank||4===a.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),EO(2===t.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")),EO(!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;3===a.rank&&(i=!0,o=QL(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:o},c={alignCorners:n,halfPixelCenters:r,size:t},l=OD.runKernel(SR,s,c);return i?QL(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const dU=WD({resizeNearestNeighbor_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=zD(e,"images","resizeNearestNeighbor");EO(3===a.rank||4===a.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),EO(2===t.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")),EO("float32"===a.dtype||"int32"===a.dtype,()=>"`images` must have `int32` or `float32` as dtype"),EO(!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=a,i=!1;3===a.rank&&(i=!0,o=QL(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,s={images:o},c={alignCorners:n,halfPixelCenters:r,size:t},l=OD.runKernel(wR,s,c);return i?QL(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const hU=WD({threshold_:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=zD(e,"image","threshold"),o=a.shape[0]*a.shape[1];let i,s,c,l,u=lF(tW([r]),255);if(EO(3===a.rank,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,".")),EO(3===a.shape[2]||1===a.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],".")),EO("int32"===a.dtype||"float32"===a.dtype,()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,".")),EO("otsu"===t||"binary"===t,()=>"Method must be binary or otsu, but was ".concat(t)),3===a.shape[2]){[i,s,c]=qj(a,[1,1,1],-1);const e=lF(i,.2989),t=lF(s,.587),n=lF(c,.114);l=iF(iF(e,t),n)}else l=e;if("otsu"===t){u=function(e,t){let n,r,a,o,i,s,c=tW([-1]),l=tW([0]),u=tW([0]);for(let d=0;d<e.size-1;d++){n=nz(e,0,d+1),r=nz(e,d+1),i=cF(eB(n),t),s=cF(eB(r),t);const h=eB(lF(n,wj(0,n.size)));a=cF(h,eB(n));const p=wF(r.shape,n.size),f=iF(wj(0,r.size),p),m=lF(r,f);o=cF(eB(m),eB(r));const g=SF(a,o),y=SF(a,o),v=lF(i,s);u=lF(lF(v,g),y);const b=dB(u,l);l=Lz(b,u,l),c=Lz(b,tW([d]),c)}return c}(uz(rF(_j(l),"int32"),GD([]),256),o)}const d=n?bB(l,u):dB(l,u);return rF(lF(d,255),"int32")}});const pU=WD({transform_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;const i=zD(e,"image","transform","float32"),s=zD(t,"transforms","transform","float32");EO(4===i.rank,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(i.rank,".")),EO(2===s.rank&&(s.shape[0]===i.shape[0]||1===s.shape[0])&&8===s.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),EO(null==o||2===o.length,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(o,"."));const c={image:i,transforms:s},l={interpolation:n,fillMode:r,fillValue:a,outputShape:o};return OD.runKernel(cP,c,l)}});const fU=WD({bandPart_:function(e,t,n){const r=zD(e,"a","bandPart");EO(r.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));const a=r.shape,[o,i]=r.shape.slice(-2);let s,c;"number"===typeof t?(EO(t%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(t,".")),EO(t<=o,()=>"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,").")),s=zD(t<0?o:t,"numLower","bandPart")):(EO("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),s=Lz(vB(t,0),o,VB(t,o))),"number"===typeof n?(EO(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,".")),EO(n<=i,()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(i,").")),c=zD(n<0?i:n,"numUpper","bandPart")):(EO("int32"===n.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),c=Lz(vB(n,0),i,VB(n,i)));const l=QL(wj(0,o,1,"int32"),[-1,1]),u=wj(0,i,1,"int32"),d=SF(l,u),h=OB(bB(d,s),hB(d,CB(c))),p=jB([o,i],r.dtype);return QL(Zj(fW(QL(r,[-1,o,i])).map(e=>Lz(h,e,p))),a)}});const mU=WD({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,EO(null!=e&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=e[0].shape[0];for(let t=1;t<e.length;++t)EO(e[t].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")"))}else t=!0,e=qj(e,e.shape[0],0).map(e=>Qj(e,[0]));EO(e.length<=e[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],")."));const n=[],r=e;for(let a=0;a<e.length;++a)n.push(OD.tidy(()=>{let e=r[a];if(a>0)for(let t=0;t<a;++t){const r=lF(eB(lF(n[t],e)),n[t]);e=SF(e,r)}return cF(e,nB(e,"euclidean"))}));return t?Zj(n,0):n}});function gU(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OD.tidy(()=>{EO(2===e.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));const n=e.shape[0],r=e.shape[1];let a=cB(n),o=aF(e);const i=nW([[1]],[1,1]);let s=aF(i);const c=n>=r?r:n;for(let e=0;e<c;++e){const t=o,c=s,l=a;[s,o,a]=OD.tidy(()=>{const t=nz(o,[e,e],[n-e,1]),c=nB(t),l=nz(o,[e,e],[1,1]),u=Lz(dB(l,0),nW([[-1]]),nW([[1]])),d=SF(l,lF(u,c)),h=cF(t,d);s=1===h.shape[0]?aF(i):JL([i,nz(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=CB(cF(ez(u,d),c)),f=nz(o,[e,0],[n-e,r]),m=lF(p,s),g=xW(s);if(0===e)o=SF(f,ez(m,ez(g,f)));else{const t=SF(f,ez(m,ez(g,f)));o=JL([nz(o,[0,0],[e,r]),t],0)}const y=xW(m),v=nz(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=SF(v,ez(ez(v,s),y));else{const t=SF(v,ez(ez(v,s),y));a=JL([nz(a,[0,0],[n,e]),t],1)}return[s,o,a]}),YD([t,c,l])}return!t&&n>r&&(a=nz(a,[0,0],[n,r]),o=nz(o,[0,0],[r,r])),[a,o]})}const yU=WD({qr_:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(EO(e.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)),2===e.rank)return gU(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),r=fW(QL(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],o=[];r.forEach(e=>{const[n,r]=gU(e,t);a.push(n),o.push(r)});return[QL(Zj(a,0),e.shape),QL(Zj(o,0),e.shape)]}}});var vU;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(vU||(vU={}));const bU=WD({computeWeightedLoss_:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vU.SUM_BY_NONZERO_WEIGHTS;const r=zD(e,"losses","computeWeightedLoss");let a=null;null!=t&&(a=zD(t,"weights","computeWeightedLoss"));const o=null==a?r:lF(r,a);if(n===vU.NONE)return o;if(n===vU.SUM)return eB(o);if(n===vU.MEAN){if(null==a)return BB(o);{const e=r.size/a.size,t=cF(eB(o),eB(a));return e>1?cF(t,fF(e)):t}}if(n===vU.SUM_BY_NONZERO_WEIGHTS){if(null==a)return cF(eB(o),fF(r.size));{const e=lF(a,WB(r.shape)),t=rF(eB(YB(e,fF(0))),"float32");return cF(eB(o),t)}}throw Error("Unknown reduction: ".concat(n))}});const xU=WD({absoluteDifference_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vU.SUM_BY_NONZERO_WEIGHTS;const a=zD(e,"labels","absoluteDifference"),o=zD(t,"predictions","absoluteDifference");let i=null;null!=n&&(i=zD(n,"weights","absoluteDifference")),TO(a.shape,o.shape,"Error in absoluteDifference: ");const s=CF(SF(a,o));return bU(s,i,r)}});const wU=WD({cosineDistance_:function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vU.SUM_BY_NONZERO_WEIGHTS;const o=zD(e,"labels","cosineDistance"),i=zD(t,"predictions","cosineDistance");let s=null;null!=r&&(s=zD(r,"weights","cosineDistance")),TO(o.shape,i.shape,"Error in cosineDistance: ");const c=fF(1),l=SF(c,eB(lF(o,i),n,!0));return bU(l,s,a)}});const kU=WD({hingeLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vU.SUM_BY_NONZERO_WEIGHTS,a=zD(e,"labels","hingeLoss");const o=zD(t,"predictions","hingeLoss");let i=null;null!=n&&(i=zD(n,"weights","hingeLoss")),TO(a.shape,o.shape,"Error in hingeLoss: ");const s=fF(1);a=SF(lF(fF(2),a),s);const c=Cj(SF(s,lF(a,o)));return bU(c,i,r)}});const SU=WD({huberLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vU.SUM_BY_NONZERO_WEIGHTS;const o=zD(e,"labels","huberLoss"),i=zD(t,"predictions","huberLoss");let s=null;null!=n&&(s=zD(n,"weights","huberLoss")),TO(o.shape,i.shape,"Error in huberLoss: ");const c=fF(r),l=CF(SF(i,o)),u=VB(l,c),d=SF(l,u),h=iF(lF(fF(.5),dF(u)),lF(c,d));return bU(h,s,a)}});const CU=WD({logLoss_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vU.SUM_BY_NONZERO_WEIGHTS;const o=zD(e,"labels","logLoss"),i=zD(t,"predictions","logLoss");let s=null;null!=n&&(s=zD(n,"weights","logLoss")),TO(o.shape,i.shape,"Error in logLoss: ");const c=fF(1),l=fF(r),u=CB(lF(o,kB(iF(i,l)))),d=lF(SF(c,o),kB(iF(SF(c,i),l))),h=SF(u,d);return bU(h,s,a)}});const IU=WD({meanSquaredError_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vU.SUM_BY_NONZERO_WEIGHTS;const a=zD(e,"labels","meanSquaredError"),o=zD(t,"predictions","meanSquaredError");let i=null;null!=n&&(i=zD(n,"weights","meanSquaredError")),TO(a.shape,o.shape,"Error in meanSquaredError: ");const s=Yj(a,o);return bU(s,i,r)}});const EU=WD({sigmoidCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vU.SUM_BY_NONZERO_WEIGHTS,o=zD(e,"multiClassLabels","sigmoidCrossEntropy");const i=zD(t,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=zD(n,"weights","sigmoidCrossEntropy")),TO(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=fF(r),t=fF(1),n=fF(.5);o=iF(lF(o,SF(t,e)),lF(n,e))}const c=function(e,t){const n=zD(e,"labels","sigmoidCrossEntropyWithLogits"),r=zD(t,"logits","sigmoidCrossEntropyWithLogits");TO(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Cj(r),o=lF(r,n),i=SB(aB(CB(CF(r))));return iF(SF(a,o),i)}(o,i);return bU(c,s,a)}});const TU=WD({softmaxCrossEntropy_:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vU.SUM_BY_NONZERO_WEIGHTS,o=zD(e,"onehotLabels","softmaxCrossEntropy");const i=zD(t,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=zD(n,"weights","softmaxCrossEntropy")),TO(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const e=fF(r),t=fF(1),n=fF(o.shape[1]);o=iF(lF(o,SF(t,e)),cF(e,n))}const c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));const r=pF((e,t,r)=>{const a=NB(t,[n],!0),o=SF(rF(t,"float32"),a);r([e,o]);const i=CB(lF(o,e));return{value:eB(i,[n]),gradFunc:(e,t)=>{const[r,a]=t,o=qz(e.shape,[n]);return[lF(QL(e,o),SF(rF(r,"float32"),aB(a))),lF(QL(e,o),SF(aB(a),rF(r,"float32")))]}}});return r(e,t)}(o,i);return bU(c,s,a)}});const NU=WD({sparseFillEmptyRows_:function(e,t,n,r){const a=zD(e,"indices","sparseFillEmptyRows","int32"),o=zD(t,"values","sparseFillEmptyRows"),i=zD(n,"denseShape","sparseFillEmptyRows","int32"),s=zD(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==o.rank)throw new Error("Values should be Tensor1D but received shape ".concat(o.shape));if(1!==i.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(i.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const c={indices:a,values:o,denseShape:i,defaultValue:s},l=OD.runKernel(HR,c);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}});const OU=WD({sparseReshape_:function(e,t,n){const r=zD(e,"inputIndices","sparseReshape","int32"),a=zD(t,"inputShape","sparseReshape","int32"),o=zD(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(o.shape));const i={inputIndices:r,inputShape:a,newShape:o},s=OD.runKernel(KR,i);return{outputIndices:s[0],outputShape:s[1]}}});const AU=WD({sparseSegmentMean_:function(e,t,n){const r=zD(e,"data","sparseSegmentMean"),a=zD(t,"indices","sparseSegmentMean","int32"),o=zD(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(o.shape));const i={data:r,indices:a,segmentIds:o};return OD.runKernel(qR,i)}});const _U=WD({sparseSegmentSum_:function(e,t,n){const r=zD(e,"data","sparseSegmentSum"),a=zD(t,"indices","sparseSegmentSum","int32"),o=zD(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==o.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(o.shape));const i={data:r,indices:a,segmentIds:o};return OD.runKernel(XR,i)}});const RU=WD({stringNGrams_:function(e,t,n,r,a,o,i,s){const c=zD(e,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error("Data must be a vector, saw: ".concat(c.shape));const l=zD(t,"dataSplits","stringNGrams");if("int32"!==l.dtype)throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:a,rightPad:o,padWidth:i,preserveShortSequences:s},d={data:c,dataSplits:l},h=OD.runKernel(eP,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}});const PU={fft:Gj,ifft:Hj,rfft:Xj,irfft:Kj},DU={hammingWindow:BW,hannWindow:jW,frame:WW,stft:UW},MU={flipLeftRight:GW,grayscaleToRGB:HW,resizeNearestNeighbor:dU,resizeBilinear:uU,rgbToGrayscale:KW,rotateWithOffset:qW,cropAndResize:VW,nonMaxSuppression:YW,nonMaxSuppressionAsync:oU,nonMaxSuppressionWithScore:iU,nonMaxSuppressionWithScoreAsync:sU,nonMaxSuppressionPadded:cU,nonMaxSuppressionPaddedAsync:lU,threshold:hU,transform:pU},FU={bandPart:fU,gramSchmidt:mU,qr:yU},LU={absoluteDifference:xU,computeWeightedLoss:bU,cosineDistance:wU,hingeLoss:kU,huberLoss:SU,logLoss:CU,meanSquaredError:IU,sigmoidCrossEntropy:EU,softmaxCrossEntropy:TU},zU={sparseFillEmptyRows:NU,sparseReshape:OU,sparseSegmentMean:AU,sparseSegmentSum:_U},BU={stringNGrams:RU,stringSplit:WD({stringSplit_:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=zD(e,"input","stringSplit","string"),a=zD(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));const o={skipEmpty:n},i={input:r,delimiter:a},s=OD.runKernel(tP,i,o);return{indices:s[0],values:s[1],shape:s[2]}}}),stringToHashBucketFast:WD({stringToHashBucketFast_:function(e,t){const n=zD(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return OD.runKernel(nP,a,r)}}),staticRegexReplace:WD({staticRegexReplace_:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=zD(e,"input","staticRegexReplace","string"),o={pattern:t,rewrite:n,replaceGlobal:r};return OD.runKernel($R,{x:a},o)}})},jU="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:e=>e();function WU(e,t){const n=e[0].length;e.forEach((e,t)=>{EO(e.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")"))}),EO(t>=0&&t<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));const r=e[0];e.forEach((e,a)=>{for(let o=0;o<n;o++)EO(o===t||e[o]===r[o],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,"."))})}function UU(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}var VU;function GU(e,t,n){let r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(let a=1;a<n.length;++a){const o=n[a],i=r[r.length-n.length+a],s=r[i];if(o>=0)if(s>=0){if(s!==o)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(o," but shape[").concat(a+e,"] = ").concat(s))}else r[i]=o}return r}function HU(e){const t={FIRST_DIM_SIZE:VU.FIRST_DIM_SIZE,VALUE_ROWIDS:VU.VALUE_ROWIDS,ROW_LENGTHS:VU.ROW_LENGTHS,ROW_SPLITS:VU.ROW_SPLITS,ROW_LIMITS:VU.ROW_LIMITS,ROW_STARTS:VU.ROW_STARTS},n=[];for(const r of e){if(!(r in t))break;n.push(t[r])}return n}function KU(e){return 0===e.length?0:e[0]===VU.FIRST_DIM_SIZE?e.length-1:e.length}function qU(e,t){if(null==e||null==t)return;const n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let a=0;a<Math.min(n,r-1);++a){const n=e[a],r=t[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(r))}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(VU||(VU={}));const XU=30;function YU(e){return e<=XU?e:KO(e,Math.floor(Math.sqrt(e)))}function QU(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function ZU(e,t,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const n=t.length;for(let a=0;a<n;++a)r=r.concat([e[a+1]/t[a],t[a]]);r=r.concat(e.slice(n+1))}return r}function $U(e,t){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],a=[];for(let n=1;n<e;++n)n>=2*t+1||n%2===1?a.push(n):r.push(n);n.push(...r),n.push(0),n.push(...a)}return n}function JU(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let o=1;o<e.length;++o)o<=t.length?r?a.push(t[o-1]*e[o]):a.push(e[o]/t[o-1]):a.push(e[o]);return a}function eV(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function tV(e,t,n){const r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function nV(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===OO(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));const a=t.shape,o=a[a.length-1];let i=1;for(let d=0;d<a.length-1;++d)i*=a[d];const s=e.shape,c=a.slice();c.pop();let l=1;for(let d=o;d<n;++d)l*=s[d],c.push(s[d]);const u=[...qO(e.shape).map(e=>e/l),1].slice(0,o);return[c,i,l,u]}const rV=1.7580993408473768,aV=1.0507009873554805,oV=.3275911,iV=.254829592,sV=-.284496736,cV=1.421413741,lV=-1.453152027,uV=1.061405429;function dV(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function hV(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function pV(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function fV(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function mV(e,t){return{real:e[2*t],imag:e[2*t+1]}}function gV(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function yV(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let a=0;a<Math.ceil(e/2);a++){const o=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(o),r[a]=Math.sin(o)}return{real:n,imag:r}}function vV(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}const bV="->",xV=/->/g,wV=",",kV="...";function SV(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(xV,"").length)/bV.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(bV,'").'));const[r,a]=e.split(bV);EO(-1===r.indexOf(kV),()=>'The ellipsis notation ("'.concat(kV,'") is not supported yet.'));const o=r.split(wV),i=o.length;if(t!==i)throw new Error("Expected ".concat(i," input tensors, received ").concat(t));if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let d=0;d<a.length;++d){const e=a[d];if(!o.some(t=>-1!==t.indexOf(e)))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===s.indexOf(e)&&s.push(e)}for(let d=0;d<r.length;++d){const e=r[d];-1===s.indexOf(e)&&e!==wV&&s.push(e)}const c=new Array(o.length);for(let d=0;d<i;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error("Found duplicate axes in input component ".concat(o[d],". ")+"Support for duplicate axes in input is not implemented yet.");c[d]=[];for(let e=0;e<o[d].length;++e)c[d].push(s.indexOf(o[d][e]))}const l=s.length,u=[];for(let d=a.length;d<l;++d)u.push(d);return{allDims:s,summedDims:u,idDims:c}}function CV(e,t){let n=new Array(e);n.fill(-1);for(let a=0;a<t.length;++a)n[t[a]]=a;const r=[];for(let a=0;a<e;++a)-1===n[a]&&r.push(a);return n=n.filter(e=>-1!==e),{permutationIndices:n,expandDims:r}}function IV(e,t,n){const r=new Array(e);for(let a=0;a<n.length;++a){const e=n[a].shape;for(let n=0;n<t[a].length;++n)void 0===r[t[a][n]]?r[t[a][n]]=e[n]:EO(r[t[a][n]]===e[n],()=>"Expected dimension ".concat(r[t[a][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(e),", ")+"but got dimension ".concat(e[n]))}}function EV(e,t){const n=e,r=[];let a=0;0===e.length&&n.push(-1),a=e.length+1;for(let i=0;i<a;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const e=NV(t,n[i]);for(const t of e)-1===o.indexOf(t)&&(r[i].push(t),o.push(t))}return{path:n,steps:r}}function TV(e){return e.every((e,t)=>e===t)}function NV(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function OV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)EO(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(e.shape[n]/t);else{const a=t.reduce((e,t)=>(-1===t&&(e+=1),e),0);EO(a<=1,()=>"There should be only one negative value in split array.");const o=t.indexOf(-1);if(-1!==o){const r=t.reduce((e,t)=>t>0?e+t:e);t[o]=e.shape[n]-r}EO(e.shape[n]===t.reduce((e,t)=>e+t),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function AV(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function _V(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function RV(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function PV(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function DV(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function MV(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function FV(e,t){const n=OO(e),r=OO(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function LV(e,t){const n=OO(e),r=OO(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function zV(){return"segment ids must be >= 0"}function BV(){return"segment ids are not increasing"}function jV(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function WV(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function UV(e,t){let n,r=!1;for(e<=XU?(n=e,r=!0):n=KO(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=KO(e,n+1);return n}function VV(e,t,n){const r=[],a=e.length;for(let o=0;o<a;o++)o!==t?r.push(e[o]):r.push(n);return r}function GV(e,t,n,r){const a=t.shape.length,o=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>o)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(o,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let d=0;d<r;++d)if(e.shape[d]!==t.shape[d])throw new Error("x.shape[".concat(d,"]: ").concat(e.shape[d]," should be equal to indices.shape[").concat(d,"]: ").concat(t.shape[d],"."));const i=e.shape[n],s=[];let c=1,l=1,u=1;for(let d=0;d<r;++d)s.push(e.shape[d]),c*=e.shape[d];for(let d=r;d<n;d++)s.push(e.shape[d]),l*=e.shape[d];for(let d=r;d<a;d++)s.push(t.shape[d]);for(let d=n+1;d<o;d++)s.push(e.shape[d]),u*=e.shape[d];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:i,outputShape:s}}function HV(e){try{return e.map(e=>XP(e))}catch(Qne){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Qne))}}function KV(e){return e.map(e=>qP(e))}!function(){for(const e of AF)bF(e)}();const qV={},XV={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function YV(e,t){if(!(e in qV)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if(iA().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",t=>{t.preventDefault(),delete qV[e]},!1),iA().getBool("SOFTWARE_WEBGL_ENABLED")&&(XV.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",XV)||n.getContext("experimental-webgl",XV);return n.getContext("webgl2",XV)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;qV[e]=n}const n=qV[e];return null==n||n.isContextLost()?(delete qV[e],YV(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),qV[e])}var QV,ZV,$V;function JV(e,t){return[t,e]}function eG(e){const t=OO(e);return PO(Math.ceil(t/4))}function tG(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function nG(e,t){const n=e;let r,a,o,i,s,c,l,u,d,h;return 2===iA().getNumber("WEBGL_VERSION")?(r=n.R32F,a=n.R16F,o=n.RGBA16F,i=n.RGBA32F,s=n.RED,l=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,c=n.RGBA8):(r=e.RGBA,a=e.RGBA,o=e.RGBA,i=n.RGBA,s=e.RGBA,l=4,u=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,c=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}function rG(e,t){const n=t();return iA().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(QV||(QV={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(ZV||(ZV={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}($V||($V={}));function aG(e){return!!(iA().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function oG(e,t){return fG(e,()=>e.getExtension(t),'Extension "'+t+'" not supported on this browser.')}const iG=/ERROR: [0-9]+:([0-9]+):/g;function sG(e,t){const n=iG.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);const r=+n[1],a=e.split("\n"),o=a.length.toString().length+2,i=a.map((e,t)=>DO((t+1).toString(),o)+e);let s=0;for(let d=0;d<i.length;d++)s=Math.max(i[d].length,s);const c=i.slice(0,r-1),l=i.slice(r-1,r),u=i.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(DO(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function cG(e,t){if(rG(e,()=>e.validateProgram(t)),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function lG(e,t,n,r,a,o,i){const s=e.getAttribLocation(t,n);return-1!==s&&(rG(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),rG(e,()=>e.vertexAttribPointer(s,a,e.FLOAT,!1,o,i)),rG(e,()=>e.enableVertexAttribArray(s)),!0)}function uG(e,t,n,r){rG(e,()=>function(e,t,n){mG(e,n),rG(e,()=>e.activeTexture(e.TEXTURE0+n)),rG(e,()=>e.bindTexture(e.TEXTURE_2D,t))}(e,t,r)),rG(e,()=>e.uniform1i(n,r))}function dG(e,t,n){rG(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),rG(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function hG(e,t){rG(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),rG(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function pG(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function fG(e,t,n){const r=rG(e,()=>t());if(null==r)throw new Error(n);return r}function mG(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){const e="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(e,"."))}}function gG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return OO(e.slice(0,e.length-t))}function yG(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function vG(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[gG(e),...yG(e)]),t}function bG(e){return e%2===0}function xG(e,t){if(_O(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(bG(n)&&bG(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&bG(e[0])&&bG(t[0])}let wG,kG;function SG(e,t){return null!=e.getExtension(t)}function CG(e){try{if(null!=YV(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function IG(e){if(0===e)return!1;const t=YV(e);if(1!==e){if(SG(t,"EXT_color_buffer_float"))return EG(t);const e="EXT_color_buffer_half_float";if(SG(t,e)){const n=t.getExtension(e);return function(e,t){const n=nG(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const a=1,o=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),s}(t,n)}return!1}if(!SG(t,"OES_texture_float"))return!1;if(!SG(t,"WEBGL_color_buffer_float"))return!1;return EG(t)}function EG(e){const t=nG(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function TG(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&EO("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors ")+"in the WebGL backend.")})}const NG=iA();function OG(){let e,t,n,r,a,o,i,s,c,l;return 2===iA().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",o="outputColor",i="out vec4 outputColor;",s=iA().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",i="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:s,defineSpecialInf:c,defineRound:l}}function AG(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=qO(t);return r.map((t,a)=>{const o="int ".concat(e[a]," = ").concat(n," / ").concat(t),i=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(o,"; ").concat(i,";")}).join("")}function _G(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=qO(t);return r.map((t,a)=>{const o="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),i=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(o,"; ").concat(i,";")}).join("")}function RG(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(e,t){const n=e.length,r=e.map(e=>"".concat(t,"[").concat(e,"]")),a=new Array(n-1);a[n-2]=r[n-1];for(let o=n-3;o>=0;--o)a[o]="(".concat(a[o+1]," * ").concat(r[o+1],")");return a}(e.map((e,t)=>t),t);return r.map((t,a)=>{const o="int ".concat(e[a]," = ").concat(n," / ").concat(r[a]),i=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(r[a]):"index -= ".concat(e[a]," * ").concat(r[a]);return"".concat(o,"; ").concat(i,";")}).join("")}function PG(e){const t=qO(e).map(e=>e.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}NG.registerFlag("HAS_WEBGL",()=>NG.getNumber("WEBGL_VERSION")>0),NG.registerFlag("WEBGL_VERSION",()=>CG(2)?2:CG(1)?1:0),NG.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),NG.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===NG.get("WEBGL_VERSION")),NG.registerFlag("WEBGL_CPU_FORWARD",()=>!0),NG.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),NG.registerFlag("WEBGL_PACK",()=>NG.getBool("HAS_WEBGL")),NG.registerFlag("WEBGL_PACK_NORMALIZATION",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_CLIP",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_REDUCE",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_LAZILY_UNPACK",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_CONV_IM2COL",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>NG.getBool("WEBGL_PACK")),NG.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(e){if(null==wG){const t=YV(e);wG=t.getParameter(t.MAX_TEXTURE_SIZE)}return wG}(NG.getNumber("WEBGL_VERSION"))),NG.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(e){if(null==kG){const t=YV(e);kG=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,kG)}(NG.getNumber("WEBGL_VERSION"))),NG.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const e=NG.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=YV(e);return t=SG(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:SG(n,"EXT_disjoint_timer_query")?1:0,t}(e)}),NG.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>NG.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!RD()),NG.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(e){if(0===e)return!1;const t=YV(e);if(1===e){if(!SG(t,"OES_texture_float"))return!1}else if(!SG(t,"EXT_color_buffer_float"))return!1;return EG(t)}(NG.getNumber("WEBGL_VERSION"))),NG.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!NG.getBool("WEBGL_FORCE_F16_TEXTURES")&&NG.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),NG.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>IG(NG.getNumber("WEBGL_VERSION"))),NG.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(e=NG.getNumber("WEBGL_VERSION"))&&null!=YV(e).fenceSync;var e}),NG.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>NG.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),NG.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}),NG.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>RD()?1:-1,e=>{if("number"!==typeof e)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(e,"."));if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}),NG.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),NG.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),NG.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),NG.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),NG.registerFlag("WEBGL_EXP_CONV",()=>!1),NG.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>NG.getBool("IS_TEST")),NG.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),NG.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),NG.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),NG.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const DG="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:MG}=i;function FG(e,t,n){const r=[];if(e.forEach(e=>{const t=OO(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){const{uniformShape:t}=KG(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(e=>{r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))});const a=r.join("\n"),o=e.map(e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?zG(e,r):LG(e,r);const o=e.shapeInfo.logicalShape,i=t.logicalShape;o.length<=i.length&&(a+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,s=MG(e.shapeInfo.logicalShape,t.logicalShape),c=HG(i),l=i-o;let u;const d=["x","y","z","w","u","v"];u=0===o?"":i<2&&s.length>=1?"coords = 0;":s.map(e=>"coords.".concat(d[e+l]," = 0;")).join("\n");let h="";h=i<2&&o>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(d[t+l])).join(", ");let p="return outputValue;";const f=1===OO(e.shapeInfo.logicalShape),m=OO(t.logicalShape),g=1===m;if(1!==o||f||g){if(f&&!g)p=1===i?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const e=o-2,t=o-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?p="return vec4(outputValue.x);":s.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(h,");\n      ").concat(p,"\n    }\n  ")}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=t.texShape,i=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===c&&null==e.shapeInfo.flatOffset&&_O(i,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const l=HG(c),u=MG(e.shapeInfo.logicalShape,t.logicalShape),d=c-s;let h;const p=["x","y","z","w","u","v"];h=0===s?"":c<2&&u.length>=1?"coords = 0;":u.map(e=>"coords.".concat(p[e+d]," = 0;")).join("\n");let f="";f=c<2&&s>0?"coords":e.shapeInfo.logicalShape.map((e,t)=>"coords.".concat(p[t+d])).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(h,"\n      return get").concat(r,"(").concat(f,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)).join("\n"),i=t.texShape,s=OG(),c=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let l,u,d=function(e){const t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(BG,"\n    ").concat(jG,"\n    ").concat(WG,"\n  ");return t}(s);t.isPacked?(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(_O(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),o=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),o=a*Math.ceil(e[e.length-2]/2);let i=o,s="",c="b, r, c";for(let l=2;l<e.length-1;l++)i*=e[e.length-l-1],s="\n      int b".concat(l," = index / ").concat(i,";\n      index -= b").concat(l," * ").concat(i,";\n    ")+s,c="b".concat(l,", ")+c;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(o,";\n      index -= b * ").concat(o,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(c,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(s)):(l=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(_O(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){const t=_G(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(t,"\n    return ivec3(r, c, d);\n  }\n")}const r=AG(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){const t=_G(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(t,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=AG(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){const n=AG(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){const n=AG(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,i,n.enableShapeUniforms),u=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(d+=UG);return[d,c,u,a,l,o,n.userCode].join("\n")}function LG(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[a,o]=e.shapeInfo.texShape;if(1===a&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const i=VG(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,c]=e.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(c,", ").concat(i,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(GG(e),"\n      }\n    ");const a=e.shapeInfo.texShape,o=a[0],i=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=VG(n);if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(o,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(o,", ").concat(i,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&_O(n,o)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const e=o[0],n=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(e,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:i,keptDims:s}=zO(n),c=i;if(c.length<n.length){const n=qG(e,c),r=["row","col"];return"\n      ".concat(LG(n,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(XG(r,s),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(GG(e),"\n      }\n    ");const l=o[0],u=o[1],d=VG(r);if(1===u)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===l)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:s,keptDims:c}=zO(n),l=s;if(l.length<n.length){const n=qG(e,l),r=["row","col","depth"];return"\n        ".concat(LG(n,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(XG(r,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(i,", 1)));\n        ").concat(GG(e),"\n      }\n    ");const u=e.shapeInfo.texShape,d=u[0],h=u[1],p=e.shapeInfo.flatOffset;if(h===o&&null==p)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(d,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(h===i&&null==p)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(d,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const f=VG(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(i," + depth + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,s=n[1]*i,{newShape:c,keptDims:l}=zO(n);if(c.length<n.length){const n=qG(e,c),r=["row","col","depth","depth2"];return"\n      ".concat(LG(n,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(XG(r,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(i,", ").concat(o,", 1)));\n        ").concat(GG(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(p===s&&null==u)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(f,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(p===o&&null==u)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const y=VG(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(f,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(i," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],o=t[3]*a,i=t[2]*o,s=t[1]*i,{newShape:c,keptDims:l}=zO(t);if(c.length<t.length){const t=qG(e,c),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(LG(t),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(XG(n,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(i,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(GG(e),"\n      }\n    ");const u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===s&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===a&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const f=VG(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(i," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(f,";\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:o}=zO(t);if(a.length<t.length){const t=qG(e,a),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(LG(t),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(XG(n,o),");\n      }\n    ")}const i=t[5],s=t[4]*i,c=t[3]*s,l=t[2]*c,u=t[1]*l;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(l,", ").concat(c,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(i,", 1)));\n        ").concat(GG(e),"\n      }\n    ");const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===u&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(l,", ").concat(c,", ").concat(s,", ").concat(i,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===i&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=VG(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(l," + depth * ").concat(c," +\n          depth2 * ").concat(s," + depth3 * ").concat(i," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function zG(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=OG();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,o=OG();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,i=o[0],s=o[1],c=OG();if(null!=o&&_O(n,o))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(i,".0);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=[1,2],o=qG(e,n.slice(1)),i=["b","row","col"];return"\n        ".concat(zG(o,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(XG(i,r),");\n        }\n      ")}const s=OG();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=i[0],l=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(d,", ").concat(u,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=OG();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=e.shapeInfo.logicalShape,i=o.length,s=e.shapeInfo.texShape,c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=c[0],u=c[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),p="int b, int row, int col",f="b * ".concat(h," + (row / 2) * ").concat(d," + (col / 2)");for(let m=2;m<i-1;m++)p="int b".concat(m,", ")+p,h*=o[i-m-1],f="b".concat(m," * ").concat(h," + ")+f;return"\n    vec4 ".concat(r,"(").concat(p,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(l,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}const BG="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",jG="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",WG="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",UG="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function VG(e){return"offset".concat(e)}function GG(e){const t=e.name,n=OO(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function HG(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function KG(e,t,n){const{newShape:r,keptDims:a}=zO(t),o=t.length,i=e&&3===o&&1===t[0],s=i?t.slice(1):r,c=!e&&o>1&&!_O(t,n)&&r.length<o||i;return{useSqueezeShape:c,uniformShape:c?s:t,keptDims:a}}function qG(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function XG(e,t){return t.map(t=>e[t]).join(", ")}function YG(e,t,n,r){const a=n.map((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),o=a.map(e=>e.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=FG(a,i,t),c=function(e,t){const n=fG(e,()=>e.createShader(e.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(rG(e,()=>e.shaderSource(n,t)),rG(e,()=>e.compileShader(n)),iA().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw sG(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),l=e.createProgram(c);return iA().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:o,outShapeInfo:i},QG(e,t,l)))}function QG(e,t,n){const r=[],a=[];let o,i,s,c=null,l=null;l=e.getUniformLocation(n,"NAN",!1),1===iA().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of t.variableNames){const a={name:d,uniform:e.getUniformLocation(n,d,u),offset:e.getUniformLocation(n,"offset".concat(d),u)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,"".concat(d,"Shape"),u),a.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),u)),r.push(a)}if(t.enableShapeUniforms&&(o=e.getUniformLocation(n,"outShape",u),s=e.getUniformLocation(n,"outShapeStrides",u),i=e.getUniformLocation(n,"outTexShape",u)),t.customUniforms)for(const d of t.customUniforms)a.push(e.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:a,infLoc:c,nanLoc:l,outShapeLocation:o,outShapeStridesLocation:s,outTexShapeLocation:i}}function ZG(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((e,n)=>{const r=e.logicalShape,a=t[n],o=a.shape;if(!_O(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(e.isUniform&&a.isUniform)return;const i=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!_O(i,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(i," and ").concat(s," must match"))})}function $G(e){return iA().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class JG{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=QV.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=OG();this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?_G(["r","c","d"],e):AG(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class eH{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=QV.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=OG();this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?_G(["r","c","d"],e):AG(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}class tH{constructor(e){this.variableNames=["A"],this.outTexUsage=ZV.DOWNLOAD;const t=OG();this.outputShape=e,this.userCode="\n      ".concat(DG,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}class nH{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ZV.DOWNLOAD;const t=OG();this.outputShape=e,this.userCode="\n      ".concat(DG,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(t.output," = encode_float(x);\n      }\n    ")}}const rH={R:0,G:1,B:2,A:3};class aH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=OG();this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length);let a="result";t&&(a="floor(result * 255. + 0.5)");let o="";for(let i=0;i<n.length;i++){const e=n[i];o+="\n          if(offset == ".concat(i,") {\n            result = values[").concat(rH[e],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":PG(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(r.output," = vec4(").concat(a,", 0., 0., 0.);\n      }\n    ")}}class oH{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=OG();this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length);let r="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let t=0;t<=1;t++){const a=2*o+t;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(t," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(e[2]),") {\n          localCoords[2] += ").concat(t,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(e[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(a,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(a,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(a,"] = values[2];\n            } else {\n              result[").concat(a,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":PG(e),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(a,";\n        }\n    ")}}function iH(e){const t=OG();return function(e,t){const n=fG(e,()=>e.createShader(e.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(rG(e,()=>e.shaderSource(n,t)),rG(e,()=>e.compileShader(n)),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function sH(e){return function(e,t){const n=fG(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return rG(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),rG(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function cH(e){return function(e,t){const n=fG(e,()=>e.createBuffer(),"Unable to create WebGLBuffer");return rG(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),rG(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}(e,new Uint16Array([0,1,2,2,1,3]))}function lH(e,t,n,r,a,o){!function(e,t){const n=iA().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){const n="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(e>n||t>n){const r="[".concat(e,"x").concat(t,"]"),a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}(t,n);const i=function(e){return fG(e,()=>e.createTexture(),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return rG(e,()=>e.bindTexture(s,i)),rG(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),rG(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),rG(e,()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)),rG(e,()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)),1===iA().getNumber("WEBGL_VERSION")?rG(e,()=>e.texImage2D(s,0,r,t,n,0,a,o,null)):rG(e,()=>e.texStorage2D(s,1,r,t,n)),rG(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:i,texShape:[n,t]}}function uH(e){return e.internalFormatFloat}function dH(e){return e.internalFormatHalfFloat}function hH(e){return e.downloadTextureFormat}function pH(e){return e.internalFormatPackedFloat}function fH(e){return e.internalFormatPackedHalfFloat}function mH(e,t,n,r,a,o,i,s){const c=e,l=new Float32Array(function(e,t){const[n,r]=tG(e,t);return n*r*4}(o,i));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}class gH{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=iA().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,function(e,t){qV[e]=t}(t,e)):this.gl=YV(t),e=this.gl,2===iA().getNumber("WEBGL_VERSION")){const t=e;this.createVertexArray=()=>rG(t,()=>t.createVertexArray()),this.bindVertexArray=e=>rG(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>rG(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>rG(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(null!=e){const t=e.getExtension("OES_vertex_array_object");if(null==t)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>rG(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>rG(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>rG(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>rG(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===iA().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=oG(this.gl,e),SG(this.gl,t))this.textureHalfFloatExtension=oG(this.gl,t);else if(iA().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),SG(this.gl,r))this.colorBufferHalfFloatExtension=oG(this.gl,r);else if(iA().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",SG(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!SG(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=sH(this.gl),this.indexBuffer=cH(this.gl),this.framebuffer=function(e){return fG(e,()=>e.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=nG(this.gl,this.textureHalfFloatExtension)}get debug(){return iA().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;rG(e,()=>e.finish()),rG(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),rG(e,()=>e.deleteFramebuffer(this.framebuffer)),rG(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),rG(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),rG(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,o]=JV(t,n);return lH(e,a,o,uH(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,o]=JV(t,n);return lH(e,a,o,dH(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,o]=JV(t,n);return lH(e,a,o,hH(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){rG(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?2===iA().getNumber("WEBGL_VERSION")?rG(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):rG(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):2===iA().getNumber("WEBGL_VERSION")?rG(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):rG(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),rG(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,o){let i,s,c;rG(e,()=>e.bindTexture(e.TEXTURE_2D,t)),a instanceof Uint8Array?(i=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,c=e.RGBA):(i=new Float32Array(n*r*4),s=e.FLOAT,c=o.internalFormatPackedFloat),i.set(a),2===iA().getNumber("WEBGL_VERSION")?rG(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,i)):rG(e,()=>e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,s,i)),rG(e,()=>e.bindTexture(e.TEXTURE_2D,null))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,o]=tG(t,n);return lH(e,a,o,fH(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[a,o]=tG(t,n);return lH(e,a,o,pH(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(hG(this.gl,this.framebuffer),this.outputTexture=null),rG(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n,r){const[a,o]=JV(t,n),i=new Uint8Array(t*n*4);return rG(e,()=>e.readPixels(0,0,a,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,a,o){return mH(this.gl,e,0,0,0,a,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n){const r=e.createBuffer();rG(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,r));const a=16*t*n;return rG(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),rG(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),rG(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),r}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(iA().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(a,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=a}else iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>function(e,t,n){const r=new Float32Array(t*n*4);return rG(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}(this.gl,t,n))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=iH(t));const n=function(e){return fG(e,()=>e.createProgram(),"Unable to create WebGLProgram.")}(t);rG(t,()=>t.attachShader(n,this.vertexShader)),rG(t,()=>t.attachShader(n,e)),function(e,t){if(rG(e,()=>e.linkProgram(t)),!iA().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&cG(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;rG(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),function(e,t,n){rG(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),lG(e,t,"clipSpacePos",n,3,20,0)&&lG(e,t,"uv",n,2,20,12)}(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(rG(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&cG(this.gl,this.program),rG(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return fG(e,()=>e.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),rG(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),uG(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,a]=tG(t,n);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&cG(this.gl,this.program),pG(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}rG(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),rG(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=oG(this.gl,2===iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await MO(()=>this.disposed||this.isQueryAvailable(e,iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=function(e){let t=0;for(;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in iA().platform&&(n=iA().platform.setTimeoutCustom.bind(iA().platform)),MO(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),dG(this.gl,e,this.framebuffer),this.debug&&pG(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(dG(this.gl,this.outputTexture,this.framebuffer),this.debug&&pG(this.gl)):hG(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;dG(r,e,this.framebuffer),this.debug&&pG(r),this.outputTexture=e,rG(r,()=>r.viewport(0,0,t,n)),rG(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),rG(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function yH(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&EO("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors in the CPU backend."))})}function vH(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}function bH(e){return(t,n,r,a,o)=>{const i=TF(t,n),s=i.length,c=qO(i),l=BO(o,OO(i)),u=t.length,d=n.length,h=qO(t),p=qO(n),f=IF(t,i),m=IF(n,i);if(f.length+m.length===0)for(let g=0;g<l.length;++g)l[g]=e(r[g%r.length],a[g%a.length]);else for(let g=0;g<l.length;++g){const t=tA(g,s,c),n=t.slice(-u);f.forEach(e=>n[e]=0);const o=eA(n,u,h),i=t.slice(-d);m.forEach(e=>i[e]=0);const y=eA(i,d,p);l[g]=e(r[o],a[y])}return[l,i]}}function xH(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,o=n.data.get(r.dataId).values,i=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(a.shape,"float32",i)},s}function wH(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return xH({inputs:{real:wH(e,t,"float32"),imag:wH(e,t,"float32")},backend:e})}const r=$O(OO(t),n);return e.makeTensorInfo(t,n,r)}function kH(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function SH(e){const{inputs:t,backend:n}=e,{input:r}=t,a=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,o)}function CH(e,t,n,r){if("int32"===r){return[t,"int32",Int32Array.from(e)]}if("bool"===r){const r=HP([0],n),[a,o]=bH((e,t)=>e!==t?1:0)(t,[],e,r,"bool");return[o,"bool",a]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function IH(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dtype:o}=r;if("complex64"===o){if("complex64"===a.dtype)return kH({inputs:{x:a},backend:n});const e=wH(n,a.shape,a.dtype),t=IH({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=xH({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===a.dtype){const e=SH({inputs:{input:a},backend:n}),t=IH({inputs:{x:e},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(e),t}if(!WO(a.dtype,o)){const e=kH({inputs:{x:a},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:o}}const i=n.data.get(a.dataId).values,[s,c,l]=CH(i,a.shape,a.dtype,o);return n.makeTensorInfo(s,c,l)}function EH(e,t,n,r){return null==n?n=>{let{inputs:a,backend:o}=n;const{a:i,b:s}=a,c=o;yH([i,s],e);const l=c.data.get(i.dataId).values,u=c.data.get(s.dataId).values,d="string"===i.dtype?HV(l):l,h="string"===i.dtype?HV(u):u,p=r||i.dtype,[f,m]=t(i.shape,s.shape,d,h,p);return c.makeTensorInfo(m,p,f)}:e=>{let{inputs:a,backend:o}=e;const{a:i,b:s}=a,c=o;if("complex64"===i.dtype||"complex64"===s.dtype){const e=IH({inputs:{x:i},backend:c,attrs:{dtype:"complex64"}}),t=c.data.get(e.dataId),r=t.complexTensorInfos.real,a=t.complexTensorInfos.imag,o=c.data.get(r.dataId).values,l=c.data.get(a.dataId).values,u=IH({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),d=c.data.get(u.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=c.data.get(h.dataId).values,m=c.data.get(p.dataId).values,[g,y,v]=n(i.shape,s.shape,o,l,f,m),b=c.makeTensorInfo(v,"float32",g),x=c.makeTensorInfo(v,"float32",y),w=xH({inputs:{real:b,imag:x},backend:c});return c.disposeIntermediateTensorInfo(e),c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(x),w}{const e=c.data.get(i.dataId).values,n=c.data.get(s.dataId).values,a=r||i.dtype,[o,l]=t(i.shape,s.shape,e,n,a);return c.makeTensorInfo(l,a,o)}}}function TH(e){return(t,n,r,a,o,i)=>{const s=TF(t,n),c=OO(s),l=s.length,u=qO(s),d=BO("float32",c),h=BO("float32",c),p=IF(t,s),f=IF(n,s),m=dV(r,a),g=dV(o,i),y=t.length,v=qO(t),b=n.length,x=qO(n);if(p.length+f.length===0)for(let w=0;w<d.length;w++){const t=w%m.length,n=w%g.length,r=e(m[2*t],m[2*t+1],g[2*n],g[2*n+1]);d[w]=r.real,h[w]=r.imag}else for(let w=0;w<d.length;w++){const t=tA(w,l,u),n=t.slice(-y);p.forEach(e=>n[e]=0);const r=eA(n,y,v),a=t.slice(-b);f.forEach(e=>a[e]=0);const o=eA(a,b,x),i=e(m[2*r],m[2*r+1],g[2*o],g[2*o+1]);d[w]=i.real,h[w]=i.imag}return[d,h,s]}}const NH=bH((e,t)=>e+t),OH=TH((e,t,n,r)=>({real:e+n,imag:t+r}));EH(fA,NH,OH);function AH(e,t,n,r,a){const o=OO(r),i=$O(a,n);for(let s=0;s<e.length;s++){const n=e[s];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(i[n]+=o>0?t[s]:1)}return i}function _H(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e.shape[0],o=e.shape[1],i=nF([a,n],t.dtype);for(let s=0;s<a;s++)for(let a=0;a<o;a++){const o=e.get(s,a);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(r?i.set(1,s,o):t.size>0?i.set(i.get(s,o)+t.get(s,a),s,o):i.set(i.get(s,o)+1,s,o))}return i}const RH=bH((e,t)=>e&t);EH(RA,RH);function PH(e){return(t,n,r)=>{const a=jO(n,t.length);for(let o=0;o<t.length;++o)a[o]=e(t[o],r);return a}}function DH(e,t,n){return MH(e,PH(t),n)}function MH(e,t,n){return r=>{let{inputs:a,attrs:o,backend:i}=r;const{x:s}=a;yH(s,e);const c=i,l=c.data.get(s.dataId).values;let u;if("string"===s.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=HV(l)}else u=l;const d=n||s.dtype,h=t(u,d,o);return c.makeTensorInfo(s.shape,d,h)}}const FH=PH(e=>Math.ceil(e));MH(MA,FH);function LH(e,t,n,r){const a=jO(n,OO(t));if(r&&"string"!==n){let t=0;e.forEach(e=>{const n=OO(e.shape);a.set(e.vals,t),t+=n})}else{let r=0;e.forEach(e=>{const o="string"===n?HV(e.vals):e.vals;let i=0;for(let n=0;n<e.shape[0];++n){const s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)a[s+t]=o[i++]}r+=e.shape[1]})}return a}const zH=bH((e,t)=>e===t?1:0),BH=(EH(u_,zH,null,"bool"),PH(e=>Math.exp(e))),jH=(MH(d_,BH,"float32"),PH(e=>Math.expm1(e))),WH=(MH(p_,jH),PH(e=>Math.floor(e))),UH=(MH(y_,WH),bH((e,t)=>Math.floor(e/t)));EH(v_,UH,null,"int32");function VH(e,t,n,r,a,o,i,s,c){const l=nF([r,o],n);for(let u=0;u<r;u++){const n=[];let r=0;for(let t=0;t<a;t++){const o=e[u*a+t];r+=o*i[t],n.push(o)}if(r<0||r>=c/o)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let e=0;e<o;e++)l.values[u*o+e]=t.get(...t.indexToLoc(r*o+e))}return l}function GH(e,t,n){const r=nF(n,e.dtype);for(let a=0;a<r.size;++a){const n=r.indexToLoc(a).slice(),o=n[0],i=n[2],s=t.locToIndex([o,i]);n[2]=t.values[s];const c=e.locToIndex(n);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}const HH=bH((e,t)=>e>t?1:0),KH=(EH(k_,HH,null,"bool"),bH((e,t)=>e>=t?1:0)),qH=(EH(S_,KH,null,"bool"),bH((e,t)=>e<t?1:0)),XH=(EH(__,qH,null,"bool"),bH((e,t)=>e<=t?1:0));EH(R_,XH,null,"bool");function YH(e,t,n){const r=(t-e)/(n-1),a=$O(n,"float32");a[0]=e;for(let o=1;o<a.length;o++)a[o]=a[o-1]+r;return a}const QH=PH(e=>Math.log(e));MH(D_,QH);function ZH(e,t,n,r){const a=BO(r,OO(n));for(let o=0;o<a.length;++o){const n=o*t;let r=e[n];for(let a=0;a<t;++a){const t=e[n+a];(Number.isNaN(t)||t>r)&&(r=t)}a[o]=r}return a}const $H=bH((e,t)=>Math.max(e,t)),JH=(EH(U_,$H),bH((e,t)=>Math.min(e,t))),eK=(EH(Q_,JH),bH((e,t)=>e*t)),tK=TH((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}));EH(eR,eK,tK);function nK(e,t,n){const r=GP(-1,n);return eK([],t,r,e,n)}const rK=bH((e,t)=>e!==t?1:0);EH(nR,rK,null,"bool");function aK(e,t,n,r,a){const o=t.length,i=OO(t),s=qO(t),c=qO(a),l=BO(n,OO(a));for(let u=0;u<i;++u){const t=tA(u,o,s),n=new Array(t.length);for(let e=0;e<n.length;e++)n[e]=t[r[e]];l[eA(n,o,c)]=e[u]}return l}function oK(e,t,n,r){const[a,o]=Kz(e,r),i=vD(t,"int32"),s=$O(OO(a),i),c=OO(o);for(let l=0;l<s.length;++l){const e=l*c;let t=1;for(let r=0;r<c;++r)t*=n[e+r];s[l]=t}return{outVals:s,outShape:a,outDtype:i}}function iK(e,t,n,r){const a=[];let o=0;const i=t.length-1+n.length,s=new Array(i).fill(null).map(()=>[0]);!function(e,t){for(let n=0;n<e.length;++n){const r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let c=1;for(let l=0;l<t.length-1;++l){c*=t[l];const e=t[l+1];for(let t=1;t<c+1;++t)s[l].push(t*e)}for(let l=0;l<e.length;++l){let r=e[l],i=e[l]+1;for(let e=0;e<n.length;++e){const a=n[e],o=e+t.length-1;if(o>=0){const e=s[o],t=e[e.length-1]-a[r];for(let n=r;n<i;++n)s[o].push(a[n+1]+t)}r=a[r],i=a[i]}i!==r&&(a.push([r,i]),o+=i-r)}return{outSplits:s,valueSlices:a,numValues:o}}function sK(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function cK(e,t,n,r,a){const o=t.slice();o[0]=a;const i=jO(n,OO(o)),s=e.length;return function(e,t,n,r,a,o){const i=sK(t,2)[1],s=sK(o,2)[1];let c=0;for(const l of n)for(let t=l[0];t<l[1];++t){for(let n=0;n<r;++n)a[c*s+n]=e[t*i+n];++c}}(e,t,r,0===s?0:s/t[0],i,o),[i,o]}function lK(e,t,n,r,a,o,i,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((e,r)=>{if(e<0||e>=n){const a=tA(r,t.length,qO(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}})}(o,i,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:l,valueSlices:u,numValues:d}=iK(o,i,e,c),h=function(e){const t=[];for(let n=0;n<e.length;++n){const r=jO("int32",e[n].length);t.push(r),e[n].forEach((e,t)=>r[t]=e)}return t}(l),p=cK(n,r,a,u,d);return[h,p[0],p[1]]}const uK=2147483647;function dK(e,t,n,r,a,o,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const s=0===t.length,c=0===a.length,l=0===i.length,u=[];s||u.push(t[0]),c||u.push(a[0]),l||u.push(i[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===u.length?1:u[0],h=jO("int32",d+1);h[0]=0;for(let m=0;m<d;++m){const t=s?e[0]:e[m],n=c?r[0]:r[m],a=l?o[0]:o[m];if(0===a)throw new Error("Requires delta != 0");let i;if(a>0&&n<t||a<0&&n>t)i=0;else if(i=Math.ceil(Math.abs((n-t)/a)),i>uK)throw new Error("Requires ((limit - start) / delta) <= ".concat(uK));h[m+1]=h[m]+i}const p=jO(n,h[d]);let f=0;for(let m=0;m<d;++m){const t=h[m+1]-h[m];let n=s?e[0]:e[m];const r=l?o[0]:o[m];for(let e=0;e<t;++e)p[f++]=n,n+=r}return[h,p]}var hK=VU;class pK{constructor(e,t,n,r,a,o,i,s,c,l){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=i,this.rowPartitionValues=s,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=HU(l),this.raggedRank=KU(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===hK.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===hK.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case hK.VALUE_ROWIDS:return pK.getMaxWidthValueRowID(t);case hK.ROW_SPLITS:return pK.getMaxWidthRowSplit(t);default:throw new Error("Cannot handle partition type ".concat(hK[this.getRowPartitionTypeByDimension(e-1)]))}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let n=0;for(let r=0;r<t-1;++r){const t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let n=0,r=e[0],a=0;for(let o=1;o<t;++o){const t=e[o];t!==r&&(r=t,a=Math.max(o-n,a),n=o)}return Math.max(t-n,a)}tensorShapeFromTensor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return mK(e,n)}calculateOutputSize(e){const t=this.valuesShape;qU(this.defaultValueShape,t);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=GU(this.raggedRank,n,t);r[0]<0&&(r[0]=e);for(let a=1;a<=this.raggedRank;++a)r[a]<0&&(r[a]=this.getMaxWidth(a));return r}calculateFirstParentOutputIndex(e,t,n){const r=Math.min(e,n),a=[];let o=0;for(let i=0;i<r;++i,o+=t)a.push(o);for(let i=r;i<e;++i)a.push(-1);return EO(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,n,r){const a=e.length,o=[];for(let i=0;i<a-1;++i){const a=e[i+1]-e[i];let s=Math.min(r,a),c=t[i];-1===c&&(s=0);for(let e=0;e<s;++e)o.push(c),c+=n;for(let e=0;e<a-s;++e)o.push(-1)}if(a>0&&o.length!==e[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,n,r){const a=e.length,o=[];if(0===a)return[];let i=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));let c=t[s];o.push(c);for(let l=1;l<a;++l){const a=e[l];if(a===s)c>=0&&(++i,i<r?c+=n:c=-1);else{if(i=0,s=a,a>=t.length)throw new Error("Got nextValueRowId=".concat(a," which is not less than ").concat(t.length));c=t[a]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,n,r){const a=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case hK.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case hK.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(hK[o]))}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case hK.FIRST_DIM_SIZE:return e[0];case hK.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case hK.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(hK[t]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let o=n.length-2;o>=0;--o)n[o]=n[o+1]*t[o+1];const r=mK(t,!1),a=jO(this.valuesDType,OO(r));if(n[0]*t[0]>0){let o=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e){o=this.calculateOutputIndex(e-1,o,n[e],t[e])}this.setOutput(this.raggedRank,o,a,r)}return[r,a]}setOutput(e,t,n,r){if(0===n.length)return;const a=this.values,o=n;let i=r.slice();i=i.slice(e+1);const s=OO(i),c=t.length;let l=this.defaultValue;if(l.length!==s&&1!==l.length){const e=this.defaultValueShape;XD(()=>{const t=QL(l,e),n=pz(t,i);l=n.dataSync()})}let u=0,d=0,h=0;for(let p=0;p<=c;++p){let e=p<c?t[p]:-1;if(e!==h){if(d<h){const e=a.subarray(u*s);fK(o.subarray(d*s),e,(h-d)*s)}if(p>=c){const t=n.length;e=Math.floor(t/s)}if(e>h)if(1===this.defaultValue.length)o.subarray(h*s,e*s).fill(this.defaultValue[0]),h=e;else for(;e>h;){fK(o.slice(h*s),l,s),++h}e<0?(u=p+1,d=h):(u=p,d=h,h=d+1)}else++h}}}function fK(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function mK(e,t){const n=[];for(let r of e){if(r<0){if(!t)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function gK(e,t,n,r,a,o,i,s,c,l){return new pK(e,t,n,r,a,o,i,s,c,l).compute()}function yK(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return $O(0,r);const a=$O(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(let o=1;o<a.length;o++)a[o]=a[o-1]+n;return a}const vK=PH(e=>1/Math.sqrt(e));MH(NR,vK);function bK(e,t,n,r,a,o,i,s,c,l){const u=[r/a,a],d=e.values,h=t.values;if(0===r)return nF(n,t.dtype);const p=c instanceof oD?c:nF(u,t.dtype);"string"===typeof c||"number"===typeof c?p.values.fill(c):"boolean"===typeof c&&p.values.fill(+c);for(let f=0;f<o;f++){const e=[];let o=0;for(let t=0;t<i;t++){const n=d[f*i+t];e.push(n),o+=n*s[t]}if(o<0||o>=r/a)throw new Error("Invalid indices: ".concat(e," does not index into ").concat(n));for(let n=0;n<a;n++)l?p.values[o*a+n]+=h[f*a+n]:p.values[o*a+n]=0===t.rank?h[0]:h[f*a+n]}return p}const xK=PH(e=>1/(1+Math.exp(-e)));DH(zR,e=>1/(1+Math.exp(-e)));function wK(e,t,n,r,a){const o=vL(r,t,n),i=OO(n),s=qO(r);if(o){const n=bL(t,s);return"string"===a?e.slice(n,n+i):e.subarray(n,n+i)}const c=nF(r,a,"string"===a?HV(e):e),l=nF(n,a);for(let u=0;u<l.size;++u){const e=l.indexToLoc(u),n=e.map((e,n)=>e+t[n]);l.set(c.get(...n),...e)}return"string"===a?KV(l.values):l.values}function kK(e,t,n,r,a,o,i){const s=t[0],c=o[0],l=new Array(c),u=new Array(s),d=t[1];if(0===c){if(0!==s)throw new Error(AV(s));return[jO(n,0),[0,d],jO(a,0),l,u]}let h=!0,p=0;const f=new Array(c).fill(0);for(let g=0;g<s;++g){const t=e[g*d];if(t<0)throw new Error(_V(g,t));if(t>=c)throw new Error(RV(g,t,c));++f[t],h=h&&t>=p,p=t}let m=!0;for(let g=0;g<c;++g){const e=0===f[g];l[g]=e,m=m&&!e,f[g]=Math.max(f[g],1),g>0&&(f[g]+=f[g-1])}if(m&&h){const t=e,n=r;for(let e=0;e<s;++e)u[e]=e;return[t,[s,d],n,l,u]}{const t=f[c-1],o=jO(n,t*d),h=jO(a,t),p=new Array(c).fill(0);for(let n=0;n<s;++n){const t=e[n*d],a=p[t],i=(0===t?0:f[t-1])+a;p[t]++;for(let r=0;r<d;++r)o[i*d+r]=e[n*d+r];h[i]=r[n],u[n]=i}for(let e=0;e<c;++e){if(0===p[e]){const t=0===e?0:f[e-1];o[t*d+0]=e;for(let e=1;e<d;++e)o[t*d+e]=0;h[t]=i}}return[o,[t,d],h,l,u]}}function SK(e,t,n,r,a){const o=OO(r),i=t[0],s=a.length,c=[];let l=1,u=-1;for(let m=0;m<s;++m){const e=a[m];if(-1===e){if(-1!==u)throw new Error(PV(u,m));u=m,c.push(1)}else{if(e<0)throw new Error(DV(m,e));l*=e,c.push(e)}}if(-1!==u){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(o/l);if(l*e!==o)throw new Error(FV(r,c));c[u]=e}if(OO(c)!==o)throw new Error(LV(r,c));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*r[e+1]}const p=[];if(s>0){p[s-1]=1;for(let e=s-2;e>=0;--e)p[e]=p[e+1]*c[e+1]}const f=jO(n,i*s);for(let m=0;m<i;++m){let t=0;for(let n=0;n<d;++n)t+=e[m*d+n]*h[n];for(let e=0;e<s;++e)f[m*s+e]=Math.trunc(t/p[e]),t%=p[e]}return[f,[i,s],c]}function CK(e,t,n,r,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,c=[t[0],e.length/t[0]],l=c[1],u=s>0?a[s-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=u;const h=d.reduce((e,t)=>e*t,1),p=jO(n,h);if(0===s)return u>0&&p.fill(i),[p,d];if(u<=0)throw new Error("segment ids must be >= 0");let f=0,m=1,g=0,y=a[f];for(;;){let t=0;if(m<s){if(t=a[m],y===t){++m;continue}if(y>=t)throw new Error(BV())}if(y<0||y>=u)throw new Error(jV(y,u));y>g&&p.fill(i,g*l,y*l);for(let n=f;n<m;++n){const t=r[n];if(t<0||t>=c[0])throw new Error(WV(n,r[n],c[0]));for(let n=0;n<l;n++)p[y*l+n]+=e[t*l+n]}if(o)for(let e=0;e<l;e++)p[y*l+e]/=m-f;if(f=m,++m,g=y+1,y=t,m>s)break}return g<u&&p.fill(i,g*l,u*l),[p,d]}const IK=PH(e=>Math.sqrt(e)),EK=(DH(jR,e=>Math.sqrt(e)),PH((e,t)=>{const{pattern:n,replaceGlobal:r,rewrite:a}=t;return e.replace(new RegExp(n,r?"g":""),a)}));MH($R,EK);function TK(e,t,n,r){const a=nF(e,t.dtype);for(let o=0;o<a.size;o++){const e=a.indexToLoc(o),i=new Array(e.length);for(let t=0;t<i.length;t++)i[t]=e[t]*n[t]+r[t];a.set(t.get(...i),...e)}return a}class NK{constructor(e,t,n,r,a,o){this.separator=qP(e),this.nGramWidths=t,this.leftPad=qP(n),this.rightPad=qP(r),this.padWidth=a,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,a,o){for(let i=0;i<a;++i){const s=this.getPadWidth(o),c=Math.max(0,s-i),l=Math.max(0,s-(a-(i+1))),u=o-(c+l),d=t+(c>0?0:i-s);let h=0;h+=c*this.leftPad.length;for(let t=0;t<u;++t)h+=e[d+t].length;h+=l*this.rightPad.length;h+=(c+l+u-1)*this.separator.length,n[r+i]=new Uint8Array(h);const p=n[r+i];let f=0;const m=e=>e.forEach(e=>p[f++]=e);for(let e=0;e<c;++e)m(this.leftPad),m(this.separator);for(let t=0;t<u-1;++t)m(e[d+t]),m(this.separator);if(u>0){m(e[d+u-1]);for(let e=0;e<l;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<l-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error("First split value must be 0, got ".concat(e));for(let a=1;a<r;++a){let r=t[a]>=e;if(r=r&&t[a]<=n,!r)throw new Error("Invalid split value ".concat(t[a],", must be in [").concat(e,", ").concat(n,"]"));e=t[a]}if(e!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(e))}const a=r-1,o=jO("int32",r);if(0===n||0===r){const e=new Array(n);for(let t=0;t<=a;++t)o[t]=0;return[e,o]}o[0]=0;for(let s=1;s<=a;++s){const e=t[s]-t[s-1];let n=0;this.nGramWidths.forEach(t=>{n+=this.getNumNGrams(e,t)}),this.preserveShort&&e>0&&0===n&&(n=1),o[s]=o[s-1]+n}const i=new Array(o[a]);for(let s=0;s<a;++s){const n=t[s];let r=o[s];if(this.nGramWidths.forEach(a=>{const o=t[s+1]-t[s],c=this.getNumNGrams(o,a);this.createNGrams(e,n,i,r,c,a),r+=c}),this.preserveShort&&r===o[s]){const a=t[s+1]-t[s];if(0===a)continue;const o=a+2*this.padWidth,c=1;this.createNGrams(e,n,i,r,c,o)}}return[i,o]}}function OK(e,t,n,r,a,o,i,s){return new NK(n,r,a,o,i,s).compute(e,t)}function AK(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const a=t[0];let o=e.indexOf(a);for(;-1!==o;){const t=e.subarray(0,o);n&&0===t.length||r.push(t),o=(e=e.subarray(o+1)).indexOf(a)}return void(n&&0===e.length||r.push(e))}let a=0;for(let o=0;o<e.length+1;o++)if(o===e.length||-1!==t.indexOf(e[o])){const t=e.subarray(a,o);n&&0===t.length||r.push(t),a=o+1}}function _K(e,t,n){const r=e.length,a=[];let o=0,i=0;const s=new Array(r);for(let h=0;h<r;++h){const r=a.length;AK(e[h],t,n,a);const c=a.length-r;s[h]=c,o+=c,i=Math.max(i,c)}const c=jO("int32",2*o),l=new Array(o),u=[r,i];let d=0;for(let h=0;h<r;++h)for(let e=0;e<s[h];++e)c[2*d]=h,c[2*d+1]=e,l[d]=a[d],++d;return[c,l,u]}function RK(e,t){const n=jO("int32",e.length);for(let r=0;r<e.length;++r)n[r]=VP(e[r]).modulo(t).getLowBitsUnsigned();return n}const PK=bH((e,t)=>e-t),DK=TH((e,t,n,r)=>({real:e-n,imag:t-r}));EH(rP,PK,DK);function MK(e,t){const n=new Array(e.rank);for(let a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];const r=nF(n,e.dtype);for(let a=0;a<r.values.length;++a){const t=r.indexToLoc(a),n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=t[r]%e.shape[r];const o=e.locToIndex(n);r.values[a]=e.values[o]}return r}const FK=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function LK(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;for(;r>n;){if(r-n>600){const a=r-n+1,o=t-n+1,i=Math.log(a),s=.5*Math.exp(2*i/3),c=.5*Math.sqrt(i*s*(a-s)/a)*Math.sign(o-a/2);LK(e,t,Math.max(n,Math.floor(t-o*s/a+c)),Math.min(r,Math.floor(t+(a-o)*s/a+c)))}const a=e[t];let o=n,i=r;for(CO(e,n,t),FK(e[r],a)>0&&CO(e,n,r);o<i;){for(CO(e,o,i),o++,i--;FK(e[o],a)<0;)o+=1;for(;FK(e[i],a)>0;)i-=1}0===FK(e[n],a)?CO(e,n,i):(i+=1,CO(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}}function zK(e,t,n,r,a){const o=t[t.length-1],[i,s]=[e.length/o,o],c=BO(n,i*r),l=BO("int32",i*r);for(let d=0;d<i;d++){const t=d*s,n=e.subarray(t,t+s);let o=new Array(n.length);n.forEach((e,t)=>o[t]={value:e,index:t}),r<o.length&&(LK(o,r),o=o.slice(0,r)),a&&o.sort(FK);const i=d*r,u=c.subarray(i,i+r),h=l.subarray(i,i+r);for(let e=0;e<r;e++)u[e]=o[e].value,h[e]=o[e].index}const u=t.slice();return u[u.length-1]=r,[nF(u,n,c),nF(u,"int32",l)]}function BK(e,t,n,r){const a=LO(t,n)[0],o=[1,n[0],1];for(let f=0;f<a;f++)o[0]*=n[f];o[1]=n[a];for(let f=a+1;f<n.length;f++)o[2]*=n[f];const i=new Map,s=new Int32Array(n[a]),c=new oD(o,r,e),l=[],u=1===o[0]&&1===o[2];for(let f=0;f<n[a];f++){let t;if(u)t=e[f].toString();else{const e=[];for(let t=0;t<o[0];t++)for(let n=0;n<o[2];n++)e.push(c.get(t,f,n));t=e.join(",")}const n=i.get(t);if(null!=n)s[f]=n;else{const e=i.size;i.set(t,e),s[f]=e,l.push(f)}}const d=o.slice();d[1]=i.size;const h=new oD(d,r);l.forEach((e,t)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)h.set(c.get(n,e,r),n,t,r)});const p=n.slice();return p[a]=d[1],{outputValues:h.values,outputShape:p,indices:s}}const{mx:jK,XI:WK,Nk:UK,f6:VK,ct:GK,YG:HK,hH:KK,z3:qK,sG:XK,uM:YK,vS:QK,qB:ZK,GG:$K,rq:JK,lg:eq,WR:tq,cu:nq,GE:rq,px:aq,jC:oq,He:iq,hE:sq,BF:cq,Dk:lq,cl:uq,_B:dq,ub:hq,_f:pq,Ku:fq,qy:mq,Zy:gq,bu:yq,zv:vq,dH:bq,HS:xq,yH:wq,l3:kq,z9:Sq,x6:Cq,_m:Iq,eW:Eq,GK:Tq,SP:Nq,yr:Oq,dl:Aq,Dw:_q,xT:Rq,_X:Pq,wz:Dq}=s;function Mq(e,t){return["x","y","z","w","u","v"].slice(0,t).map(t=>"".concat(e,".").concat(t))}function Fq(e,t){return 1===t?[e]:Mq(e,t)}class Lq{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=$G(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=Fq("rc",this.rank),t=HG(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),a=this.getOutput(e);this.userCode="\n        void main() {\n          ".concat(t," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(a,"));\n          }\n        }\n      ")}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let t=2;t<this.rank;t++)a="".concat(e[e.length-1-t],",")+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let t="";for(let n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(e){const t=this.getSourceCoordsArr(e);if(1===this.rank){const e=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(e," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}class zq{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length);let n="";for(let r=0;r<4;r++){let e="thisRC = rc;";r%2===1&&(e+="thisRC.z += 1;"),r>1&&(e+="thisRC.y += 1;"),n+="\n        ".concat(e,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){const n=t?RG(["r","c","d"],"inputShape"):AG(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":PG(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":e[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":e[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class Bq{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){const r=Wq(t,n),a=Uq(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const o=jq(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const e=this.freeTextures[a].pop();return this.usedTextures[a].push(e),e}let i;return r===$V.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===$V.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===$V.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===$V.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===$V.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const a=Wq(n,r),o=Uq(t,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);const i=jq(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=iA().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const c=this.usedTextures[o],l=c&&c.indexOf(e);if(null==l||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[l]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));const t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function jq(e,t,n,r,a){const o=function(e,t){switch(e){case $V.PACKED_2X2_FLOAT32:return pH(t);case $V.PACKED_2X2_FLOAT16:return fH(t);case $V.UNPACKED_FLOAT32:return uH(t);case $V.UNPACKED_FLOAT16:return dH(t);case $V.PACKED_4X1_UNSIGNED_BYTE:return hH(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);let i;if(a){const[t,n]=tG(e[0],e[1]);i=t*n}else{const[t,n]=JV(e[0],e[1]);i=t*n}const s=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*s}function Wq(e,t){if(e===ZV.UPLOAD)return $V.PACKED_2X2_FLOAT32;if(e===ZV.RENDER||null==e)return function(e){return iA().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?$V.PACKED_2X2_FLOAT32:$V.UNPACKED_FLOAT32:e?$V.PACKED_2X2_FLOAT16:$V.UNPACKED_FLOAT16}(t);if(e===ZV.DOWNLOAD||e===ZV.PIXELS)return $V.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function Uq(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}class Vq{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const Gq="if (isnan(x)) return x;",Hq="return abs(x);";const Kq=Gq+"\n  return (x < 0.0) ? 0.0 : x;\n",qq=Gq+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Xq="return x;";class Yq{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class Qq{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length);const t=e.length,n=Fq("rc",t),r=HG(t),a=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),o=n.slice(-2),i=t<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(i,"));\n      }\n    ")}}const Zq=yW,$q={};const Jq=iA().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class eX extends xO{nextDataId(){return eX.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!iA().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof gH)t=e;else{const n=YV(iA().getNumber("WEBGL_VERSION"),e);t=new gH(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=YV(iA().getNumber("WEBGL_VERSION"));t=new gH(e),this.binaryCache=((n=iA().getNumber("WEBGL_VERSION"))in $q||($q[n]={}),$q[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Bq(this.gpgpu),this.numMBBeforeWarning=null==iA().global.screen?1024:iA().global.screen.height*iA().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new bO(this,qD())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,a,o){const i=this.makeTensorInfo(t,n),s=this.texData.get(i.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];const c=vG(t),l=new aH(c,!1,o),u=this.runWebGLProgram(l,[i],n,[[r,a]]);return u.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(i),u.dataId}write(e,t,n){if((iA().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||iA().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:ZV.UPLOAD,refCount:1}),r}refCount(e){if(this.texData.has(e)){return this.texData.get(e).refCount}return 0}incRef(e){this.texData.get(e).refCount++}decRef(e){if(this.texData.has(e)){this.texData.get(e).refCount--}}move(e,t,n,r,a){if(iA().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:ZV.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:a,slice:o,shape:i,isPacked:s}=t;if(null!=o){let t;t=s?new Yq(i,Xq):new Vq(i,Xq);const n=this.runWebGLProgram(t,[{dataId:e,shape:i,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const c=null!=this.activeTimers;let l,u;if(c&&(l=KP()),"complex64"===r){u=dV(this.readSync(a.real.dataId),this.readSync(a.imag.dataId))}else u=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=KP()-l),this.convertAndCacheOnCPU(e,u)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}const t=this.texData.get(e),{values:n,shape:r,slice:a,dtype:o,complexTensorInfos:i,isPacked:s}=t;if(null!=a){let t;t=s?new Yq(r,Xq):new Vq(r,Xq);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:o}],o),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(e);if(iA().getBool("DEBUG")&&!iA().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===iA().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,l,u=null;if("complex64"!==o&&iA().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const t=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(t.texture.texture,...eG(r))}if(this.pendingRead.set(e,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const e=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]);l=dV(e[0],e[1])}else if(null==u)l=this.getValuesFromTexture(e);else{const e=OO(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(u,e)}if(null!=c&&this.disposeIntermediateTensorInfo(c),null!=u){const e=this.gpgpu.gl;rG(e,()=>e.deleteBuffer(u))}const d=this.convertAndCacheOnCPU(e,l),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(e=>e(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&qD().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(e),{values:r,shape:a,slice:o,dtype:i,isPacked:s,texture:c}=n;if("complex64"===i)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=s?new Yq(a,Xq):new Vq(a,Xq);const r=this.runWebGLProgram(n,[{dataId:e,shape:a,dtype:i}],i),o=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),o}if(null==c)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(e,t.customTexShape),u=qD().makeTensorFromTensorInfo(l),d=this.texData.get(l.dataId);return Object.assign({tensorRef:u},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>XP(e));return nF(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return nF(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!aG(n)){if(iA().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),a=OO(t);if(iA().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...eG(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),o}const o=iA().getBool("WEBGL_PACK")&&!0===r,i=o?vG(t):t,s=o?new nH(i):new tH(i),c=this.runWebGLProgram(s,[{shape:i,dtype:n,dataId:e}],"float32"),l=this.texData.get(c.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),u}timerAvailable(){return iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const a=QP(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),o=QP(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,r&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(a);i.kernelMs=IO(e),i.getExtraProfileInfo=()=>e.map((e,t)=>({name:o[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:KP(),endMs:null}}endTimer(e){return iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=KP(),e)}async getQueryTime(e){if(iA().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:a,isPacked:o,slice:i}=this.texData.get(e),s=i&&i.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,a,o)));const l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jq;return iA().getBool("WEBGL_CPU_FORWARD")&&e.every(e=>null==this.texData.get(e.dataId).texture&&OO(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){xP("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Zq(e.shape,t)}packedUnaryOp(e,t,n){const r=new Yq(e.shape,t),a=this.compileAndRun(r,[e],n);return qD().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=bq(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(iA().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Hq,e.dtype);const t=new Vq(e.shape,Hq),n=this.compileAndRun(t,[e]);return qD().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&VO(n[0])){const a=n.map(e=>qP(e));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return qD().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new Qq(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Lq(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[gG(e.shape),...yG(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[gG(t),...yG(t)],o=new zq(a,n),i=[n],s=this.runWebGLProgram(o,[r],e.dtype,i,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:a,dtype:o}=n;if(null!=t){EO(OO(a)<=t[0]*t[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=vG(a);let s;s=r?new eH(i):new JG(i);const c=[null!=t?t:eG(i)];return{dtype:o,shape:a,dataId:this.runWebGLProgram(s,[{shape:i,dtype:o,dataId:e}],o,c,!0,t).dataId}}runWebGLProgram(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;const i=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(i.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===QV.DENSE){const t=null!=o?o:eG(e.outputShape);s.texShape=t.map(e=>2*e)}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===OO(i.shape))return s.values=BO(i.dtype,0),i;const c=[],l=t.map(t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&OO(t.shape)<=iA().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),c.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!xG(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),c.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(i.dataId);const u={shape:i.shape,texData:s,isUniform:!1},d=function(e,t,n){let r="";t.concat(n).forEach(t=>{const a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const o=t.texData.texShape,{useSqueezeShape:i,uniformShape:s,keptDims:c}=KG(e.packedInputs,t.shape,o);let l="",u="",d="";if(1===s.length&&e.packedInputs){const e=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];l="".concat(e[0]>1,"_").concat(e[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){const e=qO(s);d="".concat(e[0]===o[1],"_").concat(e[e.length-1]===o[1])}}else u="".concat(s[0]>1,"_").concat(s[1]>1);const h=t.shape.length,p=2===s.length&&_O(t.shape,o),f=1===OO(t.shape),m=IF(t.shape,n.shape),g=!e.packedInputs&&h===n.shape.length&&_O(o,n.texData.texShape),y=e.packedInputs||s.length>2?"":"".concat(o[0]>1,"_").concat(o[1]>1);r+="".concat(h,"_").concat(g,"_").concat(i?c:"","_").concat(s.length,"_").concat(f,"_").concat(m,"_").concat(p,"_").concat(l,"_").concat(u,"_").concat(d,"_").concat(y,"_").concat(a)}else{const e=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(e,"_").concat(a)}});const a=e.userCode;let o=e.constructor.name;return o+="_"+r+"_"+a+"".concat(iA().getNumber("WEBGL_VERSION")),o}(e,l,u),h=this.getAndSaveBinary(d,()=>YG(this.gpgpu,e,l,u)),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),iA().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(ZG(t.inShapeInfos,n),ZG([t.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):e.setOutputMatrixTexture(o.texture,i[0],i[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===iA().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(let c=0;c<n.length;++c){const r=n[c],{uniform:a,offset:o,shape:i,texShape:s}=t.variablesLocations[c];if(i){const{uniformShape:n}=KG(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(s&&e.gl.uniform2i(s,r.texData.texShape[0],r.texData.texShape[1]),null!=a)if(r.isUniform)if(OO(r.shape)<2)e.gl.uniform1f(a,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(a,t)}else null!=r.texData.slice&&null!=o&&e.gl.uniform1i(o,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,a,c)}const s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=qO(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(let c=0;c<t.program.customUniforms.length;++c){const n=t.program.customUniforms[c],r=t.customUniformLocations[c],o=a[c];if("float"===n.type)e.gl.uniform1fv(r,o);else if("vec2"===n.type)e.gl.uniform2fv(r,o);else if("vec3"===n.type)e.gl.uniform3fv(r,o);else if("vec4"===n.type)e.gl.uniform4fv(r,o);else if("int"===n.type)e.gl.uniform1iv(r,o);else if("ivec2"===n.type)e.gl.uniform2iv(r,o);else if("ivec3"===n.type)e.gl.uniform3iv(r,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(r,o)}}e.executeProgram()}(this.gpgpu,h,l,u,r),c.forEach(e=>this.disposeIntermediateTensorInfo(e)),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=iA().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=KP();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!iA().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){const e=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),e}return i}compileAndRun(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;return this.runWebGLProgram(e,t,n,r,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!iA().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=XD(()=>{if(!iA().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=iA().getBool("DEBUG");iA().set("DEBUG",!1);const t=this.abs(fF(1e-8)).dataSync()[0];if(iA().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:a,texture:o,usage:i,isPacked:s}=t;if(null!=o)return;const c=null!=this.activeTimers;let l;c&&(l=KP());let u=t.texShape;if(null==u&&(u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=iA().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=iA().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&iA().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((t,n)=>n>=e.length-2?SO(e[n]):e[n])).length&&(e=[2,e[0]])),2!==e.length){const t=zO(e);e=t.newShape}let a=OO(e),o=null;e.length<=1&&a<=n?o=[1,a]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);const i=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(t?2:1)&&Math.min(...o)>0;if(null==o||i)if(t){const t=gG(e);let n=2,r=2;e.length&&([n,r]=yG(e)),a=t*(n/2)*(r/2),o=PO(a).map(e=>2*e)}else o=PO(a);return o}(n,s),t.texShape=u),null!=a){const e=vG(n);let o,i=u[1],d=u[0];const h=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!s&&h||([i,d]=tG(u[0],u[1])),o=s?new oH(e,h):new aH(e,h);const p=h?[d,i]:u,f=this.makeTensorInfo(p,r),m=this.texData.get(f.dataId);m.usage=h?ZV.PIXELS:ZV.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),i,d,a);const g=[[d,i]],y=!0,v=this.runWebGLProgram(o,[f],r,g,y),b=this.texData.get(v.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,iA().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(f),c&&(this.uploadWaitMs+=KP()-l)}else{const e=this.acquireTexture(u,i,r,s);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(e," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*UO(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(n){throw n}});e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await new Promise(e=>jU(()=>e())),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw sG(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:a,outShapeLocation:o,outShapeStridesLocation:i,outTexShapeLocation:s}=QG(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=o,e.outShapeStridesLocation=i,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:o,channels:i}=e,s=qD().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=s.writeTexture(r,t,n,a,o,i);return qD().makeTensorFromDataId(c,t,n,s)}}eX.nextDataId=0,PD()&&$D("webgl",()=>new eX,2);const tX="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class nX{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=TF(t,n),this.enableShapeUniforms=$G(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const rX="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class aX{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=TF(t,n);const a=this.outputShape.length;this.enableShapeUniforms=$G(a);let o="";if(r)if(0===a||1===OO(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const e=HG(a);if(o="\n          ".concat(e," coords = getOutputCoords();\n        "),1===a)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const e=Fq("coords",a);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(e[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(e[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}}function oX(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const iX={kernelName:C_,backendName:"webgl",kernelFunc:oX};function sX(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),s=oX({inputs:{x:r},backend:n}),c=oX({inputs:{x:a},backend:n});return i.complexTensorInfos={real:s,imag:c},o}const cX={kernelName:LA,backendName:"webgl",kernelFunc:sX},lX="return (a < 0.) ? b * a : a;",uX="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const dX={kernelName:A_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:o}=r,i=n.makeTensorInfo([],"float32",GP(o,"float32")),s=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aX(uX,a.shape,i.shape):new nX(lX,a.shape,i.shape),c=n.runWebGLProgram(s,[a,i],"float32");return n.disposeIntermediateTensorInfo(i),c}},hX="return (a < 0.) ? b * a : a;",pX="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const fX={kernelName:dR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t,o=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aX(pX,r.shape,a.shape):new nX(hX,r.shape,a.shape);return n.runWebGLProgram(o,[r,a],"float32")}},mX="if (isnan(x)) return x;";function gX(e){let{opSnippet:t,packedOpSnippet:n,cpuKernelImpl:r,dtype:a}=e;return e=>{let{inputs:o,backend:i}=e;const{x:s}=o,c=i,l=a||s.dtype;if(c.shouldExecuteOnCPU([s])&&null!=r){const e=c.texData.get(s.dataId),t=r(e.values,l);return c.makeTensorInfo(s.shape,l,t)}let u;return u=iA().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Yq(s.shape,n):new Vq(s.shape,t),c.runWebGLProgram(u,[s],l)}}function yX(e){let{opSnippet:t,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:a=!1,cpuKernelImpl:o,dtype:i}=e;return e=>{let{inputs:s,backend:c}=e;const{a:l,b:u}=s,d=c;if(a&&"complex64"===l.dtype){const e=d.texData.get(l.dataId),n=d.texData.get(u.dataId),[r,a]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,a={dataId:n.dataId,dtype:n.dtype,shape:l.shape},o={dataId:r.dataId,dtype:r.dtype,shape:u.shape},i=new nX(t,l.shape,u.shape);return d.runWebGLProgram(i,[a,o],vD(n.dtype,r.dtype))}),o=sX({inputs:{real:r,imag:a},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(a),o}const h=i||vD(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||d.shouldExecuteOnCPU([l,u]))&&null!=o){const e=d.texData.get(l.dataId).values,t=d.texData.get(u.dataId).values,n="string"===l.dtype?HV(e):e,r="string"===l.dtype?HV(t):t,[a,i]=o(l.shape,u.shape,n,r,h),s=d.makeTensorInfo(i,h);return d.texData.get(s.dataId).values=a,s}let p;return p=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new aX(n,l.shape,u.shape,r):new nX(t,l.shape,u.shape),d.runWebGLProgram(p,[l,u],h)}}function vX(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":Kq;if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":qq;if("prelu"===e)return t?pX:hX;if("leakyrelu"===e)return t?uX:lX;if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}class bX{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=$G(this.outputShape.length);const l=r?e[1]:e[2],u=Math.ceil(l/2),d=r?"i * 2, rc.y":"rc.y, i * 2",h=a?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";i&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),g="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v="imod(rc.x, ".concat(e[0],")"):t[0]<e[0]&&(b="imod(rc.x, ".concat(t[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(v,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(f[0],");\n          result += (").concat(p[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const xX="return areal * breal - aimag * bimag;",wX="return areal * bimag + aimag * breal;";class kX{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=TF(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const SX="return a * b;";function CX(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,o=vD(r.dtype,a.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),o=new kX(xX,r.shape,a.shape),i=new kX(wX,r.shape,a.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:a.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:a.shape}],c=n.runWebGLProgram(o,s,"float32"),l=n.runWebGLProgram(i,s,"float32"),u=sX({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([r,a])){const e=n.texData.get(r.dataId),t=n.texData.get(a.dataId),[i,s]=cq(r.shape,a.shape,e.values,t.values,o),c=n.makeTensorInfo(s,o);return n.texData.get(c.dataId).values=i,c}let i;return i=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aX(SX,r.shape,a.shape):new nX(SX,r.shape,a.shape),n.runWebGLProgram(i,[r,a],o)}const IX={kernelName:eR,backendName:"webgl",kernelFunc:CX};function EX(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{shape:o}=r,i=n,s=OO(a.shape),c=FO(o,s),l=OO(c);EO(s===l,()=>"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.");const u=i.texData.get(a.dataId);return!u.isPacked||xG(a.shape,c)||null!==u.texture&&xG(u.shape,c)?(i.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype}):function(e,t,n){const r=[gG(e.shape),...yG(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},o=[gG(t),...yG(t)],i=new zq(o,r),s=[r],c=n.runWebGLProgram(i,[a],e.dtype,s,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}(a,c,i)}const TX={kernelName:xR,backendName:"webgl",kernelFunc:EX};class NX{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];const i=4*Math.floor(n/4),s=n%4;let c="sumValue += dot(values, ones);";if(null!=t){const e=1/t;c="sumValue += dot(values * ".concat(RO(e)?e.toPrecision(2):e,", ones);")}let l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(i,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class OX{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];let i="0.0",s="";"prod"===t?i="1.0":"min"===t?(i="1.0 / 1e-20",s="min"):"max"===t&&(i="-1.0 / 1e-20",s="max");let c="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?c="sumValue":"prod"===t?c="prodValue":"all"===t?c="allValue":"any"===t&&(c="anyValue");const l=4*Math.floor(n/4),u=n%4;let d="\n      if (".concat("sum"===t,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===t,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===t," || ").concat("max"===t,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===t?(i="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(i="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(i,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(i,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===u,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}function AX(e,t,n,r){const a=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=YU(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let o=e;for(let i=0;i<a.length;i++){const{inSize:s,windowSize:c,outSize:l}=a[i];let u,d;u="mean"===n?0===i?new NX({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},s):new NX({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l}):new OX({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},n),d=o,o=r.runWebGLProgram(u,[o],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return o}class _X{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let o=0;o<n.length;o++)n[o]=e[t[o]];this.outputShape=n,this.rank=n.length;const r=HG(this.rank),a=function(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}}class RX{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let l=0;l<n.length;l++)n[l]=e[t[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=HG(this.rank),a=Mq("rc",this.rank),o=new Array(this.rank);for(let l=0;l<t.length;l++)o[t[l]]=a[l];const i="vec2(".concat(o.slice(-2).join(),")"),s="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(o.join(),"), ").concat(i,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(s,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(s,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function PX(e,t,n){const r=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RX(e.shape,t):new _X(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function DX(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r;return function(e,t,n,r){const a=t,o=e.shape.length,i=LO(a,e.shape);let s=i;const c=Yz(s,o),l=null!=c;let u=e;l&&(u=PX(e,c,r),s=Zz(s.length,o)),Xz("sum",s,o);const[d,h]=Kz(u.shape,s);let p=d;n&&(p=qz(d,i));const f=OO(h),m=EX({inputs:{x:u},attrs:{shape:[OO(e.shape)/f,f]},backend:r}),g=AX(m,bD(e.dtype),"sum",r),y=EX({inputs:{x:g},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),l&&r.disposeIntermediateTensorInfo(u),y}(a,o,i,n)}const MX={kernelName:WR,backendName:"webgl",kernelFunc:DX};function FX(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:o}=r,i=n,s=a.shape.length,c=new Array(s);for(let u=0;u<c.length;u++)c[u]=a.shape[o[u]];let l;if(i.shouldExecuteOnCPU([a])){const e=i.texData.get(a.dataId).values,t=Pq(e,a.shape,a.dtype,o,c);l=i.makeTensorInfo(c,a.dtype);i.texData.get(l.dataId).values=t}else l=PX(a,o,i);return l}const LX={kernelName:lP,backendName:"webgl",kernelFunc:FX};function zX(e){let{a:t,b:n,transposeA:r,transposeB:a,backend:o,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:l=null}=e;const u=t.shape.length,d=n.shape.length,h=r?t.shape[u-2]:t.shape[u-1],p=a?n.shape[d-1]:n.shape[d-2],f=r?t.shape[u-1]:t.shape[u-2],m=a?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),v=OO(g),b=OO(y),x=TF(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);EO(h===p,()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(p,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const w=r?[v,h,f]:[v,f,h],k=a?[b,m,p]:[b,p,m],S=EX({inputs:{x:t},backend:o,attrs:{shape:w}}),C=EX({inputs:{x:n},backend:o,attrs:{shape:k}}),I=[S,C],E=Math.max(v,b),T=r?S.shape[1]:S.shape[2],N=null!=i,O=null!=s,A="leakyrelu"===l,_=null!=l?vX(l,!0):null;let R;if((1===f||1===m)&&T>1e3&&!1===(N||O||A||null!=_)){let e=S,t=C;r&&(e=FX({inputs:{x:S},backend:o,attrs:{perm:[0,2,1]}}),I.push(e)),a&&(t=FX({inputs:{x:C},backend:o,attrs:{perm:[0,2,1]}}),I.push(t));const n=1===m;let i=e;1!==m&&(i=EX({inputs:{x:e},backend:o,attrs:{shape:[E,T,1]}}),I.push(i));const s=1===m?2:1;let c=t;n&&(c=EX({inputs:{x:t},backend:o,attrs:{shape:[E,1,T]}}),I.push(c));const l=CX({inputs:{a:i,b:c},backend:o});R=DX({inputs:{x:l},backend:o,attrs:{axis:s,keepDims:!0}}),I.push(l)}else{const e=vD(t.dtype,n.dtype),l=new bX(w,k,[E,f,m],r,a,N,_,O,A),u=[S,C];if(null!=i&&u.push(i),O&&u.push(s),A){const e=o.makeTensorInfo([],"float32",GP(c,"float32"));u.push(e),I.push(e)}R=o.runWebGLProgram(l,u,e)}const P=EX({inputs:{x:R},backend:o,attrs:{shape:x}});I.push(R);for(const D of I)o.disposeIntermediateTensorInfo(D);return P}const BX={kernelName:yP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:o,bias:i,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;return zX({a:a,b:o,transposeA:c,transposeB:l,backend:n,bias:i,preluActivationWeights:s,leakyreluAlpha:d,activation:u})}},jX="return abs(x);";const WX={kernelName:dA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const e=n.texData.get(r.dataId),t=bq(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let a;return a=iA().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Yq(r.shape,jX):new Vq(r.shape,jX),n.runWebGLProgram(a,[r],r.dtype)}},UX=gX({opSnippet:Gq+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),VX={kernelName:hA,backendName:"webgl",kernelFunc:UX},GX=gX({opSnippet:Gq+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),HX={kernelName:pA,backendName:"webgl",kernelFunc:GX},KX="return a + b;",qX=yX({opSnippet:KX,packedOpSnippet:KX,supportsComplex:!0,cpuKernelImpl:jK}),XX={kernelName:fA,backendName:"webgl",kernelFunc:qX};class YX{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))});const r=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class QX{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>"T".concat(t));const n=[];this.variableNames.forEach(e=>{n.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))});const r=this.variableNames.map(e=>"v".concat(e)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const ZX={kernelName:mA,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,a=n;if(1===a.length)return oX({inputs:{x:a[0]},backend:r});if(a.length>iA().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(a.length/2),n=e({inputs:a.slice(0,t),backend:r}),o=e({inputs:a.slice(t),backend:r});return e({inputs:[n,o],backend:r})}const o=a.map(e=>e.dtype).reduce((e,t)=>vD(e,t)),i=a.map(e=>e.shape),s=iA().getBool("WEBGL_PACK")?new QX(a[0].shape,i):new YX(a[0].shape,i);return r.runWebGLProgram(s,a,o)}};const $X={kernelName:gA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r,s=a.shape.length,c=LO(o,a.shape);let l=c;const u=Yz(l,s);let d=a;null!=u&&(d=FX({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Zz(l.length,s)),Xz("all",l,s);const[h,p]=Kz(d.shape,l),f=EX({inputs:{x:d},backend:n,attrs:{shape:[-1,OO(p)]}}),m=AX(f,f.dtype,"all",n);let g;if(i){g=EX({inputs:{x:m},backend:n,attrs:{shape:qz(h,c)}})}else g=EX({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}};const JX={kernelName:yA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r,s=a.shape.length,c=LO(o,a.shape);let l=c;const u=Yz(l,s);let d=a;null!=u&&(d=FX({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Zz(l.length,s)),Xz("any",l,s);const[h,p]=Kz(d.shape,l),f=EX({inputs:{x:d},backend:n,attrs:{shape:[-1,OO(p)]}}),m=AX(f,f.dtype,"any",n);let g;if(i){g=EX({inputs:{x:m},backend:n,attrs:{shape:qz(h,c)}})}else g=EX({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}};class eY{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:o}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];const i="max"===t?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(i," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class tY{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,EO(e.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const a=e[e.length-1],o=Math.ceil(a/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const i=this.outputShape,s=i.length,c=HG(s),l=Fq("coords",s);let u,d;if(1===o){d=s+1;const e=HG(d);u="\n        ".concat(e," sourceLocR = ").concat(e,"(").concat(l.join(),", 0);\n        ++").concat(l[s-1],";\n        ").concat(e," sourceLocG = ").concat(e,"(").concat(l.join(),", 0);\n        ++").concat(l[s-2],";\n        ").concat(e," sourceLocA = ").concat(e,"(").concat(l.join(),", 0);\n        --").concat(l[s-1],";\n        ").concat(e," sourceLocB = ").concat(e,"(").concat(l.join(),", 0);\n        --").concat(l[s-2],";")}else d=s,u="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(l[s-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(l[s-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(l[s-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(l[s-2],";");const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],f=h.map(e=>"int "+e),m=Fq("sourceLocR",d-1).concat("inIdx.r"),g=Fq("sourceLocG",d-1).concat("inIdx.g"),y=Fq("sourceLocB",d-1).concat("inIdx.b"),v=Fq("sourceLocA",d-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),")));"),w="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(v.join(),") : 0.)"),k=r?"":"\n      float getBestIndicesAChannel(".concat(f.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(f.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(l[s-1]," < ").concat(i[s-1]-1,";\n        bool hasNextRow = ").concat(l[s-2]," < ").concat(i[s-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(t,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(t,"; i++) {\n          inIdx = srcIdx;\n          ").concat(x,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function nY(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],o=t.shape[1];null!=r&&(a=r.shape[0],o=r.shape[1]);const i=YU(o),s={windowSize:i,inSize:o,batchSize:a,outSize:Math.ceil(o/i)},c=new eY(s,n,null==r),l=[t];null!=r&&l.push(r);const u=e.runWebGLProgram(c,l,"int32");if(1===u.shape[1])return u;const d=nY(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function rY(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=null!=r?r.shape:t.shape,o=YU(a[a.length-1]),i=new tY(a,o,n,null==r),s=null==r?[t]:[t,r],c=e.runWebGLProgram(i,s,"int32");if(c.shape.length===t.shape.length){const r=rY(e,t,n,c);return e.disposeIntermediateTensorInfo(c),r}return c}function aY(e,t,n,r){const a=[n];if(Xz("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!iA().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],o=e.texData.get(t.dataId);let i=t;null!==o&&o.isPacked&&(i=e.unpackTensor(t),n.push(i));const[s,c]=Kz(i.shape,a),l=OO(c),u=EX({inputs:{x:i},backend:e,attrs:{shape:[-1,l]}});n.push(u);const d=nY(e,u,r);n.push(d);const h=EX({inputs:{x:d},backend:e,attrs:{shape:s}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),h}return rY(e,t,r)}const oY={kernelName:vA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o}=r;let i=LO(o,a.shape);const s=Yz(i,a.shape.length);let c=a;const l=[];null!=s&&(c=FX({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),i=Zz(i.length,c.shape.length)),Xz("argMax",[i[0]],c.shape.length);const u=aY(n,c,i[0],"max");return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}};const iY={kernelName:bA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o}=r;let i=LO(o,a.shape);const s=Yz(i,a.shape.length);let c=a;const l=[];null!=s&&(c=FX({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),i=Zz(i.length,c.shape.length)),Xz("argMin",[i[0]],c.shape.length);const u=aY(n,c,i[0],"min");return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}},sY=gX({opSnippet:Gq+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),cY={kernelName:xA,backendName:"webgl",kernelFunc:sY},lY=gX({opSnippet:Gq+"return log(x + sqrt(x * x + 1.0));"}),uY={kernelName:wA,backendName:"webgl",kernelFunc:lY},dY=gX({opSnippet:Gq+"\n  return atan(x);\n"}),hY={kernelName:kA,backendName:"webgl",kernelFunc:dY},pY=yX({opSnippet:tX+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+rX+"\n  return result;\n"}),fY={kernelName:CA,backendName:"webgl",kernelFunc:pY},mY=gX({opSnippet:Gq+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),gY={kernelName:SA,backendName:"webgl",kernelFunc:mY};class yY{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideHeight,s=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m="((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"),g="(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d");let y="0.0";if(f||(y="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(i,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(t," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?a?m:g:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(v="avgValue / max(count, 1.0)");const b=4*Math.floor(o/4),x=o%4,w="\n      if (".concat(f,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}class vY{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideDepth,s=e.strideHeight,c=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v="avg"===t;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(i,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(f,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(t," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?a?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(f," +\n                      wR * ").concat(f," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(t,"(").concat(t,"(").concat(t,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(o/4),k=o%4,S="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(i,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}const bY={kernelName:IA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;TG(a,"avgPool");const{filterSize:o,strides:i,pad:s,dimRoundingMode:c}=r;EO(KL(i,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const l=FL(a.shape,o,i,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&_O(l.inShape,l.outShape))return oX({inputs:{x:a},backend:n});const u=new yY(l,"avg",!1);return n.runWebGLProgram(u,[a],"float32")}};const xY={kernelName:TA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dimRoundingMode:c,dataFormat:l}=r,u=LL(a.shape,o,i,[1,1,1],s,c,l),d=new vY(u,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}};class wY{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.top,u=c-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(u,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(i,") {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class kY{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=u-1-e.padInfo.front,f=d-1-e.padInfo.top,m=h-1-e.padInfo.left,g=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(f,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(a,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const SY={kernelName:NA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=LL(i.shape,s,c,[1,1,1],l,u),h=new kY(d);return n.runWebGLProgram(h,[a],i.dtype)}};const CY={kernelName:EA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o;TG([a,o],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=FL(i.shape,s,c,1,l),d=new wY(u);return n.runWebGLProgram(d,[a],i.dtype)}};const IY={kernelName:OA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:o}=t,{transposeA:i,transposeB:s}=r;return zX({a:a,b:o,transposeA:i,transposeB:s,backend:n})}};class EY{constructor(e,t,n,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],TF(e,t),TF(e,n);let i="0.0";null!=r&&(TF(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let s="1.0";null!=a&&(TF(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(i,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class TY{constructor(e,t,n,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],TF(e,t),TF(e,n);let i="vec4(0.0)";null!=r&&(TF(e,r),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=a&&(TF(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(i,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const NY={kernelName:b_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a,mean:o,variance:i,offset:s,scale:c}=t;EO(o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),EO(null==s||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),EO(null==c||o.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=[a,o,i];let d=null;null!=s&&(d=s.shape,u.push(s));let h=null;null!=c&&(h=c.shape,u.push(c));const p=iA().getBool("WEBGL_PACK_NORMALIZATION")?new TY(a.shape,o.shape,i.shape,d,h,l):new EY(a.shape,o.shape,i.shape,d,h,l);return n.runWebGLProgram(p,u,u[0].dtype)}};class OY{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=HG(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return AY.slice(0,e).map(e=>"sourceLoc."+e).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let r;const a=e.map((e,t)=>"sourceLoc.".concat(AY[t]," = start[").concat(t,"] + coords.").concat(AY[t],";"));r="\n        ".concat(t," sourceLoc;\n        ").concat(t," coords = getOutputCoords();\n        ").concat(a.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const AY=["x","y","z","w","u","v"];class _Y{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=HG(this.rank),n=Fq("coords",this.rank),r=Fq("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),o="getChannel(getSource(".concat(r.join(),"), ").concat(a,")"),i="\n      result.x = ".concat(o,";\n      if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(n[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(t,"(").concat(e.map((e,t)=>"start[".concat(t,"]")).join(),");"):e.map((e,t)=>"".concat(r[t]," = ").concat(n[t]," + start[").concat(t,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(t," coords = getOutputCoords();\n        ").concat(t," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(i,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function RY(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:o,size:i}=r,[s,c]=xL(a,o,i);if(iL(a,s,c),0===OO(c))return n.makeTensorInfo(c,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){const e=n.texData.get(a.dataId),t=xq(e.values,s,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,t)}const{isPacked:l}=n.texData.get(a.dataId),u=vL(a.shape,s,c);if(l||!u){const e=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _Y(c):new OY(c),t=[s];return n.runWebGLProgram(e,[a],a.dtype,t)}return n.uploadToGPU(a.dataId),function(e,t,n,r){const a=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),i=r.texData.get(o.dataId);Object.assign(i,a),i.refCount=1,i.shape=n,i.dtype=e.dtype;let s=bL(t,qO(e.shape));a.slice&&(s+=a.slice.flatOffset),i.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};const c=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,c+1),o}(a,s,c,n)}const PY={kernelName:DR,backendName:"webgl",kernelFunc:RY},DY={kernelName:AA,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:o,crops:i}=r;EO(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=o.reduce((e,t)=>e*t),c=ZU(a.shape,o,s),l=$U(c.length,o.length),u=JU(a.shape,o,s),d=eV(i,o.length),h=tV(u,i,o.length),p=[],f=EX({inputs:{x:a},backend:n,attrs:{shape:c}}),m=FX({inputs:{x:f},backend:n,attrs:{perm:l}}),g=EX({inputs:{x:m},backend:n,attrs:{shape:u}}),y=RY({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}};const MY={kernelName:_A,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:o}=t,{size:i}=r,s=n.readSync(a.dataId),c=n.readSync(o.dataId),l=WK(s,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,l)}};const FY={kernelName:RA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{a:r,b:a}=t,o=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=iA().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||1===i){const e=n.texData.get(r.dataId).values,t=n.texData.get(a.dataId).values,[o,i]=VK(r.shape,a.shape,e,t,r.dtype),s=n.makeTensorInfo(i,r.dtype);return n.texData.get(s.dataId).values=o,s}let s;return s=o?new aX("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,a.shape,!1):new nX("\n  return float(int(a.r) & int(b.r));\n",r.shape,a.shape),n.runWebGLProgram(s,[r,a],r.dtype)}};const LY={kernelName:PA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t,o=n.readSync(r.dataId),i=n.readSync(a.dataId),s=TF(Array.from(o),Array.from(i));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},zY=yX({opSnippet:"return float(a != b);",cpuKernelImpl:uq,dtype:"bool"}),BY={kernelName:nR,backendName:"webgl",kernelFunc:zY};function jY(e){const{inputs:t,backend:n}=e,{input:r}=t;return oX({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const WY={kernelName:yR,backendName:"webgl",kernelFunc:jY};const UY={kernelName:DA,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:a}=t,{x:o}=n,{dtype:i}=a;if("complex64"===i){if("complex64"===o.dtype)return oX({inputs:{x:o},backend:r});const t=jB(o.shape),n=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),a=sX({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),a}if("complex64"===o.dtype){const t=jY({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:i}});return r.disposeIntermediateTensorInfo(t),n}if(!WO(o.dtype,i)){const e=oX({inputs:{x:o},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(r.shouldExecuteOnCPU([o])){const e=r.texData.get(o.dataId).values,[t,n,a]=GK(e,o.shape,o.dtype,i);return r.makeTensorInfo(t,n,a)}if("int32"===i)return function(e,t){const n=new Vq(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===i){const e=r.makeTensorInfo([],"bool",BO("bool",1)),t=zY({inputs:{a:o,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(i))}},VY="return ceil(x);",GY=gX({opSnippet:VY,packedOpSnippet:VY,cpuKernelImpl:HK}),HY={kernelName:MA,backendName:"webgl",kernelFunc:GY};class KY{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class qY{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const XY={kernelName:FA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:o,clipValueMax:i}=r;let s;s=iA().getBool("WEBGL_PACK_CLIP")?new qY(a.shape):new KY(a.shape);const c=[[o],[i]];return n.runWebGLProgram(s,[a],a.dtype,c)}};class YY{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function QY(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const ZY={kernelName:zA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=n.texData.get(r.dataId),o=new YY(r.shape),i=[QY(r,a.complexTensorInfos.real),QY(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}};class $Y{constructor(e){this.outputShape=[],this.outputShape=UU(e,1),this.variableNames=e.map((e,t)=>"T".concat(t));const t=new Array(e.length-1);t[0]=e[0][1];for(let o=1;o<t.length;o++)t[o]=t[o-1]+e[o][1];const n=["if (yC < ".concat(t[0],") setOutput(getT0(yR, yC));")];for(let o=1;o<t.length;o++){const e=t[o-1];n.push("else if (yC < ".concat(t[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(e,"));"))}const r=t.length,a=t[t.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class JY{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=UU(e,t);const n=this.outputShape,r=n.length,a=HG(r),o=Fq("coords",r),i=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((e,t)=>"T".concat(t));const s=new Array(e.length-1);s[0]=e[0][t];for(let f=1;f<s.length;f++)s[f]=s[f-1]+e[f][t];const c=i[t],l=i.slice(-2),u=i.join();let d="if (".concat(c," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(l.join(),"));\n        }");for(let f=1;f<s.length;f++){const e=s[f-1];d+="\n        if (".concat(c," < ").concat(s[f],"  && ").concat(c," >= ").concat(s[f-1],") {\n          return getChannel(\n            getT").concat(f,"(").concat(eQ(i,c,e),"),\n            vec2(").concat(eQ(l,c,e),"));\n        }")}const h=s.length,p=s[s.length-1];d+="\n        return getChannel(\n          getT".concat(h,"(").concat(eQ(i,c,p),"),\n          vec2(").concat(eQ(l,c,p),"));"),this.userCode="\n      float getValue(".concat(i.map(e=>"int "+e),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[r-1]," = ").concat(o[r-1]," + 1;\n        if (").concat(o[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[r-2]," = ").concat(o[r-2]," + 1;\n        if (").concat(o[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[r-1]," = ").concat(o[r-1]," - 1;\n        if (").concat(o[r-2]," < ").concat(n[r-2]," &&\n            ").concat(o[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}}function eQ(e,t,n){const r=e.indexOf(t),a=e.map((e,t)=>t===r?"".concat(e," - ").concat(n):e);return a.join()}function tQ(e){const{inputs:t,backend:n}=e,{input:r}=t;return oX({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const nQ={kernelName:E_,backendName:"webgl",kernelFunc:tQ};function rQ(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map(e=>jY({inputs:{input:e},backend:n})),a=e.map(e=>tQ({inputs:{input:e},backend:n})),o=rQ(r,t,n),i=rQ(a,t,n),s=sX({inputs:{real:o,imag:i},backend:n});return r.forEach(e=>n.disposeIntermediateTensorInfo(e)),a.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),s}let a=n.shouldExecuteOnCPU(e);if("string"===r&&(a=!0),a){const a=e.map(e=>{const r=OO(e.shape.slice(t));return EX({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})}),o=a.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),i=UU(a.map(e=>e.shape),1),s=1===a[0].shape[0],c=KK(o,i,r,s),l=UU(e.map(e=>e.shape),t),u=n.makeTensorInfo(l,r,c);return a.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}const o=e.filter(e=>OO(e.shape)>0),i=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(1===o.length){const t=i?new Vq(e[0].shape,Xq):new Yq(e[0].shape,Xq);return n.runWebGLProgram(t,e,r)}const s=iA().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>s){const e=[];for(let a=0;a<o.length;a+=s){const r=o.slice(a,a+s);e.push(rQ(r,t,n))}const r=rQ(e,t,n);for(const t of e)n.disposeIntermediateTensorInfo(t);return r}if(i){const e=new JY(o.map(e=>e.shape),t);return n.runWebGLProgram(e,o,r)}const{tensors2D:c,outShape:l}=function(e,t,n){const r=UU(e.map(e=>e.shape),t),a=e.map(e=>EX({inputs:{x:e},attrs:{shape:[-1,OO(e.shape.slice(t))]},backend:n}));return{tensors2D:a,outShape:r}}(o,t,n),u=new $Y(c.map(e=>e.shape)),d=n.runWebGLProgram(u,c,r);c.forEach(e=>n.disposeIntermediateTensorInfo(e));const h=EX({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),h}function aQ(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,o=LO(a,t[0].shape)[0];WU(t.map(e=>e.shape),o);const i=UU(t.map(e=>e.shape),o);if(0===OO(i))return n.makeTensorInfo(i,t[0].dtype,[]);const s=t.filter(e=>OO(e.shape)>0);return 1===s.length?oX({inputs:{x:s[0]},backend:n}):rQ(s,o,n)}const oQ={kernelName:BA,backendName:"webgl",kernelFunc:aQ};class iQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,i=e.padInfo.left,s=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,g=m?1:2,y=m?2:3,v=m?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===f,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===f,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===f,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class sQ{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(o,", ").concat(i,");\n      const ivec3 pads = ivec3(").concat(t,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===f,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===f,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===f,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class cQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=$G(this.outputShape.length);const o=e.padInfo.left,i=e.strideWidth,s=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,u=l;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<l;m++)d+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");d+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(e.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<l;m++)d+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){const t=2*m;if(d+="\n           xC = xCCorner + ".concat(t*s,";\n           "),1===i){if(t<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n               "),d+=1===s&&t>0?"\n                 xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                   } else {\n                     xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xC").concat(t," = xTexelC").concat(t,";\n                 "),t+1<l)){const e=o%2===0?SO(s):s;s%2===0&&o%2===1||s%2!==0&&o%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                     xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(t+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(t+1,"Ready = 1;\n                   }\n                   "),d+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                     } else {\n                      xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                     }\n                     "):"\n                     xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                     ")):d+=1===e?"\n                     xC".concat(t+1," = xTexelC").concat(t,";\n                     "):"\n                     xCOffset = xC + ".concat(e,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                       xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(t+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(t+1,"Ready = 1;\n                     }\n\n                     xC").concat(t+1," = xTexelC").concat(t+1,";\n                     ")}}else t<l&&(o%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n               "),t+1<l&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                   xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(t,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(t,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                   xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(t+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(t+1,"Ready = 1;\n                 }\n\n                 xC").concat(t," = vec4(\n                   xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n               "),t+1<l&&(d+="\n                   xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                 "))));t<l&&(d+="\n             wTexel = getW(r, ".concat(t,", d1, d2);\n             dotProd += xC").concat(t,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(e.inChannels,") {\n               dotProd += xC").concat(t,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),t+1<l&&(d+="\n               wTexel = getW(r, ".concat(t+1,", d1, d2);\n               dotProd += xC").concat(t+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(e.inChannels,") {\n                 dotProd += xC").concat(t+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";n&&(h=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(h,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(f,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}}class lQ{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=$G(this.outputShape.length);const{dataFormat:n}=t,r=OG(),a="channelsLast"===n,o=a?1:2,i=a?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(e[2]," && pos < ").concat(e[1],") {");let c="";for(let l=0;l<=1;l++)for(let e=0;e<=1;e++)c+="\n          blockIndex = rc.z + ".concat(e,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(i,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(a,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+e,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+e,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function uQ(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function dQ(e){let{x:t,filter:n,convInfo:r,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const l=t.shape,u=a.texData.get(t.dataId),d=r.inChannels,h=l[0]*l[1]*l[2],p=r.outChannels,f="channelsLast"===r.dataFormat,m=!1;let g;const y=[];if(null!=i){const e=uQ(i.shape,f);null!=e&&(i=EX({inputs:{x:i},backend:a,attrs:{shape:e}}),y.push(i))}if(null!=o){const e=uQ(o.shape,f);null!=e&&(o=EX({inputs:{x:o},backend:a,attrs:{shape:e}}),y.push(o))}if(!((1===h||1===p)&&d>1e3)&&u.isPacked&&f&&null!=u.texture&&l[2]%2!==0&&_O(u.shape.slice(-3),l.slice(-3))){const e=l[0]*l[1]*(l[2]+1),d={dataId:t.dataId,shape:[1,e,r.inChannels],dtype:t.dtype},h=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,EO(xG(u.shape,d.shape),()=>"packed reshape ".concat(u.shape," to ").concat(d.shape," isn't free"));const p=EX({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(p);const f=zX({a:d,b:p,backend:a,transposeA:false,transposeB:m,bias:o,activation:c,preluActivationWeights:i,leakyreluAlpha:s}),v=a.texData.get(f.dataId);EO(v.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=h,v.shape=r.outShape,g=oX({inputs:{x:f},backend:a}),g.shape=r.outShape,y.push(f)}else{const e=r.outHeight*r.outWidth,l=EX({inputs:{x:t},backend:a,attrs:{shape:f?[r.batchSize,e,r.inChannels]:[r.batchSize,r.inChannels,e]}}),u=EX({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}}),d=zX({a:f?l:u,b:f?u:l,transposeA:!f,transposeB:m,backend:a,bias:o,activation:c,preluActivationWeights:i,leakyreluAlpha:s});g=EX({inputs:{x:d},backend:a,attrs:{shape:r.outShape}}),y.push(l),y.push(u),y.push(d)}for(const v of y)a.disposeIntermediateTensorInfo(v);return g}function hQ(e){let{x:t,filter:n,convInfo:r,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const{filterWidth:l,filterHeight:u,inChannels:d,outWidth:h,outHeight:p,dataFormat:f}=r,m="channelsLast"===f,g=l*u*d,y=p*h,v=[r.batchSize,g,y],b=[];if(null!=i){const e=uQ(i.shape,m);null!=e&&(i=EX({inputs:{x:i},backend:a,attrs:{shape:e}}),b.push(i))}if(null!=o){const e=uQ(o.shape,m);null!=e&&(o=EX({inputs:{x:o},backend:a,attrs:{shape:e}}),b.push(o))}const x=EX({inputs:{x:n},backend:a,attrs:{shape:[1,g,OO(n.shape)/g]}});b.push(x);const w=new lQ(v,r),k=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=a.runWebGLProgram(w,[t],"float32",k),C=EX({inputs:{x:S},backend:a,attrs:{shape:v}});b.push(S),b.push(C);const I=null!=o,E=null!=i,T="leakyrelu"===c,N=c?vX(c,!0):null,O=new bX(m?C.shape:x.shape,m?x.shape:C.shape,m?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,I,N,E,T),A=m?[C,x]:[x,C];if(o&&A.push(o),E&&A.push(i),T){const e=a.makeTensorInfo([],"float32",GP(s,"float32"));A.push(e),b.push(e)}const _=a.runWebGLProgram(O,A,"float32"),R=EX({inputs:{x:_},backend:a,attrs:{shape:r.outShape}});b.push(_);for(const P of b)a.disposeIntermediateTensorInfo(P);return R}const pQ={kernelName:jA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r,d=XL(c),h=zL(a.shape,o.shape,i,l,s,u,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&iA().getBool("WEBGL_EXP_CONV")){const e=new cQ(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(e,[a,o],"float32",t)}else if(iA().getBool("WEBGL_CONV_IM2COL"))p=hQ({x:a,filter:o,convInfo:h,backend:n});else{const e=new iQ(h);p=n.runWebGLProgram(e,[a,o],"float32")}else p=dQ({x:a,filter:o,convInfo:h,backend:n});const f=EX({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}};class fQ{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              ").concat(o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class mQ{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o="channelsLast"===e.dataFormat,i=t-1-e.padInfo.top,s=n-1-e.padInfo.left,c=o?1:2,l=o?2:3,u=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class gQ{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,o=e.padInfo.top,i=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t," - ").concat(a,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class yQ{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,i=e.strideWidth,s=t-1-e.padInfo.front,c=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(t,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(a,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(t," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const vQ={kernelName:WA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,d=XL(c),h=zL(a.shape,u,i,1,s,l,!1,d),p=new fQ(h);return n.runWebGLProgram(p,[a,o],"float32")}};class bQ{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=$G(this.outputShape.length);const t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,a=n-1-e.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(e.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(e.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const xQ={kernelName:UA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{inputShape:i,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r,d=XL(l),h=zL(i,o.shape,s,1,c,u,!1,d);if(iA().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const e=[[h.strideHeight,h.strideWidth]],t=new bQ(h);return n.runWebGLProgram(t,[a,o],"float32",e)}{const e=new mQ(h);return n.runWebGLProgram(e,[a,o],"float32")}}};const wQ={kernelName:VA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dilations:c}=r,l=BL(a.shape,o.shape,i,c,s),u=new sQ(l);return n.runWebGLProgram(u,[a,o],"float32")}};const kQ={kernelName:GA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,pad:s,filterShape:c}=r,l=BL(a.shape,c,i,1,s),u=new gQ(l);return n.runWebGLProgram(u,[a,o],"float32")}};const SQ={kernelName:HA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{pad:i,strides:s,inputShape:c}=r,l=BL(c,o.shape,s,1,i),u=new yQ(l);return n.runWebGLProgram(u,[a,o],"float32")}},CQ=gX({opSnippet:mX+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(rX,"\n  return result;\n")}),IQ={kernelName:KA,backendName:"webgl",kernelFunc:CQ},EQ=gX({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),TQ={kernelName:qA,backendName:"webgl",kernelFunc:EQ};class NQ{constructor(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,i,s,c]=e,[l]=t,[u,d]=n;this.outputShape=[l,u,d,c];const h="bilinear"===r?1:0,[p,f]=["".concat(i-1,".0"),"".concat(s-1,".0")],[m,g,y]=u>1?["".concat((i-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(p," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(p)],[v,b,x]=d>1?["".concat((s-1)/(d-1)),"(x2-x1) * width_ratio","x1*".concat(f," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(f)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(v,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(o,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(p," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(f," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(h," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const OQ={kernelName:QA,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:o,boxInd:i}=t,{cropSize:s,method:c,extrapolationValue:l}=r,u=new NQ(a.shape,o.shape,s,c,l);return n.runWebGLProgram(u,[a,o,i],"float32")}};var AQ;!function(e){e.Prod="*",e.Sum="+"}(AQ||(AQ={}));class _Q{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,o=this.op===AQ.Prod?"1.0":"0.0",i=n?o:"getX(".concat(RQ(a,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let c="",l="";n?(c=r?"end != ".concat(s-1):"end != 0",l=r?"end + 1":"end - 1"):(c=r?"end + pow2 < ".concat(s):"end >= pow2",l=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(HG(a)," coords = getOutputCoords();\n        int end = ").concat(PQ(a,"coords",this.op),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(PQ(a,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(RQ(a,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function RQ(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function PQ(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function DQ(e,t,n,r,a,o){const i=t.shape.length,s=Yz([r],i);let c=t;null!=s&&(c=FX({inputs:{x:t},backend:n,attrs:{perm:s}}));const l=Zz(1,i)[0];if(l!==i-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));const u=c.shape[l];let d=oX({inputs:{x:c},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const t=new _Q(e,c.shape,!1,o),r=[[h]],a=d;d=n.runWebGLProgram(t,[d],d.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){const t=new _Q(e,c.shape,a,o),r=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const e=FX({inputs:{x:d},backend:n,attrs:{perm:Qz(s)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(c),e}return d}const MQ={kernelName:XA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,exclusive:i,reverse:s}=r;return DQ(AQ.Prod,a,n,o,i,s)}};const FQ={kernelName:YA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,exclusive:i,reverse:s}=r;return DQ(AQ.Sum,a,n,o,i,s)}};const LQ={kernelName:ZA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:o}=t,{size:i,binaryOutput:s}=r;if(1===a.shape.length){const e=n.readSync(a.dataId),t=n.readSync(o.dataId),r=WK(e,t,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,r)}if(2===a.shape.length){const e=n.bufferSync(a),t=n.bufferSync(o),r=UK(e,t,i,s);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};class zQ{constructor(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(t,";\n      int offset_h = imod(h, ").concat(t,");\n      int in_w = w / ").concat(t,";\n      int offset_w = imod(w, ").concat(t,");\n      int offset_d = (offset_h * ").concat(t," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const BQ={kernelName:$A,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:o,dataFormat:i}=r,s=a.shape[0],c=("NHWC"===i?a.shape[1]:a.shape[2])*o,l=("NHWC"===i?a.shape[2]:a.shape[3])*o,u=("NHWC"===i?a.shape[3]:a.shape[1])/(o*o),d=new zQ("NHWC"===i?[s,c,l,u]:[s,u,c,l],o,i);return n.runWebGLProgram(d,[a],a.dtype)}};class jQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=$G(this.outputShape.length);const o=e.filterHeight,i=e.filterWidth,s=e.outChannels/e.inChannels;let c="",l="";n&&(c=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),l="result = activation(result);");const u=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")}}class WQ{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=$G(this.outputShape.length);const o=e.outChannels/e.inChannels,i=e.padInfo.left,s=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,d=u;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)h+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");h+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(let g=0;g<u;g++)h+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(d+1)/2;g++){const e=2*g;if(h+="\n          xC = xCCorner + ".concat(e*c,";\n          "),1===s){if(e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n              "),h+=1===c&&e>0?"\n                xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                  } else {\n                    xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                  }\n                  ")):h+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xC").concat(e," = xTexelC").concat(e,";\n                "),e+1<u)){const t=i%2===0?SO(c):c;c%2===0&&i%2===1||c%2!==0&&i%2!==1?(h+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                    xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(e+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(e+1,"Ready = 1;\n                  }\n                  "),h+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                    } else {\n                     xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                    }\n                    "):"\n                    xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                    ")):h+=1===t?"\n                    xC".concat(e+1," = xTexelC").concat(e,";\n                    "):"\n                    xCOffset = xC + ".concat(t,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                      xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(e+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(e+1,"Ready = 1;\n                    }\n\n                    xC").concat(e+1," = xTexelC").concat(e+1,";\n                    ")}}else e<u&&(i%2===1?(h+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n              "),e+1<u&&(h+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                "))):(h+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                  xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(e,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(e,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                  xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(e+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(e+1,"Ready = 1;\n                }\n\n                xC").concat(e," = vec4(\n                  xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n              "),e+1<u&&(h+="\n                  xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                "))));e<u&&(h+="\n            wTexel = getW(r, ".concat(e,", d1, q);\n            dotProd += xC").concat(e," * vec4(wTexel.xz, wTexel.xz);\n          "),e+1<u&&(h+="\n              wTexel = getW(r, ".concat(e+1,", d1, q);\n              dotProd += xC").concat(e+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";n&&(p=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(h,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const UQ={kernelName:JA,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dilations:c,dimRoundingMode:l}=r;let u=c;null==u&&(u=[1,1]),EO(KL(i,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(i," and dilations '").concat(u,"'"));const d=zL(a.shape,o.shape,i,u,s,l,!0);let h;h=iA().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new WQ(d):new jQ(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[a,o],"float32",p)}};class VQ{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class GQ{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(t,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(t," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const HQ={kernelName:e_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r,d=zL(a.shape,u,i,s,c,l,!0),h=new VQ(d);return n.runWebGLProgram(h,[a,o],"float32")}};const KQ={kernelName:t_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r,d=zL(u,o.shape,i,s,c,l,!0),h=new GQ(d);return n.runWebGLProgram(h,[a,o],"float32")}};class qQ{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const XQ={kernelName:n_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],o=OO(r.shape),i=EX({inputs:{x:r},backend:n,attrs:{shape:[o]}}),s=new qQ(o),c=n.runWebGLProgram(s,[i],i.dtype),l=EX({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),l}};class YQ{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:n,padInfo:r,strideHeight:a,strideWidth:o,filterHeight:i,filterWidth:s,dilationHeight:c,dilationWidth:l}=e,{top:u,left:d}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(i,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(t,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const QQ={kernelName:r_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dilations:c}=r,l=ML(a.shape,o.shape,i,s,"NHWC",c);let u;const d=new YQ(l);u=n.runWebGLProgram(d,[a,o],"float32");const h=EX({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),h}};const ZQ={kernelName:i_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,o=t,{allDims:i,summedDims:s,idDims:c}=SV(a,o.length);IV(i.length,c,o);const{path:l,steps:u}=EV(s,c),d=u.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of u[m]){const{permutationIndices:t,expandDims:r}=CV(p,c[e]);let a;TV(t)?a=o[e]:(a=FX({inputs:{x:o[e]},backend:n,attrs:{perm:t}}),f.push(a));const i=a.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);_O(a.shape,i)||(a=EX({inputs:{x:a},backend:n,attrs:{shape:i}}),f.push(a)),null===h?h=a:(h=CX({inputs:{a:a,b:h},backend:n}),f.push(h))}m<d-1&&(l[m]>=0&&(h=DX({inputs:{x:h},backend:n,attrs:{axis:l[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeIntermediateTensorInfo(m);return h}},$Q=gX({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),JQ={kernelName:s_,backendName:"webgl",kernelFunc:$Q},eZ={kernelName:c_,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:a}=t,o=iA().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new aX("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new nX("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)}},tZ=yX({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:qK}),nZ={kernelName:u_,backendName:"webgl",kernelFunc:tZ},rZ=gX({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(oV,";\n  float a1 = ").concat(iV,";\n  float a2 = ").concat(sV,";\n  float a3 = ").concat(cV,";\n  float a4 = ").concat(lV,";\n  float a5 = ").concat(uV,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),aZ={kernelName:l_,backendName:"webgl",kernelFunc:rZ},oZ=gX({opSnippet:mX+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:XK,dtype:"float32"}),iZ={kernelName:d_,backendName:"webgl",kernelFunc:oZ};function sZ(e){const{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:o}=t,i=o.shape.length,s=o.shape.slice();let c=a;return a<0&&(EO(-(i+1)<=a,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),c=i+a+1),s.splice(c,0,1),EX({inputs:{x:o},backend:r,attrs:{shape:s}})}const cZ={kernelName:h_,backendName:"webgl",kernelFunc:sZ},lZ="return exp(x) - 1.0;",uZ=gX({opSnippet:lZ,packedOpSnippet:lZ,cpuKernelImpl:YK}),dZ={kernelName:p_,backendName:"webgl",kernelFunc:uZ};class hZ{constructor(e,t,n){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),o=n?"".concat(r,".0"):"1.0";let i;if("real"===e)i="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error('FFT component must be either "real" or "imag", got '.concat(e,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(o,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function pZ(e,t,n){const r=n.texData.get(e.dataId),a=OO(e.shape),o=e.shape[e.shape.length-1],i=EX({inputs:{x:e},backend:n,attrs:{shape:[a/o,o]}}),s=i.shape,c=new hZ("real",s,t),l=new hZ("imag",s,t),u=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],d=n.runWebGLProgram(c,u,"float32"),h=n.runWebGLProgram(l,u,"float32"),p=sX({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);const f=EX({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(p),f}const fZ={kernelName:f_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return pZ(r,!1,n)}};class mZ{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function gZ(e){const{backend:t,attrs:n}=e,{shape:r,value:a}=n;let{dtype:o}=n;if(o=o||GO(a),"string"===o){const e=jO(o,OO(r));return e.fill(a),t.makeTensorInfo(r,o,e)}{const e=new mZ(r,a),n=[[a]];return t.runWebGLProgram(e,[],o,n)}}const yZ={kernelName:m_,backendName:"webgl",kernelFunc:gZ};class vZ{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(t," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(t,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const bZ={kernelName:g_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,a=n,o=new vZ(r.shape);return a.runWebGLProgram(o,[r],r.dtype)}},xZ="return floor(x);",wZ=gX({opSnippet:xZ,packedOpSnippet:xZ,cpuKernelImpl:QK}),kZ={kernelName:y_,backendName:"webgl",kernelFunc:wZ},SZ=yX({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),CZ={kernelName:v_,backendName:"webgl",kernelFunc:SZ};class IZ{constructor(e){this.variableNames=["A"];const t=OG(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(t.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class EZ{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=OG(),[n,r]=e;this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(t.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(t.output," = result;\n      }\n    ")}}const TZ={kernelName:mP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:a}=t;const{numChannels:o}=r,i="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,[c,l]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[l,c],d=[l,c,o];if(s||i){const e=iA().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=NZ&&e===OZ||(OZ=e,NZ=document.createElement("canvas").getContext("2d",{willReadFrequently:OZ})),NZ.canvas.width=c,NZ.canvas.height=l,NZ.drawImage(a,0,0,c,l),a=NZ.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=ZV.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),a);const p=iA().getBool("WEBGL_PACK")?new EZ(d):new IZ(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}};let NZ,OZ=iA().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const AZ={kernelName:vP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=XL(u),g=zL(a.shape,o.shape,c,d,l,h,!1,m);let y;const v=[],b=null!=i,x=null!=s,w="leakyrelu"===p,k=()=>{const e=[a,o],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=EX({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return v.push(t),t}return e};if(b&&e.push(t(i,u)),x&&e.push(t(s,u)),w){const t=n.makeTensorInfo([],"float32",GP(f,"float32"));e.push(t),v.push(t)}return e};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&iA().getBool("WEBGL_EXP_CONV")){const e=p?vX(p,!0):null,t=new cQ(g,b,e,x,w),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],a=k();y=n.runWebGLProgram(t,a,"float32",r)}else if(iA().getBool("WEBGL_CONV_IM2COL"))y=hQ({x:a,filter:o,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:s,leakyreluAlpha:f});else{const e=p?vX(p,!1):null,t=new iQ(g,b,e,x,w),r=k();y=n.runWebGLProgram(t,r,"float32")}else y=dQ({x:a,filter:o,convInfo:g,backend:n,bias:i,activation:p,preluActivationWeights:s,leakyreluAlpha:f});const S=EX({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach(e=>n.disposeIntermediateTensorInfo(e)),S}};const _Z={kernelName:bP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let m=u;null==m&&(m=[1,1]),EO(KL(c,m),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(m,"'"));const g=zL(a.shape,o.shape,c,m,l,d,!0),y=iA().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=h?vX(h,y):null,b=[a,o],x=null!=i,w=null!=s,k="leakyrelu"===h;if(x&&b.push(i),w&&b.push(s),k){const e=n.makeTensorInfo([],"float32",GP(p,"float32"));b.push(e),f.push(e)}let S;S=y?new WQ(g,x,v,w,k):new jQ(g,x,v,w,k);const C=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],I=n.runWebGLProgram(S,b,"float32",C);return f.forEach(e=>n.disposeIntermediateTensorInfo(e)),I}};class RZ{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const a=HG(n.length);let o="\n    int index;";for(let i=0;i<this.sliceDim;i++)o+="\n          index = round(getIndices(coords[0], ".concat(i,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[i],";\n          flattenIndex += index * ").concat(this.strides[i],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const PZ={kernelName:w_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,o=a.shape,i=o[o.length-1],s=OO(r.shape),[c,l,u,d]=nV(r,a),h=EX({inputs:{x:a},backend:n,attrs:{shape:[l,i]}}),p=EX({inputs:{x:r},backend:n,attrs:{shape:[OO(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const e=n.readSync(a.dataId),t=n.bufferSync(r),o=ZK(e,t,r.dtype,l,i,u,d,r.shape,s);return n.makeTensorInfo(c,r.dtype,o.values)}const f=new RZ(i,d,[l,u],r.shape),m=n.runWebGLProgram(f,[p,h],p.dtype),g=EX({inputs:{x:m},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};class DZ{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const n=HG(this.rank),r=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("index"):n.push("".concat(t[r]));return n.join()}(e);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(e[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function MZ(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:o}=t,{axis:i,batchDims:s}=r,c=LO(i,a.shape)[0];if(iA().get("DEBUG")){const e=n.readSync(o.dataId),t=a.shape[c];for(let n=0;n<e.length;++n){const r=e[n];EO(r<=t-1&&r>=0,()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(t-1,"]"))}}const l=GV(a,o,c,s),u=OO(o.shape),d=[],h=EX({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=EX({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,u/l.batchSize]}});d.push(h),d.push(p);const f=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,o])||"string"===a.dtype){const e=n.bufferSync(p),t=n.bufferSync(h),r=$K(t,e,f);return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const m=new DZ(h.shape,f),g=n.runWebGLProgram(m,[h,p],h.dtype);d.push(g);const y=EX({inputs:{x:g},backend:n,attrs:{shape:l.outputShape}});return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}const FZ={kernelName:x_,backendName:"webgl",kernelFunc:MZ},LZ=yX({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:JK,dtype:"bool"}),zZ={kernelName:k_,backendName:"webgl",kernelFunc:LZ},BZ=yX({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:eq}),jZ={kernelName:S_,backendName:"webgl",kernelFunc:BZ};const WZ={kernelName:I_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return pZ(r,!0,n)}},UZ=gX({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),VZ={kernelName:T_,backendName:"webgl",kernelFunc:UZ},GZ=gX({opSnippet:"return float(isinf(x));",dtype:"bool"}),HZ={kernelName:N_,backendName:"webgl",kernelFunc:GZ},KZ=gX({opSnippet:"return float(isnan(x));",dtype:"bool"}),qZ={kernelName:O_,backendName:"webgl",kernelFunc:KZ},XZ=yX({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:tq,dtype:"bool"}),YZ={kernelName:__,backendName:"webgl",kernelFunc:XZ},QZ=yX({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:nq,dtype:"bool"}),ZZ={kernelName:R_,backendName:"webgl",kernelFunc:QZ};const $Z={kernelName:P_,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:o}=n,i=rq(r,a,o);return t.makeTensorInfo([i.length],"float32",i)}},JZ=gX({opSnippet:mX+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:aq}),e$={kernelName:D_,backendName:"webgl",kernelFunc:JZ},t$=gX({opSnippet:mX+"\n  return log(1.0 + x);\n"}),n$={kernelName:M_,backendName:"webgl",kernelFunc:t$},r$=yX({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),a$={kernelName:F_,backendName:"webgl",kernelFunc:r$},o$=gX({opSnippet:"return float(!(x >= 1.0));"}),i$={kernelName:L_,backendName:"webgl",kernelFunc:o$},s$=yX({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),c$={kernelName:z_,backendName:"webgl",kernelFunc:s$};class l${constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];const o=t,i=e[3]-1;let s;this.outputShape=e;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(c,")"):1===a?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(o,"; j <= ").concat(o,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(i,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class u${constructor(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,i=e[3]-1;let s;this.outputShape=e;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(c,")"):1===a?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(o,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(o,"; j <= ").concat(o,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(i,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const d$={kernelName:B_,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:o,bias:i,alpha:s,beta:c}=r,l=iA().getBool("WEBGL_PACK_NORMALIZATION")?new u$(a.shape,o,i,s,c):new l$(a.shape,o,i,s,c);return n.runWebGLProgram(l,[a],a.dtype)}};class h${constructor(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(t,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(t," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(a,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const p$={kernelName:j_,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a,y:o,dy:i}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r,d=new h$(a.shape,s,c,l,u);return n.runWebGLProgram(d,[a,o,i],a.dtype)}};function f$(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:o,keepDims:i}=r,s=a.shape.length,c=LO(o,a.shape);let l=c;const u=Yz(l,s),d=null!=u,h=n.shouldExecuteOnCPU([a]);let p=a;if(d){if(h){const e=n.texData.get(p.dataId).values,t=new Array(s);for(let n=0;n<t.length;n++)t[n]=a.shape[u[n]];const r=Pq(e,a.shape,a.dtype,u,t);p=n.makeTensorInfo(t,a.dtype);n.texData.get(p.dataId).values=r}else p=PX(a,u,n);l=Zz(l.length,s)}Xz("max",l,s);const[f,m]=Kz(p.shape,l);let g,y=f;if(i&&(y=qz(f,c)),h){const e=n.texData.get(p.dataId).values,t=oq(e,OO(m),y,a.dtype);g=n.makeTensorInfo(y,a.dtype);n.texData.get(g.dataId).values=t}else g=function(e,t,n,r){const a=OO(t),o=EX({inputs:{x:e},attrs:{shape:[OO(e.shape)/a,a]},backend:r}),i=AX(o,e.dtype,"max",r),s=EX({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),s}(p,m,y,n);return d&&n.disposeIntermediateTensorInfo(p),g}const m$={kernelName:W_,backendName:"webgl",kernelFunc:f$},g$=yX({opSnippet:tX+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+rX+"\n  return result;\n",cpuKernelImpl:iq}),y$={kernelName:U_,backendName:"webgl",kernelFunc:g$};const v$={kernelName:V_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;TG(a,"maxPool");const{filterSize:o,strides:i,pad:s,dimRoundingMode:c}=r;EO(KL(i,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(1,"'"));const l=FL(a.shape,o,i,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&_O(l.inShape,l.outShape))return oX({inputs:{x:a},backend:n});const u=new yY(l,"max",!1);return n.runWebGLProgram(u,[a],a.dtype)}};const b$={kernelName:H_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=LL(a.shape,o,i,[1,1,1],s,l,c),d=new vY(u,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}};class x${constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,o=e.effectiveFilterWidth,i=a-1-e.padInfo.top,s=o-1-e.padInfo.left,c=a*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class w${constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,i=e.dilationWidth,s=e.effectiveFilterDepth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=s-1-e.padInfo.front,d=c-1-e.padInfo.top,h=l-1-e.padInfo.left,p=s*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(i,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const k$={kernelName:K_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=LL(i.shape,s,c,[1,1,1],l,u),h=new vY(d,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),f=new w$(d),m=n.runWebGLProgram(f,[a,p],i.dtype);return n.disposeIntermediateTensorInfo(p),m}};const S$={kernelName:G_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o,output:i}=t,s=o;TG([o,i],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=FL(s.shape,c,l,1,u,d),p=new yY(h,"max",!0),f=n.runWebGLProgram(p,[s],s.dtype),m=new x$(h),g=n.runWebGLProgram(m,[a,f],s.dtype);return n.disposeIntermediateTensorInfo(f),g}};const C$={kernelName:q_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{filterSize:o,strides:i,pad:s,includeBatchInIndex:c}=n,l=r;EO(4===a.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,"."));const u=[1,1];EO(KL(i,u),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(u,"'"));const d=FL(a.shape,o,i,u,s),[h,p]=function(e,t,n,r){let a=new yY(n,"max",!1);const o=r.runWebGLProgram(a,[e],"float32");return a=new yY(n,"max",!0,!0,t),[o,r.runWebGLProgram(a,[e],"float32")]}(a,c,d,l);return[h,p]}};const I$={kernelName:X_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{keepDims:o,axis:i}=n,s=r,c=a.shape.length,l=LO(i,a.shape);let u=l;const d=Yz(u,c),h=null!=d,p=s.shouldExecuteOnCPU([a]),f=[];let m=a;if(h){if(p){const e=s.texData.get(m.dataId).values,t=new Array(c);for(let r=0;r<t.length;r++)t[r]=a.shape[d[r]];const n=Pq(e,a.shape,a.dtype,d,t);m=s.makeTensorInfo(t,a.dtype);s.texData.get(m.dataId).values=n}else m=PX(a,d,s);f.push(m),u=Zz(u.length,c)}Xz("sum",u,c);const[g,y]=Kz(m.shape,u);let v=g;o&&(v=qz(g,l));const b=function(e,t,n,r){const a=OO(t),o=EX({inputs:{x:e},attrs:{shape:[OO(e.shape)/a,a]},backend:r}),i=AX(o,"float32","mean",r),s=EX({inputs:{x:i},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),s}(m,y,v,s);for(const x of f)s.disposeIntermediateTensorInfo(x);return b}};const E$={kernelName:Y_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r,s=a.shape.length,c=LO(o,a.shape);let l=c;const u=Yz(l,s);let d=a;null!=u&&(d=FX({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Zz(l.length,a.shape.length)),Xz("min",l,s);const[h,p]=Kz(d.shape,l),f=EX({inputs:{x:d},backend:n,attrs:{shape:[-1,OO(p)]}}),m=AX(f,f.dtype,"min",n);let g;if(i){g=EX({inputs:{x:m},backend:n,attrs:{shape:qz(h,c)}})}else g=EX({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(d),g}},T$=yX({opSnippet:tX+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+rX+"\n  return result;\n",cpuKernelImpl:sq}),N$={kernelName:Q_,backendName:"webgl",kernelFunc:T$};class O${constructor(e,t,n){this.variableNames=["x"],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=HG(r),o=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(o,");\n      ").concat(a," end = ").concat(a,"(").concat(i,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class A${constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=HG(r),o=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),s=Fq("rc",r),c=Fq("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===n?0:1;let h="";if(1===r){const e="\n        ".concat(a," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ")}else{const e="\n        ".concat(a," source = rc;\n        ").concat(a," lt = ").concat(a,"(lessThan(source, start));\n        ").concat(a," gte = ").concat(a,"(greaterThanEqual(source, end));\n        ").concat(a," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(a," rc = outputLoc;\n        ").concat(e,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(e,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(e,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(l,") {\n            ").concat(e,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(o,");\n      const ").concat(a," end = ").concat(a,"(").concat(i,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")}}const _$={kernelName:Z_,backendName:"webgl",kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e;const{x:a}=t,{paddings:o,mode:i}=r,s=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new A$(a.shape,o,i):new O$(a.shape,o,i);return n.runWebGLProgram(s,[a],a.dtype)}},R$=yX({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+rX+"\n  return result;\n"}),P$={kernelName:$_,backendName:"webgl",kernelFunc:R$};class D${constructor(e,t,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(t-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(t-1,"));\n      }\n    ")}}const M$=yX({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),F$={kernelName:o_,backendName:"webgl",kernelFunc:M$},L$="return a - b;",z$=yX({opSnippet:L$,packedOpSnippet:L$,supportsComplex:!0,cpuKernelImpl:Aq}),B$={kernelName:rP,backendName:"webgl",kernelFunc:z$};function j$(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:o}=r,i=LO([o],a.shape),s=f$({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),c=qz(s.shape,i),l=EX({inputs:{x:s},backend:n,attrs:{shape:c}}),u=z$({inputs:{a:a,b:l},backend:n}),d=oZ({inputs:{x:u},backend:n}),h=DX({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),p=EX({inputs:{x:h},backend:n,attrs:{shape:c}}),f=M$({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const W$={kernelName:GR,backendName:"webgl",kernelFunc:j$};const U$={kernelName:J_,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:o,seed:i,normalized:s}=r,c=s?a:j$({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),l=c.shape[0],u=c.shape[1],d=new D$(l,u,o),h=[[i]],p=n.runWebGLProgram(d,[c],"int32",h);return s||n.disposeIntermediateTensorInfo(c),p}},V$=Gq+"\n  return -x;\n";const G$={kernelName:tR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.texData.get(r.dataId),[t,a]=lq(e.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,t)}let a;return a=iA().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Yq(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new Vq(r.shape,V$),n.runWebGLProgram(a,[r],r.dtype)}},H$=$W;const K$={kernelName:rR,backendName:"webgl",kernelFunc:function(e){xP("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:o}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=r,l=n.readSync(a.dataId),u=n.readSync(o.dataId),{selectedIndices:d}=H$(l,u,i,s,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},q$=JW;const X$={kernelName:aR,backendName:"webgl",kernelFunc:function(e){xP("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:o}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r,u=n.readSync(a.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:p}=q$(u,d,i,s,c,l);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Y$=eU;const Q$={kernelName:oR,backendName:"webgl",kernelFunc:function(e){xP("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:o}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(a.dataId),d=n.readSync(o.dataId),h=i,p=s,f=c,m=l,{selectedIndices:g,selectedScores:y}=Y$(u,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class Z${constructor(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const $$={kernelName:sR,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:o,depth:i,onValue:s,offValue:c}=r,l=OO(a.shape),u=new Z$(l,i,s,c),d=EX({inputs:{x:a},backend:n,attrs:{shape:[l]}}),h=n.runWebGLProgram(u,[d],o);n.disposeIntermediateTensorInfo(d);const p=EX({inputs:{x:h},backend:n,attrs:{shape:[...a.shape,i]}});return n.disposeIntermediateTensorInfo(h),p}};function J$(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=jY({inputs:{input:r},backend:n}),t=J$({inputs:{x:e},backend:n}),a=tQ({inputs:{input:r},backend:n}),o=J$({inputs:{x:a},backend:n}),i=sX({inputs:{real:t,imag:o},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),i}return gZ({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const eJ={kernelName:pP,backendName:"webgl",kernelFunc:J$};const tJ={kernelName:iR,backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){const t=jY({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),o=tQ({inputs:{input:a},backend:r}),i=J$({inputs:{x:o},backend:r}),s=sX({inputs:{real:n,imag:i},backend:r});return r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(i),s}return gZ({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};const nJ={kernelName:cR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return sZ({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const o=t[0].shape,i=t[0].dtype;t.forEach(e=>{TO(o,e.shape,"All tensors passed to stack must have matching shapes"),EO(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],c=aQ({inputs:t.map(e=>{const t=sZ({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t}),backend:n,attrs:{axis:a}});return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),c}};class rJ{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=HG(r),o=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(o,");\n      ").concat(a," end = ").concat(a,"(").concat(i,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(i,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class aJ{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);const r=e.length,a=HG(r),o=t.map(e=>e[0]).join(","),i=t.map((t,n)=>t[0]+e[n]).join(","),s=Fq("rc",r),c=Fq("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),d=["".concat(a," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(l,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(l,") {")],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+="\n        ".concat(d[f],"\n        if (").concat(h,") {\n          result[").concat(f,"] = float(value);\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(f,"] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ");p+=1===r?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(o,");\n      const ").concat(a," end = ").concat(a,"(").concat(i,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const oJ=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:o,constantValue:i}=r;if(0===OO(a.shape)){return gZ({backend:n,attrs:{shape:o.map((e,t)=>e[0]+a.shape[t]+e[1]),value:i,dtype:a.dtype}})}const s=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aJ(a.shape,o,i):new rJ(a.shape,o,i),c=[[i]];return n.runWebGLProgram(s,[a],a.dtype,c)},iJ={kernelName:lR,backendName:"webgl",kernelFunc:oJ},sJ=yX({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+rX+"\n  return result;\n"}),cJ={kernelName:uR,backendName:"webgl",kernelFunc:sJ};const lJ={kernelName:hR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r,s=a.shape.length,c=[],l=LO(o,a.shape);let u=l;const d=Yz(u,s);let h,p=a;if(null!=d&&(p=FX({inputs:{x:a},backend:n,attrs:{perm:d}}),u=Zz(u.length,s),c.push(p)),Xz("prod",u,s),n.shouldExecuteOnCPU([p])){const e=n.texData.get(p.dataId).values,{outVals:t,outShape:r,outDtype:a}=dq(p.shape,p.dtype,e,u);h=n.makeTensorInfo(r,a,t)}else{const[e,t]=Kz(p.shape,u),r=OO(t),o=EX({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),i=AX(o,bD(a.dtype),"prod",n);h=EX({inputs:{x:i},backend:n,attrs:{shape:e}}),c.push(o),c.push(i)}if(i){c.push(h);const e=qz(h.shape,l);h=EX({inputs:{x:h},backend:n,attrs:{shape:e}})}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),h}};const uJ={kernelName:pR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:a,paramsDenseValues:o,indices:i}=t,{outputRaggedRank:s}=r,c=a.map(e=>n.readSync(e.dataId)),l=a.map(e=>e.shape),u=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,p,f]=hq(c,l,u,o.shape,o.dtype,d,i.shape,s),m=h.map(e=>n.makeTensorInfo([e.length],"int32",e)),g=n.makeTensorInfo(f,o.dtype,p);return m.concat([g])}};const dJ={kernelName:fR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{starts:r,limits:a,deltas:o}=t,i=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),[l,u]=pq(i,r.shape,r.dtype,s,a.shape,c,o.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([u.length],r.dtype,u)]}};const hJ={kernelName:mR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{shape:a,values:o,defaultValue:i,rowPartitionTensors:s}=t,{rowPartitionTypes:c}=r,l=n.readSync(a.dataId),u=n.readSync(o.dataId),d=n.readSync(i.dataId),h=s.map(e=>n.readSync(e.dataId)),p=s.map(e=>e.shape),[f,m]=fq(l,a.shape,u,o.shape,o.dtype,d,i.shape,h,p,c);return n.makeTensorInfo(f,o.dtype,m)}},pJ=e=>{const{backend:t,attrs:n}=e,{start:r,stop:a,step:o,dtype:i}=n,s=mq(r,a,o,i);return t.makeTensorInfo([s.length],i,s)},fJ={kernelName:gR,backendName:"webgl",kernelFunc:pJ},mJ=gX({opSnippet:"return 1.0 / x;"}),gJ={kernelName:vR,backendName:"webgl",kernelFunc:mJ},yJ=gX({opSnippet:Gq+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),vJ={kernelName:bR,backendName:"webgl",kernelFunc:yJ},bJ=gX({opSnippet:Gq+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),xJ={kernelName:IR,backendName:"webgl",kernelFunc:bJ};class wJ{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[o,i,s,c]=e;this.outputShape=[o,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class kJ{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,s,c]=e;this.outputShape=[o,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const SJ={kernelName:SR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:o,halfPixelCenters:i,size:s}=r,[c,l]=s,u=iA().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kJ(a.shape,c,l,o,i):new wJ(a.shape,c,l,o,i);return n.runWebGLProgram(u,[a],"float32")}};class CJ{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,o,i]=e,s=[n&&o>1?r-1:r,n&&i>1?a-1:a],c=[n&&o>1?o-1:o,n&&i>1?i-1:i],l=s[0]/c[0],u=s[1]/c[1],d=1/l,h=1/u,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const IJ={kernelName:CR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:o}=t,{alignCorners:i}=r,s=new CJ(o.shape,a.shape,i);return n.runWebGLProgram(s,[o],o.dtype)}};class EJ{constructor(e,t,n,r,a){this.variableNames=["A"],this.outputShape=[];const[o,i,s,c]=e;this.outputShape=[o,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(i,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class TJ{constructor(e,t,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,s,c]=e;this.outputShape=[o,t,n,c];const l=[r&&t>1?i-1:i,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(i,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(d,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const NJ={kernelName:wR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:o,halfPixelCenters:i,size:s}=r,[c,l]=s,u=iA().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new TJ(a.shape,c,l,o,i):new EJ(a.shape,c,l,o,i);return n.runWebGLProgram(u,[a],a.dtype)}};class OJ{constructor(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,a]=t,[,o,i]=e,s=[n&&o>1?r-1:r,n&&i>1?a-1:a],c=[n&&o>1?o-1:o,n&&i>1?i-1:i],l=s[0]/c[0],u=s[1]/c[1],d=1/l,h=1/u,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(d,");\n        const float invWidthScale = float(").concat(h,");\n\n        const int winHeight = int(").concat(p,");\n        const int winWidth = int(").concat(f,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(i,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const AJ={kernelName:kR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:o}=t,{alignCorners:i}=r,s=new OJ(o.shape,a.shape,i);return n.runWebGLProgram(s,[o],o.dtype)}};class _J{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=e,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      "));const r=e.map((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r)).join(","),a=HG(n);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class RJ{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=e;const r=Fq("rc",n),a="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),o="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),i=HG(n);function s(n){const r=e.map((r,a)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?"".concat(e[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(a,n)),a=r.join(","),o=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(o,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(r.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const PJ={kernelName:ER,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:o}=r,i=a.shape.length,s=LO(o,a.shape);if(0===i)return oX({inputs:{x:a},backend:n});const c=iA().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new RJ(a.shape,s):new _J(a.shape,s);return n.runWebGLProgram(c,[a],a.dtype)}};class DJ{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=e[1],r=e[2];this.outputShape=e;let a="";a="number"===typeof t?"float outputValue = ".concat(t.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(t.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(a,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const MJ={kernelName:gP,backendName:"webgl",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:o,fillValue:i,center:s}=n,c=r,l=new DJ(a.shape,i),[u,d]=QU(s,a.shape[1],a.shape[2]),h=[[u,d,Math.sin(o),Math.cos(o)]];return c.runWebGLProgram(l,[a],a.dtype,h)}},FJ=gX({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),LJ={kernelName:TR,backendName:"webgl",kernelFunc:FJ},zJ=gX({opSnippet:"return inversesqrt(x);",cpuKernelImpl:gq}),BJ={kernelName:NR,backendName:"webgl",kernelFunc:zJ};class jJ{constructor(e,t,n,r,a,o){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const s=HG(a.length),c=HG(o.length);let l="";1===n?l="i":2===n&&(l="i, j");const u="getIndices(".concat(l,")");let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(t,"; j++) {\n              int index = round(").concat(u,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(f,", sum, float(found)));\n        }\n      ")}}class WJ{constructor(e,t,n,r,a,o){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const s=HG(a.length),c=HG(o.length);let l="";1===n?l="i":2===n&&(l="i, j");const u="getIndices(".concat(l,")");let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h="getUpdates(".concat(d,")");let p="";i&&(p="coords[0], coords[1]");const f="getDefaultValue(".concat(p,")"),m=t>1?"strides[j]":"strides",g=t>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(e,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(t,"; j+=2) {\n              ivec4 index = round(").concat(u,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(t,") {\n                flattenedIndex += index.yw * ").concat(g,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(h,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(f,", sum, found));\n        }\n      ")}}const UJ={kernelName:OR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:o}=t,{shape:i}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=cW(0,a,i),h=[d/l,l];if(0===d)return n.makeTensorInfo(i,a.dtype);const p=EX({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),f=EX({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;g=iA().getBool("WEBGL_PACK")?new WJ(c,s,p.shape.length,f.shape.length,u,h):new jJ(c,s,p.shape.length,f.shape.length,u,h);const y=n.runWebGLProgram(g,[f,p,m],f.dtype),v=EX({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}};class VJ{constructor(e,t,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,n];const a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(t+1)),"; ++i) { if (left >= right) break;"),o=2===iA().getNumber("WEBGL_VERSION")?"while (left < right) {":a,i="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(i," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const GJ={kernelName:_R,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:o}=t,{side:i}=r,s=new VJ(a.shape[0],a.shape[1],o.shape[1],i),c=[[a.shape[1]]];return n.runWebGLProgram(s,[a,o],"int32",c)}};class HJ{constructor(e,t,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)a="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=[];for(let r=0;r<t.length;r++)i.push("".concat(n[r])),r<e&&o.push("".concat(n[r]));r=o.join(),a=i.join()}const o=HG(n);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}}const KJ={kernelName:RR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:o}=t,i=new HJ(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(i,[r,a,o],vD(a.dtype,o.dtype))}},qJ=gX({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(rV,";\n  float scale = ").concat(aV,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),XJ={kernelName:PR,backendName:"webgl",kernelFunc:qJ},YJ=gX({opSnippet:mX+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:vq}),QJ={kernelName:zR,backendName:"webgl",kernelFunc:YJ},ZJ=gX({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),$J={kernelName:LR,backendName:"webgl",kernelFunc:ZJ},JJ=gX({opSnippet:mX+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(rX,"\n  return result;\n")}),e0={kernelName:MR,backendName:"webgl",kernelFunc:JJ},t0=gX({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),n0={kernelName:FR,backendName:"webgl",kernelFunc:t0},r0=gX({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),a0={kernelName:BR,backendName:"webgl",kernelFunc:r0},o0={kernelName:UR,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:o,paddings:i}=r;EO(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=o.reduce((e,t)=>e*t),c=[[0,0]];c.push(...i);for(let y=1+o.length;y<a.shape.length;++y)c.push([0,0]);const l=[],u=oJ({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),d=ZU(u.shape,o,s,!1),h=$U(d.length,o.length,!1),p=JU(u.shape,o,s,!1),f=EX({inputs:{x:u},backend:n,attrs:{shape:d}}),m=FX({inputs:{x:f},backend:n,attrs:{perm:h}}),g=EX({inputs:{x:m},backend:n,attrs:{shape:p}});return l.push(u),l.push(f),l.push(m),l.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}};const i0={kernelName:HR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{indices:r,values:a,denseShape:o,defaultValue:i}=t;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==i.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(i.shape));const s=n.readSync(r.dataId),c=n.readSync(a.dataId),l=n.readSync(o.dataId),u=n.readSync(i.dataId)[0],[d,h,p,f,m]=wq(s,r.shape,r.dtype,c,a.dtype,l,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],a.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(e=>Number(e)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const s0={kernelName:KR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{inputIndices:r,inputShape:a,newShape:o}=t;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const i=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(o.dataId)),[l,u,d]=kq(s,r.shape,r.dtype,i,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}};const c0={kernelName:qR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));const i=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),[l,u]=Sq(i,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}};const l0={kernelName:XR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:o}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));const i=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),[l,u]=Sq(i,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}};const u0={kernelName:YR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:o,defaultValue:i}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=cW(0,a,s),p=!1;if("string"===o.dtype){const e=n.bufferSync(a),t=n.bufferSync(o),r=XP(n.readSync(i.dataId)[0]),f=yq(e,t,s,h,u,l,c,d,r,p);return n.makeTensorInfo(s,f.dtype,f.values)}const f=new jJ(l,c,a.shape.length,o.shape.length,d,[h,1],p),m=n.runWebGLProgram(f,[o,a,i],o.dtype),g=EX({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),g}};const d0={kernelName:VR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:o,axis:i}=r,s=LO(i,a.shape)[0],c=OV(a,o,s),l=a.shape.length,u=new Array(l).fill(0),d=a.shape.slice();return c.map(e=>{const t=[...d];t[s]=e;const r=RY({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[s]+=e,r})}},h0="return sqrt(x);",p0=gX({opSnippet:h0,packedOpSnippet:h0,cpuKernelImpl:Cq}),f0={kernelName:jR,backendName:"webgl",kernelFunc:p0},m0={kernelName:ZR,backendName:"webgl",kernelFunc:gX({opSnippet:"return x * x;"})},g0="return (a - b) * (a - b);",y0=yX({opSnippet:g0,packedOpSnippet:g0}),v0={kernelName:QR,backendName:"webgl",kernelFunc:y0};const b0={kernelName:$R,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t;if("string"!==a.dtype)throw new Error("Input must be of datatype string");const o=HV(n.readSync(a.dataId)),i=Iq(o,"string",r);return n.makeTensorInfo(a.shape,"string",i)}};const x0={kernelName:fP,backendName:"webgl",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,o=Gq+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),i=new Vq(a.shape,o);return r.runWebGLProgram(i,[a],a.dtype)}};class w0{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,a=HG(n.length),o=HG(n.length);let i="";if(1===r)i="coords * strides + begin";else{let e=0;i=n.map((t,r)=>(e++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(e-1,"] * strides[").concat(r,"] + begin[").concat(r,"]"))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(e,");\n      ").concat(a," strides = ").concat(a,"(").concat(t,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}const k0={kernelName:JR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:o,end:i,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=wL(a.shape,o,i,s,c,l,u,d,h);let w;if(m)w=EX({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){EO(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const e=cL(v,b,x),t=RY({inputs:{x:a},backend:n,attrs:{begin:v,size:e}});w=EX({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{if(n.shouldExecuteOnCPU([a])){const e=n.readSync(a.dataId),t=nF(a.shape,a.dtype,e),r=Eq(p,t,x,v);w=n.makeTensorInfo(f,a.dtype,r.values)}else{const e=new w0(v,x,p);w=n.runWebGLProgram(e,[a],a.dtype)}}const k=EX({inputs:{x:w},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(w),k}};const S0={kernelName:eP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:o,leftPad:i,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,h=n.readSync(u.dataId),p=n.readSync(d.dataId),[f,m]=Tq(h,p,a,o,i,s,c,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}};const C0={kernelName:tP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{skipEmpty:a}=r,{input:o,delimiter:i}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));const s=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[l,u,d]=Nq(s,c,a),h=u.length;return[n.makeTensorInfo([h,2],"int32",l),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}};const I0={kernelName:nP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{numBuckets:a}=r,{input:o}=t;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),s=Oq(i,a);return n.makeTensorInfo(o.shape,"int32",s)}},E0=gX({opSnippet:"return tan(x);"}),T0={kernelName:aP,backendName:"webgl",kernelFunc:E0},N0=gX({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),O0={kernelName:oP,backendName:"webgl",kernelFunc:N0};const A0={kernelName:AR,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:o,updates:i}=t,{}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=cW(0,o,a.shape),h=[d/l,l];if(0===d)return n.makeTensorInfo(a.shape,o.dtype);const p=EX({inputs:{x:o},backend:n,attrs:{shape:[c,s]}}),f=EX({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),m=EX({inputs:{x:a},backend:n,attrs:{shape:h}}),g=new jJ(c,s,p.shape.length,f.shape.length,u,h,!1,!0),y=n.runWebGLProgram(g,[f,p,m],m.dtype),v=EX({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),v}};class _0{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let o=0;o<n.length;o++)n[o]=e[o]*t[o];this.outputShape=n,this.rank=n.length;const r=HG(this.rank),a=function(e){const t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}}function R0(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:o}=r;if("string"===a.dtype||a.shape.length>5){const e=n.readSync(a.dataId),t="string"===a.dtype?e.map(e=>XP(e)):e,r=nF(a.shape,a.dtype,t),i=_q(r,o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const i=new _0(a.shape,o);return n.runWebGLProgram(i,[a],a.dtype)}const P0={kernelName:iP,backendName:"webgl",kernelFunc:R0};class D0{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class M0{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function F0(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function L0(e){let t=1;for(;t<e;)t*=2;return t}const z0={kernelName:sP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:o,sorted:i}=r,s=iA().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=iA().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=a.shape,u=l[l.length-1];if(n.shouldExecuteOnCPU([a])||u<s||o>c){const e=n.readSync(a.dataId),[t,r]=Rq(e,l,a.dtype,o,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return l[l.length-1]=0,[n.makeTensorInfo(l,a.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===u)return[a,gZ({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),h=null!==d&&d.isPacked,p=h?n.unpackTensor(a):a,f=OO(l)/u,m=EX({inputs:{x:p},attrs:{shape:[f,u]},backend:n});h&&F0(n,p);const g=L0(o),y=L0(u);let v=null;const b=()=>null===v?[m,m]:[m,v],x=(e,t,r)=>{const a=b(),o=new D0(r),i=[[u],[null===v?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=v;v=n.runWebGLProgram(o,a,"int32",i),F0(n,s)};for(let I=1;I<g;I*=2){const e=2*I;for(let t=I;t>=1;t/=2)x(e,t,[f,y])}for(let I=y;I>g;I/=2){const e=b(),t=new M0([f,I/2]),r=[[u],[null===v?1:0],[g]],a=v;v=n.runWebGLProgram(t,e,"int32",r),F0(n,a);const o=g/2,i=2*o;for(let n=o;n>=1;n/=2)x(i,n,v.shape)}let w=v;v=RY({inputs:{x:v},backend:n,attrs:{begin:0,size:[f,o]}}),F0(n,w);let k=MZ({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});F0(n,m);const S=l.slice(0,-1);S.push(o),w=v,v=EX({inputs:{x:v},attrs:{shape:S},backend:n}),F0(n,w);const C=k;return k=EX({inputs:{x:k},attrs:{shape:S},backend:n}),F0(n,C),[k,v]}};class B0{constructor(e,t,n,r,a,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const i="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(e," && 0 <= coordX && coordX < ").concat(t,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(a,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(a,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(t,"));\n                float mapY = mapCoord(inY, float(").concat(e,"));\n\n                if (").concat(i," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const j0={kernelName:cP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:o}=t,{interpolation:i,fillMode:s,fillValue:c,outputShape:l}=r,[u,d,h,p]=a.shape,[f,m]=null!=l?l:[d,h],g=new B0(d,h,i,s,c,[u,f,m,p]);return n.runWebGLProgram(g,[a,o],"float32")}};const W0={kernelName:uP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{axis:a}=n,{x:o}=t;TG(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:s,outputShape:c,indices:l}=Dq(i,a,o.shape,o.dtype);return[r.makeTensorInfo(c,o.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};const U0={kernelName:dP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:o}=r;o<0&&(o+=a.shape.length);const i=a,s=i.shape.length,c=a.shape[o],l=new Array(s-1);let u=0;for(let m=0;m<s;m++)m!==o&&(l[u++]=i.shape[m]);const d=[],h=new Array(s).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(c);for(let m=0;m<f.length;m++){h[o]=m;const e=RY({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),t=EX({inputs:{x:e},backend:n,attrs:{shape:l}});f[m]=t,d.push(e)}return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),f}};class V0{constructor(e,t){this.variableNames=["x","segmentIds"];const n=e.windowSize,r=e.batchSize,a=e.inSize,o=e.numSegments,i=o*Math.ceil(a/n);this.outputShape=[r,i];const s=4*Math.floor(n/4),c=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let u="";a%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));let d="";a%n>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const G0={kernelName:hP,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:o}=t,{numSegments:i}=r,s=a.shape.length,c=[];let l=0;const u=Yz([l],s);let d=a;null!=u&&(d=FX({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(d),l=Zz(1,s)[0]);const h=VV(d.shape,l,i),p=OO([d.shape[l]]),f=EX({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});c.push(f);const m=bD(a.dtype),g=(e,t,r,a,o)=>{const i=e.shape[0],s=e.shape[1],l=UV(s,o),u=new V0({windowSize:l,inSize:s,batchSize:i,numSegments:o},t),d=n.compileAndRun(u,[e,r],a);if(c.push(d),d.shape[1]===o)return d;const h=pJ({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=R0({inputs:{x:h},backend:n,attrs:{reps:[s/l]}});c.push(h),c.push(p);return g(d,t,p,a,o)},y=EX({inputs:{x:g(f,"unsortedSegmentSum",o,m,i)},backend:n,attrs:{shape:h}});let v=y;if(null!=u){c.push(y);const e=Qz(u);v=FX({inputs:{x:v},backend:n,attrs:{perm:e}})}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),v}},H0=[BX,WX,VX,HX,XX,ZX,$X,JX,oY,iY,cY,uY,hY,fY,gY,bY,xY,SY,CY,IY,NY,DY,MY,FY,LY,UY,HY,XY,cX,ZY,oQ,pQ,vQ,xQ,wQ,kQ,SQ,IQ,TQ,OQ,MQ,FQ,LQ,BQ,UQ,HQ,KQ,XQ,QQ,ZQ,JQ,eZ,nZ,aZ,iZ,cZ,dZ,fZ,yZ,bZ,kZ,CZ,TZ,AZ,_Z,PZ,FZ,zZ,jZ,iX,WZ,nQ,VZ,HZ,qZ,dX,YZ,ZZ,$Z,e$,n$,a$,i$,c$,d$,p$,m$,y$,v$,b$,k$,S$,C$,I$,E$,N$,_$,P$,U$,IX,G$,K$,X$,Q$,BY,$$,tJ,nJ,iJ,cJ,fX,lJ,uJ,dJ,hJ,fJ,WY,F$,gJ,vJ,xJ,TX,SJ,IJ,NJ,AJ,PJ,MJ,LJ,BJ,UJ,GJ,KJ,XJ,QJ,$J,e0,n0,PY,W$,a0,o0,i0,s0,c0,l0,u0,d0,f0,m0,v0,b0,x0,k0,S0,C0,I0,B$,MX,T0,O0,A0,P0,z0,j0,LX,W0,U0,G0,eJ];for(const n of H0)TP(n);var K0,q0;iA().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(K0||(K0={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(q0||(q0={}));const X0={};function Y0(e){return X0[e]}function Q0(e,t,n,r,a){const o=t.inputParams[e];if(o&&void 0!==o.inputIndexStart){const e=o.inputIndexStart,i=0===o.inputIndexEnd?void 0:void 0===o.inputIndexEnd?e+1:o.inputIndexEnd,s=e<0?t.inputNames.length+e:e;if("tensor"===o.type)return Z0(t.inputNames[s],n,r,a);if("tensors"===o.type){const o=t.inputs.slice(e,i);return t.inputNames.slice(e,i).filter((e,t)=>{var n;return"NoOp"!==(null===(n=o[t])||void 0===n?void 0:n.op)}).map(e=>Z0(e,n,r,a))}const c=Z0(t.inputNames[s],n,r,a),l=c.dataSync();return"number"===o.type?l[0]:YO(c.shape,l)}const i=t.attrParams[e];return i&&i.value}function Z0(e,t,n,r){const[a,o]=t1(e,n);if(null!=r){const e=r.getHashTableHandleByName(a);if(null!=e)return e}const i=n.currentContextIds.find(e=>!!t[e1(a,e)]);return void 0!==i?t[e1(a,i)][o]:void 0}function $0(e,t,n){return t[e1(e,n.currentContextId)]}function J0(e,t){const[n,r,a]=t1(e,t);return[e1(n,t&&t.currentContextId),r,a]}function e1(e,t){return t?"".concat(e,"-").concat(t):e}function t1(e,t){if(""===e)return["",0,void 0];const n=null!=t&&null!=t.parseNodeNameCache;if(n){const n=t.parseNodeNameCache.get(e);if(null!=n)return n}const r=e.split(":");let a;if(1===r.length)a=[e,0,void 0];else{const e=r[0],t=3===r.length?r[1]:void 0;a=[e,Number(r[r.length-1]),t]}return n&&t.parseNodeNameCache.set(e,a),a}function n1(e,t,n){let r=Q0("pad",e,t,n);if("explicit"===r){r=Q0("explicitPaddings",e,t,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)a[e][0]=r[2*e],a[e][1]=r[2*e+1];return a}return r}function r1(e){return e.kept?e:aF(e)}const a1=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],o1=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],i1=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],s1=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],c1=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],l1=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],u1=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],d1=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],h1=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],p1=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],f1=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],m1=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],g1=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],y1=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],v1=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],b1=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],x1=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],w1=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],k1=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class S1{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[c,l,u,d,h,p,f,m,g,y,v,b,x,w,k,S,C,I,E].map(e=>e.json));this.opMappers=e.reduce((e,t)=>(e[t.tfOpName]=t,e),{})}transformGraph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.node,r=[],a=[],o=[],i=n.reduce((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?a.push(e[t.name]):null!=t.input&&0!==t.input.length||o.push(e[t.name]),e),{});let s=[];const c=[];let l={},u={};null!=t&&(l=this.mapSignatureEntries(t.inputs),u=this.mapSignatureEntries(t.outputs));const d=Object.keys(i);d.forEach(e=>{const t=i[e];t.inputNames.forEach((e,n)=>{const[r,,a]=J0(e),o=i[r];if(null!=o.outputs){const e=o.outputs.indexOf(a);if(-1!==e){const a="".concat(r,":").concat(e);t.inputNames[n]=a}}t.inputs.push(o),o.children.push(t)})}),0===Object.keys(u).length?d.forEach(e=>{const t=i[e];0===t.children.length&&c.push(t)}):Object.keys(u).forEach(e=>{const[t]=J0(e),n=i[t];null!=n&&(n.signatureKey=u[e],c.push(n))}),Object.keys(l).length>0?Object.keys(l).forEach(e=>{const[t]=J0(e),n=i[t];n&&(n.signatureKey=l[e],s.push(n))}):s=r;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((e,t)=>(e[t.signature.name]=this.mapFunction(t),e),{}));const p={nodes:i,inputs:s,outputs:c,weights:a,placeholders:r,signature:t,functions:h};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=Y0(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(e=>e.startsWith("^")?e.slice(1):e),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((t,n)=>{const r=n.type;let a;switch(n.type){case"string":a=I1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=I1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=M1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=M1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=T1(e.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=T1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=D1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=D1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=E1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=E1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=L1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=L1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=P1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=P1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=F1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=F1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=A1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=A1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=_1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=_1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=O1(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=O1(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t},{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e),{}));const a=[],o=[];e.signature.inputArg.forEach(e=>{const[t]=J0(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:N1(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,a.push(n),r[t]=n});Object.keys(r).forEach(e=>{const t=r[e];t.inputNames.forEach((e,n)=>{const[a,,o]=J0(e),i=r[a];if(null!=i.outputs){const e=i.outputs.indexOf(o);if(-1!==e){const r="".concat(a,":").concat(e);t.inputNames[n]=r}}t.inputs.push(i),i.children.push(t)})});const i=e.ret;e.signature.outputArg.forEach(e=>{const[t,n]=J0(i[e.name]),a=r[t];null!=a&&(a.defaultOutput=n,o.push(a))});const s=this.mapArgsToSignature(e);return{nodes:r,inputs:a,outputs:o,weights:n,placeholders:[],signature:s}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function C1(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=iA().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function I1(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e[t];return null!=a?C1(a.s,r):n}function E1(e,t,n){const r=e[t];return r?r.b:n}function T1(e,t,n){const r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function N1(e){switch("string"===typeof e&&(e=K0[e]),e){case K0.DT_FLOAT:case K0.DT_HALF:return"float32";case K0.DT_INT32:case K0.DT_INT64:case K0.DT_INT8:case K0.DT_UINT8:return"int32";case K0.DT_BOOL:return"bool";case K0.DT_DOUBLE:return"float32";case K0.DT_STRING:return"string";case K0.DT_COMPLEX64:case K0.DT_COMPLEX128:return"complex64";default:return null}}function O1(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function A1(e,t,n){const r=e[t];return r&&r.type?N1(r.type):n}function _1(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map(e=>N1(e)):n}function R1(e){if(!e.unknownRank)return null!=e.dim?e.dim.map(e=>"number"===typeof e.size?e.size:parseInt(e.size,10)):[]}function P1(e,t,n){const r=e[t];return r&&r.shape?R1(r.shape):n}function D1(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(e=>"number"===typeof e?e:parseInt(e,10)):n}function M1(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=e[t];return a&&a.list&&a.list.s?a.list.s.map(e=>C1(e,r)):n}function F1(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(e=>R1(e)):n}function L1(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class z1{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(e=>this.getInput(e)),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((e,t)=>(e[t]=this.getAttr(t),e),{}))}getInput(e){return Z0(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return Z0(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return T1(this.node.rawAttrs,e,t);if(null!=n.s)return I1(this.node.rawAttrs,e,t);if(null!=n.b)return E1(this.node.rawAttrs,e,t);if(null!=n.shape)return P1(this.node.rawAttrs,e,t);if(null!=n.type)return A1(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return D1(this.node.rawAttrs,e,t);if(null!=n.list.s)return M1(this.node.rawAttrs,e,t);if(null!=n.list.shape)return F1(this.node.rawAttrs,e,t);if(null!=n.list.b)return L1(this.node.rawAttrs,e,t);if(null!=n.list.type)return _1(this.node.rawAttrs,e,t)}return t}}function B1(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){EO(e.length===t.length,()=>n+" Shapes ".concat(e," and ").concat(t," must match"));for(let r=0;r<e.length;r++){const a=e[r],o=t[r];EO(a<0||o<0||a===o,()=>n+" Shapes ".concat(e," and ").concat(t," must match"))}}}function j1(e){return"number"!==typeof e&&!e.some(e=>e<0)}function W1(e,t,n){let r=U1(e,n);const a=!j1(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach(e=>{r=U1(e.shape,r)}),!j1(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function U1(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));const n=[];for(let r=0;r<e.length;++r){const a=e[r],o=t[r];if(a>=0&&o>=0&&a!==o)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:o}return n}class V1{constructor(e,t,n,r,a,o,i){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=fF(0),QD(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));const t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(e=>this.read(e))}write(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),B1(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,QD(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((e,n)=>this.write(e,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return GD([],[0].concat(this.elementShape));const n=this.readMany(e);return B1(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Zj(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return GD([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const n=this.readMany(t);return B1(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),JL(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,fW(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));let n=0;const r=e.map(e=>(n+=e,n));if(n!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const a=0===n?0:t.size/n,o=[];XD(()=>{t=QL(t,[1,n,a]);for(let n=0;n<e.length;++n){const i=[0,0===n?0:r[n-1],0],s=[1,e[n],a];o[n]=QL(nz(t,i,s),this.elementShape)}return o});const i=[];for(let s=0;s<e.length;s++)i[s]=s;this.writeMany(i,o)}}class G1{get id(){return this.idTensor.id}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach(e=>{if(n!==e.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(e.dtype));B1(t,e.shape,"TensorList shape mismatch: "),QD(e)}),this.idTensor=fF(0),this.maxNumElements=r,QD(this.idTensor)}copy(){return new G1([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{null!=e&&e.has(t.id)||t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));B1(e,this.elementShape,"TensorList shape mismatch: ");const r=W1(this.elementShape,this.tensors,e);return XD(()=>{const e=this.tensors.map(e=>QL(e,r));return Zj(e,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=W1(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,B1(r.shape,e,"TensorList shape mismatch: "),QL(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(B1(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");QD(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));const t=new G1([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));B1(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=W1(this.elementShape,this.tensors,t);return QL(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));B1(this.elementShape,t.shape,"TensorList shape mismatch: "),QD(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));B1(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=W1(this.elementShape,this.tensors,n);return 0===e.length?GD([],[0].concat(r)):XD(()=>{const t=e.map(e=>QL(this.tensors[e],r));return Zj(t,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));B1(this.elementShape,t,"TensorList shape mismatch: ");const n=W1(this.elementShape,this.tensors,t);return 0===this.size()?GD([],[0].concat(n)):XD(()=>{const e=this.tensors.map(e=>QL(e,n));return JL(e,0)})}}const H1=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=Q0("thenBranch",e,t,n),a=Q0("elseBranch",e,t,n),o=Q0("cond",e,t,n),i=Q0("args",e,t,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=Q0("body",e,t,n),a=Q0("cond",e,t,n),o=Q0("args",e,t,n),i=await n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),s=o.map(e=>e.id);let c=await i[0].data();i.forEach(e=>{e.kept||-1!==s.indexOf(e.id)||e.dispose()});let l=o;for(;c[0];){const e=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const t=l.map(e=>e.id);e.forEach(e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()});const o=await n.functionMap[a].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);c=await o[0].data(),o.forEach(e=>{e.kept||-1!==s.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()})}return l}case"LoopCond":return[r1(Q0("pred",e,t,n))];case"Switch":{const r=Q0("pred",e,t,n);let a=Q0("data",e,t,n);return a.kept||(a=r1(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=e.inputNames.find(e=>void 0!==Z0(e,t,n));if(r){return[r1(Z0(r,t,n))]}return}case"Enter":{const r=Q0("frameName",e,t,n),a=Q0("tensor",e,t,n);return n.enterFrame(r),[r1(a)]}case"Exit":{const r=Q0("tensor",e,t,n);return n.exitFrame(),[r1(r)]}case"NextIteration":{const r=Q0("tensor",e,t,n);return n.nextIteration(),[r1(r)]}case"TensorArrayV3":{const r=Q0("size",e,t,n),a=Q0("dtype",e,t,n),o=Q0("elementShape",e,t,n),i=Q0("dynamicSize",e,t,n),s=Q0("clearAfterRead",e,t,n),c=Q0("identicalElementShapes",e,t,n),l=Q0("name",e,t,n),u=new V1(l,a,r,o,c,i,s);return n.addTensorArray(u),[u.idTensor,fF(1)]}case"TensorArrayWriteV3":{const r=Q0("tensorArrayId",e,t,n),a=Q0("index",e,t,n),o=Q0("tensor",e,t,n),i=n.getTensorArray(r.id);return i.write(a,o),[i.idTensor]}case"TensorArrayReadV3":{const r=Q0("tensorArrayId",e,t,n),a=Q0("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=Q0("tensorArrayId",e,t,n),a=Q0("indices",e,t,n),o=Q0("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,o)]}case"TensorArrayScatterV3":{const r=Q0("tensorArrayId",e,t,n),a=Q0("indices",e,t,n),o=Q0("tensor",e,t,n),i=n.getTensorArray(r.id);return i.scatter(a,o),[i.idTensor]}case"TensorArrayConcatV3":{const r=Q0("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),o=Q0("dtype",e,t,n);return[a.concat(o)]}case"TensorArraySplitV3":{const r=Q0("tensorArrayId",e,t,n),a=Q0("tensor",e,t,n),o=Q0("lengths",e,t,n),i=n.getTensorArray(r.id);return i.split(o,a),[i.idTensor]}case"TensorArraySizeV3":{const r=Q0("tensorArrayId",e,t,n);return[fF(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=Q0("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=Q0("tensorListId",e,t,n),a=Q0("index",e,t,n),o=Q0("tensor",e,t,n),i=n.getTensorList(r.id);return i.setItem(a,o),[i.idTensor]}case"TensorListGetItem":{const r=Q0("tensorListId",e,t,n),a=Q0("index",e,t,n),o=Q0("elementShape",e,t,n),i=Q0("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=Q0("indices",e,t,n),a=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const a=Math.max(...t);if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));const o=new G1([],n,e.dtype,r),i=fW(e,0);return t.forEach((e,t)=>{o.setItem(e,i[t])}),o}(Q0("tensor",e,t,n),r,Q0("elementShape",e,t,n),Q0("numElements",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=Q0("elementShape",e,t,n),a=Q0("elementDType",e,t,n);let o;o="TensorListReserve"===e.op?"numElements":"maxNumElements";const i=Q0(o,e,t,n),s=function(e,t,n,r){return new G1([],e,t,r)}(r,a,0,"TensorListReserve"===e.op?-1:i);return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=Q0("tensorListId",e,t,n),a=Q0("indices",e,t,n),o=Q0("elementShape",e,t,n),i=Q0("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,i,o)]}case"TensorListStack":{const r=Q0("tensorListId",e,t,n),a=Q0("elementShape",e,t,n),o=Q0("elementDType",e,t,n),i=Q0("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,o,i)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));B1(e.shape.slice(1),t,"TensorList shape mismatch: ");const a=fW(e);return new G1(a,t,r)}(Q0("tensor",e,t,n),Q0("elementShape",e,t,n),Q0("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=Q0("tensorListId",e,t,n),a=n.getTensorList(r.id),o=Q0("dtype",e,t,n),i=Q0("elementShape",e,t,n);return[a.concat(o,i)]}case"TensorListPushBack":{const r=Q0("tensorListId",e,t,n),a=Q0("tensor",e,t,n),o=n.getTensorList(r.id);return o.pushBack(a),[o.idTensor]}case"TensorListPopBack":{const r=Q0("tensorListId",e,t,n),a=Q0("elementShape",e,t,n),o=Q0("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,o)]}case"TensorListSplit":{const r=Q0("tensor",e,t,n),a=Q0("elementShape",e,t,n),o=function(e,t,n){let r=0;const a=t.map(e=>(r+=e,r));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));const o=U1(e.shape.slice(1),n),i=0===r?0:e.size/r,s=XD(()=>{const n=[];e=QL(e,[1,r,i]);for(let r=0;r<t.length;++r){const s=[0,0===r?0:a[r-1],0],c=[1,t[r],i];n[r]=QL(nz(e,s,c),o)}return e.dispose(),n}),c=new G1([],n,e.dtype,t.length);for(let l=0;l<s.length;l++)c.setItem(l,s[l]);return c}(r,Q0("lengths",e,t,n),a);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=Q0("tensorListId",e,t,n);return[fF(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=Q0("tensorListId",e,t,n),a=Q0("size",e,t,n),o=n.getTensorList(r.id).resize(a);return n.addTensorList(o),[o.idTensor]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}};function K1(e,t,n){const[r,a]=Q0("fusedOps",e,t,n),o="biasadd"===r,i=!o,s="prelu"===a,c="fusedbatchnorm"===r,l=Q0("numArgs",e,t,n);if(o){if(s&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&o&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=Q0("strides",e,t,n),d=n1(e,t,n),h=Q0("dataFormat",e,t,n).toUpperCase(),p=Q0("dilations",e,t,n);let[f,m]=Q0("args",e,t,n);i&&(m=f,f=void 0);return{stride:u,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:Q0("leakyreluAlpha",e,t,n)}}function q1(e,t,n){return{boxes:Q0("boxes",e,t,n),scores:Q0("scores",e,t,n),maxOutputSize:Q0("maxOutputSize",e,t,n),iouThreshold:Q0("iouThreshold",e,t,n),scoreThreshold:Q0("scoreThreshold",e,t,n),softNmsSigma:Q0("softNmsSigma",e,t,n)}}class X1{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=fF(0),this.tensorMap=new Map,QD(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return fF(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),XD(()=>{const e=fW(t),r=n.length,a=e.length;EO(r===a,()=>"The number of elements doesn't match, keys has "+"".concat(r," elements, the values has ").concat(a," ")+"elements.");for(let t=0;t<r;t++){const r=n[t],a=e[t];QD(a),this.tensorMap.set(r,a)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return XD(()=>{const e=[];for(let r=0;r<n.length;r++){const a=n[r],o=this.findWithDefault(a,t);e.push(o)}return Zj(e)})}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}function Y1(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:XD;const o=((e,t,n)=>{switch(e.category){case"arithmetic":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(Q0("a",e,t,n),Q0("b",e,t,n))];case"AddN":return[r.addN(Q0("tensors",e,t,n))];case"FloorMod":case"Mod":return[r.mod(Q0("a",e,t,n),Q0("b",e,t,n))];case"Mul":return[r.mul(Q0("a",e,t,n),Q0("b",e,t,n))];case"RealDiv":case"Div":return[r.div(Q0("a",e,t,n),Q0("b",e,t,n))];case"DivNoNan":return[r.divNoNan(Q0("a",e,t,n),Q0("b",e,t,n))];case"FloorDiv":return[r.floorDiv(Q0("a",e,t,n),Q0("b",e,t,n))];case"Sub":return[r.sub(Q0("a",e,t,n),Q0("b",e,t,n))];case"Minimum":return[r.minimum(Q0("a",e,t,n),Q0("b",e,t,n))];case"Maximum":return[r.maximum(Q0("a",e,t,n),Q0("b",e,t,n))];case"Pow":return[r.pow(Q0("a",e,t,n),Q0("b",e,t,n))];case"SquaredDifference":return[r.squaredDifference(Q0("a",e,t,n),Q0("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"basic_math":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Abs":case"ComplexAbs":return[r.abs(Q0("x",e,t,n))];case"Acos":return[r.acos(Q0("x",e,t,n))];case"Acosh":return[r.acosh(Q0("x",e,t,n))];case"Asin":return[r.asin(Q0("x",e,t,n))];case"Asinh":return[r.asinh(Q0("x",e,t,n))];case"Atan":return[r.atan(Q0("x",e,t,n))];case"Atan2":return[r.atan2(Q0("x",e,t,n),Q0("y",e,t,n))];case"Atanh":return[r.atanh(Q0("x",e,t,n))];case"Ceil":return[r.ceil(Q0("x",e,t,n))];case"Complex":return[r.complex(Q0("real",e,t,n),Q0("imag",e,t,n))];case"Cos":return[r.cos(Q0("x",e,t,n))];case"Cosh":return[r.cosh(Q0("x",e,t,n))];case"Elu":return[r.elu(Q0("x",e,t,n))];case"Erf":return[r.erf(Q0("x",e,t,n))];case"Exp":return[r.exp(Q0("x",e,t,n))];case"Expm1":return[r.expm1(Q0("x",e,t,n))];case"Floor":return[r.floor(Q0("x",e,t,n))];case"Log":return[r.log(Q0("x",e,t,n))];case"Log1p":return[r.log1p(Q0("x",e,t,n))];case"Imag":return[r.imag(Q0("x",e,t,n))];case"Neg":return[r.neg(Q0("x",e,t,n))];case"Reciprocal":return[r.reciprocal(Q0("x",e,t,n))];case"Real":return[r.real(Q0("x",e,t,n))];case"Relu":return[r.relu(Q0("x",e,t,n))];case"Round":return[r.round(Q0("x",e,t,n))];case"Selu":return[r.selu(Q0("x",e,t,n))];case"Sigmoid":return[r.sigmoid(Q0("x",e,t,n))];case"Sin":return[r.sin(Q0("x",e,t,n))];case"Sign":return[r.sign(Q0("x",e,t,n))];case"Sinh":return[r.sinh(Q0("x",e,t,n))];case"Softplus":return[r.softplus(Q0("x",e,t,n))];case"Sqrt":return[r.sqrt(Q0("x",e,t,n))];case"Square":return[r.square(Q0("x",e,t,n))];case"Tanh":return[r.tanh(Q0("x",e,t,n))];case"Tan":return[r.tan(Q0("x",e,t,n))];case"ClipByValue":return[r.clipByValue(Q0("x",e,t,n),Q0("clipValueMin",e,t,n),Q0("clipValueMax",e,t,n))];case"Relu6":return[r.relu6(Q0("x",e,t,n))];case"Rsqrt":return[r.rsqrt(Z0(e.inputNames[0],t,n))];case"LeakyRelu":return[r.leakyRelu(Q0("x",e,t,n),Q0("alpha",e,t,n))];case"Prelu":return[r.prelu(Q0("x",e,t,n),Q0("alpha",e,t,n))];case"IsNan":return[r.isNaN(Z0(e.inputNames[0],t,n))];case"IsInf":return[r.isInf(Z0(e.inputNames[0],t,n))];case"IsFinite":return[r.isFinite(Z0(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"control":return H1(e,t,n);case"convolution":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Conv1D":{const a=Q0("stride",e,t,n),o=Q0("pad",e,t,n),i=Q0("dataFormat",e,t,n).toUpperCase(),s=Q0("dilation",e,t,n);return[r.conv1d(Q0("x",e,t,n),Q0("filter",e,t,n),a,o,i,s)]}case"Conv2D":{const a=Q0("strides",e,t,n),o=n1(e,t,n),i=Q0("dataFormat",e,t,n).toUpperCase(),s=Q0("dilations",e,t,n);return[r.conv2d(Q0("x",e,t,n),Q0("filter",e,t,n),[a[1],a[2]],o,i,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:a,pad:o,dataFormat:i,dilations:s,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:d}=K1(e,t,n);return[r.fused.conv2d({x:Q0("x",e,t,n),filter:Q0("filter",e,t,n),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[s[1],s[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:o,dataFormat:i,dilations:s,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:d}=K1(e,t,n);return[r.fused.depthwiseConv2d({x:Q0("x",e,t,n),filter:Q0("filter",e,t,n),strides:[a[1],a[2]],pad:o,dataFormat:i,dilations:[s[1],s[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=Q0("outputShape",e,t,n),o=Q0("strides",e,t,n),i=n1(e,t,n);return[r.conv2dTranspose(Q0("x",e,t,n),Q0("filter",e,t,n),a,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=Q0("strides",e,t,n),o=n1(e,t,n),i=Q0("dilations",e,t,n),s=Q0("dataFormat",e,t,n).toUpperCase();return[r.depthwiseConv2d(Q0("input",e,t,n),Q0("filter",e,t,n),[a[1],a[2]],o,s,[i[1],i[2]])]}case"Conv3D":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("dataFormat",e,t,n).toUpperCase(),s=Q0("dilations",e,t,n);return[r.conv3d(Q0("x",e,t,n),Q0("filter",e,t,n),[a[1],a[2],a[3]],o,i,[s[1],s[2],s[3]])]}case"AvgPool":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("kernelSize",e,t,n);return[r.avgPool(Q0("x",e,t,n),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPool":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("kernelSize",e,t,n);return[r.maxPool(Q0("x",e,t,n),[i[1],i[2]],[a[1],a[2]],o)]}case"MaxPoolWithArgmax":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("kernelSize",e,t,n),s=Q0("includeBatchInIndex",e,t,n),{result:c,indexes:l}=r.maxPoolWithArgmax(Q0("x",e,t,n),[i[1],i[2]],[a[1],a[2]],o,s);return[c,l]}case"AvgPool3D":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("kernelSize",e,t,n);return[r.avgPool3d(Q0("x",e,t,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"MaxPool3D":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("kernelSize",e,t,n);return[r.maxPool3d(Q0("x",e,t,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],o)]}case"Dilation2D":{const a=Q0("strides",e,t,n),o=Q0("pad",e,t,n),i=Q0("dilations",e,t,n),s=a[1],c=a[2],l=i[1],u=i[2];return[r.dilation2d(Q0("x",e,t,n),Q0("filter",e,t,n),[s,c],o,[l,u],"NHWC")]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"creation":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Fill":{const a=Q0("shape",e,t,n),o=Q0("dtype",e,t,n),i=Q0("value",e,t,n);return[r.fill(a,i,o)]}case"LinSpace":{const a=Q0("start",e,t,n),o=Q0("stop",e,t,n),i=Q0("num",e,t,n);return[r.linspace(a,o,i)]}case"Multinomial":{const a=Q0("logits",e,t,n),o=Q0("numSamples",e,t,n),i=Q0("seed",e,t,n);return[r.multinomial(a,o,i)]}case"OneHot":{const a=Q0("indices",e,t,n),o=Q0("depth",e,t,n),i=Q0("onValue",e,t,n),s=Q0("offValue",e,t,n),c=Q0("dtype",e,t,n);return[r.oneHot(a,o,i,s,c)]}case"Ones":return[r.ones(Q0("shape",e,t,n),Q0("dtype",e,t,n))];case"OnesLike":return[r.onesLike(Q0("x",e,t,n))];case"RandomStandardNormal":return[r.randomStandardNormal(Q0("shape",e,t,n),Q0("dtype",e,t,n),Q0("seed",e,t,n))];case"RandomUniform":return[r.randomUniform(Q0("shape",e,t,n),Q0("minval",e,t,n),Q0("maxval",e,t,n),Q0("dtype",e,t,n))];case"RandomUniformInt":return[r.randomUniformInt(Q0("shape",e,t,n),Q0("minval",e,t,n),Q0("maxval",e,t,n),Q0("seed",e,t,n))];case"Range":{const a=Q0("start",e,t,n),o=Q0("stop",e,t,n),i=Q0("step",e,t,n);return[r.range(a,o,i,Q0("dtype",e,t,n))]}case"TruncatedNormal":{const a=Q0("shape",e,t,n),o=Q0("mean",e,t,n),i=Q0("stdDev",e,t,n),s=Q0("seed",e,t,n);return[r.truncatedNormal(a,o,i,Q0("dtype",e,t,n),s)]}case"Zeros":return[r.zeros(Q0("shape",e,t,n),Q0("dtype",e,t,n))];case"ZerosLike":return[r.zerosLike(Q0("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"dynamic":return async function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:T;switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:o,maxOutputSize:i,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=q1(e,t,n),u=await a.image.nonMaxSuppressionWithScoreAsync(r,o,i,s,c,l);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:o,maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=q1(e,t,n),l=Q0("padToMaxOutputSize",e,t,n),u=await a.image.nonMaxSuppressionPaddedAsync(r,o,i,s,c,l);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:o,maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=q1(e,t,n);return[await a.image.nonMaxSuppressionAsync(r,o,i,s,c)]}case"Where":{const r=a.cast(Q0("condition",e,t,n),"bool"),o=[await a.whereAsync(r)];return r.dispose(),o}case"ListDiff":return a.setdiff1dAsync(Q0("x",e,t,n),Q0("y",e,t,n));default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n);case"evaluation":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"LowerBound":{const a=Q0("sortedSequence",e,t,n),o=Q0("values",e,t,n);return[r.lowerBound(a,o)]}case"TopKV2":{const a=Q0("x",e,t,n),o=Q0("k",e,t,n),i=Q0("sorted",e,t,n),s=r.topk(a,o,i);return[s.values,s.indices]}case"UpperBound":{const a=Q0("sortedSequence",e,t,n),o=Q0("values",e,t,n);return[r.upperBound(a,o)]}case"Unique":{const a=Q0("x",e,t,n),o=r.unique(a);return[o.values,o.indices]}case"UniqueV2":{const a=Q0("x",e,t,n),o=Q0("axis",e,t,n),i=r.unique(a,o);return[i.values,i.indices]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"image":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"ResizeBilinear":{const a=Q0("images",e,t,n),o=Q0("size",e,t,n),i=Q0("alignCorners",e,t,n),s=Q0("halfPixelCenters",e,t,n);return[r.image.resizeBilinear(a,[o[0],o[1]],i,s)]}case"ResizeNearestNeighbor":{const a=Q0("images",e,t,n),o=Q0("size",e,t,n),i=Q0("alignCorners",e,t,n),s=Q0("halfPixelCenters",e,t,n);return[r.image.resizeNearestNeighbor(a,[o[0],o[1]],i,s)]}case"CropAndResize":{const a=Q0("image",e,t,n),o=Q0("boxes",e,t,n),i=Q0("boxInd",e,t,n),s=Q0("cropSize",e,t,n),c=Q0("method",e,t,n),l=Q0("extrapolationValue",e,t,n);return[r.image.cropAndResize(a,o,i,s,c,l)]}case"ImageProjectiveTransformV3":{const a=Q0("images",e,t,n),o=Q0("transforms",e,t,n),i=Q0("outputShape",e,t,n),s=Q0("fillValue",e,t,n),c=Q0("interpolation",e,t,n),l=Q0("fillMode",e,t,n);return[r.image.transform(a,o,c.toLowerCase(),l.toLowerCase(),s,i)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"graph":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const a=Q0("default",e,t,n);return[Z0(e.name,t,n)||a];case"Placeholder":return[Z0(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[r1(Q0("x",e,t,n))];case"IdentityN":return Q0("x",e,t,n).map(e=>r1(e));case"Shape":return[r.tensor1d(Q0("x",e,t,n).shape,"int32")];case"ShapeN":return Q0("x",e,t,n).map(e=>r.tensor1d(e.shape));case"Size":return[r.scalar(Q0("x",e,t,n).size,"int32")];case"Rank":return[r.scalar(Q0("x",e,t,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=Q0("x",e,t,n),i=Q0("data",e,t,n),s=Q0("message",e,t,n),c=Q0("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let e=0;e<i.length;e++)console.log(Array.prototype.slice.call(i[e].dataSync()).slice(0,c));return[o];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"logical":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Equal":return[r.equal(Q0("a",e,t,n),Q0("b",e,t,n))];case"NotEqual":return[r.notEqual(Q0("a",e,t,n),Q0("b",e,t,n))];case"Greater":return[r.greater(Q0("a",e,t,n),Q0("b",e,t,n))];case"GreaterEqual":return[r.greaterEqual(Q0("a",e,t,n),Q0("b",e,t,n))];case"Less":return[r.less(Q0("a",e,t,n),Q0("b",e,t,n))];case"LessEqual":return[r.lessEqual(Q0("a",e,t,n),Q0("b",e,t,n))];case"LogicalAnd":return[r.logicalAnd(Q0("a",e,t,n),Q0("b",e,t,n))];case"LogicalNot":return[r.logicalNot(Q0("a",e,t,n))];case"LogicalOr":return[r.logicalOr(Q0("a",e,t,n),Q0("b",e,t,n))];case"Select":case"SelectV2":return[r.where(Q0("condition",e,t,n),Q0("a",e,t,n),Q0("b",e,t,n))];case"BitwiseAnd":return[r.bitwiseAnd(Q0("a",e,t,n),Q0("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"matrices":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(Q0("a",e,t,n),Q0("b",e,t,n),Q0("transposeA",e,t,n),Q0("transposeB",e,t,n))];case"Einsum":return[r.einsum(Q0("equation",e,t,n),...Q0("tensors",e,t,n))];case"Transpose":return[r.transpose(Q0("x",e,t,n),Q0("perm",e,t,n))];case"_FusedMatMul":const[a,o]=Q0("fusedOps",e,t,n),i="biasadd"===a,s="prelu"===o,c=Q0("numArgs",e,t,n),l=Q0("leakyreluAlpha",e,t,n);if(i){if(s&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=Q0("args",e,t,n);return[r.fused.matMul({a:Q0("a",e,t,n),b:Q0("b",e,t,n),transposeA:Q0("transposeA",e,t,n),transposeB:Q0("transposeB",e,t,n),bias:u,activation:o,preluActivationWeights:d,leakyreluAlpha:l})];case"MatrixBandPart":return[r.linalg.bandPart(Q0("a",e,t,n),Q0("numLower",e,t,n),Q0("numUpper",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"normalization":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"EuclideanNorm":return[r.euclideanNorm(Q0("x",e,t,n),Q0("axis",e,t,n),Q0("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(Q0("x",e,t,n),Q0("mean",e,t,n),Q0("variance",e,t,n),Q0("offset",e,t,n),Q0("scale",e,t,n),Q0("epsilon",e,t,n))];case"LRN":return[r.localResponseNormalization(Q0("x",e,t,n),Q0("radius",e,t,n),Q0("bias",e,t,n),Q0("alpha",e,t,n),Q0("beta",e,t,n))];case"Softmax":return[r.softmax(Q0("x",e,t,n))];case"LogSoftmax":return[r.logSoftmax(Q0("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"ragged":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:o}=r.raggedGather(Q0("paramsNestedSplits",e,t,n),Q0("paramsDenseValues",e,t,n),Q0("indices",e,t,n),Q0("outputRaggedRank",e,t,n));return a.concat(o)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:o}=r.raggedRange(Q0("starts",e,t,n),Q0("limits",e,t,n),Q0("splits",e,t,n));return[a,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(Q0("shape",e,t,n),Q0("values",e,t,n),Q0("defaultValue",e,t,n),Q0("rowPartitionTensors",e,t,n),Q0("rowPartitionTypes",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"reduction":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Max":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.max(Q0("x",e,t,n),a,o)]}case"Mean":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.mean(Q0("x",e,t,n),a,o)]}case"Min":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.min(Q0("x",e,t,n),a,o)]}case"Sum":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.sum(Q0("x",e,t,n),a,o)]}case"All":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.all(Q0("x",e,t,n),a,o)]}case"Any":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.any(Q0("x",e,t,n),a,o)]}case"ArgMax":{const a=Q0("axis",e,t,n);return[r.argMax(Q0("x",e,t,n),a)]}case"ArgMin":{const a=Q0("axis",e,t,n);return[r.argMin(Q0("x",e,t,n),a)]}case"Prod":{const a=Q0("axis",e,t,n),o=Q0("keepDims",e,t,n);return[r.prod(Q0("x",e,t,n),a,o)]}case"Cumprod":{const a=Q0("axis",e,t,n),o=Q0("exclusive",e,t,n),i=Q0("reverse",e,t,n);return[r.cumprod(Q0("x",e,t,n),a,o,i)]}case"Cumsum":{const a=Q0("axis",e,t,n),o=Q0("exclusive",e,t,n),i=Q0("reverse",e,t,n);return[r.cumsum(Q0("x",e,t,n),a,o,i)]}case"Bincount":const a=Q0("x",e,t,n),o=Q0("weights",e,t,n),i=Q0("size",e,t,n);return[r.bincount(a,o,i)];case"DenseBincount":{const a=Q0("x",e,t,n),o=Q0("weights",e,t,n),i=Q0("size",e,t,n),s=Q0("binaryOutput",e,t,n);return[r.denseBincount(a,o,i,s)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"slice_join":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"ConcatV2":case"Concat":{const a=Q0("n",e,t,n),o=Q0("axis",e,t,n);let i=Q0("tensors",e,t,n);return i=i.slice(0,a),[r.concat(i,o)]}case"Gather":{const a=Q0("x",e,t,n),o=Q0("indices",e,t,n);return[r.gather(a,r.cast(o,"int32"),0)]}case"GatherV2":{const a=Q0("axis",e,t,n),o=Q0("batchDims",e,t,n),i=Q0("x",e,t,n),s=Q0("indices",e,t,n);return[r.gather(i,r.cast(s,"int32"),a,o)]}case"Reverse":{const a=Q0("dims",e,t,n),o=[];for(let e=0;e<a.length;e++)a[e]&&o.push(e);const i=Q0("x",e,t,n);return[r.reverse(i,o)]}case"ReverseV2":{const a=Q0("axis",e,t,n),o=Q0("x",e,t,n);return[r.reverse(o,a)]}case"Slice":{const a=Q0("begin",e,t,n),o=Q0("size",e,t,n);return[r.slice(Q0("x",e,t,n),a,o)]}case"StridedSlice":{const a=Q0("begin",e,t,n),o=Q0("end",e,t,n),i=Q0("strides",e,t,n),s=Q0("beginMask",e,t,n),c=Q0("endMask",e,t,n),l=Q0("ellipsisMask",e,t,n),u=Q0("newAxisMask",e,t,n),d=Q0("shrinkAxisMask",e,t,n),h=Q0("x",e,t,n);return[r.stridedSlice(h,a,o,i,s,c,l,u,d)]}case"Pack":return XD(()=>{const a=Q0("axis",e,t,n),o=Q0("tensors",e,t,n),i=o[0].shape,s=r.squeeze(o[0]).shape,c=o.map(e=>{const t=_O(e.shape,i);if(!t&&!_O(r.squeeze(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:r.reshape(e,i)});return[r.stack(c,a)]});case"Unpack":{const a=Q0("axis",e,t,n),o=Q0("tensor",e,t,n);return r.unstack(o,a)}case"Tile":{const a=Q0("reps",e,t,n);return[r.tile(Q0("x",e,t,n),a)]}case"Split":case"SplitV":{const a=Q0("axis",e,t,n),o=Q0("numOrSizeSplits",e,t,n),i=Q0("x",e,t,n);return r.split(i,o,a)}case"ScatterNd":{const a=Q0("indices",e,t,n),o=Q0("values",e,t,n),i=Q0("shape",e,t,n);return[r.scatterND(a,o,i)]}case"GatherNd":{const a=Q0("x",e,t,n),o=Q0("indices",e,t,n);return[r.gatherND(a,o)]}case"SparseToDense":{const a=Q0("sparseIndices",e,t,n),o=Q0("outputShape",e,t,n),i=Q0("sparseValues",e,t,n),s=Q0("defaultValue",e,t,n);return[r.sparseToDense(a,i,o,i.dtype===s.dtype?s:r.cast(s,i.dtype))]}case"TensorScatterUpdate":{const a=Q0("indices",e,t,n),o=Q0("values",e,t,n),i=Q0("tensor",e,t,n);return[r.tensorScatterUpdate(i,a,o)]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"sparse":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:o,emptyRowIndicator:i,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(Q0("indices",e,t,n),Q0("values",e,t,n),Q0("denseShape",e,t,n),Q0("defaultValue",e,t,n));return[a,o,i,s]}case"SparseReshape":{const{outputIndices:a,outputShape:o}=r.sparse.sparseReshape(Q0("inputIndices",e,t,n),Q0("inputShape",e,t,n),Q0("newShape",e,t,n));return[a,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(Q0("data",e,t,n),Q0("indices",e,t,n),Q0("segmentIds",e,t,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(Q0("data",e,t,n),Q0("indices",e,t,n),Q0("segmentIds",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"spectral":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"FFT":return[r.fft(Q0("x",e,t,n))];case"IFFT":return[r.ifft(Q0("x",e,t,n))];case"RFFT":return[r.rfft(Q0("x",e,t,n))];case"IRFFT":return[r.irfft(Q0("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"string":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(Q0("input",e,t,n),Q0("pattern",e,t,n),Q0("rewrite",e,t,n),Q0("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:a,nGramsSplits:o}=r.string.stringNGrams(Q0("data",e,t,n),Q0("dataSplits",e,t,n),Q0("separator",e,t,n),Q0("nGramWidths",e,t,n),Q0("leftPad",e,t,n),Q0("rightPad",e,t,n),Q0("padWidth",e,t,n),Q0("preserveShortSequences",e,t,n));return[a,o]}case"StringSplit":{const{indices:a,values:o,shape:i}=r.string.stringSplit(Q0("input",e,t,n),Q0("delimiter",e,t,n),Q0("skipEmpty",e,t,n));return[a,o,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(Q0("input",e,t,n),Q0("numBuckets",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"transformation":return a(()=>function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;switch(e.op){case"Cast":return[r.cast(Q0("x",e,t,n),Q0("dtype",e,t,n))];case"ExpandDims":{const a=Q0("axis",e,t,n);return[r.expandDims(Q0("x",e,t,n),a)]}case"Squeeze":{const a=Q0("axis",e,t,n);return[r.squeeze(Q0("x",e,t,n),a)]}case"Reshape":return[r.reshape(Q0("x",e,t,n),Q0("shape",e,t,n))];case"EnsureShape":return[r.ensureShape(Q0("x",e,t,n),Q0("shape",e,t,n))];case"MirrorPad":return[r.mirrorPad(Q0("x",e,t,n),Q0("padding",e,t,n),Q0("mode",e,t,n))];case"PadV2":case"Pad":return[r.pad(Q0("x",e,t,n),Q0("padding",e,t,n),Q0("constantValue",e,t,n))];case"SpaceToBatchND":{const a=Q0("blockShape",e,t,n),o=Q0("paddings",e,t,n);return[r.spaceToBatchND(Q0("x",e,t,n),a,o)]}case"BatchToSpaceND":{const a=Q0("blockShape",e,t,n),o=Q0("crops",e,t,n);return[r.batchToSpaceND(Q0("x",e,t,n),a,o)]}case"DepthToSpace":{const a=Q0("blockSize",e,t,n),o=Q0("dataFormat",e,t,n).toUpperCase();return[r.depthToSpace(Q0("x",e,t,n),a,o)]}case"BroadcastTo":return[r.broadcastTo(Q0("x",e,t,n),Q0("shape",e,t,n))];case"BroadcastArgs":return[r.broadcastArgs(Q0("s0",e,t,n),Q0("s1",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const a=r.getHashTableHandleByName(e.name);if(null!=a)return[a];{const a=Q0("keyDType",e,t,n),o=Q0("valueDType",e,t,n),i=new X1(a,o);return r.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=Q0("tableHandle",e,t,n,r),o=Q0("keys",e,t,n),i=Q0("values",e,t,n),s=r.getHashTableById(a.id);return[await s.import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const a=Q0("tableHandle",e,t,n,r),o=Q0("keys",e,t,n),i=Q0("defaultValue",e,t,n),s=r.getHashTableById(a.id);return[await s.find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=Q0("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(e.op," is not implemented"))}})(e,t,n,r);case"custom":const o=Y0(e.op);if(o&&o.customExecutor)return o.customExecutor(new z1(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(e,t,n);return nA(o)?o.then(e=>[].concat(e)):[].concat(o)}class Q1{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(e=>0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function Z1(e,t,n,r){const a=new Set,o=[];let i=null,s=null;const c=new Set,l=new Set(Object.keys(e).map(e=>t1(e)[0]));r=r||[];const u=new Set(r.map(e=>t1(e.name)[0])),d=[...t];for(;d.length>0;){const e=d.pop();(r2(e)||a2(e)||o2(e))&&null==i&&(i=e,s=i.children.map(e=>e.name).filter(e=>a.has(e))),a.add(e.name),null==n[e.name]&&(l.has(e.name)||u.has(e.name)||(0!==e.inputs.length?e.inputs.forEach(e=>{c.has(e.name)||(c.add(e.name),d.push(e))}):o.push(e.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:o,dynamicNode:i,syncInputs:s}}function $1(e,t){const{usedNodes:n,inputs:r}=t,a=Object.keys(r).map(e=>t1(e)[0]).map(t=>e.nodes[t]),o=e.initNodes||[],i=e=>n.has("string"===typeof e?e:e.name);function s(e){return[...new Map(e.map(e=>[e.name,e])).values()]}const c=s([...a,...e.weights,...o]).filter(i),l=s([...c,...Object.values(e.nodes)]).filter(i),u=new Map(l.map(e=>[e.name,e])),d={};for(const m of l){d[m.name]=d[m.name]||0;for(const e of m.children)i(e)||(d[e.name]=Number.POSITIVE_INFINITY),d[e.name]=(d[e.name]||0)+1}const h=Object.entries(d).filter(e=>{let[,t]=e;return 0===t}).map(e=>{let[t]=e;return t}),p=[...h];for(;h.length>0;){const e=h.pop(),t=u.get(e);for(const n of t.children.filter(i))0===--d[n.name]&&(p.push(n.name),h.push(n.name))}const f=function(e,t){const n=new Map(e.map(e=>[e.name,e])),r=t.map(e=>e.name),a=new Set(r);for(;r.length>0;){const e=r.pop(),t=n.get(e);for(const o of t.children)n.has(o.name)&&!a.has(o.name)&&(a.add(o.name),r.push(o.name))}const o=e.filter(e=>a.has(e.name));return o}(p.map(e=>u.get(e)),c);return function(e,t){const n=new Map(e.map((e,t)=>[e.name,t])),r=new Set(t.map(e=>e.name)),a=e=>r.has("string"===typeof e?e:e.name),o=new Set(e.map(e=>e.name)),i=e=>o.has("string"===typeof e?e:e.name);for(const s of e){for(const e of s.children.filter(i)){if(!n.has(e.name))throw new J1("Child ".concat(e.name," of node ").concat(s.name," is unreachable."));if(n.get(s.name)>n.get(e.name))throw new J1("Node ".concat(s.name," is scheduled to run after its child ").concat(e.name,"."))}if(!a(s))for(const e of s.inputs){if(!n.has(e.name))throw new J1("Input ".concat(e.name," of node ").concat(s.name," is unreachable."));if(n.get(e.name)>n.get(s.name))throw new J1("Node ".concat(s.name," is scheduled to run before its input ").concat(e.name,"."))}}}(f,c),f}class J1 extends Error{constructor(e){super("NodesExecutionOrderError: ".concat(e))}}const e2=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),t2=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),n2=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function r2(e){return e2.has(e.op)}function a2(e){return t2.has(e.op)}function o2(e){return n2.has(e.op)}class i2{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(t=>e[t].map(e=>e.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach(t=>{this._functionExecutorMap[t]=new i2(e.functions[t],this)})}getCompilationKey(e,t){const n=e.map(e=>e.name).sort(),r=t.map(e=>e.name).sort();return n.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const n=Z1(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:o}=n;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(o,"]"));if(r.length>0){const n=t.map(e=>e.name),a=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(a,"]. Missing the following inputs: [").concat(r,"]"))}const i=$1(this.graph,n),s=function(e){const t=new Map(e.map((e,t)=>[e.name,t])),n=Number.MAX_SAFE_INTEGER,r=e.map((e,t)=>r2(e)?n:t),a=e=>{const n=r[t.get(e.name)];return null==n?-1:n},o=e.map((e,t)=>e.children.map(a).reduce((e,t)=>Math.max(e,t),r[t])),i=new Map;for(let s=0;s<e.length;++s){const t=o[s];if(t===n)continue;const r=e[s],a=e[t];i.has(a.name)||i.set(a.name,[]),i.get(a.name).push(r)}return i}(i);return{orderedNodes:i,nodeLiveUntilMap:s}}cloneAndKeepTensor(e){if(null==e)return null;const t=e.clone();return QD(t),t}cloneTensorList(e){if(!e)return null;const t=e.map(e=>this.cloneAndKeepTensor(e));return t}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,this.cloneTensorList(n)]}))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map(e=>this.graph.nodes[t1(e)[0]]),a=t.map(e=>t1(e)[0]),o=new Set(a);let i=a.map(e=>this.graph.nodes[e]);0===i.length&&(i=this._outputs);const s=this.getCompilationKey(r,i);let c=this.compiledMap.get(s);null==c&&(c=this.compile(e,i),this.compiledMap.set(s,c));try{this.keepIntermediateTensors=iA().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const l={},u={};return XD(()=>{const n=new Q1(this.weightMap,l,u,this.functionExecutorMap,this.parseNodeNameCache),r=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(t=>{const[a,o]=t1(t,n),i=[];i[o]=e[t],r[a]=i,this.keepIntermediateTensors&&(this.clonedTensorsMap[a]=this.cloneTensorList(i))});const a=this.getFrozenTensorIds(r),{orderedNodes:i,nodeLiveUntilMap:s}=c;for(const e of i){if(r[e.name])continue;const t=Y1(e,r,n,this._resourceManager);if(nA(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");r[e.name]=t,this.keepIntermediateTensors&&(this.clonedTensorsMap[e.name]=this.cloneTensorList(t)),this.checkTensorForDisposalWithNodeLiveUntilInfo(e,r,n,a,o,s.get(e.name))}return null==this.parent&&n.dispose(a),t.map(e=>Z0(e,r,n))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(t=>e[t]).map(e=>e.map(e=>e.id)));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,o,i){if(!r2(t)&&!o.has(e)){for(const r of n[e])null!=r&&(i[r.id]=(i[r.id]||0)+t.children.length);for(const e of t.inputs){if(r2(e))continue;const t=$0(e.name,n,r);if(null!=t)for(const e of t){if(!e||e.kept||a.has(e.id))continue;const t=i[e.id];1===t?(e.dispose(),delete i[e.id]):null!=t&&i[e.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,n,r,a,o){function i(e){return r2(e)||a.has(e.name)}if(!r2(e)&&null!=o)for(const s of o){if(i(s))continue;const e=$0(s.name,t,n);for(const t of e)!t||t.kept||r.has(t.id)||t.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.disposeIntermediateTensors(),n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=iA().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const o=new Q1(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(e,o,t,n),s=t.map(e=>Z0(e,i,o)),c=s.map(e=>e.id),l=Object.keys(e).map(t=>e[t].id),u=new Set([...c,...l,...this.weightIds]);return Object.values(i).forEach(e=>{e.forEach(e=>{!e||e.isDisposed||u.has(e.id)||e.dispose()})}),null==this.parent&&o.dispose(u),s}async executeFunctionAsync(e,t,n){const r=e.reduce((e,t,n)=>(e[this.inputs[n].name]=t,e),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const a=Object.keys(e),o=a.map(e=>this.graph.nodes[t1(e)[0]]),i=n.map(e=>t1(e)[0]),s=new Set(i);let c=i.map(e=>this.graph.nodes[e]);0===c.length&&(c=this._outputs);const{usedNodes:l,missingInputs:u,dynamicNode:d,syncInputs:h}=Z1(e,c,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(e=>({node:e,contexts:t.currentContext})),f=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{const[n,r]=t1(t),a=[];a[r]=e[t],f[n]=a});const m={},g=this.getFrozenTensorIds(f),y={};for(;p.length>0;){const e=this.processStack(o,p,t,f,y,g,s,m,l);await Promise.all(e)}null!=d||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=c.filter(e=>!r2(e)&&!Z0(e.name,f,t)).map(e=>e.name);if(v.length>0){let e="";throw null!=d&&(e="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(v,"] from the provided ")+"inputs [".concat(a,"]. Consider providing the following inputs: ")+"[".concat(u,"]. ").concat(e))}return f}processStack(e,t,n,r,a,o,i,s,c){const l=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let u="";if("Enter"===e.node.op&&Q0("isConstant",e.node,r,n)&&([u]=J0(e.node.name,n)),null==r[e.node.name]){const d=Y1(e.node,r,n,this._resourceManager);u||([u]=J0(e.node.name,n));const h=n.currentContext;nA(d)?l.push(d.then(l=>(r[u]=l,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(l)),n.currentContext=h,this.checkTensorForDisposal(u,e.node,r,n,o,i,s),this.processChildNodes(e.node,t,n,r,a,c),l))):(r[u]=d,this.keepIntermediateTensors&&(this.clonedTensorsMap[u]=this.cloneTensorList(d)),this.checkTensorForDisposal(u,e.node,r,n,o,i,s),this.processChildNodes(e.node,t,n,r,a,c))}else this.processChildNodes(e.node,t,n,r,a,c)}return l}processChildNodes(e,t,n,r,a,o){e.children.forEach(e=>{const[i]=J0(e.name,n);!a[i]&&o.has(e.name)&&("Merge"===e.op?e.inputNames.some(e=>!!Z0(e,r,n))&&(a[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every(e=>!!Z0(e,r,n))&&(a[i]=!0,t.push({contexts:n.currentContext,node:e})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(e=>e.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[r]=t1(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const e=a.attrParams.shape.value;EO(e.length===n.shape.length&&n.shape.every((t,n)=>-1===e[n]||e[n]===t),()=>"The shape of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be [".concat(e,"], but was ")+"[".concat(n.shape,"]"))}a.attrParams.dtype&&a.attrParams.dtype.value&&EO(n.dtype===a.attrParams.dtype.value,()=>"The dtype of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(a.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(e){var t,n;const r={};for(const a in e){const o=null===(n=null===(t=this._signature)||void 0===t?void 0:t.inputs)||void 0===n?void 0:n[a];null!=o?r[o.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const t=Object.keys(e).filter(e=>{const[t]=t1(e);return null==this.graph.nodes[t]});if(t.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(t,"] that are not part of graph"))}mapOutputs(e){return e.map(e=>{var t,n;const r=null===(n=null===(t=this._signature)||void 0===t?void 0:t.outputs)||void 0===n?void 0:n[e];return null!=r?r.name:e},{})}checkOutputs(e){e.forEach(e=>{const[t]=t1(e);if(!this.graph.nodes[t])throw new Error("The output '".concat(e,"' is not found in the graph"))})}}class s2{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const c2="?tfjs-format=file",l2="model.json";class u2{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new s2}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return nA(e)?e.then(e=>null==e.getWeightStream?this.loadSync(e):this.loadStreaming(e)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(null==e.getWeightStream)throw new Error("Model artifacts missing streamWeights function");const t=await sM(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(r=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}if(this.signature=r,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer),this.executor=new i2(S1.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=S1.Instance.transformGraph(e.modelInitializer);this.initializer=new i2(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if("string"===typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));if(t.length>1)throw new Error("Found more than one (".concat(t.length,") save handlers for ")+"URL '".concat(e,"'"));e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t={};return(e instanceof lD?[e]:e).forEach((e,n)=>t[this.structuredOutputKeys[n]]=e),t}return e}predict(e,t){const n=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(n)}async predictAsync(e,t){const n=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(n)}normalizeInputs(e){var t;if(!(e instanceof lD)&&!Array.isArray(e)){const n=null===(t=this.signature)||void 0===t?void 0:t.inputs;if(null!=n)for(const t in n){const r=n[t];null!=r.resourceId&&(e[t]=this.resourceIdToCapturedInput[r.resourceId])}return e}e=Array.isArray(e)?e:[e];const n=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+n!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has ".concat(this.inputNodes.length-n," non-resource placeholders, while there are ").concat(e.length," input tensors provided."));let r=0;return this.inputNodes.reduce((t,n)=>{var a,o,i;const s=null===(i=null===(o=null===(a=this.signature)||void 0===a?void 0:a.inputs)||void 0===o?void 0:o[n])||void 0===i?void 0:i.resourceId;return t[n]=null!=s?this.resourceIdToCapturedInput[s]:e[r++],t},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return null==this.initializer?[]:null==this.initializerSignature?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,n=Object.keys(t);for(let r=0;r<n.length;r++){const a=t[n[r]];this.resourceIdToCapturedInput[a.resourceId]=e[r]}}}execute(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&YD(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function d2(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==n&&(n={}),n.fromTFHub&&"string"===typeof e&&(e=function(e){e.endsWith("/")||(e+="/");return"".concat(e).concat(l2).concat(c2)}(e));const a=new u2(e,n,r);return await a.load(),a}var h2=n(3879);const p2=iA();p2.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15),p2.registerFlag("WEBGPU_CPU_FORWARD",()=>!0),p2.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1),p2.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0),p2.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1),p2.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3),p2.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1),p2.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0),p2.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1),p2.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1),p2.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1),p2.registerFlag("WEBGPU_PRINT_SHADER",()=>""),p2.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);class f2{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return"intel"===this.vendor}}class m2{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=g2(e,t);return a?(this.freeBuffers.has(o)||this.freeBuffers.set(o,[]),this.freeBuffers.get(o).length>0?(n=this.freeBuffers.get(o).pop(),this.numFreeBuffers--):(n=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e)):(n=this.device.createBuffer({size:e,usage:t,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(o)||this.usedBuffers.set(o,[]),this.usedBuffers.get(o).push(n),this.numUsedBuffers++,this.numBytesUsed+=e,n}releaseBuffer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0===this.freeBuffers.size)return;const n=e.size,r=g2(n,e.usage),a=this.usedBuffers.get(r),o=a.indexOf(e);if(o<0)throw new Error("Cannot find the buffer in buffer manager");a[o]=a[a.length-1],a.pop(),this.numUsedBuffers--,this.numBytesUsed-=n,t?(this.freeBuffers.get(r).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=n)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,t)=>{e.forEach(e=>{e.destroy()})}),this.usedBuffers.forEach((e,t)=>{e.forEach(e=>{e.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function g2(e,t){return"".concat(e,"_").concat(t)}class y2{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,t,n,r){const a=e*t*b2(n),o=v2(e,t,n,r);if(this.freeTextures.has(o)||this.freeTextures.set(o,[]),this.usedTextures.has(o)||this.usedTextures.set(o,[]),this.numBytesUsed+=a,this.numUsedTextures++,this.freeTextures.get(o).length>0){this.numFreeTextures--;const e=this.freeTextures.get(o).shift();return this.usedTextures.get(o).push(e),e}this.numBytesAllocated+=a;const i=this.device.createTexture({size:[e,t],format:n,usage:r});return this.usedTextures.get(o).push(i),i}releaseTexture(e){if(0===this.freeTextures.size)return;const t=e.width,n=e.height,r=e.format,a=v2(t,n,r,e.usage);this.freeTextures.has(a)||this.freeTextures.set(a,[]),this.freeTextures.get(a).push(e),this.numFreeTextures++,this.numUsedTextures--;const o=this.usedTextures.get(a),i=o.indexOf(e);if(i<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(i,1);const s=t*n*b2(r);this.numBytesUsed-=s}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,t)=>{e.forEach(e=>{e.destroy()})}),this.usedTextures.forEach((e,t)=>{e.forEach(e=>{e.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function v2(e,t,n,r){return"".concat(e,"_").concat(t,"_").concat(n,"_").concat(r)}function b2(e){if("rgba8unorm"===e)return 16;throw new Error("".concat(e," is not supported!"))}function x2(e,t){if(Math.max(...e)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const n=e.length,r=e.map(e=>"".concat(t,".").concat("xyzwuv"[e])),a=new Array(n-1);a[n-2]=r[n-1];for(let o=n-3;o>=0;--o)a[o]="(".concat(a[o+1]," * ").concat(r[o+1],")");return a}const w2=(e,t,n)=>"int32"===n?"atomicAdd(".concat(e,", bitcast<i32>(").concat(t,"));"):"\n          {\n            var oldValue = 0;\n            loop {\n              let newValueF32 = bitcast<f32>(oldValue) + (".concat(t,");\n              let newValue = bitcast<i32>(newValueF32);\n              let res = atomicCompareExchangeWeak(").concat(e,", oldValue, newValue);\n              if res.exchanged {\n                break;\n              }\n              oldValue = res.old_value;\n            }\n          }");var k2;!function(e){e[e.FROM_PIXELS=0]="FROM_PIXELS",e[e.DRAW=1]="DRAW"}(k2||(k2={}));const S2=(e,t,n,r,a)=>{const o=function(e,t,n){const r=[],a=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,r.push("\n\n      var<private> localId: vec3<u32>;\n      var<private> localIndex: u32;\n      var<private> globalId: vec3<u32>;\n      var<private> numWorkgroups: vec3<u32>;\n      var<private> workgroupId: vec3<u32>;\n\n      // Only used when the y/z dimension of workgroup size is 1.\n      fn getGlobalIndex() -> i32 {\n        ".concat(P2(n)?"  return i32(globalId.x);":"  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +\n                workgroupId.y * numWorkgroups.x + workgroupId.x) * ".concat(a,"u +\n                localIndex);\n        "),"\n      }\n    ")),null!=n.pixelsOpType){const a=n.pixelsOpType===k2.FROM_PIXELS?"@group(0) @binding(0) var<storage, read_write> result: array<".concat(D2(t.dtype,n.outputComponent),">;"):"@group(0) @binding(1) var<storage, read> inBuf : array<".concat(D2(e[0].dtype,n.outputComponent),">;"),o=3===t.shape.length?"vec2<i32>":"i32";r.push("\n        struct Uniform {\n          outShapeStrides : ".concat(o,",\n          size            : i32,\n          numChannels     : i32,\n          alpha           : f32,\n        };\n\n        ").concat(a,"\n        @group(0) @binding(2) var<uniform> uniforms: Uniform;\n      "));const i=M2(n);return[O2,r.join("\n"),_2(t.shape),n.getUserCode(),N2(i,n)].join("\n")}let o,i,s="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((t,n)=>{const r=I2(e[n].shape.length);s+="".concat(t.charAt(0).toLowerCase()+t.slice(1),"Shape : ").concat(r,", "),o=e[n].shape.length-1,i=I2(o),s+="".concat(t.charAt(0).toLowerCase()+t.slice(1),"ShapeStrides: ").concat(i,", ")});const c=I2(t.shape.length);s+="outShape : ".concat(c,", "),o=t.shape.length-1,i=I2(o),s+="\n         outShapeStrides: ".concat(i,", "),n.size&&(s+="size : i32, ");n.uniforms&&(s+=n.uniforms);s+="};",s=function(e){const t=/(\w+)\s*:\s*vec(5|6)/g;e=e.replace(t,e=>"@align(16) "+e);const n=/vec(5|6)\s*,\s*(\w+)/g;return e=e.replace(n,(e,t,n)=>"vec".concat(t,", @align(16) ").concat(n))}(s),r.push(s),n.atomic?r.push("\n      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;\n    "):r.push("\n      @group(0) @binding(0) var<storage, read_write> result: array<".concat(D2(t.dtype,n.outputComponent),">;\n    "));n.variableNames.forEach((t,a)=>{r.push("\n      @group(0) @binding(".concat(1+a,") var<storage, read> ").concat(t,": array<").concat(n.variableComponents?D2(e[a].dtype,n.variableComponents[a]):D2(e[a].dtype,n.outputComponent),">;\n        "))}),""!==s&&r.push("\n      @group(0) @binding(".concat(1+n.variableNames.length,") var<uniform> uniforms: Uniforms;\n      "));const l=function(e,t){const{x:n,y:r=[],z:a=[]}=t,o=e.length,i=n.length+r.length+a.length;if(i!==o)return"";if(n.length===o){const e=I2(o);return"fn getOutputCoords() -> ".concat(e,"{\n    let globalIndex = getGlobalIndex();\n    return getCoordsFromIndex(globalIndex);\n  }\n  ")}let s="";const c=[n,r,a];for(let h=0;h<c.length;h++){const e=c[h];if(0!==e.length)if(1===e.length)s+="let d".concat(e[0]," = i32(globalId[").concat(h,"]);");else{const t=x2(e,"uniforms.outShape");s+="var index".concat(h," = i32(globalId[").concat(h,"]);");for(let n=0;n<t.length;n++)s+="let d".concat(e[n]," = index").concat(h," / ").concat(t[n],";"),n===t.length-1?s+="let d".concat(e[n+1]," = ")+"index".concat(h," - d").concat(e[n]," * ").concat(t[n],";"):s+="index".concat(h," = index").concat(h," - d").concat(e[n]," * ").concat(t[n],";")}}const l=[];for(let h=0;h<i;h++)l.push("d".concat(h));const u=I2(i);let d="fn getOutputCoords() -> ".concat(u," {\n  ").concat(s,"\n");0===l.length?d+="return ".concat(u,"(0); }"):d+="return ".concat(u,"(").concat(l.join(","),"); }");return d}(t.shape,n.dispatchLayout),u=[O2,r.join("\n")+A2,_2(t.shape),l,R2(t.shape.length)];n.atomic||u.push(function(e,t,n){const r=e.length,a=D2(t,n);let o="fn setOutputAtIndex(flatIndex : i32, value : ".concat(C2(n),") {\n      result[flatIndex] = ").concat(a,"(value);\n    }\n\n    fn setOutputAtIndexI32(flatIndex : i32, value : ").concat(C2(n,"i32"),") {\n      result[flatIndex] = ").concat(a,"(value);\n    }\n    ");if(r>=2){const e=["d0","d1","d2","d3","d4","d5"].slice(0,r),t=I2(r);o+="\n      fn setOutputAtCoords(".concat(e.map(e=>"".concat(e," : i32")).join(", "),", value : ").concat(C2(n),") {\n        let flatIndex = getOutputIndexFromCoords(").concat(t,"(").concat(e.join(", "),"));\n        setOutputAtIndex(flatIndex").concat(1===n?"":" / ".concat(n),", value);\n      }\n      fn setOutputAtCoordsI32(").concat(e.map(e=>"".concat(e," : i32")).join(", "),", value : ").concat(C2(n,"i32"),") {\n        let flatIndex = getOutputIndexFromCoords(").concat(t,"(").concat(e.join(", "),"));\n        setOutputAtIndexI32(flatIndex").concat(1===n?"":" / ".concat(n),", value);\n      }\n    ")}return o}(t.shape,t.dtype,n.outputComponent));n.variableNames.forEach((t,n)=>{u.push("".concat(_2(e[n].shape,t)))});const d=e.map((e,r)=>function(e,t,n,r){let a=function(e,t){const n=e.name,r=e.shape.length,a=I2(r),o="get"+n.charAt(0).toUpperCase()+n.slice(1),i=["d0","d1","d2","d3","d4","d5"].slice(0,r),s=i.map(e=>"".concat(e," : i32")).join(", ");if(r<1)return"\n      fn ".concat(o,"() -> ").concat(C2(t)," {\n        return ").concat(C2(t),"(").concat(n,"[0]);\n      }\n    ");const c="uniforms.".concat(n.charAt(0).toLowerCase()+n.slice(1),"Shape");let l="".concat(r,"D");0===r&&(l="1D");return"\n    fn ".concat(o,"(").concat(s,") -> ").concat(C2(t)," {\n      return ").concat(C2(t),"(").concat(n,"[getIndexFromCoords").concat(l,"(").concat(a,"(").concat(i.join(","),"),\n        ").concat(c,")").concat(1===t?"":" / ".concat(t),"]);\n    }\n   ")}(e,n);const o=e.shape;o.length<=t.length&&(a+=function(e,t,n,r){const a=e.name,o=a.charAt(0).toUpperCase()+a.slice(1),i="get"+o+"ByOutput",s=e.shape.length,c=t.length,l=I2(c);if(_O(e.shape,t)&&r)return"\n    fn ".concat(i,"Index(globalIndex : i32) -> ").concat(C2(n)," {\n      return ").concat(C2(n),"(").concat(a,"[globalIndex]);\n    }\n\n    fn ").concat(i,"Coords(coords : ").concat(l,") -> ").concat(C2(n)," {\n      return ").concat(C2(n),"(").concat(a,"[").concat(c>1?"getOutputIndexFromCoords(coords)":"coords").concat(1===n?"":" / ".concat(n),"]);\n    }\n    ");const u=IF(e.shape,t),d=c-s;let h="";if(0===s)return"\n    fn ".concat(i,"Index(globalIndex : i32) -> ").concat(C2(n),"{\n      return get").concat(o,"();\n    }\n\n    fn ").concat(i,"Coords(coords : ").concat(l,") -> ").concat(C2(n),"{\n      return get").concat(o,"();\n    }\n  ");h=c<2&&u.length>=1?"coords = 0;":u.map(e=>"coords.".concat(E2(e+d)," = 0;")).join("\n");let p="";if(c<2&&s>0)p="coords";else if(c>1){const t=I2(s),n=e.shape.map((e,t)=>"coords.".concat(E2(t+d))).join(", ");p="".concat(t,"(").concat(n,")")}else p="coords";const f="uniforms.".concat(a.charAt(0).toLowerCase()+a.slice(1),"Shape"),m="".concat(s,"D");return"\n  fn ".concat(i,"Index(globalIndex : i32) -> ").concat(C2(n)," {\n    var coords = getCoordsFromIndex(globalIndex);\n    ").concat(h,"\n    return ").concat(C2(n),"(").concat(a,"[getIndexFromCoords").concat(m,"(").concat(p,", ").concat(f,")").concat(1===n?"":" / ".concat(n),"]);\n  }\n\n  fn ").concat(i,"Coords(coordsIn : ").concat(l,") -> ").concat(C2(n)," {\n    var coords = coordsIn;\n    ").concat(h,"\n    return ").concat(C2(n),"(").concat(a,"[getIndexFromCoords").concat(m,"(").concat(p,", ").concat(f,")").concat(1===n?"":" / ".concat(n),"]);\n  }\n")}(e,t,n,r));return a}(e,t.shape,n.variableComponents?n.variableComponents[r]:n.outputComponent,n.dispatchLayout.x.length===t.shape.length)).join("\n");u.push(d),u.push(n.getUserCode());const h=M2(n);u.push(N2(h,n));const p=u.join("\n");return p}(n,{dtype:r.dtype,shape:r.shape},t),i=e.createShaderModule({code:o,label:t.constructor.name});let s=iA().get("WEBGPU_PRINT_SHADER");if(""!==s){s=s.toLowerCase();const e=s.split(",");("all"===s||e.some(e=>t.shaderKey.toLowerCase().includes(e)))&&(console.group(t.shaderKey),console.debug(o),console.groupEnd())}return a?e.createComputePipelineAsync({compute:{module:i,entryPoint:"_start"},label:t.constructor.name,layout:"auto"}):e.createComputePipeline({compute:{module:i,entryPoint:"_start"},label:t.constructor.name,layout:"auto"})},C2=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"f32";switch(e){case 1:return"".concat(t);case 2:return"vec2<".concat(t,">");case 3:return"vec3<".concat(t,">");case 4:return"vec4<".concat(t,">");default:throw new Error("".concat(e,"-component ").concat(t," is not supported."))}};function I2(e){if(e<=1)return"i32";if(2===e)return"vec2<i32>";if(3===e)return"vec3<i32>";if(4===e)return"vec4<i32>";if(5===e)return"vec5";if(6===e)return"vec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function E2(e){if(0===e)return"x";if(1===e)return"y";if(2===e)return"z";if(3===e)return"w";if(4===e)return"u";if(5===e)return"v";throw Error("Index ".concat(e," is not yet supported"))}function T2(){let e;switch(arguments.length){case 0:e="\n        fn main()\n      ";break;case 1:e="\n        fn main(".concat(arguments.length<=0?void 0:arguments[0]," : i32)\n      ");break;default:throw Error("Unreachable")}return e}function N2(e,t){let n;return n="\n     ".concat(function(e){return"\n  @compute @workgroup_size(".concat(e.workgroupSize[0],", ").concat(e.workgroupSize[1],", ").concat(e.workgroupSize[2],")\n")}(t),"\n      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,\n                @builtin(global_invocation_id) GlobalId : vec3<u32>,\n                @builtin(local_invocation_index) LocalIndex: u32,\n                @builtin(workgroup_id) WorkgroupId : vec3<u32>,\n                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {\n        localId = LocalId;\n        localIndex = LocalIndex;\n        globalId = GlobalId;\n        numWorkgroups = NumWorkgroups;\n        workgroupId = WorkgroupId;\n        ").concat(e?"main(getGlobalIndex());":"main();",";\n      }\n    "),n}const O2="\n  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};\n  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};\n\n  // Checks whether coordinates lie within the bounds of the shape.\n  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {\n    return all(coord >= vec2<i32>(0)) && all(coord < shape);\n  }\n  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {\n    return all(coord >= vec3<i32>(0)) && all(coord < shape);\n  }\n  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {\n    return all(coord >= vec4<i32>(0)) && all(coord < shape);\n  }\n\n  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {\n    return coord;\n  }\n  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {\n    return dot(coords, vec2<i32>(shape.y, 1));\n  }\n  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {\n    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));\n  }\n  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n    return dot(coords, vec4<i32>(\n        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n  }\n  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {\n    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);\n    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;\n  }\n  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {\n    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);\n    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;\n  }\n\n  // NaN defination in IEEE 754-1985 is :\n  //   - sign = either 0 or 1.\n  //   - biased exponent = all 1 bits.\n  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).\n  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers\n  fn isnan(val: f32) -> bool {\n    let floatToUint: u32 = bitcast<u32>(val);\n    return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n  }\n  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {\n    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);\n    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);\n  }\n",A2="\n  fn isinf(val: f32) -> bool {\n    return abs(val) == uniforms.INFINITY;\n  }\n";function _2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e.length,r=""!==t?"get".concat(t.charAt(0).toUpperCase()+t.slice(1),"CoordsFromIndex"):"getCoordsFromIndex",a=""!==t?"".concat(t.charAt(0).toLowerCase()+t.slice(1),"ShapeStrides"):"outShapeStrides";if(n<=1)return"fn ".concat(r,"(index : i32) -> i32 { return index; }");const o=qO(e),i=I2(n),s=[];for(let l=0;l<n;l++)s.push("d".concat(l));if(1===o.length)return"    fn ".concat(r,"(index : i32) -> vec2<i32> {\n      let d0 = index / uniforms.").concat(a,"; let d1 = index - d0 * uniforms.").concat(a,";\n      return vec2<i32>(d0, d1);\n    }");let c;return c="var index2 = index;"+o.map((e,t)=>{const n="let ".concat(s[t]," = index2 / uniforms.").concat(a,".").concat(E2(t)),r=t===o.length-1?"let ".concat(s[t+1]," = index2 - ").concat(s[t]," * uniforms.").concat(a,".").concat(E2(t)):"index2 = index2 - ".concat(s[t]," * uniforms.").concat(a,".").concat(E2(t));return"".concat(n,"; ").concat(r,";")}).join(""),"\n    fn ".concat(r,"(index : i32) -> ").concat(i," {\n      ").concat(c,"\n      return ").concat(i,"(").concat(s.join(","),");\n    }\n  ")}function R2(e){let t="";switch(e){case 0:case 1:t+="\n        fn getOutputIndexFromCoords(coords : i32) -> i32 {\n          return coords;\n        }\n        ";break;case 2:t+="\n        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {\n          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));\n        }\n        ";break;case 3:t+="\n        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {\n          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));\n        }\n        ";break;case 4:t+="\n        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n          return dot(coords, vec4<i32>(\n            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));\n        }\n        ";break;case 5:t+="\n        fn getOutputIndexFromCoords(coords : vec5) -> i32 {\n          return coords.x * uniforms.outShapeStrides.x +\n              coords.y * uniforms.outShapeStrides.y +\n              coords.z * uniforms.outShapeStrides.z +\n              coords.w * uniforms.outShapeStrides.w +\n              coords.u;\n        }\n        ";break;case 6:t+="\n        fn getOutputIndexFromCoords(coords : vec6) -> i32 {\n          return coords.x * uniforms.outShapeStrides.x +\n              coords.y * uniforms.outShapeStrides.y +\n              coords.z * uniforms.outShapeStrides.z +\n              coords.w * uniforms.outShapeStrides.w +\n              coords.u * uniforms.outShapeStrides.u +\n              coords.v;\n        }\n        ";break;default:EO(!1,()=>"Unsupported ".concat(e,"D shape"))}return t}function P2(e){return 1===e.dispatch[1]&&1===e.dispatch[2]}function D2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if("float32"===e)return C2(t,"f32");if("int32"===e||"bool"===e)return C2(t,"i32");throw new Error("type ".concat(e," is not supported."))}function M2(e){return(!e.dispatchLayout.hasOwnProperty("y")||0===e.dispatchLayout.y.length)&&(!e.dispatchLayout.hasOwnProperty("z")||0===e.dispatchLayout.z.length)}const F2=e=>{let t=1;for(let n=0;n<e.length;n++)t*=e[n];return t};function L2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1];const[a,o,i]=[Math.ceil(F2(e.x.map(e=>t[e]))/(n[0]*r[0])),e.y?Math.ceil(F2(e.y.map(e=>t[e]))/(n[1]*r[1])):1,e.z?Math.ceil(F2(e.z.map(e=>t[e]))/(n[2]*r[2])):1];return[a,o,i]}function z2(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return[8,8,1];const n=F2(e.x.map(e=>t[e])),r=F2(e.y.map(e=>t[e]));return n<=4?[4,16,1]:r<=4?[16,4,1]:[16,16,1]}function B2(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return[4,4,1];const n=F2(e.x.map(e=>t[e])),r=F2(e.y.map(e=>t[e]));return n<=4?[1,2,1]:r<=4?[2,1,1]:[2,2,1]}function j2(e){return{x:e.map((e,t)=>t)}}function W2(e){if("float32"===e||"int32"===e||"bool"===e||"string"===e)return 4;if("complex64"===e)return 8;throw new Error("Unknown dtype ".concat(e))}function U2(){return!("undefined"===typeof globalThis||!globalThis.navigator||!globalThis.navigator.gpu)}function V2(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{null!=e&&EO("complex64"!==e.dtype,()=>"".concat(t," does not support complex64 tensors ")+"in the WebGPU backend.")})}var G2;!function(e){e[e.MatMulReduceProgram=0]="MatMulReduceProgram",e[e.MatMulSplitKProgram=1]="MatMulSplitKProgram",e[e.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",e[e.MatMulPackedProgram=3]="MatMulPackedProgram",e[e.MatMulMax=4]="MatMulMax"}(G2||(G2={}));const H2=iA().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD");class K2 extends xO{nextDataId(){return K2.nextDataId++}constructor(e,t){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!U2())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new f2(t),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new m2(this.device),this.textureManager=new y2(this.device),this.tensorMap=new bO(this,qD()),iA().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.tensorMap.has(e))return!0;const n=this.tensorMap.get(e);return t?n.refCount=0:n.refCount--,!(n.refCount>0)&&(null!=n.complexTensorInfos&&(this.disposeData(n.complexTensorInfos.real.dataId),this.disposeData(n.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const t=this.tensorMap.get(e);t&&t.resource&&(t.external||(t.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(t.resource):t.resource instanceof GPUTexture&&this.textureManager.releaseTexture(t.resource)),t.resource=null)}refCount(e){if(this.tensorMap.has(e)){return this.tensorMap.get(e).refCount}return 0}incRef(e){this.tensorMap.get(e).refCount++}decRef(e){if(this.tensorMap.has(e)){this.tensorMap.get(e).refCount--}}write(e,t,n){if("complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.tensorMap.set(r,{dtype:n,shape:t,values:e,refCount:1}),r}move(e,t,n,r,a){if("complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:r,shape:n,values:t,refCount:a})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(t){throw new Error(t.message)}Object.keys(this.pipelineCache).map((t,n)=>{this.pipelineCache[t]=e[n]})}async getBufferData(e){if(iA().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const t=e.size,n=this.bufferManager.acquireBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,n,0,t),this.submitQueue(),await n.mapAsync(GPUMapMode.READ);const r=n.getMappedRange().slice(0);return n.unmap(),null!=n&&this.bufferManager.releaseBuffer(n),iA().getBool("WEBGPU_USE_PROFILE_TOOL")&&(EO(void 0!==this.dummyContext,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),r}convertAndCacheOnCPU(e,t){const n=this.tensorMap.get(e);return n.values=t,n.values}readSync(e){const t=this.tensorMap.get(e),{values:n,complexTensorInfos:r}=t;if(null!=n||"string"===t.dtype)return n;if("complex64"===t.dtype){const t=QO(dV(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)).buffer,"float32");return this.convertAndCacheOnCPU(e,t),t}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const a=["opaque","premultiplied"],o=t.resource,i=o.size;EO(i%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const s=i/4,c=new ArrayBuffer(i),l=256,u=256,d=a.map(e=>new OffscreenCanvas(l,u)),h=new OffscreenCanvas(l,u);this.endComputePassEncoder(),d.map((e,t)=>{const n=e.getContext("webgpu");return n.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:a[t]}),n.getCurrentTexture()}).map((e,t)=>{const n=(n,r,i)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:o,bytesPerRow:1024,offset:i},{texture:e},{width:n,height:r}),this.submitQueue();const s=h.getContext("2d",{willReadFrequently:!0});s.clearRect(0,0,n,r),s.drawImage(d[t],0,0);const l=s.getImageData(0,0,n,r).data,u=a[t],p=new Uint8ClampedArray(c,i,n*r*4);for(let e=0;e<p.length;e+=4)if("premultiplied"===u)p[e+3]=l[e+3];else{const t=l[e];p[e]=l[e+2],p[e+1]=l[e+1],p[e+2]=t}},r=Math.floor(s/65536);let i=l,p=u,f=0;for(let a=0;a<r;a++)n(i,p,f),f+=262144;const m=s%65536;p=Math.floor(m/l),p>0&&(n(i,p,f),f+=1024*p),i=m%l,i>0&&n(i,1,f)});const p=QO(c,t.dtype);return this.convertAndCacheOnCPU(e,p),p}async read(e){if(!this.tensorMap.has(e))throw new Error("Tensor ".concat(e," was not registered!"));const t=this.tensorMap.get(e),{values:n}=t;if(null!=n)return n;let r;if("complex64"===t.dtype){const e=await Promise.all([this.read(t.complexTensorInfos.real.dataId),this.read(t.complexTensorInfos.imag.dataId)]);r=dV(e[0],e[1])}else{r=QO(await this.getBufferData(t.resource),t.dtype)}return this.convertAndCacheOnCPU(e,r),r}copyBuffer(e){const t=e.size,n=e.usage,r=this.bufferManager.acquireBuffer(t,n);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,t),this.submitQueue(),r}createTensorFromGPUData(e,t,n){let r=e.buffer;if("complex64"===n)throw new Error("Cannot write to a complex64 dtype. ");const a={id:this.nextDataId()};this.tensorMap.set(a,{dtype:n,shape:t,values:null,refCount:1,external:e.zeroCopy});const o=this.tensorMap.get(a),i=W2(o.dtype)*OO(o.shape);if(e.buffer.size<i)throw new Error("GPUBuffer size(".concat(e.buffer.size,") is smaller than tensor size(").concat(i,")!"));if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return!0!==e.zeroCopy&&(r=this.copyBuffer(r)),o.resource=r,qD().makeTensorFromDataId(a,t,n,this)}readToGPU(e){const t=this.tensorMap.get(e),{values:n,dtype:r,shape:a,resource:o}=t;if("complex64"===r)throw new Error("Does not support reading buffer for complex64 dtype.");if(null==o)throw null!=n?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const i=o,s=i.size,c=i.usage,l=this.bufferManager.acquireBuffer(s,c);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,l,0,s),this.submitQueue();const u=this.makeTensorInfo(a,r),d=qD().makeTensorFromTensorInfo(u);return this.tensorMap.get(u.dataId).resource=l,{tensorRef:d,buffer:l}}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map(e=>XP(e));return nF(e.shape,e.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return nF(e.shape,e.dtype,t)}async time(e){this.supportTimestampQuery||this.hasTimestampQueryWarned||(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const a=QP(this.activeTimers.map(e=>e.query)).filter(e=>null!=e),o=QP(this.activeTimers.map(e=>e.name)).filter(e=>null!=e);this.activeTimers=t,r&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},s=await Promise.all(a);return i.kernelMs=IO(s),i.getExtraProfileInfo=()=>s.map((e,t)=>({name:o[t],ms:e})).map(e=>"".concat(e.name,": ").concat(e.ms)).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,i}makeTensorInfo(e,t,n){"string"===t&&null!=n&&n.length>0&&VO(n[0])&&(n=n.map(e=>qP(e)));return{dataId:this.write(n,e,t),shape:e,dtype:t}}tensorToBinding(e){if(!e)return null;const t=this.tensorMap.get(e.dataId).resource;return t instanceof GPUBuffer?{buffer:t}:t instanceof GPUTexture?t.createView():t}uploadToGPU(e){const t=this.tensorMap.get(e);if(null!=t.resource)return;const n=W2(t.dtype)*OO(t.shape);let r;const a=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(t.values){if(r=this.bufferManager.acquireBuffer(n,a,!0),"unmapped"===r.mapState){const e=this.bufferManager.acquireBuffer(n,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),a=e.getMappedRange();"int32"===t.dtype||"bool"===t.dtype?new Int32Array(a).set(t.values):new Float32Array(a).set(t.values),e.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,n),this.stagingPendingDisposal.push(e)}else{const e=r.getMappedRange();"int32"===t.dtype||"bool"===t.dtype?new Int32Array(e).set(t.values):new Float32Array(e).set(t.values),r.unmap()}t.values=null}else r=this.bufferManager.acquireBuffer(n,a);t.resource=r}makeUniforms(e){let t=0,n=0;const r=[];let a=1;e.forEach(e=>{let o;switch(0===e.data.length&&(e.data=[1]),e.data.length){case 1:o=4;break;case 2:o=8;break;case 3:case 4:case 5:case 6:o=16;break;default:EO(!1,()=>"Unsupported ".concat(e.data.length,"D shape"))}5!==n&&6!==n||(o=16),o>a&&(a=o),t=Math.ceil(t/o)*o,n=e.data.length,r.push(t),t+=4*e.data.length}),t=Math.ceil(t/a)*a;const o=new ArrayBuffer(t);e.forEach((e,t)=>{const n=r[t];"int32"===e.type?new Int32Array(o,n,e.data.length).set(e.data):"uint32"===e.type?new Uint32Array(o,n,e.data.length).set(e.data):new Float32Array(o,n,e.data.length).set(e.data)});const i=this.bufferManager.acquireBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(i,0,o,0,t),this.uniformPendingDisposal.push(i),{offset:0,size:t,buffer:i}}runWebGPUProgram(e,t,n,r,a){if(a||(a=this.makeTensorInfo(e.outputShape,n)),0===OO(a.shape))return this.tensorMap.get(a.dataId).values=BO(a.dtype,0),a;this.uploadToGPU(a.dataId),e.dispatch=((e,t)=>{const n=e.limits.maxComputeWorkgroupsPerDimension,r=t.dispatchLayout,a=t.dispatch;if(a.every(e=>e<=n))return a;EO(a[0]>n&&void 0===r.y&&void 0===r.z,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let o=Math.ceil(Math.sqrt(a[0]));return o>n?(o=Math.ceil(Math.cbrt(a[0])),EO(o<=n,()=>"Total dispatch size exceeds WebGPU maximum."),[o,o,o]):[o,o,1]})(this.device,e);const o=t.map((t,n)=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(t.dataId),{dtype:this.tensorMap.get(t.dataId).dtype,shape:t.shape,name:e.variableNames[n]}});e.shaderKey=function(e,t,n){let r=e.shaderKey;if(null!=e.pixelsOpType)return r;const a=[],o=[];t.forEach(e=>{a.push(e.shape),o.push(e.dtype)}),a.push(n.shape),o.push(n.dtype);const i=t.map(e=>IF(e.shape,n.shape)),s=t.map(e=>_O(e.shape,n.shape)).join("_"),c=i.map(e=>e.join("_")).join(";"),l=P2(e)?"flatDispatch":"";return r+="_"+(e.workgroupSize?e.workgroupSize.join(","):"")+a.map(e=>e.length).join(",")+o.join(",")+e.variableNames.join(",")+c+s+l,r}(e,o,a);const i=iA().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=S2(this.device,e,o,a,i)),e.pipeline=this.pipelineCache[e.shaderKey],i||this.recordAndSubmit(e,a,t,r),a}recordAndSubmit(e,t,n,r){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let a=[],o=[];const i="int32";if(null==e.pixelsOpType){a.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),o=n.concat(t).map(e=>e.shape);const e="int32";o.map(t=>{a.push({type:e,data:t});const n=qO(t);a.push({type:e,data:n})})}else{const e=qO(t.shape);a.push({type:i,data:e})}if(e.size){const t=OO(e.outputShape);a.push({type:i,data:[e.outputComponent?t/e.outputComponent:t]})}r&&(a=[...a,...r]);const s=[this.tensorToBinding(t),...n.map(e=>this.tensorToBinding(e)),this.makeUniforms(a)];n.forEach(e=>{this.commandQueueOwnedIds.add(e.dataId)}),this.commandQueueOwnedIds.add(t.dataId);const c=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:s.map((e,t)=>({binding:t,resource:e}))}),l=null!=this.activeTimers;this.ensureCommandEncoderReady();const u={};l&&this.supportTimestampQuery?(this.endComputePassEncoder(),null==this.querySet&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),u.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(u)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(u)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,c),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(l||iA().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===k2.DRAW)&&(this.endComputePassEncoder(),l?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;null==this.queryResolveBuffer&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(8*this.querySetCount,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,8*this.querySetCount),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const t=new BigUint64Array(e.getMappedRange()),n=Number(t[1]-t[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),n}shouldExecuteOnCPU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H2;return iA().getBool("WEBGPU_CPU_FORWARD")&&e.every(e=>null==this.tensorMap.get(e.dataId).resource&&OO(e.shape)<t)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(null!=this.querySet&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}var q2;K2.nextDataId=0,U2()&&$D("webgpu",async()=>{const e={powerPreference:iA().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},t=await navigator.gpu.requestAdapter(e),n={},r=[];t.features.has("timestamp-query")&&r.push("timestamp-query"),t.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),n.requiredFeatures=r;const a=t.limits;n.requiredLimits={maxComputeWorkgroupStorageSize:a.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:a.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:a.maxStorageBufferBindingSize,maxBufferSize:a.maxBufferSize,maxComputeWorkgroupSizeX:a.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:a.maxComputeInvocationsPerWorkgroup};const o=await t.requestDevice(n),i="info"in t?t.info:"requestAdapterInfo"in t?await t.requestAdapterInfo():void 0;return new K2(o,i)},3),function(e){e[e.ADD=0]="ADD",e[e.ATAN2=1]="ATAN2",e[e.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",e[e.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",e[e.DIV=4]="DIV",e[e.ELU_DER=5]="ELU_DER",e[e.EQUAL=6]="EQUAL",e[e.FLOOR_DIV=7]="FLOOR_DIV",e[e.GREATER=8]="GREATER",e[e.GREATER_EQUAL=9]="GREATER_EQUAL",e[e.LESS=10]="LESS",e[e.LESS_EQUAL=11]="LESS_EQUAL",e[e.LOGICAL_AND=12]="LOGICAL_AND",e[e.LOGICAL_OR=13]="LOGICAL_OR",e[e.MAX=14]="MAX",e[e.MIN=15]="MIN",e[e.MOD=16]="MOD",e[e.MUL=17]="MUL",e[e.NOT_EQUAL=18]="NOT_EQUAL",e[e.POW=19]="POW",e[e.PRELU=20]="PRELU",e[e.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",e[e.SUB=22]="SUB"}(q2||(q2={}));function X2(e,t){let n;do{switch(e){case q2.ATAN2:n="let resultTemp = atan2(a, b);";break;case q2.MAX:n="let resultTemp = max(a, b);";break;case q2.MIN:n="let resultTemp = min(a, b);";break;case q2.MOD:n=t?"\n  let isNaN = !vec4<bool>(b);\n  var resultTemp = vec4<f32>(a % b);\n  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {\n    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];\n  }\n  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {\n    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];\n  }\n  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {\n    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];\n  }\n  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {\n    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];\n  }\n":"\n  let isNaN = b == 0.;\n  var resultTemp = a % b;\n  resultTemp = select((resultTemp + b) % b, resultTemp,\n      (a < 0. && b < 0.) || (a >= 0. && b > 0.));\n";break;case q2.NOT_EQUAL:n=t?"\n  var resultTemp = vec4<f32>(a != b);\n  let valueForNaN = 1.0;\n":"\n  var resultTemp = f32(a != b);\n  let valueForNaN = 1.0;\n";break;case q2.POW:n=t?"\n  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);\n  let isModRound1 = vec4<f32>(isModRound1Bool);\n  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);\n  var resultTemp = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  let isExpZero = b == vec4<f32>(0.0);\n  if (isExpZero.r) {\n    resultTemp.r = 1.0;\n  }\n  if (isExpZero.g) {\n    resultTemp.g = 1.0;\n  }\n  if (isExpZero.b) {\n    resultTemp.b = 1.0;\n  }\n  if (isExpZero.a) {\n    resultTemp.a = 1.0;\n  }\n  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);\n":"\n  let isNaN = a < 0.0 && floor(b) < b;\n  if (b == 0.0) {\n    return 1.0;\n  }\n  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),\n      round(abs(b) % 2.0) != 1.0);\n";break;default:continue}let r,a,o;return t?(r="isnanVec4",a="vec4<f32>",o="vec4<bool>"):(r="isnan",a="f32",o="bool"),"\n      let aIsNaN = ".concat(r,"(a);\n      let aPostLegalization = select(a, ").concat(a,"(42), aIsNaN);\n      let bIsNaN = ").concat(r,"(b);\n      let bPostLegalization = select(b, ").concat(a,"(42), bIsNaN);\n      let isNaN = false;\n      let valueForNaN = uniforms.NAN;\n      {\n        let a = aPostLegalization;\n        let b = bPostLegalization;\n        ").concat(n,"\n        return select(\n            resultTemp, ").concat(a,"(valueForNaN),\n            ").concat(o,"(isNaN) | aIsNaN | bIsNaN);\n      }\n    ")}while(0);switch(e){case q2.ADD:n="let resultTemp = a + b;";break;case q2.COMPLEX_MULTIPLY_IMAG:n="let resultTemp = areal * bimag + aimag * breal;";break;case q2.COMPLEX_MULTIPLY_REAL:n="let resultTemp = areal * breal - aimag * bimag;";break;case q2.DIV:n="let resultTemp = a / b;";break;case q2.ELU_DER:n="let resultTemp = select(a * (b + 1.0), a, b >= b - b);";break;case q2.EQUAL:n="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a == b);\n";break;case q2.FLOOR_DIV:n="\n  let remainder =\n      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));\n  let quotient = (a - remainder) / b;\n  let resultTemp =\n      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));\n";break;case q2.GREATER:n="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a > b);\n";break;case q2.GREATER_EQUAL:n="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a >= b);\n";break;case q2.LESS:n="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a < b);\n";break;case q2.LESS_EQUAL:n="\n  let zero = sign(a) * 0 + 0;\n  let one = sign(b) * 0 + 1;\n  let resultTemp = select(zero, one, a <= b);\n";break;case q2.LOGICAL_AND:return t?"return (vec4<f32>(a >= vec4<f32>(1.0)) *\n  vec4<f32>(b >= vec4<f32>(1.0)));":"return f32(a >= 1.0 && b >= 1.0);";case q2.LOGICAL_OR:return t?"return min(vec4<f32>(a >= vec4<f32>(1.0)) +\n  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));":"return f32(a >= 1.0 || b >= 1.0);";case q2.MUL:n="let resultTemp = a * b;";break;case q2.PRELU:return t?"\n  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));\n  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);\n":"if (a < 0.0) { return b * a; }  return a;";case q2.SQUARED_DIFFERENCE:n="let resultTemp = (a - b) * (a - b);";break;case q2.SUB:n="let resultTemp = a - b;"}return"\n    ".concat(n,"\n    return resultTemp;\n  ")}var Y2;!function(e){e[e.ABS=0]="ABS",e[e.ACOS=1]="ACOS",e[e.ACOSH=2]="ACOSH",e[e.ASIN=3]="ASIN",e[e.ASINH=4]="ASINH",e[e.ATAN=5]="ATAN",e[e.ATANH=6]="ATANH",e[e.CEIL=7]="CEIL",e[e.COS=8]="COS",e[e.COSH=9]="COSH",e[e.ELU=10]="ELU",e[e.ERF=11]="ERF",e[e.EXP=12]="EXP",e[e.EXPM1=13]="EXPM1",e[e.FLOOR=14]="FLOOR",e[e.IS_FINITE=15]="IS_FINITE",e[e.IS_INF=16]="IS_INF",e[e.IS_NAN=17]="IS_NAN",e[e.LINEAR=18]="LINEAR",e[e.LOG=19]="LOG",e[e.LOG1P=20]="LOG1P",e[e.LOGICAL_NOT=21]="LOGICAL_NOT",e[e.NEG=22]="NEG",e[e.RELU=23]="RELU",e[e.RELU6=24]="RELU6",e[e.LEAKYRELU=25]="LEAKYRELU",e[e.RECIPROCAL=26]="RECIPROCAL",e[e.ROUND=27]="ROUND",e[e.RSQRT=28]="RSQRT",e[e.SELU=29]="SELU",e[e.SIGMOID=30]="SIGMOID",e[e.SIGN=31]="SIGN",e[e.SIN=32]="SIN",e[e.SINH=33]="SINH",e[e.SOFTPLUS=34]="SOFTPLUS",e[e.SQRT=35]="SQRT",e[e.SQUARE=36]="SQUARE",e[e.STEP=37]="STEP",e[e.TAN=38]="TAN",e[e.TANH=39]="TANH",e[e.TO_INT=40]="TO_INT"}(Y2||(Y2={}));const Q2='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  let p = '.concat(oV,";\n  let a1 = ").concat(iV,";\n  let a2 = ").concat(sV,";\n  let a3 = ").concat(cV,";\n  let a4 = ").concat(lV,";\n  let a5 = ").concat(uV,";\n\n  let sign = sign(a);\n  let absA = abs(a);\n  let t = 1.0 / (1.0 + p * absA);\n  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));\n"),Z2="\n  if (a >= 0.0) {\n    return ".concat(aV," * a;\n  } else {\n    return ").concat(rV," * (exp(a) - 1.0);\n  }\n");function $2(e,t){switch(e){case Y2.ABS:return"return abs(a);";case Y2.ACOS:return"\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  return acos(a);\n";case Y2.ACOSH:return"\n  if (a < 1.) {\n    return uniforms.NAN;\n  }\n  return acosh(a);\n";case Y2.ASIN:return"\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  return asin(a);\n";case Y2.ASINH:return"return asinh(a);";case Y2.ATAN:return"\n  if (isnan(a)) {\n    return uniforms.NAN;\n  }\n  return atan(a);\n";case Y2.ATANH:return"\n  if (abs(a) > 1.) {\n    return uniforms.NAN;\n  }\n  if (a == 1.) {\n    return uniforms.INFINITY;\n  }\n  if (a == -1.) {\n    return -uniforms.INFINITY;\n  }\n  return atanh(a);\n";case Y2.COS:return"return cos(a);";case Y2.COSH:return"\n  let e2x = exp(-a);\n  return (e2x + 1.0 / e2x) / 2.0;\n";case Y2.CEIL:return"return ceil(a);";case Y2.ELU:return t?"\n  var resFloat = exp(a) - vec4<f32>(1.0);\n  if (a.r >= 0.0) {\n    resFloat.r = a.r;\n  }\n  if (a.g >= 0.0) {\n    resFloat.g = a.g;\n  }\n  if (a.b >= 0.0) {\n    resFloat.b = a.b;\n  }\n  if (a.a >= 0.0) {\n    resFloat.a = a.a;\n  }\n  return resFloat;\n":"if (a >= 0.0) { return a; }  return (exp(a) - 1.0);";case Y2.ERF:return Q2;case Y2.EXP:return"return exp(a);";case Y2.EXPM1:return"return exp(a) - 1.0;";case Y2.FLOOR:return"return floor(a);";case Y2.IS_FINITE:return"return f32(!isnan(a) && !isinf(a));";case Y2.IS_INF:return"return f32(isinf(a));";case Y2.IS_NAN:return"return f32(isnan(a));";case Y2.LINEAR:return"return a;";case Y2.LOG:return"if (a < 0.0) { return uniforms.NAN; }\n  return log(a);";case Y2.LOG1P:return"\n  if (isnan(a)) { return a; }\n  return log(1.0 + a);\n";case Y2.LOGICAL_NOT:return"return f32(!(a >= 1.0));";case Y2.NEG:return"return -a;";case Y2.LEAKYRELU:return t?"\n  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));\n  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);\n":"if (a < 0.0) { return uniforms.alpha * a; } return a;";case Y2.RECIPROCAL:return"return 1.0 / a;";case Y2.RELU:return t?"\n  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));\n":"return select(a, 0.0, a < 0.0);";case Y2.RELU6:return t?"return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));":"return clamp(a, 0.0, 6.0);";case Y2.ROUND:return"return round(a);";case Y2.RSQRT:return"return inverseSqrt(a);";case Y2.SELU:return Z2;case Y2.SIGMOID:return"return 1.0 / (1.0 + exp(-1.0 * a));";case Y2.SIGN:return"return sign(a);";case Y2.SIN:return"return sin(a);";case Y2.SINH:return"\n  let e2x = exp(a);\n  return (e2x - 1.0 / e2x) / 2.0;\n";case Y2.SOFTPLUS:return"\n  let epsilon = 1.1920928955078125e-7;\n  let threshold = log(epsilon) + 2.0;\n\n  let too_large = a > -threshold;\n  let too_small = a < threshold;\n  let exp_a = exp(a);\n\n  if (too_large) {\n    return a;\n  } else if (too_small) {\n    return exp_a;\n  } else {\n    return log(exp_a + 1.0);\n  }\n";case Y2.SQRT:return"return sqrt(a);";case Y2.SQUARE:return"return a * a;";case Y2.STEP:return"\n  if (isnan(a)) {\n    return a;\n  }\n\n  return select(uniforms.stepAlpha, 1.0, a > 0.0);\n";case Y2.TAN:return"return tan(a);";case Y2.TANH:return"\n  let e2x = exp(-2.0 * abs(a));\n  return sign(a) * (1.0 - e2x) / (1.0 + e2x);\n";case Y2.TO_INT:return"return f32(i32((a)));";default:throw new Error("BinaryType ".concat(e," is not implemented!"))}}function J2(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;if(null===e)return"";let a="";if("linear"===e)a=$2(Y2.LINEAR);else if("relu"===e)a=$2(Y2.RELU,n);else if("elu"===e)a=$2(Y2.ELU,n);else if("relu6"===e)a=$2(Y2.RELU6,n);else if("prelu"===e)a=X2(q2.PRELU,n);else if("sigmoid"===e)a=$2(Y2.SIGMOID,n);else{if("leakyrelu"!==e)throw new Error("Activation ".concat(e," has not been implemented for the WebGPU backend."));a=$2(Y2.LEAKYRELU,n)}const o=C2(n?4:1);let i="";return i=t?"\n      fn activation(a : ".concat(o,", coords : vec").concat(r,"<i32>) -> ").concat(o," {\n        let b = getPreluActivationWeightsByOutputCoords(coords);\n        ").concat(a,"\n      }"):"\n      fn activation(a : ".concat(o,", coords : vec").concat(r,"<i32>) -> ").concat(o," {\n        ").concat(a,"\n      }"),i}function e3(e,t){return"\n      ".concat(e?"value = value + getBiasByOutputCoords(coords);":"","\n      ").concat(t?"value = activation(value, coords);":"","\n      ")}function t3(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;EO(e&&1===a||!e,()=>"transposeA ".concat(e," is not compatible with component size ").concat(a));const o="\n      ".concat(e?"value = getA(batch, col, row);":"value = getA(batch, row, col);","\n\n    "),i=t?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return"\n  fn mm_readA(batch: i32, row: i32, col: i32) -> ".concat(C2(a)," {\n    var value = ").concat(C2(a),"(0.0);\n    ").concat(n&&r?o:"\n    ".concat(e?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])","\n    {\n      ").concat(o,"\n    }\n    "),"\n    return value;\n  }\n\n  fn mm_readB(batch: i32, row: i32, col: i32) -> ").concat(C2(a)," {\n    var value = ").concat(C2(a),"(0.0);\n    ").concat(i,"\n    return value;\n  }\n  ")}function n3(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1;return"\n  ".concat(t3(n,r,a,o,arguments.length>6&&void 0!==arguments[6]&&arguments[6],i),"\n  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ").concat(C2(i),") {\n    ").concat(a&&o?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)","\n    {\n      var value = valueIn;\n      let coords = vec3<i32>(batch, row, col);\n      ").concat(e3(e,t),"\n      setOutputAtCoords(coords[0], coords[1], coords[2], value);\n    }\n  }\n  ")}function r3(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];const s=t[1]*e[1],c=t[0]*e[0],l=n?s:r,u=n?r:s,d=l/t[0],h=r/t[1],p=e[1],f=e[0];return EO((n&&4===d&&4===e[1]||!n&&(3===d||4===d))&&l%t[0]===0&&r%t[1]===0&&4===e[0],()=>"If transposeA ".concat(n," is true, innerElementSize ").concat(d," and workPerThread[1] ").concat(e[1]," must be 4.\n          Otherwise, innerElementSize ").concat(d," must be 3 or 4.\n      tileAWidth ").concat(l," must be divisible by workgroupSize[0]").concat(t[0],". tileInner ").concat(r," must be divisible by workgroupSize[1] ").concat(t[1],". colPerThread ").concat(e[0]," must be 4.")),"\n  var<workgroup> mm_Asub : array<array<vec".concat(d,"<f32>, ").concat(l/d,">, ").concat(u,">;\n  var<workgroup> mm_Bsub : array<array<vec4<f32>, ").concat(c/e[0],">, ").concat(r,">;\n\n  ").concat(T2()," {\n    let localRow = i32(localId.y);\n    let tileRow = localRow * ").concat(p,";\n    let tileCol = i32(localId.x);\n\n    let globalRow = i32(globalId.y) * ").concat(p,";\n    let globalCol = i32(globalId.x) * ").concat(f,";\n    let batch = ").concat(a?"0":"i32(globalId.z)",";\n    let batchA = ").concat(a||!i?"batch":"batch % uniforms.aShape[0]",";\n    let batchB = ").concat(a||!i?"batch":"batch % uniforms.bShape[0]",";\n    let globalRowStart = i32(workgroupId.y) * ").concat(s,";\n\n    let numTiles = ").concat(a?"".concat(Math.ceil(o/r)):"(uniforms.dimInner - 1) / ".concat(r," + 1"),";\n    var kStart = ").concat(a?"i32(globalId.z) * ".concat(o):"0",";\n\n    var acc: array<vec4<f32>, ").concat(p,">;\n\n    // Loop over shared dimension.\n    let tileRowB = localRow * ").concat(h,";\n    for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        for (var innerRow = 0; innerRow < ").concat(p,"; innerRow++) {\n            let inputRow = tileRow + innerRow;\n            let inputCol = tileCol;\n            ").concat(((e,t)=>e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          kStart + inputRow,\n          globalRowStart + inputCol * ".concat(t,");\n        "):"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          globalRow + innerRow,\n          kStart + inputCol * ".concat(t,");\n        "))(n,d),"\n        }\n\n        // Load one tile of B into local memory.\n        for (var innerRow = 0; innerRow < ").concat(h,"; innerRow++) {\n            let inputRow = tileRowB + innerRow;\n            let inputCol = tileCol;\n            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);\n        }\n        kStart = kStart + ").concat(r,";\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        ").concat(((e,t,n,r)=>{if(e)return"\n      for (var k = 0; k < ".concat(r,"; k++) {\n        let BCached0 = mm_Bsub[k][tileCol];\n        let ACached0 = mm_Asub[k][localRow];\n        for (var i = 0; i < ").concat(n,"; i++) {\n          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);\n        }\n      }");{let e="",a="";for(let n=0;n<t;n++)e+="let BCached".concat(n," = mm_Bsub[k * ").concat(t," + ").concat(n,"][tileCol];"),a+="acc[i] = fma(BCached".concat(n,", vec4<f32>(ACached[").concat(n,"]), acc[i]);");return"\n      for (var k = 0; k < ".concat(r/t,"; k++) {\n        ").concat(e,"\n        for (var i = 0; i < ").concat(n,"; i++) {\n          let ACached = mm_Asub[tileRow + i][k];\n          ").concat(a,"\n        }\n      }")}})(n,d,p,r),"\n        workgroupBarrier();\n    }\n\n    for (var innerRow = 0; innerRow < ").concat(p,"; innerRow++) {\n        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n    }\n  }")}const a3=e=>e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          kStart + inputRow,\n          globalRowStart + inputCol);\n        ":"\n        mm_Asub[inputRow][inputCol] = mm_readA(batchA,\n          globalRowStart + inputRow,\n          kStart + inputCol);\n        ";function o3(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const c=e[1]*t[1],l=e[0]*t[0],u=n?c:r,d=n?r:c;EO(d%t[1]===0&&u%t[0]===0&&r%t[1]===0,()=>"tileAHight ".concat(d," must be divisible by workgroupSize[1]").concat(t[1],", tileAWidth ").concat(u," must be divisible by workgroupSize[0]").concat(t[0],", tileInner ").concat(r," must be divisible by workgroupSize[1]").concat(t[1]));const h=d/t[1],p=u/t[0],f=r/t[1],m=e[1],g=e[0],y=i?"\n      let localRow = i32(localId.y);\n      let localCol = i32(localId.x);\n      let globalRowStart = i32(workgroupId.y) * ".concat(c,";\n      let globalColStart = i32(workgroupId.x) * ").concat(l,";\n\n      // Loop over shared dimension.\n      for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(d,"; inputRow = inputRow + ").concat(t[1],") {\n          for (var inputCol = localCol; inputCol < ").concat(u,"; inputCol = inputCol + ").concat(t[0],") {\n            ").concat(a3(n),"\n          }\n        }\n        // Load one tile of B into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(r,"; inputRow = inputRow + ").concat(t[1],") {\n              for (var inputCol = localCol; inputCol < ").concat(l,"; inputCol = inputCol + ").concat(t[0],") {\n            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,\n              kStart + inputRow,\n              globalColStart + inputCol);\n          }\n        }\n        kStart = kStart + ").concat(r,";\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        var BCached : array<f32, ").concat(g,">;\n        for (var k = 0; k < ").concat(r,"; k++) {\n          for (var inner = 0; inner < ").concat(g,"; inner++) {\n            BCached[inner] = mm_Bsub[k][localCol + inner * ").concat(t[0],"];\n          }\n          for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n            let ACached = ").concat(n?"mm_Asub[k][localRow + innerRow * ".concat(t[1],"];"):"mm_Asub[localRow + innerRow * ".concat(t[1],"][k];"),"\n            for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n              acc[innerRow][innerCol] =\n                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);\n            }\n          }\n        }\n        workgroupBarrier();\n      }\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        let gRow = globalRowStart + localRow + innerRow * ").concat(t[1],";\n        for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n          let gCol = globalColStart + localCol + innerCol * ").concat(t[0],";\n          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n        }\n      }\n      "):"\n  let tileRow = i32(localId.y) * ".concat(m,";\n  let tileCol = i32(localId.x) * ").concat(g,";\n\n  let globalRow = i32(globalId.y) * ").concat(m,";\n  let globalCol = i32(globalId.x) * ").concat(g,";\n  let globalRowStart = i32(workgroupId.y) * ").concat(c,";\n\n  let tileRowA = i32(localId.y) * ").concat(h,";\n  let tileColA = i32(localId.x) * ").concat(p,";\n  let tileRowB = i32(localId.y) * ").concat(f,";\n  // Loop over shared dimension.\n  for (var t = 0; t < numTiles; t++) {\n    // Load one tile of A into local memory.\n    for (var innerRow = 0; innerRow < ").concat(h,"; innerRow++) {\n      for (var innerCol = 0; innerCol < ").concat(p,"; innerCol++) {\n        let inputRow = tileRowA + innerRow;\n        let inputCol = tileColA + innerCol;\n        ").concat(a3(n),"\n      }\n    }\n\n    // Load one tile of B into local memory.\n    for (var innerRow = 0; innerRow < ").concat(f,"; innerRow++) {\n      for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n        let inputRow = tileRowB + innerRow;\n        let inputCol = tileCol + innerCol;\n        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,\n          kStart + inputRow,\n          globalCol + innerCol);\n      }\n    }\n    kStart = kStart + ").concat(r,";\n    workgroupBarrier();\n\n    // Compute acc values for a single thread.\n    var BCached : array<f32, ").concat(g,">;\n    for (var k = 0; k < ").concat(r,"; k++) {\n      for (var inner = 0; inner < ").concat(g,"; inner++) {\n        BCached[inner] = mm_Bsub[k][tileCol + inner];\n      }\n\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        ").concat((e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];")(n),"\n        for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n          acc[innerRow][innerCol] =\n              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);\n        }\n      }\n    }\n\n    workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n    for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n      mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n          acc[innerRow][innerCol]);\n    }\n  }\n  ");return"\n    var<workgroup> mm_Asub : array<array<f32, ".concat(u,">, ").concat(d,">;\n    var<workgroup> mm_Bsub : array<array<f32, ").concat(l,">, ").concat(r,">;\n\n    ").concat(T2()," {\n      let batch = ").concat(a?"0":"i32(globalId.z)",";\n      let batchA = ").concat(a||!s?"batch":"batch % uniforms.aShape[0]",";\n      let batchB = ").concat(a||!s?"batch":"batch % uniforms.bShape[0]",";\n      let numTiles = ").concat(a?"".concat(Math.ceil(o/r)):"(uniforms.dimInner - 1) / ".concat(r," + 1"),";\n      var kStart = ").concat(a?"i32(globalId.z) * ".concat(o):"0",";\n\n      var acc : array<array<f32, ").concat(g,">, ").concat(m,">;\n\n      // Without this initialization strange values show up in acc.\n      for (var innerRow = 0; innerRow < ").concat(m,"; innerRow++) {\n        for (var innerCol = 0; innerCol < ").concat(g,"; innerCol++) {\n          acc[innerRow][innerCol] = 0.0;\n        }\n      }\n      ").concat(y,"\n    }\n  ")}class i3{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=t,this.dispatchLayout={x:[2],y:[1],z:[0]};const c=n?e[1]:e[2];if(this.isVec4=(c%4===0&&!n||t[1]%4===0&&n)&&t[2]%4===0&&!r,this.outputComponent=this.isVec4?4:1,this.isVectorA=1===t[1]&&!n,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const e=function(e,t,n){const r=[8,8,1],a=[4,4,1];return arguments.length>3&&void 0!==arguments[3]&&arguments[3]||(e<=8&&(a[1]=1),t<=16&&n<=16&&(r[0]=4)),{workgroupSize:r,elementsPerThread:a}}(t[1],c,t[2],n);this.workgroupSize=e.workgroupSize,this.elementsPerThread=e.elementsPerThread}this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const l=null!=a,u=null!=i;l&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=s,this.transposeA=n,this.transposeB=r,this.addBias=l,this.activation=o,this.hasPreluActivationWeights=u,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(t[1],t[2],c),this.shaderKey="matMulPacked_".concat(this.elementsPerThread,"_").concat(n,"_").concat(r,"_").concat(this.activation,"_").concat(this.fitAOuter,"_").concat(this.fitBOuter,"_").concat(this.fitInner,"_").concat(this.isVec4,"_").concat(this.isVectorA,"_").concat(this.sequentialAccessByThreads)}getShapeFit(e,t,n){const r=this.workgroupSize[1]*this.elementsPerThread[1],a=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=4*this.workgroupSize[0]:this.tileInner=a;return[e%r===0,t%a===0,n%this.tileInner===0]}getUserCode(){const e="\n      ".concat(J2(this.activation,this.hasPreluActivationWeights,this.isVec4),"\n      ").concat(n3(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1),"\n      ").concat(this.isVec4?r3(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];EO(1===e[1]&&1===e[2],()=>"A linear work group size is required. But got ".concat(e,"."));const n=4*e[0];return"\n    var<workgroup> mm_Asub : array<vec4<f32>, ".concat(e[0],">;\n\n    ").concat(T2()," {\n      let tileCol = i32(localId.x);\n      let globalCol = i32(globalId.x);\n      let globalRow = i32(globalId.y);\n\n      let numTiles = (uniforms.dimInner - 1) / ").concat(n," + 1;\n      let batch = i32(globalId.z);\n      let batchA = batch % uniforms.aShape[0];\n      let batchB = batch % uniforms.bShape[0];\n      // Without this initialization strange values show up in acc.\n      var acc = 0.0;\n\n      // Loop over shared dimension.\n      for (var t = 0; t < numTiles; t++) {\n        // Load one tile of A into local memory.\n        let colA = t * ").concat(n," + tileCol * 4;\n        mm_Asub[tileCol] = vec4<f32>(").concat((e=>e?"\n      mm_readA(batchA, colA, globalRow),\n      mm_readA(batchA, colA + 1, globalRow),\n      mm_readA(batchA, colA + 2, globalRow),\n      mm_readA(batchA, colA + 3, globalRow)\n  ":"\n      mm_readA(batchA, globalRow, colA),\n      mm_readA(batchA, globalRow, colA + 1),\n      mm_readA(batchA, globalRow, colA + 2),\n      mm_readA(batchA, globalRow, colA + 3)\n  ")(t),");\n        workgroupBarrier();\n\n        // Compute acc values for a single thread.\n        for (var k = 0; k < ").concat(n/4,"; k++) {\n          let rowB = t * ").concat(n," + k * 4;\n          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),\n                              mm_readB(batchB, rowB + 1, globalCol),\n                              mm_readB(batchB, rowB + 2, globalCol),\n                              mm_readB(batchB, rowB + 3, globalCol));\n\n          let ACached = mm_Asub[k];\n          acc = acc + dot(ACached, BCached);\n        }\n\n        workgroupBarrier();\n      }\n\n      mm_write(batch, globalRow, globalCol, acc);\n    }\n  ")}(this.workgroupSize,this.transposeA):o3(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0),"\n    ");return e}}class s3{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize);const i=null!=r,s=null!=o;i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.transposeA=t,this.transposeB=n,this.addBias=i,this.activation=a,this.hasPreluActivationWeights=s,this.shaderKey="matMulReduce_".concat(this.activation,"_").concat(t,"_").concat(n)}getUserCode(){var e;return"\n      ".concat(J2(this.activation,this.hasPreluActivationWeights),"\n      ").concat(n3(this.addBias,this.activation,this.transposeA,this.transposeB),"\n      ").concat((e=this.workgroupSize[0],"\n    var<workgroup> sumValues : array<f32, ".concat(e,">;\n    ").concat(T2()," {\n      let coords = getOutputCoords();\n      let batch = coords[0];\n      let batchA = batch % uniforms.aShape[0];\n      let batchB = batch % uniforms.bShape[0];\n      let row = coords[1];\n      let col = coords[2];\n      var sum = 0.0;\n      let Length = uniforms.dimInner;\n      for (var k = i32(localId.x); k < Length; k = k + ").concat(e,") {\n        let dataA = mm_readA(batchA, row, k);\n        let dataB = mm_readB(batchB, k, col);\n        sum = sum + dataA * dataB;\n      }\n      sumValues[localId.x] = sum;\n      workgroupBarrier();\n\n      for(var currentSize = ").concat(e/2,"u; currentSize > 1u;\n          currentSize = currentSize / 2u) {\n        if (localId.x < currentSize)\n        {\n          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];\n        }\n        workgroupBarrier();\n      }\n\n      if (localId.x == 0u) {\n        sum = sumValues[0] + sumValues[1];\n        mm_write(batch, row, col, sum);\n      }\n    }\n  ")),"\n    ")}}class c3{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(n[2]/this.workgroupSize[0]),Math.ceil(n[1]/this.workgroupSize[1]),n[0]];const c=null!=o;c&&this.variableNames.push("bias");const l=null!=s;l&&this.variableNames.push("preluActivationWeights"),this.transposeA=r,this.transposeB=a,this.addBias=c,this.activation=i,this.hasPreluActivationWeights=l,this.shaderKey="matMulSmallOutputSize_".concat(this.activation,"_").concat(r,"_").concat(a)}getUserCode(){return"\n      ".concat(J2(this.activation,this.hasPreluActivationWeights),"\n      ").concat(n3(this.addBias,this.activation,this.transposeA,this.transposeB),"\n      ").concat(function(e){const t=e[1],n=e[0],r=t>n?t:n;return"\n  var<workgroup> mm_Asub : array<array<f32, ".concat(r,">, ").concat(t,">;\n  var<workgroup> mm_Bsub : array<array<f32, ").concat(n,">, ").concat(r,">;\n\n  // If the output size is small for matrix multiplication, avoid to use vec4\n  // and handle some elements per thread to optimally utilize the ALU.\n  // Read data from global memory to registers firstly, then store them into\n  // shared memory, so it is instruction-Level parallelism for arithmetic\n  // operations and others handle IO operations between barrier api, makes ALU\n  // and load/store units work simultaneously, could improves the performance.\n  ").concat(T2()," {\n    let tileRow = i32(localId.y);\n    let tileCol = i32(localId.x);\n    let globalRow = i32(globalId.y);\n    let globalCol = i32(globalId.x);\n    let batch = i32(globalId.z);\n    let batchA = batch % uniforms.aShape[0];\n    let batchB = batch % uniforms.bShape[0];\n\n    // uniforms.dimInner should be greater than 0.\n    let numTiles = (uniforms.dimInner - 1) / ").concat(r," + 1;\n    var acc = 0.0;\n\n    var globalColA = tileCol;\n    var globalRowB = 0;\n    var regA = mm_readA(batchA, globalRow, globalColA);\n    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);\n    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);\n    globalColA = globalColA + ").concat(r,";\n    globalRowB = globalRowB + ").concat(r,";\n\n    for (var t = 0; t < numTiles; t = t + 1) {\n      mm_Asub[tileRow][tileCol] = regA;\n      mm_Bsub[2 * tileRow][tileCol] = regB0;\n      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;\n\n      workgroupBarrier();\n\n      regA = mm_readA(batchA, globalRow, globalColA);\n      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);\n      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);\n      globalColA = globalColA + ").concat(r,";\n      globalRowB = globalRowB + ").concat(r,";\n\n      for (var k = 0; k < ").concat(r,"; k = k + 1) {\n        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];\n      }\n      workgroupBarrier();\n    }\n\n    mm_write(batch, globalRow, globalCol, acc);\n  }\n  ")}(this.workgroupSize),"\n    ")}}class l3{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,EO(1===e[0],()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const a=(n&&this.outputShape[1]%4===0||!n&&t%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=a?4:1,a||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=L2(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],t],this.workgroupSize,this.elementsPerThread),this.transposeA=n,this.transposeB=r,this.shaderKey="matMulSplitK_".concat(n,"_").concat(r,"_").concat(this.elementsPerThread,"_").concat(this.outputComponent)}getUserCode(){const e=this.outputComponent;return"\n      ".concat(t3(!1,this.transposeB,!1,!1,!1,e),"\n      fn mm_write(batch: i32, row : i32, col : i32, value : ").concat(C2(e),") {\n        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n          let coords = vec3<i32>(batch, row, col);\n          let flatIndex = getOutputIndexFromCoords(coords);\n          // The problem is that we should initialize output to zero before using.\n          // Otherwise, the original value will be added to the result.\n          for (var i = 0; i < ").concat(e,"; i = i + 1) {\n            ").concat(w2("&result[flatIndex + i]","".concat(e>1?"value[i]":"value"),"float32"),"\n          }\n        }\n      }\n      ").concat(4===e?r3(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):o3(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner),"\n    ")}}class u3{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=null!=t,this.hasPreluActivationWeights=null!=r,this.activation=n,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey="biasActivation_".concat(n)}getUserCode(){return"\n    ".concat(J2(this.activation,this.hasPreluActivationWeights),"\n    ").concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        var value = getXByOutputIndex(index);\n        ").concat(e3(this.addBias,this.activation),"\n        setOutputAtIndex(index, value);\n      }\n    }\n    ")}}class d3{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        setOutputAtIndex(index, uniforms.value);\n      }\n    }\n  ")}}function h3(e){const{backend:t,attrs:n}=e,{shape:r,value:a}=n;let{dtype:o}=n;if(o=o||GO(a),"string"===o){const e=jO(o,OO(r));return e.fill(a),t.makeTensorInfo(r,o,e)}{const e=new d3(r),n=[{type:"float32",data:[a]}];return t.runWebGPUProgram(e,[],o,n)}}const p3={kernelName:m_,backendName:"webgpu",kernelFunc:h3};function f3(e){const{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,o=OO(r.shape),i=FO(a,o),s=OO(i);return EO(o===s,()=>"The new shape (".concat(i,") has ").concat(s," elements and the old ")+"shape (".concat(r.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:i,dtype:r.dtype}}const m3={kernelName:xR,backendName:"webgpu",kernelFunc:f3};function g3(e){let{a:t,b:n,transposeA:r,transposeB:a,backend:o,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:l=null}=e;const u=t.shape.length,d=n.shape.length,h=r?t.shape[u-2]:t.shape[u-1],p=a?n.shape[d-1]:n.shape[d-2],f=r?t.shape[u-1]:t.shape[u-2],m=a?n.shape[d-2]:n.shape[d-1],g=t.shape.slice(0,-2),y=n.shape.slice(0,-2),v=OO(g),b=OO(y),x=TF(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,m]);EO(h===p,()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(p,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const w=r?[v,h,f]:[v,f,h],k=a?[b,m,p]:[b,p,m],S=f3({inputs:{x:t},backend:o,attrs:{shape:w}}),C=f3({inputs:{x:n},backend:o,attrs:{shape:k}}),I=[S,C],E=Math.max(v,b),T=[S,C],N=[{type:"int32",data:[f]},{type:"int32",data:[m]},{type:"int32",data:[h]}];let O,A;const _=[E,f,m];let R=iA().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(R<0){const e=iA().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),t=e>0?e:o.thresholdToIncreaseWorkgroups,n=E*Math.ceil(f/32)*Math.ceil(m/32);R=n<=t||f<=8&&n<=2*t?E*f*m<=128?G2.MatMulReduceProgram:1===E&&p>=2e3?G2.MatMulSplitKProgram:G2.MatMulSmallOutputSizeProgram:G2.MatMulPackedProgram}switch(R){case G2.MatMulReduceProgram:O=new s3(_,r,a,i,l,s);break;case G2.MatMulSplitKProgram:if(A=h3({backend:o,attrs:{shape:_,value:0,dtype:t.dtype}}),O=new l3(_,p,r,a),i||l){A=o.runWebGPUProgram(O,T,t.dtype,N,A);const e=new u3(A.shape,i,l,s);let n=null;const r=[A];i&&r.push(i),s&&r.push(s),"leakyrelu"===l&&(n=[{type:"float32",data:[c]}],e.uniforms+=" alpha : f32,");const a=o.runWebGPUProgram(e,r,A.dtype,n);I.push(A);const u=f3({inputs:{x:a},backend:o,attrs:{shape:x}});I.push(a);for(const t of I)o.disposeData(t.dataId);return u}break;case G2.MatMulSmallOutputSizeProgram:O=new c3(w,k,_,r,a,i,l,s);break;case G2.MatMulPackedProgram:const e=o.adapterInfo.isIntel();O=new i3(w,_,r,a,i,l,s,e);break;default:throw new Error("Unsupported MatMulProgramType ".concat(R,"."))}i&&T.push(i),s&&T.push(s),"leakyrelu"===l&&(N.push({type:"float32",data:[c]}),O.uniforms+=" alpha : f32,"),A=o.runWebGPUProgram(O,T,t.dtype,N,A);const P=f3({inputs:{x:A},backend:o,attrs:{shape:x}});I.push(A);for(const D of I)o.disposeData(D.dataId);return P}const y3={kernelName:yP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:o,bias:i,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;return g3({a:a,b:o,transposeA:c,transposeB:l,backend:n,bias:i,preluActivationWeights:s,leakyreluAlpha:d,activation:u})}};class v3{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=TF(t,n),this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="binaryOpComplex_".concat(e),this.op=e}getUserCode(){const e=X2(this.op,!1);return"\n      fn binaryOpComplex(\n          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {\n        ".concat(e,"\n      }\n\n      ").concat(T2("index")," {\n        if(index < uniforms.size) {\n          let areal = getARealByOutputIndex(index);\n          let aimag = getAImagByOutputIndex(index);\n          let breal = getBRealByOutputIndex(index);\n          let bimag = getBImagByOutputIndex(index);\n          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));\n        }\n      }\n    ")}}class b3{constructor(e,t,n){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=TF(t,n),this.dispatchLayout=j2(this.outputShape),this.op=e,this.useSharedMemoryWithA=t.length<=1&&n.length>1&&t[0]<128,this.useSharedMemoryWithB=n.length<=1&&t.length>1&&n[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?n[0]:t[0],this.shaderKey="binary_".concat(e,"_").concat(this.lastDimensionSize),this.type="shared",this.workgroupSize=[256,1,1];else{const r=t.length>0&&t[t.length-1]%4===0,a=n.length>0&&n[n.length-1]%4===0;r&&a?(this.outputComponent=4,this.variableComponents=[4,4]):r&&(AO(n)||1===n[n.length-1])||a&&(AO(t)||1===t[t.length-1])?(this.outputComponent=4,this.variableComponents=r?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey="binary_".concat(e,"_").concat(this.variableComponents),this.workgroupSize=[128,1,1]}this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const t=4===this.outputComponent?"vec4<f32>":"f32",n="\n    fn binaryOperation(a : ".concat(t,", b : ").concat(t,") -> ").concat(t," {\n      ").concat(X2(this.op,4===this.outputComponent),"\n    };\n    ");if("shared"===this.type){const t=this.lastDimensionSize>1?"coords[".concat(this.outputShape.length-1,"]"):"0",r=this.useSharedMemoryWithB?"let a = getAByOutputIndex(index);\n          let b = sharedBuf[".concat(t,"];"):"let a = sharedBuf[".concat(t,"];\n          let b = getBByOutputIndex(index);");e="\n        ".concat(n,"\n        var<workgroup> sharedBuf : array<f32, ").concat(this.lastDimensionSize,">;\n        ").concat(T2("index")," {\n          // Fill in the shared memory buffer.\n          let localIndex = i32(localId.x);\n          if(localIndex < ").concat(this.lastDimensionSize,") {\n            sharedBuf[localIndex] = f32(").concat(this.useSharedMemoryWithB?"B":"A","[localIndex]);\n          }\n          workgroupBarrier();\n\n          if(index < uniforms.size) {\n            let coords = getCoordsFromIndex(index);\n            ").concat(r,"\n            setOutputAtIndex(index, binaryOperation(a, b));\n          }\n        }\n        ")}else e="\n       ".concat(n,"\n       ").concat(T2("index")," {\n         if (index < uniforms.size) {\n           let coords = getCoordsFromIndex(index * ").concat(this.outputComponent,");\n           let a = ").concat(t,"(getAByOutputCoords(coords));\n           let b = ").concat(t,"(getBByOutputCoords(coords));\n           setOutputAtIndex(index, binaryOperation(a, b));\n         }\n       }\n       ");return e}}function x3(e){const{inputs:t}=e,{x:n}=t;return e.backend.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const w3={kernelName:C_,backendName:"webgpu",kernelFunc:x3};function k3(e){const{inputs:t,backend:n}=e,{real:r,imag:a}=t,o=n.makeTensorInfo(r.shape,"complex64"),i=n.tensorMap.get(o.dataId),s=x3({inputs:{x:r},backend:n}),c=x3({inputs:{x:a},backend:n});return i.complexTensorInfos={real:s,imag:c},o}const S3={kernelName:LA,backendName:"webgpu",kernelFunc:k3};class C3{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.variableNames=["A"],this.size=!0;this.workgroupSize=[128,1,1],this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=t,""!==n&&(this.uniforms=n),this.shaderKey="unary_".concat(t)}getUserCode(){return"\n      fn unaryOperation(a : f32) -> f32 {\n        ".concat($2(this.op,!1),"\n      }\n      ").concat(T2("index")," {\n        if (index < uniforms.size) {\n          let a = getAByOutputIndex(index);\n          setOutputAtIndex(index, unaryOperation(a));\n        }\n      }\n      ")}}function I3(e){let{opType:t,cpuKernelImpl:n,dtype:r}=e;return e=>{let{inputs:a,backend:o}=e;const{x:i}=a,s=o,c=r||i.dtype;if(s.shouldExecuteOnCPU([i])&&null!=n){const e=s.tensorMap.get(i.dataId),t=n(e.values,c);return s.makeTensorInfo(i.shape,c,t)}const l=new C3(i.shape,t);return s.runWebGPUProgram(l,[i],c)}}function E3(e){let{opType:t,cpuKernelImpl:n,supportsComplex:r=!1,dtype:a}=e;return e=>{let{inputs:o,backend:i}=e;const{a:s,b:c}=o,l=i;if(r&&"complex64"===s.dtype){const e=l.tensorMap.get(s.dataId),n=l.tensorMap.get(c.dataId);let r,a;if(t!==q2.MUL)[r,a]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,a={dataId:n.dataId,dtype:n.dtype,shape:s.shape},o={dataId:r.dataId,dtype:r.dtype,shape:c.shape},i=new b3(t,s.shape,c.shape);return l.runWebGPUProgram(i,[a,o],vD(n.dtype,r.dtype))});else{const t=new v3(q2.COMPLEX_MULTIPLY_REAL,s.shape,c.shape),o=new v3(q2.COMPLEX_MULTIPLY_IMAG,s.shape,c.shape),i=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:s.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:c.shape},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:c.shape}];r=l.runWebGPUProgram(t,i,"float32"),a=l.runWebGPUProgram(o,i,"float32")}const o=k3({inputs:{real:r,imag:a},backend:l});return l.disposeData(r.dataId),l.disposeData(a.dataId),o}const u=a||vD(s.dtype,c.dtype);if(("string"===s.dtype||"string"===c.dtype||l.shouldExecuteOnCPU([s,c]))&&null!=n){const e=l.tensorMap.get(s.dataId).values,t=l.tensorMap.get(c.dataId).values,r="string"===s.dtype?HV(e):e,a="string"===s.dtype?HV(t):t,[o,i]=n(s.shape,c.shape,r,a,u);return l.makeTensorInfo(i,u,o)}const d=new b3(t,s.shape,c.shape);return l.runWebGPUProgram(d,[s,c],u)}}const{mx:T3,ct:N3,YG:O3,hH:A3,z3:_3,sG:R3,uM:P3,vS:D3,C1:M3,qB:F3,GG:L3,lg:z3,rq:B3,cu:j3,WR:W3,px:U3,jC:V3,He:G3,hE:H3,BF:K3,Dk:q3,cl:X3,_B:Y3,qy:Q3,Zy:Z3,bu:$3,dH:J3,HS:e4,eW:t4,GK:n4,dl:r4,Dw:a4,xT:o4,_X:i4,wz:s4}=s,c4=I3({opType:Y2.ABS,cpuKernelImpl:J3}),l4={kernelName:dA,backendName:"webgpu",kernelFunc:c4},u4=I3({opType:Y2.ACOS}),d4={kernelName:hA,backendName:"webgpu",kernelFunc:u4},h4=I3({opType:Y2.ACOSH}),p4={kernelName:pA,backendName:"webgpu",kernelFunc:h4},f4=E3({opType:q2.ADD,cpuKernelImpl:T3,supportsComplex:!0}),m4={kernelName:fA,backendName:"webgpu",kernelFunc:f4};class g4{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((e,t)=>"T".concat(t)),this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(t=>{e.push("let v".concat(t," = get").concat(t,"ByOutputCoords(coords);"))});const t=this.variableNames.map(e=>"v".concat(e)).join(" + ");return"\n      ".concat(T2("index")," {\n        for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if (flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            ").concat(e.join("\n        "),"\n            setOutputAtIndex(flatIndex, ").concat(t,");\n          }\n        }\n      }\n    ")}}const y4={kernelName:mA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,r=t;if(1===r.length)return x3({inputs:{x:r[0]},backend:n});const a=r.map(e=>e.dtype).reduce((e,t)=>vD(e,t)),o=r.map(e=>e.shape),i=new g4(o);return n.runWebGPUProgram(i,r,a)}};class v4{constructor(e,t){this.variableNames=["A"],this.workgroupSize=[16,16,1];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.dispatchLayout={x:[0],y:[1]},this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){EO(this.workgroupSize[0]===this.workgroupSize[1],()=>"Must be a square tile, current tile shape is ".concat(this.workgroupSize[0]," x ").concat(this.workgroupSize[1]));const e=this.workgroupSize[0];return"\n      var<workgroup> tile : array<array<f32, ".concat(this.workgroupSize[0]+1,">, ").concat(this.workgroupSize[0],">;\n      ").concat(T2()," {\n        var x = i32(workgroupId.x) * ").concat(e," + i32(localId.x);\n        var y = i32(workgroupId.y) * ").concat(e," + i32(localId.y);\n        let width = uniforms.outShape[0];\n        let height = uniforms.outShape[1];\n        if (x < width && y < height) {\n          tile[localId.y][localId.x] = f32(A[y * width + x]);\n        }\n        workgroupBarrier();\n\n        x = i32(workgroupId.y) * ").concat(e," + i32(localId.x);\n        y = i32(workgroupId.x) * ").concat(e," + i32(localId.y);\n        if (x < height && y < width) {\n          setOutputAtIndex((y * height + x), tile[localId.x]\n            [localId.y]);\n        }\n      }\n    ")}}class b4{constructor(e,t){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=t,this.shaderKey="transpose_".concat(t)}getUserCode(){const e=I2(this.outputShape.length),t=x4(this.newDim);return"\n      ".concat(T2("index")," {\n        for(var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if(flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            setOutputAtIndex(flatIndex, A[getIndexFromCoords").concat(this.outputShape.length,"D(\n              ").concat(e,"(").concat(t,"), uniforms.aShape)]);\n          }\n        }\n      }\n    ")}}function x4(e){const t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));const n=new Array(t);for(let r=0;r<e.length;r++)n[e[r]]="coords.".concat(E2(r));return n.join()}function w4(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{perm:o}=r,i=n,s=a.shape.length,c=new Array(s);for(let u=0;u<c.length;u++)c[u]=a.shape[o[u]];if(n.shouldExecuteOnCPU([a])){const e=i.tensorMap.get(a.dataId).values,t=i4(e,a.shape,a.dtype,o,c);return n.makeTensorInfo(c,a.dtype,t)}if(2===a.shape.length&&_O(o,[1,0])){const e=new v4(a.shape,o);return i.runWebGPUProgram(e,[a],a.dtype)}const l=new b4(a.shape,o);return i.runWebGPUProgram(l,[a],a.dtype)}const k4={kernelName:lP,backendName:"webgpu",kernelFunc:w4};class S4{constructor(e,t,n){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[r]=Kz(this.inputShape,[1]);this.outputShape=0===r.length?[1]:r,e.inSize>=32768&&n>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=t,this.shaderKey="reduce_".concat(t)}getUserCode(){let e="",t="0.0";const n=this.workgroupSize[0];"min"===this.reduceType||"max"===this.reduceType?(e="\n         if (isnan(candidate)) {\n          bestValue = uniforms.NAN;\n         } else if (!isnan(bestValue) && candidate ".concat("min"===this.reduceType?"<":">"," bestValue)\n           {  bestValue = candidate; }"),t="f32(x[offset])"):"sum"===this.reduceType||"mean"===this.reduceType?e=" bestValue = bestValue + candidate; ":"prod"===this.reduceType?(e=" bestValue = bestValue * candidate; ",t="1.0"):"all"===this.reduceType?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",t="1.0"):"any"===this.reduceType&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",t="0.0");const r="mean"===this.reduceType?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);",a="\n         var<workgroup> xBestValues : array<f32, ".concat(n,">;\n       ");return"\n       fn DIV_CEIL(a : u32, b : u32) -> u32 {\n        return ((a - 1u) / b + 1u);\n       }\n\n       ".concat(a,"\n       fn getOffset(outputIndex : i32) -> i32 {\n         let outputCoords = getCoordsFromIndex(outputIndex);\n         let offset = ").concat(1===this.outputShape.length?"outputCoords":"outputCoords[0]"," * uniforms.reduceSize;\n          return offset;\n       }\n       ").concat(T2("index")," {\n         let outputIndex = index / ").concat(n,";\n         let offset = getOffset(outputIndex);\n         var bestValue = ").concat(t,";\n         let Length = uniforms.reduceSize;\n         let WorkPerThread = DIV_CEIL(u32(Length), ").concat(n,"u);\n         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;\n             k = k + ").concat(n,") {\n           let candidate = f32(x[offset + k]);\n           ").concat(e,"\n         }\n         xBestValues[localId.x] = bestValue;\n         workgroupBarrier();\n\n         var reduceSize = min(u32(Length), ").concat(n,"u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (localId.x < currentSize) {\n            let candidate = xBestValues[localId.x + interval];\n            ").concat(e,"\n            xBestValues[localId.x] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (localId.x == 0u && outputIndex < uniforms.size) {\n          ").concat(r,"\n        }\n       }\n     ")}}const C4={mean:"float32",all:"bool",any:"bool"};function I4(e,t,n,r,a){const o=e.shape.length,i=[],s=LO(t,e.shape);let c=s;const l=Yz(c,o);let u=e;null!=l&&(u=w4({inputs:{x:e},attrs:{perm:l},backend:a}),c=Zz(c.length,o),i.push(u)),Xz(r,c,o);const[d,h]=Kz(u.shape,c);let p,f=d;if(n&&(f=qz(d,s)),"max"!==r&&"prod"!==r||!a.shouldExecuteOnCPU([u])){const t=OO(h),n={windowSize:t,inSize:t,batchSize:OO(u.shape)/t,outSize:1},o=C4[r]||bD(e.dtype),s=[{type:"int32",data:[t]}],c=new S4(n,r,a.device.limits.maxComputeWorkgroupSizeX),l=a.runWebGPUProgram(c,[u],o,s);i.push(l),p=f3({inputs:{x:l},attrs:{shape:f},backend:a})}else{const t=a.tensorMap.get(u.dataId).values;switch(r){case"max":const n=V3(t,OO(h),f,e.dtype);p=a.makeTensorInfo(f,e.dtype,n);break;case"prod":const{outVals:o,outShape:i,outDtype:s}=Y3(u.shape,u.dtype,t,c);p=a.makeTensorInfo(i,s,o);break;default:throw new Error("".concat(r," CPU implementation is not yet supported."))}}return i.forEach(e=>a.disposeData(e.dataId)),p}const E4={kernelName:gA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{keepDims:o,axis:i}=r;return I4(a,i,o,"all",n)}};const T4={kernelName:yA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{keepDims:o,axis:i}=r;return I4(a,i,o,"any",n)}};class N4{constructor(e,t,n){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const r=[t];this.op="min"===n?"<":">";const[a,o]=Kz(e,r);this.outputShape=0===a.length?[1]:a,this.dispatchLayout=j2(this.outputShape),OO(o)<32?(this.type="plain",this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=L2(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey="argMinMax_".concat(this.op,"_").concat(this.type)}getUserCode(){const e=this.workgroupSize[0],t=()=>1===this.inputShape.length?"uniforms.xShape":"uniforms.xShape.".concat(E2(this.inputShape.length-1)),n=()=>{let e="";if(1===this.outputShape.length)1!==this.inputShape.length&&(e+="outputCoords,");else for(let t=0;t<this.outputShape.length;t++)e+="outputCoords.".concat(E2(t),",");return e};if("shared"===this.type){const r="\n      var<workgroup> xBestIndices : array<i32, ".concat(e,">;\n      var<workgroup> xBestValues : array<f32, ").concat(e,">;\n    ");return"\n      fn DIV_CEIL(a : u32, b : u32) -> u32 {\n        return ((a - 1u) / b + 1u);\n      }\n\n      ".concat(r,"\n\n      ").concat(T2("index")," {\n        let outputIndex = index / ").concat(e,";\n        let reduceLength = ").concat(t(),";\n\n        var bestIndex = i32(localId.x);\n        var bestValue = uniforms.infinityValue;\n        let outputCoords = getCoordsFromIndex(outputIndex);\n        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;\n            k = k + ").concat(e,") {\n          let candidate = getX(").concat(n()," k);\n          if (!isnan(candidate) && candidate ").concat(this.op," bestValue) {\n            bestValue = candidate;\n            bestIndex = k;\n          }\n        }\n        xBestValues[localId.x] = bestValue;\n        xBestIndices[localId.x] = bestIndex;\n        workgroupBarrier();\n\n        var reduceSize = min(u32(reduceLength), ").concat(e,"u);\n        for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n            currentSize = reduceSize / 2u) {\n          let interval = DIV_CEIL(reduceSize, 2u);\n          if (localId.x < currentSize) {\n            let candidate = xBestValues[localId.x + interval];\n            if (candidate ").concat(this.op," bestValue) {\n              bestValue = candidate;\n              xBestValues[localId.x] = bestValue;\n              xBestIndices[localId.x] = xBestIndices[localId.x + interval];\n            }\n          }\n          reduceSize = interval;\n          workgroupBarrier();\n        }\n\n        if (localId.x == 0u && outputIndex < uniforms.size) {\n          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);\n        }\n      }\n    ")}return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let outputCoords = getCoordsFromIndex(index);\n          var bestIndex = 0;\n          var bestValue = getX(").concat(n()," 0);\n          let reduceLength = ").concat(t(),";\n          for (var i = 1; i < reduceLength; i++) {\n            let candidate = getX(").concat(n()," i);\n            if (candidate ").concat(this.op," bestValue) {\n              bestValue = candidate;\n              bestIndex = i;\n            }\n          }\n          setOutputAtIndexI32(index, bestIndex);\n        }\n      }\n      ")}}const O4={kernelName:vA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o}=r;let i=LO(o,a.shape);const s=Yz(i,a.shape.length);let c=a;const l=[];null!=s&&(c=w4({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),i=Zz(i.length,c.shape.length)),Xz("argMax",[i[0]],c.shape.length);const u=new N4(c.shape,i[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],h=n.runWebGPUProgram(u,[c],"int32",d);return l.forEach(e=>n.disposeData(e.dataId)),h}};const A4={kernelName:bA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o}=r;let i=LO(o,a.shape);const s=Yz(i,a.shape.length);let c=a;const l=[];null!=s&&(c=w4({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),i=Zz(i.length,c.shape.length)),Xz("argMin",[i[0]],c.shape.length);const u=new N4(c.shape,i[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],h=n.runWebGPUProgram(u,[c],"int32",d);return l.forEach(e=>n.disposeData(e.dataId)),h}},_4=I3({opType:Y2.ASIN}),R4={kernelName:xA,backendName:"webgpu",kernelFunc:_4},P4=I3({opType:Y2.ASINH}),D4={kernelName:wA,backendName:"webgpu",kernelFunc:P4},M4=I3({opType:Y2.ATAN}),F4={kernelName:kA,backendName:"webgpu",kernelFunc:M4},L4=E3({opType:q2.ATAN2}),z4={kernelName:CA,backendName:"webgpu",kernelFunc:L4},B4=I3({opType:Y2.ATANH}),j4={kernelName:SA,backendName:"webgpu",kernelFunc:B4};class W4{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let batch = coords[0];\n          let d = coords[3];\n\n          let xRCCorner = coords.yz * uniforms.strides;\n          let xRCorner = xRCCorner.x;\n          let xCCorner = xRCCorner.y;\n\n          let value = getX(batch, xRCorner, xCCorner, d);\n          setOutputAtIndex(index, value);\n        }\n      }\n    ")}}class U4{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=t,this.computePositions=n,this.flattenPositions=r,this.includeBatchIndex=a,this.shaderKey="pool2D_".concat(t,"_").concat(n,"_").concat(r,"_").concat(a)}getUserCode(){let e;if("avg"===this.poolType)e="resultValue = resultValue + value; count = count + 1.0;";else if(this.computePositions){const t=this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC";e="let currMaxValue = mix(value, maxValue, maxValueFound);\n      if (value >= currMaxValue) {\n        maxValue = value;\n        maxValueFound = 1.0;\n        maxPosition = ".concat(t,";\n      }")}else e="resultValue = max(value, resultValue);";let t="resultValue";"avg"===this.poolType&&(t="resultValue / max(count, 1.0)");return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n          let batch = coords[0];\n          let d = coords[3];\n          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;\n          let xRCorner = xRCCorner.x;\n          let xCCorner = xRCCorner.y;\n\n          ").concat(this.computePositions?"var maxValue = 0.0;\n            var maxValueFound = 0.0;\n            var maxPosition = 0;":"var resultValue = ".concat("avg"===this.poolType?"0.0":"-1.0 / pow(10.0, -20.0)",";"),"\n\n          var count = 0.0;\n          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {\n            let xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= uniforms.convDims.x) {\n              continue;\n            }\n\n            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {\n              let xC = xCCorner + wC;\n              if (xC < 0 || xC >= uniforms.convDims.y) {\n                continue;\n              }\n\n              let value = getX(batch, xR, xC, d);\n              ").concat(e,"\n            }\n          }\n\n          ").concat(this.computePositions?"setOutputAtIndexI32(index, maxPosition);":"setOutputAtIndex(index, ".concat(t,");"),"\n        }\n      }\n    ")}}class V4{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=t,this.computePositions=n,this.flattenPositions=r,this.includeBatchIndex=a,this.shaderKey="pool3D_".concat(t,"_").concat(n,"_").concat(r,"_").concat(a)}getUserCode(){let e;if("avg"===this.poolType)e="resultValue += value; count += 1.0;";else if(this.computePositions){const t=this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC";e="let currMaxValue = mix(value, maxValue, maxValueFound);\n      if (value >= currMaxValue) {\n        maxValue = value;\n        maxValueFound = 1.0;\n        maxPosition = ".concat(t,";\n      }")}else e="resultValue = max(value, resultValue);";let t="resultValue";"avg"===this.poolType&&(t="resultValue / max(count, 1.0)");return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let batch = coords.x;\n          let ch = coords.u;\n\n          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;\n          let xDCorner = xCorner.x;\n          let xRCorner = xCorner.y;\n          let xCCorner = xCorner.z;\n\n          ").concat(this.computePositions?"var maxValue = 0.0;\n            var maxValueFound = 0.0;\n            var maxPosition = 0;":"var resultValue = ".concat("avg"===this.poolType?"0.0":"-1.0 / pow(10.0, -20.0)",";"),"\n\n          var count = 0.0;\n          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {\n            let xD = xDCorner + wD;\n            if (xD < 0 || xD >= uniforms.convDims.x) {\n              continue;\n            }\n\n            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {\n              let xR = xRCorner + wR;\n              if (xR < 0 || xR >= uniforms.convDims.y) {\n                continue;\n              }\n\n              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {\n                let xC = xCCorner + wC;\n                if (xC < 0 || xC >= uniforms.convDims.z) {\n                  continue;\n                }\n\n                let value = getX(batch, xD, xR, xC, ch);\n                ").concat(e,"\n              }\n            }\n          }\n\n          ").concat(this.computePositions?"setOutputAtIndexI32(index, maxPosition);":"setOutputAtIndex(index, ".concat(t,");"),"\n        }\n      }\n    ")}}function G4(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reductionIndices:o,keepDims:i}=r;return I4(a,o,i,"max",n)}const H4={kernelName:W_,backendName:"webgpu",kernelFunc:G4};function K4(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{keepDims:o,axis:i}=r;return I4(a,i,o,"mean",n)}const q4={kernelName:X_,backendName:"webgpu",kernelFunc:K4};function X4(e,t,n,r){if(1===t.filterWidth&&1===t.filterHeight&&_O(t.inShape,t.outShape))return x3({inputs:{x:e},backend:r});if(t.filterWidth===t.inWidth&&t.filterHeight===t.inHeight&&1===t.batchSize&&"VALID"===t.padInfo.type){const a=e.shape.length,o=f3({inputs:{x:e},backend:r,attrs:{shape:[e.shape[a-3]*e.shape[a-2],e.shape[a-1]]}});let i;"avg"===n?i=K4({inputs:{x:o},backend:r,attrs:{axis:0,keepDims:!1}}):(EO("max"===n,()=>"Invalid pool type ".concat(n)),i=G4({inputs:{x:o},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const s=f3({inputs:{x:i},backend:r,attrs:{shape:t.outShape}});return r.disposeData(o.dataId),r.disposeData(i.dataId),s}let a;const o=[{type:"int32",data:[t.strideHeight,t.strideWidth]}];return 1===t.filterHeight&&1===t.filterWidth?a=new W4(t):("avg"===n?a=new U4(t,"avg"):(EO("max"===n,()=>"Invalid pool type ".concat(n)),a=new U4(t,"max")),o.push({type:"int32",data:[t.padInfo.top,t.padInfo.left]},{type:"int32",data:[t.dilationHeight,t.dilationWidth]},{type:"int32",data:[t.inHeight,t.inWidth]},{type:"int32",data:[t.effectiveFilterHeight,t.effectiveFilterWidth]})),r.runWebGPUProgram(a,[e],e.dtype,o)}const Y4={kernelName:IA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dimRoundingMode:c}=r;return X4(a,FL(a.shape,o,i,1,s,c),"avg",n)}};const Q4={kernelName:TA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=LL(a.shape,o,i,[1,1,1],s,l,c),d=new V4(u,"avg"),h=[{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.inDepth,u.inHeight,u.inWidth]},{type:"int32",data:[u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth]}];return n.runWebGPUProgram(d,[a],a.dtype,h)}};class Z4{constructor(e){this.variableNames=["dy"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32, avgMultiplier : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d = coords[3];\n\n        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;\n        let dyRCorner = dyRCCorner.x;\n        let dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            let dyValue = getDy(batch, idyR, idyC, d);\n\n            dotProd = dotProd + dyValue * uniforms.avgMultiplier;\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}class $4{constructor(e){this.variableNames=["dy"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,\n       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let ch = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyDCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {\n          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);\n\n          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {\n            continue;\n          }\n          let idyD = i32(dyD);\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              dotProd += dyValue * uniforms.avgMultiplier;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}const J4={kernelName:NA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=LL(i.shape,s,c,1,l,u),h=new $4(d),p=1/(d.filterDepth*d.filterHeight*d.filterWidth),f=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[p]}];return n.runWebGPUProgram(h,[a],i.dtype,f)}};const e6={kernelName:EA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o;V2([a,o],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=FL(i.shape,s,c,1,l),d=new Z4(u),h=1/(u.filterHeight*u.filterWidth),p=[{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.effectiveFilterHeight-1-u.padInfo.top,u.effectiveFilterWidth-1-u.padInfo.left]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[u.effectiveFilterHeight,u.effectiveFilterWidth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"float32",data:[h]}];return n.runWebGPUProgram(d,[a],i.dtype,p)}};const t6={kernelName:OA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:o}=t,{transposeA:i,transposeB:s}=r;return g3({a:a,b:o,transposeA:i,transposeB:s,backend:n})}};class n6{constructor(e,t){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.rank=t.length,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms="start : ".concat(I2(e.length),", "),this.shaderKey="slice"}getUserCode(){const e=I2(this.rank),t=function(e){if(1===e)return"sourceLoc";if(e<=6)return r6.slice(0,e).map(e=>"sourceLoc.".concat(e)).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);let n;n=1===this.start.length?this.outputShape.map((e,t)=>"sourceLoc = uniforms.start + coords;"):this.outputShape.map((e,t)=>"sourceLoc.".concat(r6[t]," = uniforms.start.").concat(E2(t)," + coords.").concat(r6[t],";"));return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          var sourceLoc : ").concat(e,";\n          let coords = getCoordsFromIndex(index);\n          ").concat(n.join("\n"),"\n          setOutputAtIndex(index, getSource(").concat(t,"));\n        }\n      }\n    ")}}const r6=["x","y","z","w","u","v"];function a6(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:o,size:i}=r,[s,c]=xL(a,o,i);if(iL(a,s,c),n.shouldExecuteOnCPU([a])||"string"===a.dtype){const e=n.tensorMap.get(a.dataId),t=e4(e.values,s,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,t)}if(0===OO(c))return n.makeTensorInfo(c,a.dtype,[]);const l=new n6(s,c),u=[{type:"int32",data:s}];return n.runWebGPUProgram(l,[a],a.dtype,u)}const o6={kernelName:DR,backendName:"webgpu",kernelFunc:a6},i6={kernelName:AA,backendName:"webgpu",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:o,crops:i}=r;EO(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const s=o.reduce((e,t)=>e*t),c=ZU(a.shape,o,s),l=$U(c.length,o.length),u=JU(a.shape,o,s),d=eV(i,o.length),h=tV(u,i,o.length),p=[],f=f3({inputs:{x:a},backend:n,attrs:{shape:c}}),m=w4({inputs:{x:f},backend:n,attrs:{perm:l}}),g=f3({inputs:{x:m},backend:n,attrs:{shape:u}}),y=a6({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(g),p.forEach(e=>n.disposeData(e.dataId)),y}},s6="\n  fn bincount_write(index: i32, value: f32) {\n    ".concat(w2("&result[index]","value","float32"),"\n  }\n");class c6{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=n,n&&(this.atomic=!1),this.hasWeights=t,this.hasWeights&&this.variableNames.push("w"),this.shaderKey="bincount_".concat(this.hasWeights,"_").concat(this.binaryOutput,"_").concat(this.rank)}getUserCode(){return"\n    ".concat(this.binaryOutput?"\n  fn bincount_write(index: i32, value: f32) {\n    atomicStore(&result[index], bitcast<i32>(value));\n  }\n":s6,"\n  ").concat(T2("index")," {\n    ").concat(1===this.rank?"if (index < uniforms.xShape) {\n      let indexVal = i32(getX(index));\n      if (indexVal < uniforms.binCountSize) {\n        let value = ".concat(this.binaryOutput?1:this.hasWeights?"getW(index)":"1.",";\n        bincount_write(indexVal, value);\n      }\n    }"):"let coord = getCoordsFromIndex(index);\n    if (coordsInBounds2D(coord, uniforms.xShape)) {\n      let indexVal = i32(getX(coord[0], coord[1]));\n      if (indexVal < uniforms.binCountSize) {\n        let value = ".concat(this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1.",";\n        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);\n      }\n    }"),"\n  }\n  ")}}const l6={kernelName:_A,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:o}=t,{size:i}=r,s=OO(a.shape),c=OO(o.shape)>0,l=[i],u=o.dtype,d=h3({backend:n,attrs:{shape:l,value:0,dtype:u}}),h=new c6([s],c),p=[{type:"int32",data:[i]}],f=c?[a,o]:[a];return n.runWebGPUProgram(h,f,u,p,d)}};class u6{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return"\n  ".concat(T2("index")," {\n    if (index < uniforms.size) {\n      var s0 = 1.0;\n      var s1 = 1.0;\n      let indexS0 = index - uniforms.size + uniforms.s0Size;\n      let indexS1 = index - uniforms.size + uniforms.s1Size;\n      if (indexS0 >= 0) {\n        s0 = getS0(indexS0);\n      }\n      if (indexS1 >= 0) {\n        s1 = getS1(indexS1);\n      }\n\n      if (s0 == 1.0) {\n        setOutputAtIndex(index, s1);\n      } else if (s1 == 1.0) {\n        setOutputAtIndex(index, s0);\n      } else if (s0 != s1) {\n        setOutputAtIndex(index, uniforms.NAN);\n      } else {\n        setOutputAtIndex(index, s0);\n      }\n    }\n  }\n  ")}}const d6={kernelName:PA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{s0:r,s1:a}=t;if(n.shouldExecuteOnCPU([r,a])){const e=n.tensorMap.get(r.dataId),t=n.tensorMap.get(a.dataId),o=e.values,i=t.values,s=TF(Array.from(o),Array.from(i));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}const o=OO(r.shape),i=OO(a.shape),s=Math.max(o,i),c=new u6(s),l=[{type:"int32",data:[o]},{type:"int32",data:[i]}];return n.runWebGPUProgram(c,[r,a],"int32",l)}},h6=E3({opType:q2.NOT_EQUAL,dtype:"bool",cpuKernelImpl:X3}),p6={kernelName:nR,backendName:"webgpu",kernelFunc:h6};function f6(e){const{inputs:t,backend:n}=e,{input:r}=t;return x3({inputs:{x:n.tensorMap.get(r.dataId).complexTensorInfos.real},backend:n})}const m6={kernelName:yR,backendName:"webgpu",kernelFunc:f6};const g6={kernelName:DA,backendName:"webgpu",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:a}=t,{x:o}=n,{dtype:i}=a;if("complex64"===i){if("complex64"===o.dtype)return x3({inputs:{x:o},backend:r});const t=jB(o.shape),n=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),a=k3({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeData(n.dataId),a}if("complex64"===o.dtype){const t=f6({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:i}});return r.disposeData(t.dataId),n}if(!WO(o.dtype,i)){const e=x3({inputs:{x:o},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:i}}if(r.shouldExecuteOnCPU([o])){const e=r.tensorMap.get(o.dataId).values,[t,n,a]=N3(e,o.shape,o.dtype,i);return r.makeTensorInfo(t,n,a)}if("int32"===i)return function(e,t){const n=new C3(e.shape,Y2.TO_INT),r=t.runWebGPUProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===i){const e=r.makeTensorInfo([],"bool",BO("bool",1)),t=h6({inputs:{a:o,b:e},backend:r});return r.disposeData(e.dataId),t}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(i))}},y6=I3({opType:Y2.CEIL,cpuKernelImpl:O3}),v6={kernelName:MA,backendName:"webgpu",kernelFunc:y6};class b6{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if(index < uniforms.size) {\n          let value = getAByOutputIndex(index);\n          var clampedValue = clamp(\n              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));\n          clampedValue = select(clampedValue, value, isnanVec4(value));\n          setOutputAtIndex(index, clampedValue);\n        }\n      }\n    ")}}class x6{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if(index < uniforms.size) {\n          let value = getAByOutputIndex(index);\n          if (isnan(value)) {\n            setOutputAtIndex(index, value);\n            return;\n          }\n          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));\n        }\n      }\n    ")}}const w6={kernelName:FA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:o,clipValueMax:i}=r;let s;const c=[{type:"float32",data:[o]},{type:"float32",data:[i]}];return s=OO(a.shape)%4===0?new b6(a.shape):new x6(a.shape),n.runWebGPUProgram(s,[a],a.dtype,c)}};class k6{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let re = abs(getRealByOutputIndex(index));\n        let im = abs(getImagByOutputIndex(index));\n        let mx = max(re, im);\n\n        // The length function in wgsl may be not underflow-safe on some GPUs.\n        // So the safe solution is to ensure underflow-safety in all cases.\n        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));\n      }\n    }\n  ")}}function S6(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const C6={kernelName:zA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=n.tensorMap.get(r.dataId),o=new k6(r.shape),i=[S6(r,a.complexTensorInfos.real),S6(r,a.complexTensorInfos.imag)];return n.runWebGPUProgram(o,i,i[0].dtype)}};class I6{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=UU(e,1),this.variableNames=e.map((e,t)=>"T".concat(t)),this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let t=0;t<this.offsetLength;t++)this.uniforms+="offset".concat(t," : i32,");this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let r=1;r<this.offsetLength;r++)e.push("else if (yC < uniforms.offset".concat([r],"){ ")+"setOutputAtCoords(coords.x, coords.y, getT".concat(r,"(yR, yC - uniforms.offset").concat(r-1,")); }"));const t=this.offsetLength,n=this.offsetLength-1;e.push("else { setOutputAtCoords(coords.x, coords.y, getT".concat(t,"(yR, yC - uniforms.offset").concat(n,")); }"))}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return"\n      ".concat(T2("index")," {\n        for(var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let flatIndex = index * ").concat(this.workPerThread," + i;\n          if(flatIndex < uniforms.size) {\n            let coords = getCoordsFromIndex(flatIndex);\n            let yR = coords.x;\n            let yC = coords.y;\n\n            ").concat(e.join("\n        "),"\n          }\n        }\n      }\n    ")}}function E6(e){const{inputs:t,backend:n}=e,{input:r}=t;return x3({inputs:{x:n.tensorMap.get(r.dataId).complexTensorInfos.imag},backend:n})}const T6={kernelName:E_,backendName:"webgpu",kernelFunc:E6};function N6(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map(e=>f6({inputs:{input:e},backend:n})),a=e.map(e=>E6({inputs:{input:e},backend:n})),o=N6(r,t,n),i=N6(a,t,n),s=k3({inputs:{real:o,imag:i},backend:n});return r.forEach(e=>n.disposeData(e.dataId)),a.forEach(e=>n.disposeData(e.dataId)),n.disposeData(o.dataId),n.disposeData(i.dataId),s}let a=n.shouldExecuteOnCPU(e);if("string"===r&&(a=!0),a){const a=e.map(e=>{const r=OO(e.shape.slice(t));return f3({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})}),o=a.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),i=UU(a.map(e=>e.shape),1),s=1===a[0].shape[0],c=A3(o,i,r,s),l=UU(e.map(e=>e.shape),t),u=n.makeTensorInfo(l,r,c);return a.forEach(e=>n.disposeData(e.dataId)),u}const o=n.device.limits.maxStorageBuffersPerShaderStage-1;if(e.length>o){const r=[];for(let i=0;i<e.length;i+=o){const a=e.slice(i,i+o);r.push(N6(a,t,n))}const a=N6(r,t,n);for(const e of r)n.disposeData(e.dataId);return a}const{tensors2D:i,outShape:s}=function(e,t,n){const r=UU(e.map(e=>e.shape),t),a=e.map(e=>f3({inputs:{x:e},backend:n,attrs:{shape:[OO(e.shape.slice(0,t)),OO(e.shape.slice(t))]}}));return{tensors2D:a,outShape:r}}(e,t,n),c=i.map(e=>e.shape),l=new I6(c),u=[],d=new Array(c.length-1);if(d.length>0){d[0]=c[0][1],u.push({type:"int32",data:[d[0]]});for(let e=1;e<d.length;e++)d[e]=d[e-1]+c[e][1],u.push({type:"int32",data:[d[e]]})}const h=n.runWebGPUProgram(l,i,i[0].dtype,u);i.forEach(e=>n.disposeData(e.dataId));const p=f3({inputs:{x:h},backend:n,attrs:{shape:s}});return n.disposeData(h.dataId),p}function O6(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r,o=LO(a,t[0].shape)[0];WU(t.map(e=>e.shape),o);const i=UU(t.map(e=>e.shape),o);if(0===OO(i))return n.makeTensorInfo(i,t[0].dtype,[]);const s=t.filter(e=>OO(e.shape)>0);return 1===s.length?x3({inputs:{x:s[0]},backend:n}):N6(s,o,n)}const A6={kernelName:BA,backendName:"webgpu",kernelFunc:O6};class _6{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast="channelsLast"===e.dataFormat,this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=z2(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=B2(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),a&&(this.variableNames.push("bias"),this.variableComponents.push(4)),i&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],a&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=s,this.addBias=a,this.activation=o,this.hasPreluActivationWeights=i,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=t%this.tileAOuter===0,this.fitBOuter=n%this.tileBOuter===0,this.fitInner=r%this.tileInner===0,this.shaderKey="conv2DMM_".concat(this.elementsPerThread,"_").concat(this.activation,"}_").concat(this.fitAOuter,"_").concat(this.fitBOuter,"_").concat(this.fitInner,"_").concat(this.isVec4,"_").concat(this.innerElementSize,"_").concat(this.isChannelsLast,"_").concat(this.sequentialAccessByThreads)}getUserCode(){const e=this.isVec4?r3(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):o3(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),t=this.isVec4?[this.innerElementSize,4,4]:[1,1,1],n="\n    ".concat(function(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:4,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:4;const u=e?"\n      let coord = vec4<i32>(batch, xRow, xCol, xCh);\n      ":"\n      let coord = vec4<i32>(batch, xCh, xRow, xCol);\n      ",d=e?"\n      let coords = vec4<i32>(\n        batch,\n        row / outWidth,\n        row % outWidth,\n        col);\n      ":"\n      let coords = vec4<i32>(\n        batch,\n        row,\n        col / outWidth,\n        col % outWidth);\n      ",h=e?"uniforms.xShape[1]":"uniforms.xShape[2]",p=e?"uniforms.xShape[2]":"uniforms.xShape[3]",f=e?"row":"col",m=e?"col":"row",g="\n      let inChannels = uniforms.wShape[2];\n      let outWidth = ".concat(e?"uniforms.outShape[2]":"uniforms.outShape[3]",";\n      let outRow = ").concat(f," / outWidth;\n      let outCol = ").concat(f," % outWidth;\n\n      let WRow = ").concat(m," / (uniforms.filterDims[1] * inChannels);\n      let WCol = ").concat(m," / inChannels % uniforms.filterDims[1];\n      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];\n      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];\n      let xCh = ").concat(m," % inChannels;\n      var resData = ").concat(C2(s),"(0.0);\n      // The bounds checking is always needed since we use it to pad zero for\n      // the 'same' padding type.\n      if (xRow >= 0 && xRow < ").concat(h," && xCol >= 0 && xCol < ").concat(p,") {\n        ").concat(u,"\n        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);\n        ").concat((e=>{switch(e){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error("innerElementSize ".concat(e," is not supported."))}})(s),"\n      }\n      return resData;"),y=e?t&&r?"\n      ".concat(g):"\n      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ".concat(g,"\n      }\n      return ").concat(C2(s),"(0.0);"):r&&n?"\n      ".concat(g):"\n      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {\n        ".concat(g,"\n      }\n      return ").concat(C2(s),"(0.0);"),v="".concat((e=>{switch(e){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error("innerElementSize ".concat(e," is not supported."))}})(c)),b=C2(l),x=C2(e?s:c),w=C2(e?c:s);return"\n      ".concat(J2(o,i,4===l,4),"\n      fn mm_readA(batch: i32, row : i32, col : i32) -> ").concat(x," {\n        ").concat(e?y:v,"\n      }\n\n      fn mm_readB(batch: i32, row : i32, col : i32) -> ").concat(w," {\n        ").concat(e?v:y,"\n      }\n\n      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ").concat(b,") {\n        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)\n        {\n        var value = valueIn;\n        let outWidth = ").concat(e?"uniforms.outShape[2]":"uniforms.outShape[3]",";\n        ").concat(d,"\n        ").concat(e3(a,o),"\n        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }")}(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,t[0],t[1],t[2]),"\n    ").concat(e,"\n  ");return n}}class R6{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast="channelsLast"===e.dataFormat,this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=t,this.activation=n,this.hasPreluActivationWeights=r,t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.shaderKey="conv2dnaive_".concat(this.activation,"_").concat(this.isChannelsLast)}getUserCode(){return"\n       ".concat(J2(this.activation,this.hasPreluActivationWeights,!1,4),"\n       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{\n         let coords = vec4<i32>(batch, row, col, chan);\n         if (coordsInBounds4D(coords, uniforms.xShape)) {\n           return  getX(batch, row, col, chan);\n         } else {\n          return 0.0;\n         }\n       }\n       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{\n         let coords = vec4<i32>(row, col, xChannel, outChannel);\n         if(coordsInBounds4D(coords, uniforms.wShape)) {\n           return getW(row, col, xChannel, outChannel);\n          } else {\n            return 0.0;\n          }\n       }\n       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {\n         let coords = ").concat(this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);","\n         if (coordsInBounds4D(coords, uniforms.outShape)) {\n           var value = valueIn;\n           ").concat(e3(this.addBias,this.activation),"\n           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);\n         }\n       }\n       ").concat(T2("index")," {\n         let coords = getOutputCoords();\n         let batch = coords[0];\n         let outChannel = ").concat(this.isChannelsLast?"coords[3];":"coords[1];","\n         let outRow = ").concat(this.isChannelsLast?"coords[1];":"coords[2];","\n         let outCol = ").concat(this.isChannelsLast?"coords[2];":"coords[3];","\n         var acc : f32 = 0.0;\n         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {\n           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {\n             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];\n             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];\n             for (var xChannel = 0; xChannel < ").concat(this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"," xChannel = xChannel + 1) {\n               ").concat(this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);","\n               let f = readFilt(row, col, xChannel, outChannel);\n               acc = acc + v * f;\n             }\n           }\n         }\n         writeResult(batch, outRow, outCol, outChannel, acc);\n       }\n     ")}}class P6{constructor(e,t){this.variableNames=["x"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,\n       inChannels : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=t,this.shaderKey="im2col_".concat(this.isChannelsLast)}getUserCode(){const e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,n=this.isChannelsLast?"coords[1]":"coords[2]",r=this.isChannelsLast?"coords[2]":"coords[1]",a=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return"\n    ".concat(T2("index")," {\n      let coords = getCoordsFromIndex(index);\n      if(index < uniforms.size) {\n        let batch = coords[0];\n        let row = ").concat(n,";\n        let col = ").concat(r,";\n        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];\n        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);\n        var value = 0.0;\n        if(xRow < uniforms.xShape[").concat(e,"] && xRow >= 0) {\n          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -\n              uniforms.pads[1];\n          let xCol = offsetX + uniforms.dilations[1] * ((col %\n              uniforms.itemsPerBlockRow) / uniforms.inChannels);\n          let ch = col % uniforms.inChannels;\n          if(xCol < uniforms.xShape[").concat(t,"] && xCol >= 0) {\n            value = ").concat(a,";\n          }\n        }\n        setOutputAtIndex(index, value);\n      }\n    }\n   ")}}function D6(e,t){const n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&1===n&&e[0]>1?[e[0],1]:null}function M6(e){let{x:t,filter:n,convInfo:r,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const l=null!=o,u=null!=i,d="channelsLast"===r.dataFormat,h=d&&r.filterHeight===r.inHeight&&r.filterWidth===r.inWidth&&"VALID"===r.padInfo.type,p=iA().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!p&&(h||1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type)))return function(e){let{x:t,filter:n,convInfo:r,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const l="channelsLast"===r.dataFormat,u=!l,d=[];let h,p;if(l&&r.filterHeight===r.inHeight&&r.filterWidth===r.inWidth&&"VALID"===r.padInfo.type){const e=r.inHeight*r.inWidth*r.inChannels;h=f3({inputs:{x:t},backend:a,attrs:{shape:[1,r.batchSize,e]}}),p=f3({inputs:{x:n},backend:a,attrs:{shape:[1,e,r.outChannels]}})}else h=f3({inputs:{x:t},backend:a,attrs:{shape:l?[r.batchSize,r.inHeight*r.inWidth,r.inChannels]:[r.batchSize,r.inChannels,r.inHeight*r.inWidth]}}),p=f3({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}});if(d.push(h),d.push(p),null!=i){const e=D6(i.shape,l);null!=e&&(i=f3({inputs:{x:i},backend:a,attrs:{shape:e}}),d.push(i))}if(null!=o){const e=D6(o.shape,l);null!=e&&(o=f3({inputs:{x:o},backend:a,attrs:{shape:e}}),d.push(o))}const f=g3({a:l?h:p,b:l?p:h,transposeA:u,transposeB:!1,backend:a,bias:o,activation:c,preluActivationWeights:i,leakyreluAlpha:s}),m=f3({inputs:{x:f},backend:a,attrs:{shape:r.outShape}});d.push(f);for(const g of d)a.disposeData(g.dataId);return m}({x:t,filter:n,convInfo:r,backend:a,bias:o,activation:c,preluActivationWeights:i,leakyreluAlpha:s});const f=iA().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),m=f>-1?f:a.thresholdToIncreaseWorkgroups,g=r.batchSize*Math.ceil(r.outHeight*r.outWidth/32)*Math.ceil(r.outChannels/32);if(iA().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||g<=m)return function(e){let{x:t,filter:n,convInfo:r,backend:a,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:s=0,activation:c=null}=e;const{filterWidth:l,filterHeight:u,inChannels:d,strideWidth:h,strideHeight:p,padInfo:f,outWidth:m,outHeight:g,dilationWidth:y,dilationHeight:v,dataFormat:b}=r,x="channelsLast"===b,w=l*u*d,k=g*m,S=x?[r.batchSize,k,w]:[r.batchSize,w,k],C=new P6(S,x),I=[{type:"int32",data:[f.top,f.left]},{type:"int32",data:[p,h]},{type:"int32",data:[v,y]},{type:"int32",data:[m]},{type:"int32",data:[d*l]},{type:"int32",data:[d]}],E=a.runWebGPUProgram(C,[t],t.dtype,I),T=[];T.push(E);const N=f3({inputs:{x:n},backend:a,attrs:{shape:[1,w,-1]}});if(T.push(N),null!=i){const e=D6(i.shape,x);null!=e&&(i=f3({inputs:{x:i},backend:a,attrs:{shape:e}}),T.push(i))}if(null!=o){const e=D6(o.shape,x);null!=e&&(o=f3({inputs:{x:o},backend:a,attrs:{shape:e}}),T.push(o))}const O=g3({a:x?E:N,b:x?N:E,transposeA:!x,transposeB:!1,backend:a,bias:o,activation:c,preluActivationWeights:i,leakyreluAlpha:s}),A=f3({inputs:{x:O},backend:a,attrs:{shape:r.outShape}});T.push(O);for(const _ of T)a.disposeData(_.dataId);return A}({x:t,filter:n,convInfo:r,backend:a,bias:o,preluActivationWeights:i,leakyreluAlpha:s,activation:c});let y;const v=[r.padInfo.top,r.padInfo.left],b=[{type:"int32",data:[r.filterHeight,r.filterWidth]},{type:"int32",data:[...v]},{type:"int32",data:[r.strideHeight,r.strideWidth]},{type:"int32",data:[r.dilationHeight,r.dilationWidth]}];if(p)y=new R6(r,l,c,u);else{const e=d?r.outHeight*r.outWidth:r.outChannels,t=d?r.outChannels:r.outHeight*r.outWidth,n=r.filterHeight*r.filterWidth*r.inChannels;b.push({type:"int32",data:[e]},{type:"int32",data:[t]},{type:"int32",data:[n]});const o=a.adapterInfo.isIntel();y=new _6(r,e,t,n,l,c,u,o)}const x=[],w=[t,n];l&&(d||1!==o.shape.length||(o=f3({inputs:{x:o},backend:a,attrs:{shape:[o.shape[0],1,1]}}),x.push(o)),w.push(o)),u&&(d||1!==i.shape.length||(i=f3({inputs:{x:i},backend:a,attrs:{shape:[i.shape[0],1,1]}}),x.push(i)),w.push(i)),"leakyrelu"===c&&(b.push({type:"float32",data:[s]}),y.uniforms+=" alpha : f32,");const k=a.runWebGPUProgram(y,w,t.dtype,b);for(const S of x)a.disposeData(S.dataId);return k}const F6={kernelName:jA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=n,d=XL(c);return M6({x:a,filter:o,convInfo:zL(a.shape,o.shape,i,l,s,u,!1,d),backend:r})}};class L6{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast="channelsLast"===e.dataFormat,this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey="conv2DDerInput_".concat(this.isChannelsLast,"_").concat(this.isVec4,"_").concat(this.workPerThread)}getUserCode(){const e=this.isChannelsLast?1:2,t=this.isChannelsLast?2:3,n=this.isChannelsLast?3:1,r="\n    ".concat(T2()," {\n      let batch = i32(globalId.z) / uniforms.outShape[1];\n      let r = i32(globalId.z) % uniforms.outShape[1];\n      let c = i32(globalId.y) * ").concat(this.workPerThread,";\n      let d1 = i32(globalId.x) * 4;\n\n      let dyCorner = vec2<i32>(r, c) - uniforms.pads;\n\n      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n      // ? = to be determined. : = across all values in that axis.\n      var dotProd: array<vec4<f32>, ").concat(this.workPerThread,">;\n      for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n        dotProd[i] = vec4<f32>(0.0);\n      }\n      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {\n        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);\n        let wRPerm = uniforms.filterDims.x - 1 - wR;\n        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||\n            fract(dyR) > 0.0) {\n          continue;\n        }\n        let idyR = i32(dyR);\n\n        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {\n          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);\n          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);\n          let wCPerm = uniforms.filterDims.y - 1 - wC;\n          var bDyCVal = true;\n          var bDyCVal2 = true;\n          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||\n              fract(dyC) > 0.0) {\n            bDyCVal = false;\n          }\n          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||\n              fract(dyC2) > 0.0) {\n            bDyCVal2 = false;\n          }\n\n          let idyC = i32(dyC);\n          let idyC2 = i32(dyC2);\n          if (bDyCVal && bDyCVal2) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[0] = dotProd[0] + tmpval;\n              xValue = getDy(batch, idyR, idyC2, d2);\n              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),\n                                                  dot(xValue, wValue1),\n                                                  dot(xValue, wValue2),\n                                                  dot(xValue, wValue3));\n            }\n          } else if (bDyCVal) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[0] = dotProd[0] + tmpval;\n            }\n          } else if (bDyCVal2) {\n            let d2Length = uniforms.outBackprop[3];\n            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {\n              let wValue0 = getW(wRPerm, wCPerm, d1, d2);\n              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);\n              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);\n              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);\n              var xValue =  getDy(batch, idyR, idyC2, d2);\n              let tmpval = vec4<f32>(dot(xValue, wValue0),\n                                     dot(xValue, wValue1),\n                                     dot(xValue, wValue2),\n                                     dot(xValue, wValue3));\n              dotProd[1] = dotProd[1] + tmpval;\n            }\n          }\n        }\n      }\n\n      for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n        let coords = vec4<i32>(batch, r, c + i, d1);\n        if (coordsInBounds4D(coords, uniforms.outShape)) {\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);\n        }\n      }\n    }\n    ");return this.isVec4?"\n    ".concat(r,"\n    "):"\n    ".concat(T2("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d1 = coords[").concat(n,"];\n\n        let dyCorner = vec2<i32>(coords[").concat(e,"], coords[").concat(t,"]) - uniforms.pads;\n        let dyRCorner = dyCorner.x;\n        let dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {\n          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);\n          let wRPerm = uniforms.filterDims.x - 1 - wR;\n          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||\n              wRPerm < 0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {\n            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);\n            let wCPerm = uniforms.filterDims.y - 1 - wC;\n            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||\n                fract(dyC) > 0.0 || wCPerm < 0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {\n              let xValue = ").concat(this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)",";\n              let wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd = dotProd + xValue * wValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}class z6{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast="channelsLast"===e.dataFormat,this.shaderKey="conv2DDerFilter_".concat(this.isChannelsLast)}getUserCode(){return"\n    ".concat(T2("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wR = coords[0];\n        let wC = coords[1];\n        let d1 = coords[2];\n        let d2 = coords[3];\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b = b + 1) {\n          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {\n            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];\n            if (xR < 0 || xR >= uniforms.inHeight) {\n              continue;\n            }\n\n            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {\n              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];\n\n              if (xC < 0 || xC >= uniforms.inWidth) {\n                continue;\n              }\n\n              if (").concat(this.isChannelsLast,") {\n                let dyValue = getDy(b, yR, yC, d2);\n                let xValue = getX(b, xR, xC, d1);\n                dotProd = dotProd + xValue * dyValue;\n              } else {\n                let dyValue = getDy(b, d2, yR, yC);\n                let xValue = getX(b, d1, xR, xC);\n                dotProd = dotProd + xValue * dyValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}class B6{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,\n       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wF = coords.x;\n        let wR = coords.y;\n        let wC = coords.z;\n        let d1 = coords.w;\n        let d2 = coords.u;\n\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b++) {\n          for (var yF = 0; yF < uniforms.outDepth; yF++) {\n            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];\n            if (xF < 0 || xF >= uniforms.inDepth) {\n              continue;\n            }\n\n            for (var yR = 0; yR < uniforms.outHeight; yR++) {\n              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];\n              if (xR < 0 || xR >= uniforms.inHeight) {\n                continue;\n              }\n\n              for (var yC = 0; yC < uniforms.outWidth; yC++) {\n                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];\n                if (xC < 0 || xC >= uniforms.inWidth) {\n                  continue;\n                }\n\n                let dyValue = getDy(b, yF, yR, yC, d2);\n                let xValue = getX(b, xF, xR, xC, d1);\n                dotProd += xValue * dyValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}class j6{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,\n      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if(index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let d1 = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyFCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        var dotProd = 0.0;\n        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {\n          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);\n          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {\n            continue;\n          }\n          let idyF = i32(dyF);\n\n          let wFPerm = uniforms.filterDims[0] - 1 - wF;\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            let wRPerm = uniforms.filterDims[1] - 1 - wR;\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let wCPerm = uniforms.filterDims[2] - 1 - wC;\n\n              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {\n                let xValue = getDy(batch, idyF, idyR, idyC, d2);\n                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n  ")}}const W6={kernelName:WA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,d=XL(c),h=zL(a.shape,u,i,1,s,l,!1,d),p=new z6(h),f=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]},{type:"int32",data:[h.inHeight]},{type:"int32",data:[h.inWidth]}];return n.runWebGPUProgram(p,[a,o],a.dtype,f)}};class U6{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,EO("channelsLast"===e.dataFormat,()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=z2(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=B2(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey="conv2DDerInputMM_".concat(this.isVec4,"_").concat(this.elementsPerThread)}getUserCode(){const e=this.isVec4?r3(this.elementsPerThread,this.workgroupSize):o3(this.elementsPerThread,this.workgroupSize),t="\n    ".concat(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;const t="\n      let outRow = row / uniforms.outShape[2];\n      let outCol = row % uniforms.outShape[2];\n\n      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);\n      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];\n      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);\n      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);\n      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {\n        return ".concat(C2(e),"(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {\n        return ").concat(C2(e),"(0.0);\n      }\n      let coord = vec4<i32>(\n          batch,\n          i32(xR),\n          i32(xC),\n          col % uniforms.outBackprop[3]);\n      return x[getIndexFromCoords4D(coord, uniforms.xShape)/").concat(e,"];"),n="if (row < uniforms.dimAOuter && col < uniforms.dimInner) {\n        ".concat(t,"\n      }\n      return ").concat(C2(e),"(0.0);");return"\n  fn mm_readA(batch: i32, row : i32, col : i32) -> ".concat(C2(e)," {\n    ").concat(n,"\n  }\n\n  fn mm_readB(batch: i32, row : i32, col : i32) -> ").concat(C2(e)," {\n    let coordX = uniforms.filterDims.x - 1 -\n        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);\n    let coordY = uniforms.filterDims.y - 1 -\n        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];\n    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&\n        coordX >= 0 && coordY >= 0) {\n      let rowInner = row % uniforms.outBackprop[3];\n      let coord = vec4<i32>(coordX, coordY, col, rowInner);\n      ").concat((e=>{switch(e){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return"\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];\n            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];\n            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];\n            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];\n            return vec4<f32>(v0, v1, v2, v3);\n            ";default:throw new Error("innerElementSize ".concat(e," is not supported."))}})(e),"\n    }\n    return ").concat(C2(e),"(0.0);\n  }\n\n  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ").concat(C2(e),") {\n    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {\n      var value = valueInput;\n      let outCoord = vec4<i32>(\n          batch,\n          row / uniforms.outShape[2],\n          row % uniforms.outShape[2],\n          col);\n      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/").concat(e,"] = value;\n    }\n  }")}(this.isVec4?4:1),"\n    ").concat(e,"\n    ");return t}}const V6={kernelName:UA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{inputShape:i,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r,d=XL(l),h=zL(i,o.shape,s,1,c,u,!1,d),p=[{type:"int32",data:[h.filterHeight,h.filterWidth]},{type:"int32",data:[h.filterHeight-1-h.padInfo.top,h.filterWidth-1-h.padInfo.left]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.batchSize,h.outHeight,h.outWidth,h.outChannels]}];let f;if(iA().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||"channelsLast"!==h.dataFormat)f=new L6(h);else{f=new U6(h);const e=h.inHeight*h.inWidth,t=h.inChannels,n=h.filterHeight*h.filterWidth*h.outChannels;p.push({type:"uint32",data:[e]},{type:"uint32",data:[t]},{type:"uint32",data:[n]})}return n.runWebGPUProgram(f,[a,o],"float32",p)}};class G6{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let batch = coords.x;\n        let d2 = coords.u;\n\n        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;\n        let xFCorner = xFRCCorner.x;\n        let xRCorner = xFRCCorner.y;\n        let xCCorner = xFRCCorner.z;\n\n        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;\n        let inputDepthVec4Remainder = uniforms.xShape.u % 4;\n\n        var dotProd = 0.0;\n        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {\n          let xF = xFCorner + wF * uniforms.dilations[0];\n          if (xF < 0 || xF >= uniforms.xShape.y) {\n            continue;\n          }\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let xR = xRCorner + wR * uniforms.dilations[1];\n            if (xR < 0 || xR >= uniforms.xShape.z) {\n              continue;\n            }\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let xC = xCCorner + wC * uniforms.dilations[2];\n              if (xC < 0 || xC >= uniforms.xShape.w) {\n                continue;\n              }\n\n              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {\n                let xValues = vec4<f32>(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                let wValues = vec4<f32>(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (inputDepthVec4Remainder == 1) {\n                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2);\n              } else if (inputDepthVec4Remainder == 2) {\n                let xValues = vec2<f32>(\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)\n                );\n                let wValues = vec2<f32>(\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (inputDepthVec4Remainder == 3) {\n                let xValues = vec3<f32>(\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),\n                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)\n                );\n                let wValues = vec3<f32>(\n                  getW(wF, wR, wC, inputDepthNearestVec4, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),\n                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }")}}const H6={kernelName:VA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dilations:c}=r,l=BL(a.shape,o.shape,i,c,s),u=[l.padInfo.front,l.padInfo.top,l.padInfo.left],d=[{type:"int32",data:[l.filterDepth,l.filterHeight,l.filterWidth]},{type:"int32",data:[...u]},{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.dilationDepth,l.dilationHeight,l.dilationWidth]}],h=new G6(l),p=vD(a.dtype,o.dtype);return n.runWebGPUProgram(h,[a,o],p,d)}};const K6={kernelName:GA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,pad:s,filterShape:c}=r,l=BL(a.shape,c,i,1,s),u=new B6(l),d=[{type:"int32",data:[l.padInfo.front,l.padInfo.top,l.padInfo.left]},{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.batchSize]},{type:"int32",data:[l.outDepth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]},{type:"int32",data:[l.inDepth]},{type:"int32",data:[l.inHeight]},{type:"int32",data:[l.inWidth]}];return n.runWebGPUProgram(u,[a,o],o.dtype,d)}};const q6={kernelName:HA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{strides:i,pad:s,inputShape:c}=r,l=BL(c,o.shape,i,1,s),u=new j6(l),d=[{type:"int32",data:[l.filterDepth,l.filterHeight,l.filterWidth]},{type:"int32",data:[l.filterDepth-1-l.padInfo.front,l.filterHeight-1-l.padInfo.top,l.filterWidth-1-l.padInfo.left]},{type:"int32",data:[l.strideDepth,l.strideHeight,l.strideWidth]},{type:"int32",data:[l.outDepth]},{type:"int32",data:[l.outHeight]},{type:"int32",data:[l.outWidth]},{type:"int32",data:[l.outChannels]}];return n.runWebGPUProgram(u,[a,o],a.dtype,d)}},X6=I3({opType:Y2.COS}),Y6={kernelName:KA,backendName:"webgpu",kernelFunc:X6},Q6=I3({opType:Y2.COSH}),Z6={kernelName:qA,backendName:"webgpu",kernelFunc:Q6};class $6{constructor(e,t,n,r){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[a]=t;this.outputShape=[a,n[0],n[1],e],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId="bilinear"===r?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey="cropAndResize_".concat(this.methodId,"_").concat(this.cropHeightBiggerThan1,"_").concat(this.cropWidthBiggerThan1)}getUserCode(){const[e,t]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[n,r,a]=this.cropHeightBiggerThan1?["(".concat(e," / f32(uniforms.outShape[1] - 1))"),"(y2-y1) * height_ratio","y1*".concat(e," + f32(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(e)],[o,i,s]=this.cropWidthBiggerThan1?["(".concat(t," / f32(uniforms.outShape[2] - 1))"),"(x2-x1) * width_ratio","x1*".concat(t," + f32(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(t)];return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let height_ratio = f32(").concat(n,");\n        let width_ratio = f32(").concat(o,");\n        let b = coords[0];\n        let y = coords[1];\n        let x = coords[2];\n        let d = coords[3];\n        // get box vals\n        let y1 = getBoxes(b, 0);\n        let x1 = getBoxes(b, 1);\n        let y2 = getBoxes(b, 2);\n        let x2 = getBoxes(b, 3);\n        // get image in batch index\n        let bInd = i32(round(getBoxInd(b)));\n        if(bInd < 0 || bInd >= uniforms.outShape[0]) {\n          return;\n        }\n        let height_scale = ").concat(r,";\n        let width_scale = ").concat(i,";\n        let in_y = ").concat(a,";\n        if( in_y < 0.0 || in_y > ").concat(e," ) {\n          setOutputAtIndex(index, uniforms.extrapolationValue);\n          return;\n        }\n        let in_x = ").concat(s,";\n        if( in_x < 0.0 || in_x > ").concat(t," ) {\n          setOutputAtIndex(index, uniforms.extrapolationValue);\n          return;\n        }\n        let sourceFracIndexCR = vec2<f32>(in_x,in_y);\n        if(").concat(this.methodId," == 1) {\n          // Compute the four integer indices.\n          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);\n          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));\n          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);\n          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);\n          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);\n          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);\n          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);\n          let top = topLeft + (topRight - topLeft) * fracCR.x;\n          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          let newValue = top + (bottom - top) * fracCR.y;\n          setOutputAtIndex(index, newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          let sourceNearestCR = vec2<i32>(floor(\n            sourceFracIndexCR + vec2<f32>(0.5,0.5)));\n          let newValue = getImage(\n            bInd, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    }\n    ")}}const J6={kernelName:QA,backendName:"webgpu",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:a,boxes:o,boxInd:i}=t,{cropSize:s,method:c,extrapolationValue:l}=r,u=new $6(a.shape[3],o.shape,s,c),d=[{type:"float32",data:[l]}];return n.runWebGPUProgram(u,[a,o,i],"float32",d)}};var e5;!function(e){e.Prod="*",e.Sum="+"}(e5||(e5={}));class t5{constructor(e,t,n,r){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=t,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=n,this.reverse=r,this.op=e,this.shaderKey="cum_".concat(this.op,"_").concat(this.exclusive,"_").concat(this.reverse)}getUserCode(){const e=this.outputShape.length,t=this.op===e5.Prod?"1.0":"0.0",n=this.exclusive?t:"getX(".concat(n5(e,"coords",this.op),")"),r=this.outputShape[this.outputShape.length-1];let a="",o="";return this.exclusive?(a=this.reverse?"end != ".concat(r-1):"end != 0",o=this.reverse?"end + 1":"end - 1"):(a=this.reverse?"end + pow2 < ".concat(r):"end >= pow2",o=this.reverse?"end + pow2":"end - pow2"),"\n      ".concat(T2("index")," {\n       if (index < uniforms.size) {\n         var coords = getCoordsFromIndex(index);\n\n         let end = ").concat(r5(e,"coords",this.op),";\n         var val = ").concat(n,";\n         let pow2 = i32(pow(2.0, uniforms.index));\n         if (").concat(a,") {\n           let idx = ").concat(o,";\n           ").concat(r5(e,"coords",this.op)," = idx;\n           val ").concat(this.op,"= getX(").concat(n5(e,"coords",this.op),");\n         }\n         setOutputAtIndex(index, val);\n       }\n      }\n    ")}}function n5(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function r5(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function a5(e,t,n,r,a,o){const i=t.shape.length,s=Yz([r],i);let c=t;null!=s&&(c=w4({inputs:{x:t},backend:n,attrs:{perm:s}}));const l=Zz(1,i)[0];if(l!==i-1)throw new Error("WebGPU cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));const u=c.shape[l];let d=x3({inputs:{x:c},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const t=new t5(e,c.shape,!1,o),r=d,a=[{type:"float32",data:[h]}];d=n.runWebGPUProgram(t,[d],d.dtype,a),n.disposeData(r.dataId)}if(a){const t=new t5(e,c.shape,a,o),r=d,i=[{type:"float32",data:[0]}];d=n.runWebGPUProgram(t,[d],d.dtype,i),n.disposeData(r.dataId)}if(null!=s){const e=w4({inputs:{x:d},backend:n,attrs:{perm:Qz(s)}});return n.disposeData(d.dataId),n.disposeData(c.dataId),e}return d}const o5={kernelName:XA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,exclusive:i,reverse:s}=r;return a5(e5.Prod,a,n,o,i,s)}};const i5={kernelName:YA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,exclusive:i,reverse:s}=r;return a5(e5.Sum,a,n,o,i,s)}};const s5={kernelName:ZA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,weights:o}=t,{size:i,binaryOutput:s}=r,c=1===a.shape.length,l=OO(o.shape)>0,u=o.dtype,d=c?[a.shape[0]]:[a.shape[0],a.shape[1]],h=h3({backend:n,attrs:{shape:c?[i]:[a.shape[0],i],value:0,dtype:u}}),p=new c6(d,l,s),f=[{type:"int32",data:[i]}],m=l?[a,o]:[a];return n.runWebGPUProgram(p,m,u,f,h)}};class c5{constructor(e,t){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthToSpace_".concat(t),this.dataFormat=t}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let h = ").concat(this.getHeightCoordString(),";\n          let w = ").concat(this.getWidthCoordString(),";\n          let d = ").concat(this.getDepthCoordString(),";\n\n          let in_h = h / uniforms.blockSize;\n          let offset_h = h % uniforms.blockSize;\n          let in_w = w / uniforms.blockSize;\n          let offset_w = w % uniforms.blockSize;\n          let offset_d = (offset_h * uniforms.blockSize + offset_w) *\n            ").concat(this.getOutputDepthSize(),";\n          let in_d = d + offset_d;\n\n          let rlt = ").concat(this.getInputSamplingString(),";\n          setOutputAtIndex(index, rlt);\n        }\n      }")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const l5={kernelName:$A,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockSize:o,dataFormat:i}=r,s=a.shape[0],c=("NHWC"===i?a.shape[1]:a.shape[2])*o,l=("NHWC"===i?a.shape[2]:a.shape[3])*o,u=("NHWC"===i?a.shape[3]:a.shape[1])/(o*o),d=[{type:"int32",data:[o]}],h=new c5("NHWC"===i?[s,c,l,u]:[s,u,c,l],i);return n.runWebGPUProgram(h,[a],a.dtype,d)}};class u5{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),r&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.addBias=r,this.activation=a,this.hasPreluActivation=o,this.filterHeight=t,this.filterWidth=n,this.shaderKey="depthwiseNCHW_".concat(this.activation,"_").concat(this.filterHeight,"_").concat(this.filterWidth)}getUserCode(){const e=this.filterWidth*this.filterHeight,t=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],n=this.workgroupSize[1]+this.filterHeight-1,r=this.workgroupSize[0]+this.filterWidth-1;return"\n      ".concat(J2(this.activation,this.hasPreluActivation,!1,4),"\n\n      var<workgroup> mm_Asub : array<array<f32, ").concat(r,">, ").concat(n,">;\n      var<workgroup> mm_Bsub : array<array<f32, ").concat(this.filterWidth,">, ").concat(this.filterHeight,">;\n      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {\n        var value = 0.0;\n        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])\n        {\n          value = getX(batch, channel, row, col);\n        }\n        return value;\n      }\n\n      ").concat(T2()," {\n        let coords = getOutputCoords();\n        let batch = coords[0];\n        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;\n        let channelMul = uniforms.wShape[3];\n        let d1 = coords[1] / channelMul;\n        let q = coords[1] % channelMul;\n\n        let inputRowStart = xRCCorner.x;\n        let inputColStart = xRCCorner.y;\n\n        let localRow = i32(localId.y);\n        let localCol = i32(localId.x);\n\n        // Load one tile of X into local memory.\n        for (var inputRow = localRow; inputRow < ").concat(n,"; inputRow = inputRow + ").concat(this.workgroupSize[1],") {\n          for (var inputCol = localCol; inputCol < ").concat(r,"; inputCol = inputCol + ").concat(this.workgroupSize[0],") {\n            let rowOffset = inputRow - localRow;\n            let colOffset = inputCol - localCol;\n            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);\n          }\n        }\n\n        // Load one tile of W into local memory.\n        var wIndex = i32(localIndex);\n        ").concat(e<t?"if (wIndex < ".concat(e,")"):"for(; wIndex < ".concat(e,"; wIndex = wIndex + ").concat(t,")"),"\n\n        {\n          let wRow = wIndex / ").concat(this.filterWidth,";\n          let wCol = wIndex % ").concat(this.filterWidth,";\n          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);\n        }\n\n        workgroupBarrier();\n\n        var value = 0.0;\n        for (var wR = 0; wR < ").concat(this.filterHeight,"; wR = wR + 1) {\n          for (var wC = 0; wC < ").concat(this.filterWidth,"; wC = wC + 1) {\n            let xVal = mm_Asub[localRow + wR][localCol + wC];\n            let wVal = mm_Bsub[wR][wC];\n            value = fma(xVal, wVal, value);\n          }\n        }\n        ").concat(e3(this.addBias,this.activation),"\n        if (coordsInBounds4D(coords, uniforms.outShape)) {\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }\n    ")}}class d5{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const a=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=j2(a),this.dispatch=L2(this.dispatchLayout,a,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),EO("channelsLast"===e.dataFormat,()=>"TODO: NCHW is unimplemented"),t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=t,this.activation=n,this.hasPreluActivation=r,this.shaderKey="depthwiseVec4_".concat(n,"_").concat(this.convInfo.filterHeight,"_").concat(this.convInfo.filterWidth,"_").concat(this.convInfo.strideHeight,"_").concat(this.convInfo.strideWidth,"_").concat(this.workPerThread)}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,t=this.convInfo.strideHeight,n=this.convInfo.strideWidth;return"\n      ".concat(J2(this.activation,this.hasPreluActivation,!0,4),"\n      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {\n        var value = vec4<f32>(0.0);\n        if (col >=0 && col < uniforms.inDims[1]) {\n          value = getX(batch, row, col, channel);\n        }\n        return value;\n      }\n\n      ").concat(T2("index")," {\n        let width0 = uniforms.outShape[3] / ").concat(this.outputComponent,";\n        let d1 = (index % width0) * ").concat(this.outputComponent,";\n        var index1 = index / width0;\n        let width1 = uniforms.virtualWidth / ").concat(this.workPerThread,";\n        let c = (index1 % width1) * ").concat(this.workPerThread,";\n        index1 = index1 / width1;\n        let r = index1 % uniforms.outShape[1];\n        let batch = index1 / uniforms.outShape[1];\n\n        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(").concat(t,", ").concat(n,") - uniforms.pads;\n\n        let xRCorner = xRCCorner.x;\n        let xCCorner = xRCCorner.y;\n        var xVals : array<vec4<f32>, ").concat(e,">;\n        var dotProd : array<vec4<f32>, ").concat(this.workPerThread,">;\n        for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n          dotProd[i] = vec4<f32>(0.0);\n        }\n\n        // Use constant instead of uniform can give better performance.\n        for (var wR = 0; wR < ").concat(this.convInfo.filterHeight,"; wR = wR + 1) {\n          let xR = xRCorner + wR;\n          if (xR >=0 && xR < uniforms.inDims[0]) {\n            for (var i = 0; i < ").concat(e,"; i++) {\n              xVals[i] = readX(batch, xR, xCCorner + i, d1);\n            }\n            for (var wC = 0; wC < ").concat(this.convInfo.filterWidth,"; wC = wC + 1) {\n              let wValue = getW(wR, wC, d1, 0);\n              for (var i = 0; i < ").concat(this.workPerThread,"; i++) {\n                dotProd[i] = fma(xVals[i * ").concat(n," + wC], wValue, dotProd[i]);\n              }\n            }\n          }\n        }\n\n        for (var i = 0; i < ").concat(this.workPerThread,"; i = i + 1) {\n          let coords = vec4<i32>(batch, r, c + i, d1);\n          if (coordsInBounds4D(coords, uniforms.outShape)) {\n            var value = dotProd[i];\n            ").concat(e3(this.addBias,this.activation),"\n            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n          }\n        }\n      }\n    ")}}class h5{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,\n      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast="channelsLast"===e.dataFormat,t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=t,this.activation=n,this.hasPreluActivation=r,this.shaderKey="depthwise_".concat(this.activation,"_").concat(this.isChannelsLast)}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return"\n      ".concat(J2(this.activation,this.hasPreluActivation,!1,4),"\n\n      ").concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let batch = coords[0];\n          let xRCCorner = vec2<i32>(coords.").concat(this.isChannelsLast?"yz":"zw",") * uniforms.strides - uniforms.pads;\n          let d2 = coords[").concat(this.isChannelsLast?3:1,"];\n          let channelMul = uniforms.wShape[3];\n          let d1 = d2 / channelMul;\n          let q = d2 % channelMul;\n\n          let inputRowStart = xRCCorner.x;\n          let inputColStart = xRCCorner.y;\n          let inputRowEnd = inputRowStart + uniforms.filterHeight *\n              uniforms.dilations[0];\n          let inputColEnd = inputColStart + uniforms.filterWidth *\n              uniforms.dilations[1];\n\n          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get\n          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all\n          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.\n          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.\n          var value = 0.0;\n\n          // Extract if checking out of for loop for performance.\n          if (inputRowStart >= 0 && inputColStart >= 0 &&\n            inputRowEnd < uniforms.inDims[0] &&\n                inputColEnd < uniforms.inDims[1]) {\n              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {\n                let xR = inputRowStart + wR * uniforms.dilations[0];\n\n                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {\n                  let xC = inputColStart + wC * uniforms.dilations[1];\n\n                  let xVal = ").concat(e,";\n                  let wVal = getW(wR, wC, d1, q);\n                  value = value + xVal * wVal;\n                }\n              }\n            } else {\n              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {\n                let xR = inputRowStart + wR * uniforms.dilations[0];\n\n                if (xR < 0 || xR >= uniforms.inDims[0]) {\n                  continue;\n                }\n\n                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {\n                  let xC = inputColStart + wC * uniforms.dilations[1];\n\n                  if (xC < 0 || xC >= uniforms.inDims[1]) {\n                    continue;\n                  }\n\n                  let xVal = ").concat(e,";\n                  let wVal = getW(wR, wC, d1, q);\n                  value = value + xVal * wVal;\n                }\n              }\n            }\n            ").concat(e3(this.addBias,this.activation),"\n          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n        }\n      }\n    ")}}const p5={kernelName:JA,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r,d=XL(c);let h=l;null==h&&(h=[1,1]);const p=zL(a.shape,o.shape,i,h,s,u,!0,d),f=[{type:"int32",data:[p.padInfo.top,p.padInfo.left]},{type:"int32",data:[p.inHeight,p.inWidth]}],m="channelsLast"===p.dataFormat;let g;return!m&&p.inHeight>16&&p.inWidth>16&&1===p.strideHeight&&1===p.strideWidth&&1===p.dilationWidth&&1===p.dilationHeight&&p.inChannels===p.outChannels?g=new u5(p.outShape,p.filterHeight,p.filterWidth):m&&p.outHeight>4&&p.outWidth>4&&p.strideWidth<=2&&p.inChannels===p.outChannels&&1===p.dilationHeight&&1===p.dilationWidth&&p.inChannels%4===0?(g=new d5(p),f.push({type:"int32",data:[g.virtualWidth]})):(g=new h5(p),f.push({type:"int32",data:[p.filterHeight]},{type:"int32",data:[p.filterWidth]},{type:"int32",data:[p.strideHeight,p.strideWidth]},{type:"int32",data:[p.dilationHeight,p.dilationWidth]})),n.runWebGPUProgram(g,[a,o],a.dtype,f)}};class f5{constructor(e){this.variableNames=["x","dy"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,\n      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let wR = coords[0];\n        let wC = coords[1];\n        let d1 = coords[2];\n        let dm = coords[3];\n        let d2 = d1 * uniforms.channelMul + dm;\n\n        var dotProd = 0.0;\n        for (var b = 0; b < uniforms.batchSize; b++) {\n          for (var yR = 0; yR < uniforms.outHeight; yR++) {\n            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];\n\n            if (xR < 0 || xR >= uniforms.inHeight) {\n              continue;\n            }\n\n            for (var yC = 0; yC < uniforms.outWidth; yC++) {\n              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];\n\n              if (xC < 0 || xC >= uniforms.inWidth) {\n                continue;\n              }\n\n              let dyValue = getDy(b, yR, yC, d2);\n              let xValue = getX(b, xR, xC, d1);\n              dotProd += xValue * dyValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}class m5{constructor(e){this.variableNames=["dy","W"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32, channelMul : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d1 = coords[3];\n        let dyCorner = coords.yz - uniforms.pads;\n        let dyRCorner = dyCorner.x;\n        let dyCCorner = dyCorner.y;\n\n        var dotProd = 0.0;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n\n          let idyR = i32(dyR);\n          let wRPerm = uniforms.filterDims[0] - 1 - wR;\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n\n            let idyC = i32(dyC);\n            let wCPerm = uniforms.filterDims[1] - 1 - wC;\n\n            for (var dm = 0; dm < uniforms.channelMul; dm++) {\n              let d2 = d1 * uniforms.channelMul + dm;\n              let xValue = getDy(batch, idyR, idyC, d2);\n              let wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}const g5={kernelName:e_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,dy:o}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r,d=zL(a.shape,u,i,s,c,l,!0),h=new f5(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[a,o],"float32",p)}};const y5={kernelName:t_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,filter:o}=t,{strides:i,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r,d=zL(u,o.shape,i,s,c,l,!0),h=new m5(d),p=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(h,[a,o],a.dtype,p)}};class v5{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);\n          setOutputAtIndex(index, value);\n        }\n      }\n    ")}}const b5={kernelName:n_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t,a=[...r.shape,...r.shape],o=OO(r.shape),i=f3({inputs:{x:r},backend:n,attrs:{shape:[o]}}),s=new v5(o),c=n.runWebGPUProgram(s,[i],i.dtype),l=f3({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeData(i.dataId),n.disposeData(c.dataId),l}};class x5{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return"\n       ".concat(T2("index")," {\n         if (index < uniforms.size) {\n           let neg_infinity = -3.4e38;\n           let coords = getOutputCoords();\n           let batch = coords.x;\n           let d1 = coords.w;\n           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;\n           let hBeg = outTopLeftCorner.x;\n           let wBeg = outTopLeftCorner.y;\n\n           var curVal = neg_infinity;\n           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {\n             let hIn = hBeg + h * uniforms.dilations[0];\n\n             if (hIn >= 0 && hIn < uniforms.xShape[1]) {\n               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {\n                 let wIn = wBeg + w * uniforms.dilations[1];\n\n                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {\n                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);\n                   if (val > curVal) {\n                     curVal = val;\n                   }\n                 }\n               }\n             }\n           }\n\n           setOutputAtIndex(index, curVal);\n         }\n       }\n     ")}}const w5={kernelName:r_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o}=t,{strides:i,pad:s,dilations:c}=r,l=ML(a.shape,o.shape,i,s,"NHWC",c),u=[l.padInfo.top,l.padInfo.left],d=[{type:"int32",data:[l.filterHeight,l.filterWidth]},{type:"int32",data:[...u]},{type:"int32",data:[l.strideHeight,l.strideWidth]},{type:"int32",data:[l.dilationHeight,l.dilationWidth]}],h=new x5(l);return n.runWebGPUProgram(h,[a,o],a.dtype,d)}};class k5{constructor(e,t){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(e.outShape),this.dispatch=L2(this.dispatchLayout,e.outShape,this.workgroupSize),"float32"!==t&&"int32"!==t)throw new Error("Dilation2DBackpropInput only supports float32 and int32\n          types, does not support ".concat(t," type."));this.type=t,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return"\n       ".concat(T2("index")," {\n         if (index < uniforms.dySize) {\n           let coords = getDyCoordsFromIndex(index);\n           let b = coords[0];\n           let r = coords[1];\n           let c = coords[2];\n           let d = coords[3];\n\n           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;\n           var curVal = -3.4e38;  // neg_infinity\n           var xRMax = 0;\n           var xCMax = 0;\n\n           // In the case of multiple argmax branches, we only back-propagate\n           // along the last branch, i.e., the one with largest value of\n           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling\n           // backward routines.\n           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n             let xR = dyCorner.x + wR * uniforms.dilations[0];\n\n             if (xR >= 0 && xR < uniforms.xShape[1]) {\n               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n                 let xC = dyCorner.y + wC * uniforms.dilations[1];\n\n                 if (xC >= 0 && xC < uniforms.xShape[2]) {\n                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);\n                   if (val > curVal) {\n                     curVal = val;\n                     xRMax = xR;\n                     xCMax = xC;\n                   }\n                 }\n               }\n             }\n           }\n\n           let flatIndexIn = d + uniforms.xShape[3] *\n               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));\n           let value = getDy(b, r, c, d);\n           ").concat(w2("&result[flatIndexIn]","value",this.type),"\n         }\n       }\n     ")}}class S5{constructor(e,t,n){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=j2(e.outShape),this.dispatch=L2(this.dispatchLayout,e.outShape,this.workgroupSize),"float32"!==n&&"int32"!==n)throw new Error("Dilation2DBackpropFilter only supports float32 and int32\n          types, does not support ".concat(n," type."));this.type=n,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return"\n       ".concat(T2("index")," {\n         if (index < uniforms.dySize) {\n           let coords = getDyCoordsFromIndex(index);\n           let b = coords[0];\n           let r = coords[1];\n           let c = coords[2];\n           let d = coords[3];\n\n           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;\n           var curVal = -3.4e38;  // neg_infinity\n           var wRMax = 0;\n           var wCMax = 0;\n\n           // In the case of multiple argmax branches, we only back-propagate\n           // along the last branch, i.e., the one with largest value of\n           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling\n           // backward routines.\n           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {\n             let xR = dyCorner.x + wR * uniforms.dilations[0];\n\n             if (xR >= 0 && xR < uniforms.xShape[1]) {\n               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {\n                 let xC = dyCorner.y + wC * uniforms.dilations[1];\n\n                 if (xC >= 0 && xC < uniforms.xShape[2]) {\n                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);\n                   if (val > curVal) {\n                     curVal = val;\n                     wRMax = wR;\n                     wCMax = wC;\n                   }\n                 }\n               }\n             }\n           }\n\n           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);\n           let value = getDy(b, r, c, d);\n           ").concat(w2("&result[flatIndexIn]","value",this.type),"\n         }\n       }\n     ")}}const C5={kernelName:"Dilation2DBackpropFilter",backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,dy:i}=t,{strides:s,pad:c,dilations:l}=r,u=ML(a.shape,o.shape,s,c,"NHWC",l),d=o.dtype,h=new S5(u,o.shape,d),p=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[OO(u.outShape)]}],f=h3({backend:n,attrs:{shape:o.shape,value:0,dtype:d}});return n.runWebGPUProgram(h,[a,o,i],d,p,f)}};const I5={kernelName:"Dilation2DBackpropInput",backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,dy:i}=t,{strides:s,pad:c,dilations:l}=r,u=ML(a.shape,o.shape,s,c,"NHWC",l),d=a.dtype,h=new k5(u,d),p=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[OO(u.outShape)]}],f=h3({backend:n,attrs:{shape:u.inShape,value:0,dtype:d}});return n.runWebGPUProgram(h,[a,o,i],d,p,f)}};class E5{constructor(e,t,n){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=k2.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=t,this.textureFormat=n,this.shaderKey="draw_".concat(t,"_").concat(n)}getUserCode(){let e;const t="float32"===this.type?"value":"value / 255.0";e="\n      if (uniforms.numChannels == 1) {\n        rgba[0] = ".concat(t,";\n        rgba[1] = ").concat(t,";\n        rgba[2] = ").concat(t,";\n      } else {\n        rgba[d] = ").concat(t,";\n      }");return"\n       @group(0) @binding(0) var outImage : texture_storage_2d<".concat(this.textureFormat,", write>;\n       ").concat(T2("index")," {\n         if (index < uniforms.size) {\n           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);\n           for (var d = 0; d < uniforms.numChannels; d = d + 1) {\n             let value = f32(inBuf[index * uniforms.numChannels + d]);\n             ").concat(e,"\n           }\n           rgba.x = rgba.x * rgba.w;\n           rgba.y = rgba.y * rgba.w;\n           rgba.z = rgba.z * rgba.w;\n           let coords = getCoordsFromIndex(index);\n           textureStore(outImage, vec2<i32>(coords.yx), rgba);\n         }\n       }\n      ")}}const T5={kernelName:a_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{canvas:o,options:i}=r,[s,c]=a.shape.slice(0,2),{imageOptions:l}=i||{},u=(null===l||void 0===l?void 0:l.alpha)||1,d=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",h=[s,c],p=new E5(h,a.dtype,d);o.width=c,o.height=s;const f="webgpu";let m,g=o.getContext(f);g||(m=new OffscreenCanvas(c,s),g=m.getContext(f));const y=3===a.shape.length?a.shape[2]:1;g.configure({device:n.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const v="int32",b=n.makeTensorInfo(h,v),x=n.tensorMap.get(b.dataId);x.resource=g.getCurrentTexture(),x.external=!0;const w=[{type:"uint32",data:[y]},{type:"float32",data:[u]}];if(n.runWebGPUProgram(p,[a],v,w,b),m){const e=o.getContext("2d");if(!e)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");e.drawImage(m,0,0)}return n.disposeData(b.dataId),a}},N5=E3({opType:q2.MUL,cpuKernelImpl:K3,supportsComplex:!0}),O5={kernelName:eR,backendName:"webgpu",kernelFunc:N5};function A5(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r;return I4(a,o,i,"sum",n)}const _5={kernelName:WR,backendName:"webgpu",kernelFunc:A5};const R5={kernelName:i_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{equation:a}=r,o=t,{allDims:i,summedDims:s,idDims:c}=SV(a,o.length);IV(i.length,c,o);const{path:l,steps:u}=EV(s,c),d=u.length;let h=null,p=i.length;const f=[];for(let m=0;m<d;++m){for(const e of u[m]){const{permutationIndices:t,expandDims:r}=CV(p,c[e]);let a;TV(t)?a=o[e]:(a=w4({inputs:{x:o[e]},backend:n,attrs:{perm:t}}),f.push(a));const i=a.shape.slice();for(let e=0;e<r.length;++e)i.splice(r[e],0,1);_O(a.shape,i)||(a=f3({inputs:{x:a},backend:n,attrs:{shape:i}}),f.push(a)),null===h?h=a:(h=N5({inputs:{a:a,b:h},backend:n}),f.push(h))}m<d-1&&(l[m]>=0&&(h=A5({inputs:{x:h},backend:n,attrs:{axis:l[m]-(i.length-p),keepDims:!1}}),f.push(h)),p--)}for(const m of f)m!==h&&n.disposeData(m.dataId);return h}},P5=I3({opType:Y2.ELU}),D5={kernelName:s_,backendName:"webgpu",kernelFunc:P5},M5={kernelName:c_,backendName:"webgpu",kernelFunc:e=>{const{inputs:t,backend:n}=e,{dy:r,y:a}=t,o=new b3(q2.ELU_DER,r.shape,a.shape);return n.runWebGPUProgram(o,[r,a],r.dtype)}},F5=E3({opType:q2.EQUAL,dtype:"bool",cpuKernelImpl:_3}),L5={kernelName:u_,backendName:"webgpu",kernelFunc:F5},z5=I3({opType:Y2.ERF}),B5={kernelName:l_,backendName:"webgpu",kernelFunc:z5},j5=I3({opType:Y2.EXP,cpuKernelImpl:R3,dtype:"float32"}),W5={kernelName:d_,backendName:"webgpu",kernelFunc:j5};function U5(e){const{inputs:t,attrs:n,backend:r}=e,{dim:a}=n,{input:o}=t,i=o.shape.length,s=o.shape.slice();let c=a;return a<0&&(EO(-(i+1)<=a,()=>"Axis must be in the interval [".concat(-(i+1),", ").concat(i,"]")),c=i+a+1),s.splice(c,0,1),f3({inputs:{x:o},backend:r,attrs:{shape:s}})}const V5={kernelName:h_,backendName:"webgpu",kernelFunc:U5},G5=I3({opType:Y2.EXPM1,cpuKernelImpl:P3}),H5={kernelName:p_,backendName:"webgpu",kernelFunc:G5};class K5{constructor(e,t){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey="fft_".concat(e)}getUserCode(){const e="real"===this.component?"return real * expR - imag * expI;":"return real * expI + imag * expR;";return"\n    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {\n      ".concat(e,"\n    }\n\n    fn mulMatDFT(batch: i32, index: i32) -> f32 {\n      let indexRatio = f32(index) / f32(uniforms.realShape[1]);\n      let exponentMultiplierTimesIndexRatio =\n          uniforms.exponentMultiplier * indexRatio;\n\n      var result = 0.0;\n\n      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {\n        // x = (-2|2 * PI / N) * index * i;\n        let x = exponentMultiplierTimesIndexRatio * f32(i);\n        let expR = cos(x);\n        let expI = sin(x);\n        let real = getReal(batch, i);\n        let imag = getImag(batch, i);\n\n        result = result +\n            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;\n      }\n\n      return result;\n    }\n\n    ").concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));\n      }\n    }\n  ")}}function q5(e,t,n){const r=n.tensorMap.get(e.dataId),a=OO(e.shape),o=e.shape[e.shape.length-1],i=[],s=f3({inputs:{x:e},backend:n,attrs:{shape:[a/o,o]}});i.push(s);const c=s.shape,l=new K5("real",c),u=new K5("imag",c),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],h=[{type:"float32",data:[t?2*Math.PI:-2*Math.PI]},{type:"float32",data:[t?c[1]:1]}],p=n.runWebGPUProgram(l,d,"float32",h);i.push(p);const f=n.runWebGPUProgram(u,d,"float32",h);i.push(f);const m=k3({inputs:{real:p,imag:f},backend:n});i.push(m);const g=f3({inputs:{x:m},backend:n,attrs:{shape:e.shape}});return i.forEach(e=>n.disposeData(e.dataId)),g}const X5={kernelName:f_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return q5(r,!1,n)}};class Y5{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let coordX = uniforms.xShape[2] - coords[2] - 1;\n          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);\n          setOutputAtIndex(index, outputValue);\n        }\n      }\n    ")}}const Q5={kernelName:g_,backendName:"webgpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{image:r}=t,a=n,o=new Y5(r.shape);return a.runWebGPUProgram(o,[r],r.dtype)}},Z5=I3({opType:Y2.FLOOR,cpuKernelImpl:D3}),$5={kernelName:y_,backendName:"webgpu",kernelFunc:Z5},J5=E3({opType:q2.FLOOR_DIV,cpuKernelImpl:M3,dtype:"int32"}),e8={kernelName:v_,backendName:"webgpu",kernelFunc:J5};class t8{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.pixelsOpType=k2.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[t,1,1]),this.importVideo=n,this.shaderKey="fromPixels_".concat(this.importVideo)}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)",t=this.importVideo?"texture_external":"texture_2d<f32>";return"\n      @binding(1) @group(0) var src: ".concat(t,";\n      ").concat(T2("index")," {\n        let flatIndex = index * uniforms.numChannels;\n        if (flatIndex < uniforms.size) {\n          let coords = getCoordsFromIndex(flatIndex);\n          let values = ").concat(e,";\n          for (var i = 0; i < uniforms.numChannels; i = i + 1) {\n            result[flatIndex + i] = i32(floor(255.0 * values[i]));\n          }\n        }\n      }\n  ")}}const n8={kernelName:mP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:a}=t;const{numChannels:o}=r;if(null==a)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const i="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,c="undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&a instanceof OffscreenCanvas,l="undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap,[u,d]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],h=[d,u,o],p=iA().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&i,f=i||s;if(l||c||f){let e;if(p)e=n.device.importExternalTexture({source:a});else{if(f){const e=iA().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=r8&&e===a8||(a8=e,r8=document.createElement("canvas").getContext("2d",{willReadFrequently:a8})),r8.canvas.width=u,r8.canvas.height=d,r8.drawImage(a,0,0,u,d),a=r8.canvas}const t=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,r="rgba8unorm",o=n.textureManager.acquireTexture(h[1],h[0],r,t);n.queue.copyExternalImageToTexture({source:a},{texture:o},[h[1],h[0]]),e=o}const t=OO(h),r=qO(h),i=new t8(h,o,p),s=[{type:"uint32",data:[t]},{type:"uint32",data:[o]},{type:"uint32",data:[...r]}],c=n.makeTensorInfo([d,u],"int32");n.tensorMap.get(c.dataId).resource=e;const l=n.runWebGPUProgram(i,[c],"int32",s);return n.disposeData(c.dataId),l}const m=a.data;let g=m;if(null!=o&&4!==o){g=new Uint8Array(a.width*a.height*o);const e=m.length;let t=0;for(let n=0;n<e;n++)n%4<o&&(g[t++]=m[n])}const y=n.makeTensorInfo(h,"int32",new Int32Array(g));return n.uploadToGPU(y.dataId),y}};let r8,a8=iA().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");class o8{constructor(e,t,n,r,a){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],TF(e,t),TF(e,n),this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),null!=r&&(TF(e,r),this.variableNames.push("offset")),null!=a&&(TF(e,a),this.variableNames.push("scale")),this.offsetShape=r,this.scaleShape=a,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";null!=this.offsetShape&&(e="getOffsetByOutputIndex(index)");let t="1.0";null!=this.scaleShape&&(t="getScaleByOutputIndex(index)");return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size)\n        {\n          let xValue = getXByOutputIndex(index);\n          let meanValue = getMeanByOutputIndex(index);\n          let varianValue = getVarianceByOutputIndex(index);\n          let offsetValue = ").concat(e,";\n          let scaleValue = ").concat(t,";\n          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));\n          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));\n        }\n      }\n  ")}}const i8={kernelName:b_,backendName:"webgpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a,scale:o,offset:i,mean:s,variance:c}=t,{varianceEpsilon:l}=n,u=r,d=[a,s,c];let h=null;null!=i&&(h=i.shape,d.push(i));let p=null;null!=o&&(p=o.shape,d.push(o));const f=new o8(a.shape,s.shape,c.shape,h,p),m=[{type:"float32",data:[l]}];return u.runWebGPUProgram(f,d,a.dtype,m)}};const s8={kernelName:vP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=XL(u);return M6({x:a,filter:o,convInfo:zL(a.shape,o.shape,c,d,l,h,!1,m),backend:n,bias:i,preluActivationWeights:s,leakyreluAlpha:f,activation:p})}};const c8={kernelName:bP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,filter:o,bias:i,preluActivationWeights:s}=t,{strides:c,pad:l,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r;let f=u;null==f&&(f=[1,1]),EO(KL(c,f),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(f,"'"));const m=zL(a.shape,o.shape,c,f,l,d,!0),g=[a,o],y=null!=i,v=null!=s;y&&g.push(i),v&&g.push(s);const b=[{type:"int32",data:[m.padInfo.top,m.padInfo.left]},{type:"int32",data:[m.inHeight,m.inWidth]}];let x;return m.outHeight>4&&m.outWidth>4&&m.strideWidth<=2&&m.inChannels===m.outChannels&&1===m.dilationHeight&&1===m.dilationWidth&&m.inChannels%4===0?(x=new d5(m,y,h,v),b.push({type:"int32",data:[x.virtualWidth]})):(x=new h5(m,y,h,v),b.push({type:"int32",data:[m.filterHeight]},{type:"int32",data:[m.filterWidth]},{type:"int32",data:[m.strideHeight,m.strideWidth]},{type:"int32",data:[m.dilationHeight,m.dilationWidth]})),"leakyrelu"===h&&(b.push({type:"float32",data:[p]}),x.uniforms+=" alpha : f32,"),n.runWebGPUProgram(x,g,"float32",b)}};class l8{constructor(e,t){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gathernd_".concat(e),this.sliceDim=e,this.uniforms="sliceDim : i32, strides : ".concat(I2(e),",")}getUserCode(){let e;e=this.sliceDim>1?"uniforms.strides[j]":"uniforms.strides";return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          var flattenIndex = 0;\n          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {\n            let indexTemp = i32(round(getIndices(coords[0], j)));\n            let strideNum = ").concat(e,";\n            flattenIndex = flattenIndex + indexTemp * strideNum;\n          }\n\n          setOutputAtIndex(index, getA(flattenIndex, coords[1]));\n        }\n      }\n      ")}}const u8={kernelName:w_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{params:r,indices:a}=t,o=a.shape,i=o[o.length-1],s=OO(r.shape),[c,l,u,d]=nV(r,a),h=f3({inputs:{x:a},backend:n,attrs:{shape:[l,i]}}),p=f3({inputs:{x:r},backend:n,attrs:{shape:[OO(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const e=n.readSync(a.dataId),t=n.bufferSync(r),o=F3(e,t,r.dtype,l,i,u,d,r.shape,s);return n.makeTensorInfo(c,r.dtype,o.values)}const f=new l8(i,[l,u]),m=[{type:"int32",data:[i]},{type:"int32",data:d}],g=n.runWebGPUProgram(f,[p,h],p.dtype,m),y=f3({inputs:{x:g},backend:n,attrs:{shape:c}});return n.disposeData(h.dataId),n.disposeData(p.dataId),n.disposeData(g.dataId),y}};class d8{constructor(e,t){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=t,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=function(e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<e.length;r++)2===r?n.push("indexZ"):n.push("".concat(t[r]));return n.join()}(this.aShape);return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          let indexZ = i32(getIndices(resRC.x, resRC.z));\n          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);\n          setOutputAtIndex(index, inBounds * getA(").concat(e,"));\n        }\n      }\n    ")}}function h8(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,indices:o}=t,{axis:i,batchDims:s}=r,c=GV(a,o,LO(i,a.shape)[0],s),l=OO(o.shape),u=[],d=f3({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),h=f3({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});u.push(d),u.push(h);const p=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,o])){const e=n.tensorMap.get(h.dataId).values,t=nF(h.shape,h.dtype,e),r=n.tensorMap.get(d.dataId).values,a=nF(d.shape,d.dtype,r),o=L3(a,t,p);return u.forEach(e=>n.disposeData(e.dataId)),n.makeTensorInfo(c.outputShape,o.dtype,o.values)}const f=new d8(d.shape,p),m=n.runWebGPUProgram(f,[d,h],d.dtype);u.push(m);const g=f3({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return u.forEach(e=>n.disposeData(e.dataId)),g}const p8={kernelName:x_,backendName:"webgpu",kernelFunc:h8},f8=E3({opType:q2.GREATER,cpuKernelImpl:B3,dtype:"bool"}),m8={kernelName:k_,backendName:"webgpu",kernelFunc:f8},g8=E3({opType:q2.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:z3}),y8={kernelName:S_,backendName:"webgpu",kernelFunc:g8};const v8={kernelName:I_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{input:r}=t;return q5(r,!0,n)}},b8=I3({opType:Y2.IS_FINITE,dtype:"bool"}),x8={kernelName:T_,backendName:"webgpu",kernelFunc:b8},w8=I3({opType:Y2.IS_INF,dtype:"bool"}),k8={kernelName:N_,backendName:"webgpu",kernelFunc:w8},S8=I3({opType:Y2.IS_NAN,dtype:"bool"}),C8={kernelName:O_,backendName:"webgpu",kernelFunc:S8};const I8={kernelName:A_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{alpha:o}=r,i=[{type:"float32",data:[o]}],s=new C3(a.shape,Y2.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(s,[a],"float32",i)}},E8=E3({opType:q2.LESS,dtype:"bool",cpuKernelImpl:W3}),T8={kernelName:__,backendName:"webgpu",kernelFunc:E8},N8=E3({opType:q2.LESS_EQUAL,dtype:"bool",cpuKernelImpl:j3}),O8={kernelName:R_,backendName:"webgpu",kernelFunc:N8};class A8{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);\n        }\n      }\n    ")}}const _8={kernelName:P_,backendName:"webgpu",kernelFunc:function(e){const{backend:t,attrs:n}=e,{start:r,stop:a,num:o}=n,i=(a-r)/(o-1),s=new A8(o),c=[{type:"float32",data:[r]},{type:"float32",data:[i]}];return t.runWebGPUProgram(s,[],"float32",c)}},R8=I3({opType:Y2.LOG,cpuKernelImpl:U3}),P8={kernelName:D_,backendName:"webgpu",kernelFunc:R8},D8=I3({opType:Y2.LOG1P}),M8={kernelName:M_,backendName:"webgpu",kernelFunc:D8},F8=E3({opType:q2.LOGICAL_AND,dtype:"bool"}),L8={kernelName:F_,backendName:"webgpu",kernelFunc:F8},z8=I3({opType:Y2.LOGICAL_NOT}),B8={kernelName:L_,backendName:"webgpu",kernelFunc:z8},j8=E3({opType:q2.LOGICAL_OR}),W8={kernelName:z_,backendName:"webgpu",kernelFunc:j8},U8="\n  var powValue = 0.0;\n  let basis = uniforms.bias + uniforms.alpha * sum;\n  if (uniforms.beta == 0.5) {\n    powValue = inverseSqrt(basis);\n  } else if (uniforms.beta == 1.0) {\n    powValue = 1.0 / basis;\n  } else {\n    powValue = exp(log(basis) * (-uniforms.beta));\n  }\n";class V8{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let b = coords[0];\n        let r = coords[1];\n        let c = coords[2];\n        let d = coords[3];\n\n        let x = getX(b, r, c, d);\n        var sum = 0.0;\n        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {\n          let idx = d + i;\n          if (idx >= 0 && idx < uniforms.xShape[3]) {\n            let z = getX(b, r, c, idx);\n            sum = sum + z * z;\n          }\n        }\n        ").concat(U8,"\n\n        setOutputAtIndex(index, x * powValue);\n      }\n    }\n  ")}}class G8{constructor(e,t){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,EO(t<=this.maxAllowRadius,()=>"Radius must be less than or equal to ".concat(this.maxAllowRadius,", current radius is ").concat(t)),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=L2(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return"\n    var <workgroup>lrnSub: array<f32, ".concat(this.workgroupSize[0],">;\n    const elementsPerWorkgroup = ").concat(this.elementsPerWorkgroup,";\n    const maxAllowRadius = ").concat(this.maxAllowRadius,";\n\n    ").concat(T2()," {\n      let localDepth = i32(localId.x);\n      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;\n      let xDepth = workgroupDepth + localDepth - maxAllowRadius;\n      let b = i32(globalId.z) / uniforms.xShape[1];\n      let r = i32(globalId.z) - b * uniforms.xShape[1];\n      let c = i32(globalId.y);\n      let d = workgroupDepth + localDepth;\n\n      var x = 0.0;\n      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {\n        x = getX(b, r, c, xDepth);\n      }\n      lrnSub[localDepth] = x;\n      workgroupBarrier();\n\n      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {\n        var sum = 0.0;\n        let index = localDepth + maxAllowRadius;\n        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {\n          let z = lrnSub[index + i];\n          sum = sum + z * z;\n        }\n        ").concat(U8,"\n\n        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);\n      }\n    } ")}}const H8={kernelName:B_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{depthRadius:o,bias:i,alpha:s,beta:c}=r;let l;l=o>16?new V8(a.shape):new G8(a.shape,o);const u=[{type:"int32",data:[o]},{type:"float32",data:[i]},{type:"float32",data:[s]},{type:"float32",data:[c]}];return n.runWebGPUProgram(l,[a],a.dtype,u)}};class K8{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let b = coords[0];\n        let r = coords[1];\n        let c = coords[2];\n\n        let MIN_DEPTH_BEGIN = 0;\n        let MAX_DEPTH_END = uniforms.outShape[3];\n        var result = 0.0;\n        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {\n          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);\n          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);\n\n          var norm = 0.0;\n          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {\n            if (k < depthBegin) {\n              continue;\n            } else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            } else {\n              break;\n            }\n          }\n\n          norm = uniforms.alpha * norm + uniforms.bias;\n\n          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {\n            if (k < depthBegin) {\n              continue;\n            } else if (k >= depthBegin && k < depthEnd) {\n              var dyi = -2.0 * uniforms.alpha * uniforms.beta\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * uniforms.beta);\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            } else {\n              break;\n            }\n          }\n        }\n\n        setOutputAtIndex(index, result);\n      }\n    }\n  ")}}const q8={kernelName:j_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,y:o,dy:i}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r,d=new K8(a.shape),h=[{type:"int32",data:[s]},{type:"float32",data:[c]},{type:"float32",data:[l]},{type:"float32",data:[u]}];return n.runWebGPUProgram(d,[a,o,i],a.dtype,h)}},X8=E3({opType:q2.MAX,cpuKernelImpl:G3}),Y8={kernelName:U_,backendName:"webgpu",kernelFunc:X8};const Q8={kernelName:V_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dimRoundingMode:c}=r;return X4(a,FL(a.shape,o,i,1,s,c),"max",n)}};const Z8={kernelName:H_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{filterSize:o,strides:i,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=LL(a.shape,o,i,[1,1,1],s,l,c),d=new V4(u,"max"),h=[{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.inDepth,u.inHeight,u.inWidth]},{type:"int32",data:[u.effectiveFilterDepth,u.effectiveFilterHeight,u.effectiveFilterWidth]}];return n.runWebGPUProgram(d,[a],a.dtype,h)}};class $8{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,\n       outHeight : i32, outWidth : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords[0];\n        let d = coords[3];\n\n        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;\n        let dyRCorner = dyRCCorner.x;\n        let dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;\n        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {\n          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);\n\n          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n            continue;\n          }\n          let idyR = i32(dyR);\n\n          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {\n            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);\n\n            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n              continue;\n            }\n            let idyC = i32(dyC);\n\n            let dyValue = getDy(batch, idyR, idyC, d);\n            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            let curPosValue = wR * uniforms.filterDims[1] + wC;\n            let mask = select(0.0, 1.0, maxPosValue == curPosValue);\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}class J8{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,\n      outDepth : i32, outHeight : i32, outWidth : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return"\n      ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n        let batch = coords.x;\n        let ch = coords.u;\n\n        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;\n        let dyDCorner = dyCorner.x;\n        let dyRCorner = dyCorner.y;\n        let dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd = 0.0;\n        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;\n\n        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {\n          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);\n\n          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {\n            continue;\n          }\n          let idyD = i32(dyD);\n\n          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {\n            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);\n\n            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {\n              continue;\n            }\n            let idyR = i32(dyR);\n\n            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {\n              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);\n\n              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {\n                continue;\n              }\n              let idyC = i32(dyC);\n\n              let dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;\n              let mask = select(0.0, 1.0, maxPosValue == curPosValue);\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n\n        setOutputAtIndex(index, dotProd);\n      }\n    }\n    ")}}const e7={kernelName:K_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o}=t,i=o,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=LL(i.shape,s,c,[1,1,1],l,u),h=new V4(d,"max",!0);let p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];const f=n.runWebGPUProgram(h,[i],"int32",p),m=new J8(d);p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]}];const g=n.runWebGPUProgram(m,[a,f],i.dtype,p);return n.disposeData(f.dataId),g}};const t7={kernelName:G_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:a,input:o,output:i}=t,s=o;V2([o,i],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,h=FL(s.shape,c,l,1,u,d),p=new U4(h,"max",!0);let f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.inHeight,h.inWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]}];const m=n.runWebGPUProgram(p,[s],"int32",f),g=new $8(h);f=[{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.effectiveFilterHeight-1-h.padInfo.top,h.effectiveFilterWidth-1-h.padInfo.left]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]},{type:"int32",data:[h.effectiveFilterHeight,h.effectiveFilterWidth]},{type:"int32",data:[h.outHeight]},{type:"int32",data:[h.outWidth]}];const y=n.runWebGPUProgram(g,[a,m],s.dtype,f);return n.disposeData(m.dataId),y}};const n7={kernelName:q_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{filterSize:a,strides:o,pad:i,includeBatchInIndex:s}=r,{x:c}=t;EO(4===c.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(c.shape.length,"."));const l=[1,1];EO(KL(o,l),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'"));const u=FL(c.shape,a,o,l,i),d=[{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]},{type:"int32",data:[u.inHeight,u.inWidth]},{type:"int32",data:[u.effectiveFilterHeight,u.effectiveFilterWidth]}];let h=new U4(u,"max",!1);const p=n.runWebGPUProgram(h,[c],c.dtype,d);return h=new U4(u,"max",!0,!0,s),[p,n.runWebGPUProgram(h,[c],"int32",d)]}};const r7={kernelName:Y_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r;return I4(a,o,i,"min",n)}},a7=E3({opType:q2.MIN,cpuKernelImpl:H3}),o7={kernelName:Q_,backendName:"webgpu",kernelFunc:a7};class i7{constructor(e,t,n){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]),this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,t.map((e,t)=>{this.uniforms+=" pad".concat(t," : vec2<i32>,")}),this.offset="reflect"===n?0:1,this.shaderKey="mirrorPad_".concat(n)}getUserCode(){const e=this.xShape.length,t=this.xShape.map((e,t)=>"uniforms.pad".concat(t,"[0]")).join(","),n=this.xShape.map((t,n)=>"uniforms.pad".concat(n,"[0] + uniforms.xShape").concat(e>1?"[".concat(n,"]"):"")).join(","),r=1===e?"start":"start[i]",a=1===e?"end":"end[i]",o=1===e?"outC":"outC[i]",i=I2(e),s=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let start = ").concat(i,"(").concat(t,");\n          let end = ").concat(i,"(").concat(n,");\n          var outC = getCoordsFromIndex(index);\n          for (var i = 0; i < ").concat(e,"; i = i + 1) {\n            if (").concat(o," < ").concat(r,") {\n              ").concat(o," = ").concat(r," * 2 - ").concat(o," - ").concat(this.offset,";\n            } else if(").concat(o," >= ").concat(a,") {\n              ").concat(o," = (").concat(a," - 1) * 2 - ").concat(o," + ").concat(this.offset,";\n            }\n          }\n          let coords = outC - start;\n          setOutputAtIndex(index, getX(").concat(s,"));\n        }\n      }\n    ")}}const s7={kernelName:Z_,backendName:"webgpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,{paddings:o,mode:i}=n,s=r,c=o.map(e=>({type:"int32",data:[e[0],e[1]]})),l=new i7(a.shape,o,i);return s.runWebGPUProgram(l,[a],a.dtype,c)}},c7=E3({opType:q2.MOD}),l7={kernelName:$_,backendName:"webgpu",kernelFunc:c7};class u7{constructor(e,t){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,t],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return"\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {\n      let HASHSCALE1 = 443.8975;\n      let p = resultUV * seed;\n      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);\n      p3 = p3 + dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let coords = getOutputCoords();\n        let batch = coords[0];\n\n        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),\n            f32(coords[0]) / f32(uniforms.outShape[0]));\n        let r = random(uniforms.seed, resUV);\n        var cdf = 0.0;\n        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {\n          cdf = cdf + getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutputAtIndexI32(index, i);\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);\n      }\n    }\n  ")}}class d7{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return"\n    var<workgroup> buf : array<f32, ".concat(this.workgroupSize[0],">;\n    var<workgroup> rowMaxShared : f32;\n    var<workgroup> rowSumShared : f32;\n    const blockSize = ").concat(this.workgroupSize[0],";\n    ").concat(T2("index")," {\n      let row = index / blockSize;\n      let tid = i32(localId.x);\n      let cols = uniforms.outShape[1];\n\n      var threadMax = -3.402823e+38f;\n      for (var col = tid; col < cols; col += blockSize) {\n        let value = getLogits(row, col);\n        threadMax = max(threadMax, value);\n      }\n      if (tid < cols) {\n        buf[tid] = threadMax;\n      }\n      workgroupBarrier();\n\n      var reduceSize = min(cols, blockSize);\n      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n        reduceSize = currSize + (reduceSize & 1);\n        if (tid < currSize) {\n          buf[tid] = max(buf[tid], buf[tid + reduceSize]);\n        }\n        workgroupBarrier();\n      }\n\n      if (tid == 0) {\n        rowMaxShared = buf[0];\n      }\n      workgroupBarrier();\n\n      var threadSum = 0.0;\n      for (var col = tid; col < cols; col += blockSize) {\n        let subExp = exp(getLogits(row, col) - rowMaxShared);\n        threadSum += subExp;\n      }\n      buf[tid] = threadSum;\n      workgroupBarrier();\n\n      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n        if (tid < currSize) {\n          buf[tid] = buf[tid] + buf[tid + currSize];\n        }\n        workgroupBarrier();\n      }\n\n      if (tid == 0) {\n        rowSumShared = buf[0];\n      }\n      workgroupBarrier();\n\n      for (var col = tid; col < cols; col += blockSize) {\n        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;\n        setOutputAtCoords(row, col, value);\n      }\n  }\n    ")}}function h7(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{dim:o}=r,i=f3({inputs:{x:a},backend:n,attrs:{shape:[OO(a.shape)/a.shape[o],a.shape[o]]}}),s=new d7(i.shape),c=n.runWebGPUProgram(s,[i],a.dtype),l=f3({inputs:{x:c},backend:n,attrs:{shape:a.shape}});return n.disposeData(i.dataId),n.disposeData(c.dataId),l}const p7={kernelName:GR,backendName:"webgpu",kernelFunc:h7};const f7={kernelName:J_,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:a}=t,{numSamples:o,seed:i,normalized:s}=r,c=s?a:h7({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),l=c.shape[0],u=c.shape[1],d=new u7(l,o),h=[{type:"float32",data:[i]},{type:"int32",data:[u]}],p=n.runWebGPUProgram(d,[c],"int32",h);return s||n.disposeData(c.dataId),p}};const m7={kernelName:tR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){const e=n.tensorMap.get(r.dataId),[t,a]=q3(e.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,t)}const a=new C3(r.shape,Y2.NEG);return n.runWebGPUProgram(a,[r],r.dtype)}};const g7={kernelName:rR,backendName:"webgpu",kernelFunc:function(e){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:o}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c}=r,l=n.readSync(a.dataId),u=n.readSync(o.dataId),{selectedIndices:d}=$W(l,u,i,s,c);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}};const y7={kernelName:oR,backendName:"webgpu",kernelFunc:function(e){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:r}=e,{boxes:a,scores:o}=t,{maxOutputSize:i,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(a.dataId),d=n.readSync(o.dataId),h=i,p=s,f=c,m=l,{selectedIndices:g,selectedScores:y}=eU(u,d,h,p,f,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class v7{constructor(e,t){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,t],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if(index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,\n                                      f32(i32(round(getX(coords.x))) == coords.y)));\n        }\n      }\n    ")}}const b7={kernelName:sR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{dtype:o,depth:i,onValue:s,offValue:c}=r,l=OO(a.shape),u=new v7(l,i),d=f3({inputs:{x:a},backend:n,attrs:{shape:[l]}}),h=[{type:"float32",data:[s]},{type:"float32",data:[c]}],p=n.runWebGPUProgram(u,[d],o,h);n.disposeData(d.dataId);const f=f3({inputs:{x:p},backend:n,attrs:{shape:[...a.shape,i]}});return n.disposeData(p.dataId),f}};function x7(e){const{inputs:t,backend:n}=e,{x:r}=t;if("complex64"===r.dtype){const e=f6({inputs:{input:r},backend:n}),t=x7({inputs:{x:e},backend:n}),a=E6({inputs:{input:r},backend:n}),o=x7({inputs:{x:a},backend:n}),i=k3({inputs:{real:t,imag:o},backend:n});return n.disposeData(e.dataId),n.disposeData(t.dataId),n.disposeData(a.dataId),n.disposeData(o.dataId),i}return h3({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const w7={kernelName:pP,backendName:"webgpu",kernelFunc:x7};const k7={kernelName:iR,backendName:"webgpu",kernelFunc:function e(t){const{inputs:n,backend:r}=t,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){const t=f6({inputs:{input:a},backend:r}),n=e({inputs:{x:t},backend:r}),o=E6({inputs:{input:a},backend:r}),i=x7({inputs:{x:o},backend:r}),s=k3({inputs:{real:n,imag:i},backend:r});return r.disposeData(t.dataId),r.disposeData(n.dataId),r.disposeData(o.dataId),r.disposeData(i.dataId),s}return h3({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};const S7={kernelName:cR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return U5({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const o=t[0].shape,i=t[0].dtype;t.forEach(e=>{TO(o,e.shape,"All tensors passed to stack must have matching shapes"),EO(i===e.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],c=O6({inputs:t.map(e=>{const t=U5({inputs:{input:e},backend:n,attrs:{dim:a}});return s.push(t),t}),backend:n,attrs:{axis:a}});return s.forEach(e=>n.disposeData(e.dataId)),c}};function C7(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.length,r=I2(n),a=e.map((e,t)=>"uniforms.pad".concat(t,"[0]")).join(","),o=e.map((e,t)=>"uniforms.pad".concat(t,"[0] + uniforms.xShape").concat(n>1?"[".concat(t,"]"):"")).join(","),i=n>1?"".concat(r,"(").concat(a,")"):"".concat(a),s=n>1?"".concat(r,"(").concat(o,")"):"".concat(o),c=n>1?"any(paddedCoords < start)":"paddedCoords < start",l=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",u=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return"\n        let start = ".concat(i,";\n        let end = ").concat(s,";\n        if (").concat(c," || ").concat(l,") {\n          setOutputAtIndex(index, ").concat(t?0:"uniforms.constantValue",");\n        } else {\n          let coords = paddedCoords - start;\n          setOutputAtIndex(index, getX(").concat(u,"));\n        }\n  ")}class I7{constructor(e,t){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]),this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),t.map((e,t)=>{this.uniforms+=" pad".concat(t," : vec2<i32>,")}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let paddedCoords = getCoordsFromIndex(index);\n          ").concat(C7(this.xShape),"\n        }\n      }\n    ")}}const E7={kernelName:lR,backendName:"webgpu",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{paddings:o,constantValue:i}=r;if(o.every(e=>_O(e,[0,0])))return x3({inputs:{x:a},backend:n});if(0===OO(a.shape)){return h3({backend:n,attrs:{shape:o.map((e,t)=>e[0]+a.shape[t]+e[1]),value:i,dtype:a.dtype}})}const s=[{type:"float32",data:[i]}];o.map(e=>s.push({type:"int32",data:[e[0],e[1]]}));const c=new I7(a.shape,o);return n.runWebGPUProgram(c,[a],a.dtype,s)}},T7=E3({opType:q2.POW}),N7={kernelName:uR,backendName:"webgpu",kernelFunc:T7};const O7={kernelName:dR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t,o=new b3(q2.PRELU,r.shape,a.shape);return n.runWebGPUProgram(o,[r,a],"float32")}};const A7={kernelName:hR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:o,keepDims:i}=r;return I4(a,o,i,"prod",n)}},_7={kernelName:gR,backendName:"webgpu",kernelFunc:e=>{const{backend:t,attrs:n}=e,{start:r,stop:a,step:o,dtype:i}=n,s=Q3(r,a,o,i);return t.makeTensorInfo([s.length],i,s)}},R7=E3({opType:q2.DIV}),P7={kernelName:o_,backendName:"webgpu",kernelFunc:R7},D7=I3({opType:Y2.RECIPROCAL}),M7={kernelName:vR,backendName:"webgpu",kernelFunc:D7},F7=I3({opType:Y2.RELU}),L7={kernelName:bR,backendName:"webgpu",kernelFunc:F7},z7=I3({opType:Y2.RELU6}),B7={kernelName:IR,backendName:"webgpu",kernelFunc:z7};class j7{constructor(e,t,n){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],t,n,e[3]],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n        let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let d = coords[3];\n          let rc = coords.yz;\n\n          let effectiveInSize = vec2<f32>(\n            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveOutSize = vec2<f32>(\n            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveInputOverOutputRatioRC =\n              effectiveInSize / effectiveOutSize;\n\n          // Fractional source index\n          let sourceFracIndexRC =\n            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *\n            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);\n\n          // Compute the four integer indices.\n          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);\n          let sourceCeilRC = vec2<i32>(\n            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));\n\n          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);\n          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);\n          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);\n          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);\n\n          let top = topLeft + (topRight - topLeft) * fracRC.y;\n          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n          let newValue = top + (bottom - top) * fracRC.x;\n\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    ")}}const W7={kernelName:SR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:o,size:i,halfPixelCenters:s}=r,[c,l]=i,u=[{type:"float32",data:[o&&c>1?1:0,o&&l>1?1:0]},{type:"float32",data:[s?.5:0]}],d=new j7(a.shape,c,l);return n.runWebGPUProgram(d,[a],"float32",u)}};class U7{constructor(e,t){this.variableNames=["dy"],this.uniforms="effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,\n       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=t,this.shaderKey="resizeBilinearBackprop_".concat(t)}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let b = coords[0];\n          let d = coords[3];\n          let r = coords[1];\n          let c = coords[2];\n\n          var accumulator = 0.0;\n\n          // Compute bounds for where in dy we will look\n          let startRLerp = floor(f32(r) * uniforms.invHeightScale);\n          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));\n\n          let startCLerp = floor(f32(c) * uniforms.invWidthScale);\n          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));\n\n          // Loop over dy\n          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {\n            let dyR = startDyR + dyROffset;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {\n              continue;\n            }\n\n            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {\n              let dyC = startDyC + dyCOffset;\n\n              // Guard against the window exceeding the bounds of dy\n              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {\n                continue;\n              }\n\n              let dxR = f32(dyR) * uniforms.heightScale;\n              let topDxRIndex = i32(floor(dxR));\n              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));\n              let dxRLerp = dxR - f32(topDxRIndex);\n              let inverseDxRLerp = 1.0 - dxRLerp;\n\n              let dxC = f32(dyC) * uniforms.widthScale;\n              let leftDxCIndex = i32(floor(dxC));\n              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));\n              let dxCLerp = dxC - f32(leftDxCIndex);\n              let inverseDxCLerp = 1.0 - dxCLerp;\n\n              if (r == topDxRIndex && c == leftDxCIndex) {\n                // topLeft\n                accumulator +=\n                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n              }\n\n              if (r == topDxRIndex && c == rightDxCIndex) {\n                // topRight\n                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n              }\n\n              if (r == bottomDxRIndex && c == leftDxCIndex) {\n                // bottomLeft\n                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n              }\n\n              if (r == bottomDxRIndex && c == rightDxCIndex) {\n                // bottomRight\n                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n              }\n            }\n          }\n          // End loop over dy\n\n          setOutputAtIndex(index, accumulator);\n        }\n      }\n    ")}}const V7={kernelName:CR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:o}=t,{alignCorners:i}=r,[,s,c]=a.shape,[,l,u]=o.shape,d=[i&&l>1?s-1:s,i&&u>1?c-1:c],h=[i&&l>1?l-1:l,i&&u>1?u-1:u],p=d[0]/h[0],f=d[1]/h[1],m=1/p,g=1/f,y=2*Math.ceil(m)+2,v=2*Math.ceil(g)+2,b=new U7(a.shape,i),x=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[p]},{type:"float32",data:[f]},{type:"float32",data:[m]},{type:"float32",data:[g]},{type:"int32",data:[y]},{type:"int32",data:[v]}];return n.runWebGPUProgram(b,[o],o.dtype,x)}};class G7{constructor(e,t,n,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],t,n,e[3]],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=r,this.shaderKey="resizeNearest_".concat(r)}getUserCode(){let e;e=this.halfPixelCenters?"max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":"vec2<f32>(rc) * effectiveInputOverOutputRatioRC";return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let b = coords[0];\n          let d = coords[3];\n          let rc = coords.yz;\n\n          let effectiveInSize = vec2<f32>(\n            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveOutSize = vec2<f32>(\n            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],\n            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);\n\n          let effectiveInputOverOutputRatioRC =\n              effectiveInSize / effectiveOutSize;\n\n          // Fractional source index\n          let sourceFracIndexRC = ").concat(e,";\n\n          // Compute the coordinators of nearest neighbor point.\n          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));\n          let sourceNearestRC = vec2<i32>(\n            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));\n          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n          setOutputAtIndex(index, newValue);\n        }\n      }\n    ")}}const H7={kernelName:wR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a}=t,{alignCorners:o,halfPixelCenters:i,size:s}=r,[c,l]=s,u=[{type:"float32",data:[o&&c>1?1:0,o&&l>1?1:0]},{type:"float32",data:[o?.5:0]}],d=new G7(a.shape,c,l,i);return n.runWebGPUProgram(d,[a],a.dtype,u)}};class K7{constructor(e,t){this.variableNames=["dy"],this.uniforms="effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,\n       winHeight : i32, winWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=t,this.shaderKey="resizeNearestNeigborBackprop_".concat(t)}getUserCode(){return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getOutputCoords();\n          let b = coords[0];\n          let d = coords[3];\n          let r = coords[1];\n          let c = coords[2];\n\n          var accumulator = 0.0;\n\n          // Compute bounds for where in dy we will look\n          let startRLerp = floor(f32(r) * uniforms.invHeightScale);\n          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));\n\n          let startCLerp = floor(f32(c) * uniforms.invWidthScale);\n          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));\n\n          // Loop over dy\n          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {\n            let dyR = startDyR + dyROffset;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {\n              continue;\n            }\n\n            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {\n              let dyC = startDyC + dyCOffset;\n\n              // Guard against the window exceeding the bounds of dy\n              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {\n                continue;\n              }\n\n              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *\n                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));\n\n              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *\n                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));\n\n              let sourceNearestRow =\n                  i32(min(f32(uniforms.outShape[1] - 1),\n                  ").concat(this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)","));\n\n              let sourceNearestCol =\n                  i32(min(f32(uniforms.outShape[2] - 1),\n                  ").concat(this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)","));\n\n              if (r == sourceNearestRow && c == sourceNearestCol) {\n                accumulator += getDy(b, dyR, dyC, d);\n              }\n            }\n          }\n          // End loop over dy\n\n          setOutputAtIndex(index, accumulator);\n        }\n      }\n    ")}}const q7={kernelName:kR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:a,dy:o}=t,{alignCorners:i}=r,[,s,c]=a.shape,[,l,u]=o.shape,d=[i&&l>1?s-1:s,i&&u>1?c-1:c],h=[i&&l>1?l-1:l,i&&u>1?u-1:u],p=1/(d[0]/h[0]),f=1/(d[1]/h[1]),m=2*Math.ceil(p)+2,g=2*Math.ceil(f)+2,y=new K7(a.shape,i),v=[{type:"int32",data:d},{type:"int32",data:h},{type:"float32",data:[p]},{type:"float32",data:[f]},{type:"int32",data:[m]},{type:"int32",data:[g]}];return n.runWebGPUProgram(y,[o],o.dtype,v)}};class X7{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return"\n      ".concat("\n      // Using uniform variables as judging conditions, so the function has\n      // coherent execution within all threads.\n      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {\n        var reverseCoords = coords;\n        if (uniforms.axis[0] == 1) {\n          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;\n        }\n        if (uniforms.axis[1] == 1) {\n          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;\n        }\n        if (uniforms.axis[2] == 1) {\n          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;\n        }\n        if (uniforms.axis[3] == 1) {\n          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;\n        }\n\n        return reverseCoords;\n      }\n    ","\n      ").concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let reverseCoords = getReverseCoords(coords);\n          setOutputAtIndex(index, getX(reverseCoords[0],\n              reverseCoords[1], reverseCoords[2], reverseCoords[3]));\n        }\n      }\n    ")}}const Y7={kernelName:ER,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:o}=r,i=a.shape.length;if(0===i)return x3({inputs:{x:a},backend:n});const s=a.shape,c=[1,1,1,1];s.forEach((e,t)=>{c[t+4-i]=e});const l=LO(o,a.shape),u=[0,0,0,0];l.forEach(e=>{u[e+4-i]=1});const d=[{type:"int32",data:u}],h=f3({inputs:{x:a},backend:n,attrs:{shape:c}}),p=new X7(c),f=n.runWebGPUProgram(p,[h],h.dtype,d);n.disposeData(h.dataId);const m=f3({inputs:{x:f},backend:n,attrs:{shape:s}});return n.disposeData(f.dataId),m}};class Q7{constructor(e,t){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="centerX : f32, centerY : f32, sinRadians : f32,\n          cosRadians : f32,",this.shaderKey="rotate",this.outputShape=e,"number"===typeof t?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return"\n        ".concat(T2("index")," {\n          if (index < uniforms.size) {\n            let coords = getCoordsFromIndex(index);\n            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *\n                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *\n                uniforms.sinRadians;\n            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *\n                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *\n                uniforms.cosRadians;\n            let coordX = i32(round(coordXFloat + uniforms.centerX));\n            let coordY = i32(round(coordYFloat + uniforms.centerY));\n            ").concat(this.fillSnippet,"\n            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&\n                coordY < uniforms.xShape[1]) {\n              outputValue = getX(coords[0], coordY, coordX, coords[3]);\n            }\n            setOutputAtIndex(index, outputValue);\n          }\n        }\n      ")}}const Z7={kernelName:gP,backendName:"webgpu",kernelFunc:e=>{let{inputs:t,attrs:n,backend:r}=e;const{image:a}=t,{radians:o,fillValue:i,center:s}=n,c=r,l=new Q7(a.shape,i),[u,d]=QU(s,a.shape[1],a.shape[2]),h=[{type:"float32",data:[u]},{type:"float32",data:[d]},{type:"float32",data:[Math.sin(o)]},{type:"float32",data:[Math.cos(o)]}];"number"===typeof i?h.push({type:"float32",data:[Number.parseFloat(i.toFixed(2))]}):h.push({type:"float32",data:i});return c.runWebGPUProgram(l,[a],a.dtype,h)}},$7=I3({opType:Y2.ROUND}),J7={kernelName:TR,backendName:"webgpu",kernelFunc:$7},e9=I3({opType:Y2.RSQRT,cpuKernelImpl:Z3}),t9={kernelName:NR,backendName:"webgpu",kernelFunc:e9};class n9{constructor(e,t,n,r,a,o,i){let s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.type=i,this.sumDupeIndices=s,this.dispatchLayout=j2(e),this.dispatch=L2(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=t>1,this.shaderKey="scatter_".concat(n,"_").concat(r,"_").concat(this.sliceDimGreaterThanOne,"_").concat(i,"_").concat(s,"_").concat(a.length);const c=I2(a.length);this.uniforms="sliceDim : i32, strides: ".concat(c,", updatesSize: i32,"),this.updatesRank=r,this.indicesRank=n}getUserCode(){let e="";1===this.indicesRank?e="coords[0]":2===this.indicesRank&&(e="coords[0], j");const t="getIndices(".concat(e,")"),n=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let r="",a="";1===this.dispatchLayout.x.length?(r="flattenedIndex",a="\n      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {\n        return index;\n      }\n      "):2===this.dispatchLayout.x.length&&(r="vec2<i32>(flattenedIndex, coords[1])",a="\n      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {\n        // N.B. |updates| could be a scalar tensor, conceptually representing a\n        // 2D tensor with all values equal to that. By design, its size must be\n        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|\n        // gives the other.\n        let sliceSize = uniforms.outShape[1];\n        let d0 = index / sliceSize;\n        let d1 = index - d0 * sliceSize;\n        return vec2<i32>(d0, d1);\n      }\n      ");const o=Array.from({length:this.updatesRank},(e,t)=>"coords[".concat(t,"]")),i="getUpdates(".concat(o.join(", "),")");return"\n    ".concat(a,"\n      ").concat(T2("index")," {\n        if (index < uniforms.updatesSize) {\n          let coords = getUpdatesCoordsFromFlatIndex(index);\n          var flattenedIndex = 0;\n          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {\n            let indexInside = i32(round(").concat(t,"));\n            flattenedIndex = flattenedIndex + indexInside * ").concat(n,";\n          }\n          let updateValue =\n              ").concat(D2(this.type),"(").concat(i,");\n          let flatIndex = getOutputIndexFromCoords(").concat(r,");\n\n          ").concat(this.sumDupeIndices?w2("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));","\n        }\n      }")}}const r9={kernelName:OR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a,updates:o}=t,{shape:i}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=cW(0,a,i),h=[d/l,l];if(0===d)return n.makeTensorInfo(i,a.dtype);const p=f3({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),f=f3({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),m=f.dtype,g=h3({backend:n,attrs:{shape:h,value:0,dtype:m}}),y=[{type:"int32",data:[s]},{type:"int32",data:u},{type:"int32",data:[OO(f.shape)]}],v=new n9(f.shape,s,p.shape.length,f.shape.length,u,h,m),b=n.runWebGPUProgram(v,[f,p],m,y,g),x=f3({inputs:{x:b},backend:n,attrs:{shape:i}});return n.disposeData(p.dataId),n.disposeData(f.dataId),n.disposeData(b.dataId),x}};class a9{constructor(e,t){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=t,this.shaderKey="search_sorted_".concat(t)}getUserCode(){const e="left"===this.side?"<":"<=";return"\n      fn findBound(batch: i32, value: f32) -> i32 {\n        var left = i32(0);\n        var right = uniforms.numInputs;\n        while (left < right) {\n          var mid = (left + right) / 2;\n          if (getSortedSequence(batch, mid) ".concat(e," value) {\n            left = mid + 1;\n          } else {\n            right = mid;\n          }\n        }\n        return right;\n      }\n\n      ").concat(T2("index")," {\n        if (index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let value = getValuesByOutputIndex(index);\n          setOutputAtIndexI32(index, findBound(coords[0], value));\n        }\n      }\n    ")}}const o9={kernelName:_R,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sortedSequence:a,values:o}=t,{side:i}=r,s=new a9([o.shape[0],o.shape[1]],i),c=[{type:"int32",data:[a.shape[1]]}];return n.runWebGPUProgram(s,[a,o],"int32",c)}};class i9{constructor(e,t,n){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=t,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=n,this.shaderKey="select"}getUserCode(){let e,t;if(this.rank>4)throw Error("Where for rank ".concat(this.rank," is not yet supported"));if(1===this.rank)t="resRC",e="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=[];for(let e=0;e<this.outputShape.length;e++)a.push("".concat(n[e])),e<this.cRank&&r.push("".concat(n[e]));e=r.join(),t=a.join()}return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          let cVal = getC(").concat(e,");\n          if (cVal >= 1.0) {\n            setOutputAtIndex(index, getA(").concat(t,"));\n          } else {\n            setOutputAtIndex(index, getB(").concat(t,"));\n          }\n        }\n      }\n    ")}}const s9={kernelName:RR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:o}=t,i=new i9(r.shape.length,a.shape,a.shape.length);return n.runWebGPUProgram(i,[r,a,o],vD(a.dtype,o.dtype))}},c9=I3({opType:Y2.SELU}),l9={kernelName:PR,backendName:"webgpu",kernelFunc:c9},u9=I3({opType:Y2.SIGMOID}),d9={kernelName:zR,backendName:"webgpu",kernelFunc:u9},h9=I3({opType:Y2.SIGN}),p9={kernelName:LR,backendName:"webgpu",kernelFunc:h9},f9=I3({opType:Y2.SIN}),m9={kernelName:MR,backendName:"webgpu",kernelFunc:f9},g9=I3({opType:Y2.SINH}),y9={kernelName:FR,backendName:"webgpu",kernelFunc:g9},v9=I3({opType:Y2.SOFTPLUS}),b9={kernelName:BR,backendName:"webgpu",kernelFunc:v9};class x9{constructor(e,t,n,r,a,o){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const i=new Array(r.length);for(let s=0;s<i.length;s++)i[s]=r[a[s]];this.outputShape=i,this.newDim=a,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=t,this.uniforms+="reshapedPaddedXShape : ".concat(I2(r.length),", paddedXShapeStrides : ").concat(I2(o),", "),n.map((e,t)=>{this.uniforms+=" pad".concat(t," : vec2<i32>,")}),this.shaderKey="spaceToBatchND_".concat(a)}getUserCode(){const e=I2(this.outputShape.length),t=x4(this.newDim);return"\n      ".concat(_2(this.paddedXShape,"PaddedX"),"\n      ").concat(T2("index")," {\n        if(index < uniforms.size) {\n          let coords = getCoordsFromIndex(index);\n          let switchedIndex = getIndexFromCoords").concat(this.outputShape.length,"D(").concat(e,"(").concat(t,"), uniforms.reshapedPaddedXShape);\n          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);\n          ").concat(C7(this.xShape,!0),"\n        }\n      }\n    ")}}const w9={kernelName:UR,backendName:"webgpu",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:o,paddings:i}=r;EO(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const s=o.reduce((e,t)=>e*t),c=[[0,0]];c.push(...i);for(let v=1+o.length;v<a.shape.length;++v)c.push([0,0]);const l=c.map((e,t)=>e[0]+a.shape[t]+e[1]),u=ZU(l,o,s,!1),d=$U(u.length,o.length,!1),h=JU(l,o,s,!1),p=qO(l),f=new x9(a.shape,l,c,u,d,p.length),m=[{type:"int32",data:u},{type:"int32",data:p}];c.map(e=>m.push({type:"int32",data:[e[0],e[1]]}));const g=n.runWebGPUProgram(f,[a],a.dtype,m),y=f3({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeData(g.dataId),y}};class k9{constructor(e,t,n){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=n,this.dispatchLayout=j2([t]),this.dispatch=L2(this.dispatchLayout,[t],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.sparseSize) {\n        let indexInSegmentIds = index / uniforms.segmentSize;\n        let indexInSegment = index % uniforms.segmentSize;\n        let indexInInput = indices[indexInSegmentIds];\n        let segmentId = segmentIds[indexInSegmentIds];\n\n        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];\n        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;\n        ").concat(w2("&result[outIndex]","value",this.type),"\n      }\n    }\n  ")}}class S9{constructor(e,t){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=j2(t),this.dispatch=L2(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.segmentIdsShape) {\n        let segmentId = segmentIds[index];\n        ").concat(w2("&result[segmentId]","1","int32"),"\n      }\n    }\n  ")}}class C9{constructor(e,t){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=t,this.dispatchLayout=j2(e),this.dispatch=L2(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.size) {\n        let segmentId = index / uniforms.segmentSize;\n        let count = sameSegmentIdCount[segmentId];\n        if (count != 0) {\n          ").concat("float32"===this.type?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);","\n        }\n      }\n    }\n  ")}}function I9(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;const o=OO(e.shape)/e.shape[0],i=e.dtype,s=OO(t.shape),c=a.readSync(n.dataId),l=s>0?c[s-1]+1:0;let u;const d=e.shape.slice();d[0]=l;const h=s*o,p=h3({backend:a,attrs:{shape:d,value:0,dtype:i}});u=new k9(d,h,i);let f=[{type:"int32",data:[o]},{type:"int32",data:[h]}];const m=a.runWebGPUProgram(u,[e,t,n],i,f,p);if(r)return m;const g=h3({backend:a,attrs:{shape:[l],value:0,dtype:"int32"}});u=new S9(l,n.shape);const y=a.runWebGPUProgram(u,[n],"int32",null,g),v=h3({backend:a,attrs:{shape:d,value:0,dtype:i}});u=new C9(d,i),f=[{type:"int32",data:[o]}];const b=a.runWebGPUProgram(u,[m,y],i,f,v);return a.disposeData(m.dataId),a.disposeData(y.dataId),b}const E9={kernelName:qR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:o}=t;return I9(r,a,o,!1,n)}};const T9={kernelName:XR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n}=e,{data:r,indices:a,segmentIds:o}=t;return I9(r,a,o,!0,n)}};class N9{constructor(e,t){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>=5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"(resRC % ".concat(t,"aShape)");const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<e;a++)r.push("(".concat(n[a]," % ").concat(t,"aShape[").concat(a,"])"));return r.join()}(this.rank,"uniforms.");return"\n      ".concat(T2("index")," {\n        if (index < uniforms.size) {\n          let resRC = getCoordsFromIndex(index);\n          setOutputAtIndex(index, getA(").concat(e,"));\n        }\n      }\n    ")}}function O9(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{reps:o}=r;if(n.shouldExecuteOnCPU([a])||"string"===a.dtype||a.shape.length>=5){const e=n.readSync(a.dataId),t="string"===a.dtype?e.map(e=>XP(e)):e,r=nF(a.shape,a.dtype,t),i=a4(r,o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const i=new N9(a.shape,o);return n.runWebGPUProgram(i,[a],a.dtype)}const A9={kernelName:iP,backendName:"webgpu",kernelFunc:O9};const _9={kernelName:YR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{sparseIndices:a,sparseValues:o,defaultValue:i}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:h}=cW(0,a,s),p=!1;if("string"===o.dtype){const e=n.bufferSync(a),t=n.bufferSync(o),r=XP(n.readSync(i.dataId)[0]),f=$3(e,t,s,h,u,l,c,d,r,p);return n.makeTensorInfo(s,f.dtype,f.values)}const f=[h/u,u],m=f3({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),g=o.shape.length?f3({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}):x3({inputs:{x:o},backend:n}),y=g.dtype,v=n.makeTensorInfo([],y,$O(1,y)),b=f3({inputs:{x:i},backend:n,attrs:{shape:Array(f.length).fill(1)}}),x=O9({inputs:{x:b},backend:n,attrs:{reps:f}}),w=[{type:"int32",data:[c]},{type:"int32",data:d},{type:"int32",data:[OO([l,u])]}];switch(l){case 0:break;case 1:{const e=new n9([l,u],c,m.shape.length,g.shape.length,d,f,y,p);n.runWebGPUProgram(e,[g,m],y,w,x)}break;default:{const e=new n9([l,u],c,m.shape.length,v.shape.length,d,f,y,p);n.runWebGPUProgram(e,[v,m],y,w,x)}{const e=new n9([l,u],c,m.shape.length,g.shape.length,d,f,y);n.runWebGPUProgram(e,[g,m],y,w,x)}}const k=f3({inputs:{x:x},backend:n,attrs:{shape:s}});return n.disposeData(m.dataId),n.disposeData(g.dataId),n.disposeData(b.dataId),n.disposeData(v.dataId),n.disposeData(x.dataId),k}};const R9={kernelName:VR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{numOrSizeSplits:o,axis:i}=r,s=LO(i,a.shape)[0],c=OV(a,o,s),l=a.shape.length,u=new Array(l).fill(0),d=a.shape.slice();return c.map(e=>{const t=[...d];t[s]=e;const r=a6({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[s]+=e,r})}},P9=I3({opType:Y2.SQRT}),D9={kernelName:jR,backendName:"webgpu",kernelFunc:P9},M9={kernelName:ZR,backendName:"webgpu",kernelFunc:e=>{let{inputs:t,backend:n}=e;const{x:r}=t,a=n,o=new C3(r.shape,Y2.SQUARE);return a.runWebGPUProgram(o,[r],r.dtype)}},F9=E3({opType:q2.SQUARED_DIFFERENCE}),L9={kernelName:QR,backendName:"webgpu",kernelFunc:F9};const z9={kernelName:fP,backendName:"webgpu",kernelFunc:function(e){let{inputs:t,attrs:n,backend:r}=e;const{x:a}=t,o=new C3(a.shape,Y2.STEP,"stepAlpha : f32,"),i=[{type:"float32",data:[n.alpha]}];return r.runWebGPUProgram(o,[a],a.dtype,i)}};class B9{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const t=I2(this.outputShape.length);this.uniforms="begin : ".concat(t,",  strides : ").concat(t,", "),this.shaderKey="stridedSlice"}getUserCode(){let e="";if(1===this.outputShape.length)e="coords * uniforms.strides + uniforms.begin";else{let t=0;e=this.outputShape.map((e,n)=>(t++,1===this.outputShape.length?"coords * uniforms.strides[".concat(n,"] + uniforms.begin[").concat(n,"]"):"coords[".concat(t-1,"] * uniforms.strides[").concat(n,"] + uniforms.begin[").concat(n,"]"))).join(",")}return"\n       ".concat(T2("index")," {\n         if (index < uniforms.size) {\n           let coords = getCoordsFromIndex(index);\n           setOutputAtIndex(index, getX(").concat(e,"));\n         }\n       }\n     ")}}const j9={kernelName:JR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{begin:o,end:i,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:x}=wL(a.shape,o,i,s,c,l,u,d,h);let w;if(m)w=f3({inputs:{x:a},backend:n,attrs:{shape:f}});else if(g||y){EO(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const e=cL(v,b,x),t=a6({inputs:{x:a},backend:n,attrs:{begin:v,size:e}});w=f3({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeData(t.dataId)}else{if(n.shouldExecuteOnCPU([a])){const e=n.readSync(a.dataId),t=nF(a.shape,a.dtype,e),r=t4(p,t,x,v);w=n.makeTensorInfo(f,a.dtype,r.values)}else{const e=new B9(p),t=[{type:"int32",data:v},{type:"int32",data:x}],r=n.runWebGPUProgram(e,[a],a.dtype,t);w=f3({inputs:{x:r},backend:n,attrs:{shape:f}}),n.disposeData(r.dataId)}}return w}};const W9={kernelName:eP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{separator:a,nGramWidths:o,leftPad:i,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,h=n.readSync(u.dataId),p=n.readSync(d.dataId),[f,m]=n4(h,p,a,o,i,s,c,l);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}},U9=E3({opType:q2.SUB,cpuKernelImpl:r4,supportsComplex:!0}),V9={kernelName:rP,backendName:"webgpu",kernelFunc:U9},G9=I3({opType:Y2.TAN}),H9={kernelName:aP,backendName:"webgpu",kernelFunc:G9},K9=I3({opType:Y2.TANH}),q9={kernelName:oP,backendName:"webgpu",kernelFunc:K9};const X9={kernelName:AR,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{tensor:a,indices:o,updates:i}=t,{}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=cW(0,o,a.shape),h=[d/l,l];if(0===d)return n.makeTensorInfo(a.shape,o.dtype);const p=[],f=f3({inputs:{x:o},backend:n,attrs:{shape:[c,s]}});p.push(f);const m=f3({inputs:{x:i},backend:n,attrs:{shape:[c,l]}});p.push(m);const g=f3({inputs:{x:a},backend:n,attrs:{shape:h}});p.push(g);const y=O9({inputs:{x:g},backend:n,attrs:{reps:Array(h.length).fill(1)}}),v=new n9([c,l],s,f.shape.length,m.shape.length,u,h,a.dtype,!1),b=[{type:"int32",data:[s]},{type:"int32",data:u},{type:"int32",data:[OO([c,l])]}],x=n.runWebGPUProgram(v,[m,f],g.dtype,b,y);p.push(x);const w=f3({inputs:{x:x},backend:n,attrs:{shape:a.shape}});return p.forEach(e=>n.disposeData(e.dataId)),w}};class Y9{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, negativeInf : f32,\n        dir : i32, inc : i32,",this.shaderKey="swap"}getUserCode(){return"\n        ".concat(T2("index")," {\n          if (index < uniforms.size) {\n            let outC = getCoordsFromIndex(index);\n            let batch = outC[0];\n            let elemIdx = outC[1];\n            // We compare elements pair-wise within a group of size 2 * inc.\n            // The comparing rule for each group alternates between ascending\n            // and descending. Within each group, we compare each pair at\n            // positions i and i+inc. To decide whether an element at position i\n            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n            // inc, it is in the first half of the group, we denote it as x0,\n            // otherwise we denote it as x1.\n            // For example, as shown in the Bitonic top K paper referenced\n            // above, Figure5(a) shows that element[1] is in the second half of\n            // the group when group size is 2, but it is in the first half of\n            // the group when group size is 4.\n            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;\n            var i = 0;\n            if (isFirstInPair) {\n              i = elemIdx;\n            } else {\n              i = elemIdx - uniforms.inc;\n            }\n\n            var i0 = 0;\n            if (uniforms.firstPass == 1) {\n              i0 = i;\n            } else {\n              i0 = i32(getIndices(batch, i));\n            }\n\n            var i1 = 0;\n            if (uniforms.firstPass == 1) {\n              i1 = i + uniforms.inc;\n            } else {\n              i1 = i32(getIndices(batch, i + uniforms.inc));\n            }\n\n            var x0 = f32(0.0);\n            var x1 = f32(0.0);\n            if (i0 < uniforms.inputSize) {\n              x0 = getX(batch, i0);\n            } else {\n              x0 = uniforms.negativeInf;\n            }\n            if (i1 < uniforms.inputSize) {\n              x1 = getX(batch, i1);\n            } else {\n              x1 = uniforms.negativeInf;\n            }\n\n            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;\n            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n            if (reverse == isGreater) {\n              // Elements in opposite order of direction\n              let iTemp = i0;\n              i0 = i1;\n              i1 = iTemp;\n            }\n            if (isFirstInPair) {\n              setOutputAtIndex(index, f32(i0));\n            } else {\n              setOutputAtIndex(index, f32(i1));\n            }\n          }\n        }\n      ")}}class Q9{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return"\n        ".concat(T2("index")," {\n          if (index < uniforms.size) {\n            let outC = getCoordsFromIndex(index);\n            let batch = outC[0];\n            let elemIdx = outC[1];\n            // The output size is half of the previous size.\n            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _\n            // (k=4), we only need to output the indices at positions |, the\n            // indices at positions _ can be thrown away, see Figure5(b) After\n            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced\n            // above.\n            // For example, the paper shows we only need to output the orange\n            // bars. The output sequence should look like this | | | | | | | |.\n            // Because the sequence is halved, to map the output index back to\n            // the previous sequence to find the corresponding value, we need\n            // to double the index. When we double the index, we basically\n            // interpolate a position, so 2i looks like\n            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k\n            // position of each 2k positions by - elemIdx % k. E.g. for output\n            // at index 4,5,6,7, we want to get the corresponding element at\n            // original index 8,9,10,11, for output at index 8,9,10,11,\n            // we want to get the corresponding element at original index\n            // 16,17,18,19, so on and so forth.\n\n            var i = 0;\n            if (elemIdx < uniforms.k) {\n              i = elemIdx;\n            } else {\n              i = elemIdx * 2 - elemIdx % uniforms.k;\n            }\n            var i0 = 0;\n            if (uniforms.firstPass == 1) {\n              i0 = i;\n            } else {\n              i0 = i32(getIndices(batch, i));\n            }\n            var i1 = 0;\n            if (uniforms.firstPass == 1) {\n              i1 = i + uniforms.k;\n            } else {\n              i1 = i32(getIndices(batch, i + uniforms.k));\n            }\n\n            let x0 = getX(batch, i0);\n            var x1 = f32(0.0);\n            if (i1 < uniforms.inputSize) {\n              x1 = getX(batch, i1);\n            } else {\n              x1 = x0;\n            }\n\n            if (x0 >= x1) {\n              setOutputAtIndex(index, f32(i0));\n            } else {\n              setOutputAtIndex(index, f32(i1));\n            }\n          }\n        }\n      ")}}function Z9(e,t){null!==t&&e.disposeData(t.dataId)}function $9(e){let t=1;for(;t<e;)t*=2;return t}const J9={kernelName:sP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{k:o,sorted:i}=r,s=a.shape,c=s[s.length-1];if(n.shouldExecuteOnCPU([a])){const e=n.readSync(a.dataId),[t,r]=o4(e,s,a.dtype,o,i);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return s[s.length-1]=0,[n.makeTensorInfo(s,a.dtype,[]),n.makeTensorInfo(s,"int32",[])];if(1===c)return[a,h3({attrs:{shape:s,dtype:"int32",value:0},backend:n})];const l=OO(s)/c,u=f3({inputs:{x:a},attrs:{shape:[l,c]},backend:n}),d=$9(o),h=$9(c);let p=null;const f=()=>null===p?[u,u]:[u,p],m=(e,t,r)=>{const a=f(),o=new Y9(r),i=[{type:"int32",data:[c]},{type:"int32",data:[null===p?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[e]},{type:"int32",data:[t]}],s=p;p=n.runWebGPUProgram(o,a,"int32",i),Z9(n,s)};for(let x=1;x<d;x*=2){const e=2*x;for(let t=x;t>=1;t/=2)m(e,t,[l,h])}for(let x=h;x>d;x/=2){const e=f(),t=new Q9([l,x/2]),r=[{type:"int32",data:[c]},{type:"int32",data:[null===p?1:0]},{type:"int32",data:[d]}],a=p;p=n.runWebGPUProgram(t,e,"int32",r),Z9(n,a);const o=d/2,i=2*o;for(let n=o;n>=1;n/=2)m(i,n,p.shape)}let g=p;p=a6({inputs:{x:p},backend:n,attrs:{begin:0,size:[l,o]}}),Z9(n,g);let y=h8({inputs:{x:u,indices:p},backend:n,attrs:{axis:1,batchDims:1}});Z9(n,u);const v=s.slice(0,-1);v.push(o),g=p,p=f3({inputs:{x:p},attrs:{shape:v},backend:n}),Z9(n,g);const b=y;return y=f3({inputs:{x:y},attrs:{shape:v},backend:n}),Z9(n,b),[y,p]}};class eee{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return"\n          fn mapCoord(outCoord : f32, len : f32) -> f32{\n            var inCoord = outCoord;\n            if(uniforms.fillModeId == 2) {\n              if (inCoord < 0.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz2 = 2.0 * len;\n                  if (inCoord < sz2) {\n                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +\n                    inCoord;\n                  }\n                  if (inCoord < -len) {\n                    inCoord = inCoord + sz2;\n                  } else {\n                    inCoord = -inCoord - 1.0;\n                  }\n                }\n              } else if (inCoord > len - 1.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz2 = 2.0 * len;\n                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));\n                  if (inCoord >= len) {\n                    inCoord = sz2 - inCoord - 1.0;\n                  }\n                }\n              }\n              return clamp(inCoord, 0.0, len - 1.0);\n            } else if (uniforms.fillModeId == 3) {\n              if (inCoord < 0.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz = len - 1.0;\n                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);\n                }\n              } else if (inCoord > len - 1.0) {\n                if (len <= 1.0) {\n                  inCoord = 0.0;\n                } else {\n                  let sz = len - 1.0;\n                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));\n                }\n              }\n              return clamp(inCoord, 0.0, len - 1.0);\n            } else if (uniforms.fillModeId == 4) {\n              return clamp(outCoord, 0.0, len - 1.0);\n            }\n            return outCoord;\n          }\n          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,\n            channel : i32) -> f32 {\n            var outputValue : f32;\n            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {\n                outputValue = getImage(batch, coordY, coordX, channel);\n            } else {\n              outputValue = uniforms.fillValue;\n            }\n            return outputValue;\n          }\n\n          ".concat(T2("index")," {\n            if (index < uniforms.size) {\n              let coords = getCoordsFromIndex(index);\n              var outputValue : f32;\n              let batch = coords[0];\n              let x = coords[2];\n              let y = coords[1];\n              let channel = coords[3];\n              let xf = f32(x);\n              let yf = f32(y);\n              let a1 = getTransforms(batch, 0);\n              let a2 = getTransforms(batch, 1);\n              let a3 = getTransforms(batch, 2);\n              let b1 = getTransforms(batch, 3);\n              let b2 = getTransforms(batch, 4);\n              let b3 = getTransforms(batch, 5);\n              let c1 = getTransforms(batch, 6);\n              let c2 = getTransforms(batch, 7);\n              let projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = uniforms.fillValue;\n              } else {\n                let inX = (a1 * xf + a2 * yf + a3) / projection;\n                let inY = (b1 * xf + b2 * yf + b3) / projection;\n                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));\n                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));\n\n                if (uniforms.interpolationModeId == 1) {\n                  let coordY = i32(round(mapY));\n                  let coordX = i32(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  let yFloor = floor(mapY);\n                  let xFloor = floor(mapX);\n                  let yCeil = yFloor + 1.0;\n                  let xCeil = xFloor + 1.0;\n                  let valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);\n                  let valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutputAtIndex(index, outputValue);\n            }\n          }\n        ")}}const tee={kernelName:cP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a,transforms:o}=t,{interpolation:i,fillMode:s,fillValue:c,outputShape:l}=r,[u,d,h,p]=a.shape,[f,m]=null!=l?l:[d,h],g=new eee([u,f,m,p]),y="nearest"===i?1:2;let v;switch(s){case"constant":default:v=1;break;case"reflect":v=2;break;case"wrap":v=3;break;case"nearest":v=4}const b=[{type:"int32",data:[y]},{type:"int32",data:[v]},{type:"float32",data:[c]}];return n.runWebGPUProgram(g,[a,o],"float32",b)}};const nee={kernelName:dP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:o}=r;o<0&&(o+=a.shape.length);const i=a,s=i.shape.length,c=a.shape[o],l=new Array(s-1);let u=0;for(let m=0;m<s;m++)m!==o&&(l[u++]=i.shape[m]);const d=[],h=new Array(s).fill(0),p=i.shape.slice();p[o]=1;const f=new Array(c);for(let m=0;m<f.length;m++){h[o]=m;const e=a6({inputs:{x:i},backend:n,attrs:{begin:h,size:p}}),t=f3({inputs:{x:e},backend:n,attrs:{shape:l}});f[m]=t,d.push(e)}return d.forEach(e=>n.disposeData(e.dataId)),f}};class ree{constructor(e,t,n){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=t,this.dispatchLayout=j2(e),this.dispatch=L2(this.dispatchLayout,e,this.workgroupSize),"float32"!==n&&"int32"!==n)throw new Error("UnsortedSegmentSum only supports float32 and int32\n              types, does not support ".concat(n," type."));this.type=n,this.shaderKey="unsortedSegmentSum"}getUserCode(){return"\n    ".concat(T2("index")," {\n      if (index < uniforms.xSize) {\n        let coords = getXCoordsFromIndex(index);\n        let b = coords[0];\n        let inCol = coords[1];\n\n        let segmentId = i32(getSegmentIds(inCol));\n        if (segmentId >= 0) {\n          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;\n          let value = getX(b, inCol);\n\n          ").concat(w2("&result[flatIndex]","value",this.type),"\n        }\n      }\n    }\n  ")}}const aee={kernelName:hP,backendName:"webgpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a,segmentIds:o}=t,{numSegments:i}=r,s=a.shape.length,c=[];let l=0;const u=Yz([l],s);let d=a;null!=u&&(d=w4({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(d),l=Zz(1,s)[0]);const h=VV(d.shape,l,i),p=OO([d.shape[l]]),f=f3({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});c.push(f);const m=a.dtype,g=[f.shape[0],i],y=h3({backend:n,attrs:{shape:g,value:0,dtype:m}}),v=new ree(f.shape,g,m),b=[{type:"int32",data:[i]},{type:"int32",data:[OO(f.shape)]}],x=n.runWebGPUProgram(v,[f,o],m,b,y),w=f3({inputs:{x:x},backend:n,attrs:{shape:h}});c.push(x);let k=w;if(null!=u){c.push(w);const e=Qz(u);k=w4({inputs:{x:k},backend:n,attrs:{perm:e}})}return c.forEach(e=>n.disposeData(e.dataId)),k}},oee=[y3,l4,d4,p4,m4,y4,E4,T4,O4,A4,R4,D4,F4,z4,j4,Y4,Q4,J4,e6,t6,i6,l6,d6,g6,v6,w6,S3,C6,A6,F6,W6,V6,H6,K6,q6,Y6,Z6,J6,o5,i5,s5,l5,g5,y5,p5,b5,w5,C5,I5,T5,R5,D5,M5,L5,B5,W5,V5,H5,X5,p3,Q5,n8,$5,e8,i8,s8,c8,u8,p8,m8,y8,w3,v8,T6,x8,k8,C8,I8,T8,O8,_8,M8,P8,L8,B8,W8,H8,q8,H4,Y8,Q8,t7,Z8,e7,n7,q4,r7,o7,s7,l7,f7,O5,m7,g7,y7,p6,b7,k7,S7,E7,N7,O7,A7,_7,m6,P7,M7,L7,B7,m3,W7,V7,H7,q7,Y7,Z7,J7,t9,r9,o9,s9,l9,d9,p9,m9,y9,o6,z9,j9,W9,p7,b9,w9,E9,T9,_9,R9,D9,M9,L9,V9,_5,H9,q9,X9,A9,J9,tee,k4,nee,aee,w7];for(const n of oee)TP(n);var iee=function(e,t){return(iee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function see(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}iee(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var cee=function(){return(cee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function lee(e,t,n,r){return new(n||(n=Promise))(function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,s)}c((r=r.apply(e,t||[])).next())})}function uee(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function dee(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var hee=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],pee=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],fee={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},mee={left:[1,3,5,7,9,11,13,15],right:[2,4,6,8,10,12,14,16],middle:[0]},gee=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]],yee=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]];function vee(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function bee(e){return lee(this,void 0,void 0,function(){var t,n;return uee(this,function(r){switch(r.label){case 0:return t=document.createElement("canvas"),e instanceof lD?[4,nL(e,t)]:[3,2];case 1:return r.sent(),[3,3];case 2:t.width=vee(e.width),t.height=vee(e.height),n=t.getContext("2d"),e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0),r.label=3;case 3:return[2,t]}})})}function xee(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o,i;return uee(this,function(s){switch(s.label){case 0:return e instanceof lD?(t=e.shape.slice(0,2),n=t[0],r=t[1],a=ImageData.bind,[4,nL(e)]):[3,2];case 1:return[2,new(a.apply(ImageData,[void 0,s.sent(),r,n]))];case 2:return o=document.createElement("canvas"),i=o.getContext("2d"),o.width=vee(e.width),o.height=vee(e.height),i.drawImage(e,0,0),[2,i.getImageData(0,0,o.width,o.height)]}})})}function wee(e){return lee(this,void 0,void 0,function(){var t;return uee(this,function(n){switch(n.label){case 0:return e instanceof SVGImageElement||e instanceof OffscreenCanvas?[4,bee(e)]:[3,2];case 1:return t=n.sent(),[3,3];case 2:t=e,n.label=3;case 3:return[2,rL(t,4)]}})})}function kee(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(e));if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got ".concat(e))}var See={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},Cee=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,this.mask]})})},e.prototype.toImageData=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,xee(this.mask)]})})},e.prototype.toTensor=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,wee(this.mask)]})})},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function Iee(e){return kee(e),"person"}var Eee=function(){function e(e){var t,n=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new h2.Pose({locateFile:function(t,n){if(e.solutionPath){var r=e.solutionPath.replace(/\/+$/,"");return"".concat(r,"/").concat(t)}return"".concat(n,"/").concat(t)}}),e.modelType){case"lite":t=0;break;case"heavy":t=2;break;default:t=1}this.poseSolution.setOptions({modelComplexity:t,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(e){if(n.height=e.image.height,n.width=e.image.width,null==e.poseLandmarks)n.poses=[];else{var t=n.translateOutput(e.poseLandmarks,e.poseWorldLandmarks);e.segmentationMask&&(t.segmentation={maskValueToLabel:Iee,mask:new Cee(e.segmentationMask)}),n.poses=[t]}})}return e.prototype.translateOutput=function(e,t){var n=this,r={keypoints:e.map(function(e,t){return{x:e.x*n.width,y:e.y*n.height,z:e.z,score:e.visibility,name:pee[t]}})};return null!=t&&(r.keypoints3D=t.map(function(e,t){return{x:e.x,y:e.y,z:e.z,score:e.visibility,name:pee[t]}})),r},e.prototype.estimatePoses=function(e,t,n){return lee(this,void 0,void 0,function(){var r,a;return uee(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof lD?(a=ImageData.bind,[4,nL(e)]):[3,2];case 1:return r=new(a.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,o.label=3;case 3:return e=r,[4,this.poseSolution.send({image:e},n)];case 4:return o.sent(),[2,this.poses]}})})},e.prototype.dispose=function(){this.poseSolution.close()},e.prototype.reset=function(){this.poseSolution.reset()},e.prototype.initialize=function(){return this.poseSolution.initialize()},e}();function Tee(e){return lee(this,void 0,void 0,function(){var t,n;return uee(this,function(r){switch(r.label){case 0:return t=function(e){if(null==e)return cee({},See);var t=cee({},e);return t.runtime="mediapipe",null==t.enableSegmentation&&(t.enableSegmentation=See.enableSegmentation),null==t.enableSmoothing&&(t.enableSmoothing=See.enableSmoothing),null==t.smoothSegmentation&&(t.smoothSegmentation=See.smoothSegmentation),null==t.modelType&&(t.modelType=See.modelType),t}(e),[4,(n=new Eee(t)).initialize()];case 1:return r.sent(),[2,n]}})})}function Nee(e){return e instanceof lD?{height:e.shape[0],width:e.shape[1]}:{height:e.height,width:e.width}}function Oee(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function Aee(e){return e instanceof lD?e:rL(e)}function _ee(e,t,n){return Ree(n,"inputResolution"),[1/n.width*e[0][0]*t.width,1/n.height*e[0][1]*t.width,e[0][3]*t.width,1/n.width*e[1][0]*t.height,1/n.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}function Ree(e,t){EO(0!==e.width,function(){return"".concat(t," width cannot be 0.")}),EO(0!==e.height,function(){return"".concat(t," height cannot be 0.")})}function Pee(e,t,n){var r=n.rotationVectorStartKeypointIndex,a=n.rotationVectorEndKeypointIndex,o=e.locationData,i=o.relativeKeypoints[r].x*t.width,s=o.relativeKeypoints[r].y*t.height,c=o.relativeKeypoints[a].x*t.width,l=o.relativeKeypoints[a].y*t.height,u=2*Math.sqrt((c-i)*(c-i)+(l-s)*(l-s)),d=function(e,t,n){var r,a=e.locationData,o=n.rotationVectorStartKeypointIndex,i=n.rotationVectorEndKeypointIndex;r=n.rotationVectorTargetAngle?n.rotationVectorTargetAngle:Math.PI*n.rotationVectorTargetAngleDegree/180;var s=a.relativeKeypoints[o].x*t.width,c=a.relativeKeypoints[o].y*t.height,l=a.relativeKeypoints[i].x*t.width,u=a.relativeKeypoints[i].y*t.height;return Oee(r-Math.atan2(-(u-c),l-s))}(e,t,n);return{xCenter:i/t.width,yCenter:s/t.height,width:u/t.width,height:u/t.height,rotation:d}}function Dee(e){if(16!==e.length)throw new Error("Array length must be 16 but got ".concat(e.length));return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}function Mee(e,t,n,r,a,o,i){return e[t][a]*(e[n][o]*e[r][i]-e[n][i]*e[r][o])}function Fee(e,t,n){var r=(t+1)%4,a=(t+2)%4,o=(t+3)%4,i=(n+1)%4,s=(n+2)%4,c=(n+3)%4;return Mee(e,r,a,o,i,s,c)+Mee(e,a,o,r,i,s,c)+Mee(e,o,r,a,i,s,c)}function Lee(e,t,n){void 0===n&&(n={ignoreRotation:!1});for(var r=[],a=0,o=e;a<o.length;a++){var i=o[a],s=i.x-.5,c=i.y-.5,l=n.ignoreRotation?0:t.rotation,u=Math.cos(l)*s-Math.sin(l)*c,d=Math.sin(l)*s+Math.cos(l)*c;u=u*t.width+t.xCenter,d=d*t.height+t.yCenter;var h=i.z*t.width,p=cee({},i);p.x=u,p.y=d,p.z=h,r.push(p)}return r}function zee(e,t){var n=function(e,t,n,r){var a=(r-n)/255;return{scale:a,offset:n-0*a}}(0,0,t[0],t[1]);return XD(function(){return iF(lF(e,n.scale),n.offset)})}function Bee(e,t,n){var r,a,o,i,s,c,l,u,d,h,p,f,m=t.outputTensorSize,g=t.keepAspectRatio,y=t.borderMode,v=t.outputTensorFloatRange,b=Nee(e),x=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}}(b,n),w=function(e,t,n){if(void 0===n&&(n=!1),!n)return{top:0,left:0,right:0,bottom:0};var r=t.height,a=t.width;Ree(t,"targetSize"),Ree(e,"roi");var o,i,s=r/a,c=e.height/e.width,l=0,u=0;return s>c?(o=e.width,i=e.width*s,u=(1-c/s)/2):(o=e.height/s,i=e.height,l=(1-s/c)/2),e.width=o,e.height=i,{top:u,left:l,right:l,bottom:u}}(x,m,g),k=(r=x,a=b.width,o=b.height,i=r.width,s=r.height,c=Math.cos(r.rotation),l=Math.sin(r.rotation),u=r.xCenter,d=r.yCenter,h=1/a,p=1/o,(f=new Array(16))[0]=i*c*1*h,f[1]=-s*l*h,f[2]=0,f[3]=(-.5*i*c*1+.5*s*l+u)*h,f[4]=i*l*1*p,f[5]=s*c*p,f[6]=0,f[7]=(-.5*s*c-.5*i*l*1+d)*p,f[8]=0,f[9]=0,f[10]=i*h,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,Dee(f));return{imageTensor:XD(function(){var t=Aee(e),n=nW(_ee(k,b,m),[1,8]),r="zero"===y?"constant":"nearest",a=MU.transform(oB(rF(t,"float32")),n,"bilinear",r,0,[m.height,m.width]);return null!=v?zee(a,v):a}),padding:w,transformationMatrix:k}}function jee(e,t,n,r){return 1===r?.5*(e+t):e+(t-e)*n/(r-1)}function Wee(e){return null!=e&&null!=e.currentTime}function Uee(e){for(var t={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=0;i<e.length;++i){var s=e[i];n=Math.min(n,s.x),r=Math.max(r,s.x),a=Math.min(a,s.y),o=Math.max(o,s.y),t.locationData.relativeKeypoints.push({x:s.x,y:s.y})}return t.locationData.relativeBoundingBox={xMin:n,yMin:a,xMax:r,yMax:o,width:r-n,height:o-a},t}function Vee(e,t,n,r){return lee(this,void 0,void 0,function(){var r,a,o,i,s;return uee(this,function(c){switch(c.label){case 0:return e.sort(function(e,t){return Math.max.apply(Math,t.score)-Math.max.apply(Math,e.score)}),r=nW(e.map(function(e){return[e.locationData.relativeBoundingBox.yMin,e.locationData.relativeBoundingBox.xMin,e.locationData.relativeBoundingBox.yMax,e.locationData.relativeBoundingBox.xMax]})),a=tW(e.map(function(e){return e.score[0]})),[4,MU.nonMaxSuppressionAsync(r,a,t,n)];case 1:return[4,(o=c.sent()).array()];case 2:return i=c.sent(),s=e.filter(function(e,t){return i.indexOf(t)>-1}),YD([r,a,o]),[2,s]}})})}function Gee(e,t){return e.map(function(e){var n=cee(cee({},e),{x:e.x*t.width,y:e.y*t.height});return null!=e.z&&(n.z=e.z*t.width),n})}function Hee(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h,p,f,m,g,y,v,b,x,w,k,S,C,I,E;return uee(this,function(T){switch(T.label){case 0:if(r=Qj(t,[0]),a=r.shape,o=a[0],i=a[1],s=a[2],e.length!==s)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(e.length,", heatmap length: ").concat(s));return c=[],[4,r.buffer()];case 1:for(l=T.sent(),u=0;u<e.length;u++)if(d=e[u],h=cee({},d),c.push(h),p=Math.trunc(h.x*i),f=Math.trunc(h.y*o),!(p<0||p>=i||f<0||p>=o)){for(m=Math.trunc((n.kernelSize-1)/2),g=Math.max(0,p-m),y=Math.min(i,p+m+1),v=Math.max(0,f-m),b=Math.min(o,f+m+1),x=0,w=0,k=0,S=0,C=v;C<b;++C)for(I=g;I<y;++I)E=l.get(C,I,u),x+=E,S=Math.max(S,E),w+=I*E,k+=C*E;S>=n.minConfidenceToRefine&&x>0&&(h.x=w/i/x,h.y=k/o/x)}return r.dispose(),[2,c]}})})}function Kee(e,t){var n=t.left,r=t.top,a=t.left+t.right,o=t.top+t.bottom;return e.map(function(e){return cee(cee({},e),{x:(e.x-n)/(1-a),y:(e.y-r)/(1-o),z:e.z/(1-a)})})}function qee(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s;return uee(this,function(c){switch(c.label){case 0:return r=e[0],a=e[1],o=function(e,t,n){return XD(function(){var r,a,o,i;n.reverseOutputOrder?(a=Qj(nz(e,[0,n.boxCoordOffset+0],[-1,1])),r=Qj(nz(e,[0,n.boxCoordOffset+1],[-1,1])),i=Qj(nz(e,[0,n.boxCoordOffset+2],[-1,1])),o=Qj(nz(e,[0,n.boxCoordOffset+3],[-1,1]))):(r=Qj(nz(e,[0,n.boxCoordOffset+0],[-1,1])),a=Qj(nz(e,[0,n.boxCoordOffset+1],[-1,1])),o=Qj(nz(e,[0,n.boxCoordOffset+2],[-1,1])),i=Qj(nz(e,[0,n.boxCoordOffset+3],[-1,1]))),a=iF(lF(cF(a,n.xScale),t.w),t.x),r=iF(lF(cF(r,n.yScale),t.h),t.y),n.applyExponentialOnBoxSize?(o=lF(aB(cF(o,n.hScale)),t.h),i=lF(aB(cF(i,n.wScale)),t.w)):(o=lF(cF(o,n.hScale),t.h),i=lF(cF(i,n.wScale),t.h));var s=SF(r,cF(o,2)),c=SF(a,cF(i,2)),l=iF(r,cF(o,2)),u=iF(a,cF(i,2)),d=JL([QL(s,[n.numBoxes,1]),QL(c,[n.numBoxes,1]),QL(l,[n.numBoxes,1]),QL(u,[n.numBoxes,1])],1);if(n.numKeypoints)for(var h=0;h<n.numKeypoints;++h){var p=n.keypointCoordOffset+h*n.numValuesPerKeypoint,f=void 0,m=void 0;n.reverseOutputOrder?(f=Qj(nz(e,[0,p],[-1,1])),m=Qj(nz(e,[0,p+1],[-1,1]))):(m=Qj(nz(e,[0,p],[-1,1])),f=Qj(nz(e,[0,p+1],[-1,1])));var g=iF(lF(cF(f,n.xScale),t.w),t.x),y=iF(lF(cF(m,n.yScale),t.h),t.y);d=JL([d,QL(g,[n.numBoxes,1]),QL(y,[n.numBoxes,1])],1)}return d})}(a,t,n),i=XD(function(){var e=r;return n.sigmoidScore?(null!=n.scoreClippingThresh&&(e=mz(r,-n.scoreClippingThresh,n.scoreClippingThresh)),e=tz(e)):e}),[4,Xee(o,i,n)];case 1:return s=c.sent(),YD([o,i]),[2,s]}})})}function Xee(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h,p,f;return uee(this,function(m){switch(m.label){case 0:return r=[],[4,e.data()];case 1:return a=m.sent(),[4,t.data()];case 2:for(o=m.sent(),i=0;i<n.numBoxes;++i)if(!(null!=n.minScoreThresh&&o[i]<n.minScoreThresh||(s=i*n.numCoords,c=Yee(a[s+0],a[s+1],a[s+2],a[s+3],o[i],n.flipVertically,i),(l=c.locationData.relativeBoundingBox).width<0||l.height<0))){if(n.numKeypoints>0)for((u=c.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)p=s+n.keypointCoordOffset+h,f={x:a[p+0],y:n.flipVertically?1-a[p+1]:a[p+1]},u.relativeKeypoints.push(f);r.push(c)}return[2,r]}})})}function Yee(e,t,n,r,a,o,i){return{score:[a],ind:i,locationData:{relativeBoundingBox:{xMin:t,yMin:o?1-n:e,xMax:r,yMax:o?1-e:n,width:r-t,height:n-e}}}}function Qee(e,t){return"none"===e?t:function(e){return 1/(1+Math.exp(-e))}(t)}function Zee(e,t,n,r){return lee(this,void 0,void 0,function(){var a,o,i,s,c,l,u,d;return uee(this,function(h){switch(h.label){case 0:return n=n||t.flipHorizontally||!1,r=r||t.flipVertically||!1,a=e.size,o=a/t.numLandmarks,[4,e.data()];case 1:for(i=h.sent(),s=[],c=0;c<t.numLandmarks;++c)l=c*o,(d={x:0,y:0}).x=n?t.inputImageWidth-i[l]:i[l],o>1&&(d.y=r?t.inputImageHeight-i[l+1]:i[l+1]),o>2&&(d.z=i[l+2]),o>3&&(d.score=Qee(t.visibilityActivation,i[l+3])),s.push(d);for(u=0;u<s.length;++u)(d=s[u]).x=d.x/t.inputImageWidth,d.y=d.y/t.inputImageHeight,d.z=d.z/t.inputImageWidth/(t.normalizeZ||1);return[2,s]}})})}function $ee(e,t,n){var r=e.width,a=e.height,o=e.rotation;if(null==n.rotation&&null==n.rotationDegree||(o=function(e,t){return null!=t.rotation?e+=t.rotation:null!=t.rotationDegree&&(e+=Math.PI*t.rotationDegree/180),Oee(e)}(o,n)),0===o)e.xCenter=e.xCenter+r*n.shiftX,e.yCenter=e.yCenter+a*n.shiftY;else{var i=(t.width*r*n.shiftX*Math.cos(o)-t.height*a*n.shiftY*Math.sin(o))/t.width,s=(t.width*r*n.shiftX*Math.sin(o)+t.height*a*n.shiftY*Math.cos(o))/t.height;e.xCenter=e.xCenter+i,e.yCenter=e.yCenter+s}if(n.squareLong){var c=Math.max(r*t.width,a*t.height);r=c/t.width,a=c/t.height}else if(n.squareShort){var l=Math.min(r*t.width,a*t.height);r=l/t.width,a=l/t.height}return e.width=r*n.scaleX,e.height=a*n.scaleY,e}function Jee(e,t){return e.map(function(e){var n=cee(cee({},e),{x:e.x/t.width,y:e.y/t.height});return null!=e.z&&(e.z=e.z/t.width),n})}var ete=function(){function e(e){this.alpha=e,this.initialized=!1}return e.prototype.apply=function(e,t){var n;return this.initialized?n=null==t?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*t*Math.asinh((e-this.storedValue)/t):(n=e,this.initialized=!0),this.rawValue=e,this.storedValue=n,n},e.prototype.applyWithAlpha=function(e,t,n){return this.alpha=t,this.apply(e,n)},e.prototype.hasLastRawValue=function(){return this.initialized},e.prototype.lastRawValue=function(){return this.rawValue},e.prototype.reset=function(){this.initialized=!1},e}(),tte=function(){function e(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new ete(this.getAlpha(this.minCutOff)),this.dx=new ete(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return e.prototype.apply=function(e,t,n){if(null==e)return e;var r=Math.trunc(t);if(this.lastTimestamp>=r)return e;0!==this.lastTimestamp&&0!==r&&(this.frequency=1/(1e-6*(r-this.lastTimestamp))),this.lastTimestamp=r;var a=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*n*this.frequency:0,o=this.dx.applyWithAlpha(a,this.getAlpha(this.derivateCutOff)),i=this.minCutOff+this.beta*Math.abs(o),s=null!=this.thresholdCutOff?this.thresholdCutOff+this.thresholdBeta*Math.abs(o):null;return this.x.applyWithAlpha(e,this.getAlpha(i),s)},e.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},e}(),nte=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var r=this;if(null==e)return this.reset(),null;this.initializeFiltersIfEmpty(e);var a=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return dee([],e,!0);a=1/n}return e.map(function(e,n){var o=cee(cee({},e),{x:r.xFilters[n].apply(e.x,t,a),y:r.yFilters[n].apply(e.y,t,a)});return null!=e.z&&(o.z=r.zFilters[n].apply(e.z,t,a)),o})},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map(function(e){return new tte(t.config)}),this.yFilters=e.map(function(e){return new tte(t.config)}),this.zFilters=e.map(function(e){return new tte(t.config)}))},e}(),rte=function(){function e(e){this.config=e,this.window=[],this.lowPassFilter=new ete(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return e.prototype.apply=function(e,t,n){if(null==e)return e;var r,a=Math.trunc(t);if(this.lastTimestamp>=a)return e;if(-1===this.lastTimestamp)r=1;else{for(var o=e*n-this.lastValue*this.lastValueScale,i=a-this.lastTimestamp,s=o,c=i,l=(1+this.window.length)*(1e6/30),u=0,d=this.window;u<d.length;u++){var h=d[u];if(c+h.duration>l)break;s+=h.distance,c+=h.duration}var p=s/(1e-6*c);r=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:o,duration:i}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=n,this.lastTimestamp=a,this.lowPassFilter.applyWithAlpha(e,r)},e}(),ate=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,n){var r=this;if(null==e)return this.reset(),null;var a=1;if(!this.config.disableValueScaling){if(n<this.config.minAllowedObjectScale)return dee([],e,!0);a=1/n}return this.initializeFiltersIfEmpty(e),e.map(function(e,n){var o=cee(cee({},e),{x:r.xFilters[n].apply(e.x,t,a),y:r.yFilters[n].apply(e.y,t,a)});return null!=e.z&&(o.z=r.zFilters[n].apply(e.z,t,a)),o})},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map(function(e){return new rte(t.config)}),this.yFilters=e.map(function(e){return new rte(t.config)}),this.zFilters=e.map(function(e){return new rte(t.config)}))},e}(),ote=function(){function e(e){if(null!=e.velocityFilter)this.keypointsFilter=new ate(e.velocityFilter);else{if(null==e.oneEuroFilter)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new nte(e.oneEuroFilter)}}return e.prototype.apply=function(e,t,n,r,a){if(void 0===r&&(r=!1),null==e)return this.keypointsFilter.reset(),null;var o=null!=a?function(e,t){return(e.width*t.width+e.height*t.height)/2}(a,n):1,i=r?Gee(e,n):e,s=this.keypointsFilter.apply(i,t,o);return r?Jee(s,n):s},e}(),ite=function(){function e(e){this.alpha=e.alpha}return e.prototype.apply=function(e){var t=this;if(null==e)return this.visibilityFilters=null,null;null!=this.visibilityFilters&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(e){return new ete(t.alpha)}));for(var n=[],r=0;r<e.length;++r){var a=e[r],o=cee({},a);o.score=this.visibilityFilters[r].apply(a.score),n.push(o)}return n},e}(),ste={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},cte={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},lte={maxPoses:1,flipHorizontal:!1},ute={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},dte={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},hte={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},pte={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},fte={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},mte={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},gte={kernelSize:7,minConfidenceToRefine:.5},yte={alpha:.1},vte={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},bte={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},xte={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},wte={activation:"none"},kte={combineWithPreviousRatio:.7},Ste=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,bee(this.mask)]})})},e.prototype.toImageData=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,xee(this.mask)]})})},e.prototype.toTensor=function(){return lee(this,void 0,void 0,function(){return uee(this,function(e){return[2,this.mask]})})},e.prototype.getUnderlyingType=function(){return"tensor"},e}();function Cte(e){return kee(e),"person"}var Ite=function(){function e(e,t,n,r,a,o){this.detectorModel=e,this.landmarkModel=t,this.enableSmoothing=n,this.enableSegmentation=r,this.smoothSegmentation=a,this.modelType=o,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(e){null==e.reduceBoxesInLowestLayer&&(e.reduceBoxesInLowestLayer=!1),null==e.interpolatedScaleAspectRatio&&(e.interpolatedScaleAspectRatio=1),null==e.fixedAnchorSize&&(e.fixedAnchorSize=!1);for(var t=[],n=0;n<e.numLayers;){for(var r=[],a=[],o=[],i=[],s=n;s<e.strides.length&&e.strides[s]===e.strides[n];){var c=jee(e.minScale,e.maxScale,s,e.strides.length);if(0===s&&e.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),i.push(.1),i.push(c),i.push(c);else{for(var l=0;l<e.aspectRatios.length;++l)o.push(e.aspectRatios[l]),i.push(c);if(e.interpolatedScaleAspectRatio>0){var u=s===e.strides.length-1?1:jee(e.minScale,e.maxScale,s+1,e.strides.length);i.push(Math.sqrt(c*u)),o.push(e.interpolatedScaleAspectRatio)}}s++}for(var d=0;d<o.length;++d){var h=Math.sqrt(o[d]);r.push(i[d]/h),a.push(i[d]*h)}var p=0,f=0;if(e.featureMapHeight.length>0)p=e.featureMapHeight[n],f=e.featureMapWidth[n];else{var m=e.strides[n];p=Math.ceil(e.inputSizeHeight/m),f=Math.ceil(e.inputSizeWidth/m)}for(var g=0;g<p;++g)for(var y=0;y<f;++y)for(var v=0;v<r.length;++v){var b={xCenter:(y+e.anchorOffsetX)/f,yCenter:(g+e.anchorOffsetY)/p,width:0,height:0};e.fixedAnchorSize?(b.width=1,b.height=1):(b.width=a[v],b.height=r[v]),t.push(b)}n=s}return t}(ste);var i=tW(this.anchors.map(function(e){return e.width})),s=tW(this.anchors.map(function(e){return e.height})),c=tW(this.anchors.map(function(e){return e.xCenter})),l=tW(this.anchors.map(function(e){return e.yCenter}));this.anchorTensor={x:c,y:l,w:i,h:s},this.prevFilteredSegmentationMask=this.enableSegmentation?nW([],[0,0]):null}return e.prototype.estimatePoses=function(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h,p,f,m,g,y,v,b,x,w,k,S,C,I;return uee(this,function(E){switch(E.label){case 0:return r=function(e){var t;if(null==(t=null==e?lte:cee({},e)).maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(t.maxPoses,". Should be > 0."));if(t.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return t}(t),null==e?(this.reset(),[2,[]]):(this.maxPoses=r.maxPoses,this.timestamp=null!=n?1e3*n:Wee(e)?1e6*e.currentTime:null,a=Nee(e),o=XD(function(){return rF(Aee(e),"float32")}),null!=(i=this.regionOfInterest)?[3,2]:[4,this.detectPose(o)]);case 1:if(0===(s=E.sent()).length)return this.reset(),o.dispose(),[2,[]];c=s[0],i=this.poseDetectionToRoi(c,a),E.label=2;case 2:return[4,this.poseLandmarksByRoi(i,o)];case 3:return l=E.sent(),o.dispose(),null==l?(this.reset(),[2,[]]):(u=l.landmarks,d=l.auxiliaryLandmarks,h=l.poseScore,p=l.worldLandmarks,f=l.segmentationMask,m=this.poseLandmarkFiltering(u,d,p,a),g=m.actualLandmarksFiltered,y=m.auxiliaryLandmarksFiltered,v=m.actualWorldLandmarksFiltered,b=this.poseLandmarksToRoi(y,a),this.regionOfInterest=b,x=this.smoothSegmentation&&null!=f?this.poseSegmentationFiltering(f):f,null!=(w=null!=g?Gee(g,a):null)&&w.forEach(function(e,t){e.name=pee[t]}),null!=(k=v)&&k.forEach(function(e,t){e.name=pee[t]}),S={score:h,keypoints:w,keypoints3D:k},null!==x&&(C=XD(function(){var e=oB(x,2),t=JB(e,[[0,0],[0,0],[0,1]]);return GB(t,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||YD(x),I={maskValueToLabel:Cte,mask:new Ste(C)},S.segmentation=I),[2,[S]])}})})},e.prototype.poseSegmentationFiltering=function(e){var t=this.prevFilteredSegmentationMask;return 0===t.size?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=function(e,t,n){return"webgl"===ZD()?function(e,t,n){var r=n.combineWithPreviousRatio.toFixed(2),a={variableNames:["prevMask","newMask"],outputShape:e.shape,userCode:"\n  void main() {\n      ivec2 coords = getOutputCoords();\n      int height = coords[0];\n      int width = coords[1];\n\n      float prevMaskValue = getPrevMask(height, width);\n      float newMaskValue = getNewMask(height, width);\n\n      /*\n      * Assume p := newMaskValue\n      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)\n      * uncertainty alpha(p) =\n      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the\n      * uncertainty]\n      *\n      * The following polynomial approximates uncertainty alpha as a\n      * function of (p + 0.5):\n      */\n      const float c1 = 5.68842;\n      const float c2 = -0.748699;\n      const float c3 = -57.8051;\n      const float c4 = 291.309;\n      const float c5 = -624.717;\n      float t = newMaskValue - 0.5;\n      float x = t * t;\n\n      float uncertainty =\n        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));\n\n      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *\n                             (uncertainty * ".concat(r,");\n\n      setOutput(outputValue);\n    }\n")},o=JD();return XD(function(){var n=o.compileAndRun(a,[e,t]);return qD().makeTensorFromDataId(n.dataId,n.shape,n.dtype)})}(e,t,n):XD(function(){var r=SF(t,.5),a=dF(r),o=SF(1,VB(1,lF(a,iF(5.68842,lF(a,iF(-.748699,lF(a,iF(-57.8051,lF(a,iF(291.309,lF(a,-624.717)))))))))));return iF(t,lF(SF(e,t),lF(o,n.combineWithPreviousRatio)))})}(t,e,kte),YD(e)),YD(t),this.prevFilteredSegmentationMask},e.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),YD([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},e.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(YD(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=nW([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},e.prototype.detectPose=function(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o,i,s,c,l,u;return uee(this,function(d){switch(d.label){case 0:return t=Bee(e,hte),n=t.imageTensor,r=t.padding,a=this.detectorModel.predict(n),o=function(e){return XD(function(){var t=function(e){return XD(function(){return[nz(e,[0,0,0],[1,-1,1]),nz(e,[0,0,1],[1,-1,-1])]})}(e),n=t[0],r=t[1];return{boxes:Qj(r),logits:Qj(n)}})}(a),i=o.boxes,[4,qee([s=o.logits,i],this.anchorTensor,ute)];case 1:return 0===(c=d.sent()).length?(YD([n,a,s,i]),[2,c]):[4,Vee(c,this.maxPoses,.3)];case 2:return l=d.sent(),u=function(e,t){void 0===e&&(e=[]);for(var n=t.left,r=t.top,a=t.left+t.right,o=t.top+t.bottom,i=0;i<e.length;i++){var s=e[i],c=s.locationData.relativeBoundingBox,l=(c.xMin-n)/(1-a),u=(c.yMin-r)/(1-o),d=c.width/(1-a),h=c.height/(1-o);c.xMin=l,c.yMin=u,c.width=d,c.height=h,c.xMax=l+d,c.yMax=u+h;var p=s.locationData.relativeKeypoints;p&&p.forEach(function(e){var t=(e.x-n)/(1-a),i=(e.y-r)/(1-o);e.x=t,e.y=i})}return e}(l,r),YD([n,a,s,i]),[2,u]}})})},e.prototype.poseDetectionToRoi=function(e,t){return $ee(Pee(e,t,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),t,dte)},e.prototype.poseLandmarksByRoi=function(e,t){return lee(this,void 0,void 0,function(){var n,r,a,o,i,s,c,l,u,d,h,p,f,m;return uee(this,function(g){switch(g.label){case 0:if(n=Nee(t),r=Bee(t,pte,e),a=r.imageTensor,o=r.padding,i=r.transformationMatrix,"lite"!==this.modelType&&"full"!==this.modelType&&"heavy"!==this.modelType)throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return s=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&s.push("activation_segmentation"),c=this.landmarkModel.execute(a,s),[4,this.tensorsToPoseLandmarksAndSegmentation(c)];case 1:return null==(l=g.sent())?(YD(c),YD(a),[2,null]):(u=l.landmarks,d=l.auxiliaryLandmarks,h=l.poseScore,p=l.worldLandmarks,f=l.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(n,e,o,i,u,d,p,f)]);case 2:return m=g.sent(),YD(c),YD(a),[2,cee({poseScore:h},m)]}})})},e.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,t,n,r,a,o,i,s){return lee(this,void 0,void 0,function(){var c,l,u,d,h,p;return uee(this,function(f){return c=Kee(a,n),l=Kee(o,n),u=Lee(c,t),d=Lee(l,t),h=function(e,t){for(var n=[],r=0,a=e;r<a.length;r++){var o=a[r],i=o.x,s=o.y,c=t.rotation,l=Math.cos(c)*i-Math.sin(c)*s,u=Math.sin(c)*i+Math.cos(c)*s,d=cee({},o);d.x=l,d.y=u,n.push(d)}return n}(i,t),p=null,this.enableSegmentation&&(p=XD(function(){var t=s.shape,n=t[0],a=t[1],o=function(e){var t=Dee(new Array(16).fill(0));t[0][0]=Fee(e,0,0),t[1][0]=-Fee(e,0,1),t[2][0]=Fee(e,0,2),t[3][0]=-Fee(e,0,3),t[0][2]=Fee(e,2,0),t[1][2]=-Fee(e,2,1),t[2][2]=Fee(e,2,2),t[3][2]=-Fee(e,2,3),t[0][1]=-Fee(e,1,0),t[1][1]=Fee(e,1,1),t[2][1]=-Fee(e,1,2),t[3][1]=Fee(e,1,3),t[0][3]=-Fee(e,3,0),t[1][3]=Fee(e,3,1),t[2][3]=-Fee(e,3,2),t[3][3]=Fee(e,3,3);for(var n=e[0][0]*t[0][0]+e[1][0]*t[0][1]+e[2][0]*t[0][2]+e[3][0]*t[0][3],r=0;r<t.length;r++)for(var a=0;a<t.length;a++)t[r][a]/=n;return t}(r),i=nW(_ee(o,{width:a,height:n},e),[1,8]),c=[1,n,a,1];return Qj(MU.transform(QL(s,c),i,"bilinear","constant",0,[e.height,e.width]),[0,3])}),YD(s)),[2,{landmarks:u,auxiliaryLandmarks:d,worldLandmarks:h,segmentationMask:p}]})})},e.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o,i,s,c,l,u,d,h,p;return uee(this,function(f){switch(f.label){case 0:return t=e[0],n=e[1],r=e[2],a=e[3],o=this.enableSegmentation?e[4]:null,[4,n.data()];case 1:return(i=f.sent()[0])<.5?[2,null]:[4,Zee(t,fte)];case 2:return[4,Hee(f.sent(),r,gte)];case 3:return s=f.sent(),c=s.slice(0,33),l=s.slice(33,35),[4,Zee(a,mte)];case 4:return u=f.sent(),d=u.slice(0,33),h=function(e,t,n){void 0===n&&(n=!0);for(var r=[],a=0;a<e.length;a++){var o=cee({},t[a]);n&&(o.score=e[a].score),r.push(o)}return r}(c,d,!0),p=this.enableSegmentation?function(e,t){return XD(function(){var n=Qj(e,[0]),r=n.shape[2];if(1===r){var a=n;switch(t.activation){case"none":break;case"sigmoid":a=tz(a);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(t.activation,")"))}return Qj(a,[2])}throw new Error("Unsupported number of tensor channels ".concat(r))})}(o,wte):null,[2,{landmarks:c,auxiliaryLandmarks:l,poseScore:i,worldLandmarks:h,segmentationMask:p}]}})})},e.prototype.poseLandmarksToRoi=function(e,t){return $ee(Pee(Uee(e),t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),t,dte)},e.prototype.poseLandmarkFiltering=function(e,t,n,r){var a,o,i;if(null!=this.timestamp&&this.enableSmoothing){var s=Pee(Uee(t),r,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});null==this.visibilitySmoothingFilterActual&&(this.visibilitySmoothingFilterActual=new ite(yte)),a=this.visibilitySmoothingFilterActual.apply(e),null==this.visibilitySmoothingFilterAuxiliary&&(this.visibilitySmoothingFilterAuxiliary=new ite(yte)),o=this.visibilitySmoothingFilterAuxiliary.apply(t),i=this.visibilitySmoothingFilterActual.apply(n),null==this.landmarksSmoothingFilterActual&&(this.landmarksSmoothingFilterActual=new ote(vte)),a=this.landmarksSmoothingFilterActual.apply(a,this.timestamp,r,!0,s),null==this.landmarksSmoothingFilterAuxiliary&&(this.landmarksSmoothingFilterAuxiliary=new ote(bte)),o=this.landmarksSmoothingFilterAuxiliary.apply(o,this.timestamp,r,!0,s),null==this.worldLandmarksSmoothingFilterActual&&(this.worldLandmarksSmoothingFilterActual=new ote(xte)),i=this.worldLandmarksSmoothingFilterActual.apply(n,this.timestamp)}else a=e,o=t,i=n;return{actualLandmarksFiltered:a,auxiliaryLandmarksFiltered:o,actualWorldLandmarksFiltered:i}},e}();function Ete(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o,i;return uee(this,function(s){switch(s.label){case 0:return t=function(e){var t=cee({},null==e?cte:e);if(null==t.enableSmoothing&&(t.enableSmoothing=cte.enableSmoothing),null==t.enableSegmentation&&(t.enableSegmentation=cte.enableSegmentation),null==t.smoothSegmentation&&(t.smoothSegmentation=cte.smoothSegmentation),null==t.modelType&&(t.modelType=cte.modelType),null==t.detectorModelUrl&&(t.detectorModelUrl=cte.detectorModelUrl),null==t.landmarkModelUrl)switch(t.modelType){case"lite":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;default:t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return t}(e),n="string"==typeof t.detectorModelUrl&&t.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r="string"==typeof t.landmarkModelUrl&&t.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([d2(t.detectorModelUrl,{fromTFHub:n}),d2(t.landmarkModelUrl,{fromTFHub:r})])];case 1:return a=s.sent(),o=a[0],i=a[1],[2,new Ite(o,i,t.enableSmoothing,t.enableSegmentation,t.smoothSegmentation,t.modelType)]}})})}var Tte,Nte,Ote,Ate=function(){function e(e){!function(e){if(e.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(e.maxTracks));if(e.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(e.maxAge));if(void 0!==e.keypointTrackerParams){if(e.keypointTrackerParams.keypointConfidenceThreshold<0||e.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(e.keypointTrackerParams.keypointConfidenceThreshold));if(e.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(e.keypointTrackerParams.minNumberOfKeypoints));for(var t=0,n=e.keypointTrackerParams.keypointFalloff;t<n.length;t++){var r=n[t];if(r<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(r))}}}(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return e.prototype.apply=function(e,t){this.filterOldTracks(t);var n=this.computeSimilarity(e);return this.assignTracks(e,n,t),this.updateTracks(t),e},e.prototype.getTracks=function(){return this.tracks.slice()},e.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},e.prototype.filterOldTracks=function(e){var t=this;this.tracks=this.tracks.filter(function(n){return e-n.lastTimestamp<=t.maxAge})},e.prototype.assignTracks=function(e,t,n){for(var r=Array.from(Array(t[0].length).keys()),a=[],o=0,i=Array.from(Array(e.length).keys());o<i.length;o++){var s=i[o];if(0!==r.length){for(var c=-1,l=-1,u=0,d=r;u<d.length;u++){var h=d[u],p=t[s][h];p>=this.minSimilarity&&p>l&&(c=h,l=p)}if(c>=0){var f=this.tracks[c];f=Object.assign(f,this.createTrack(e[s],n,f.id)),e[s].id=f.id;var m=r.indexOf(c);r.splice(m,1)}else a.push(s)}else a.push(s)}for(var g=0,y=a;g<y.length;g++){s=y[g];var v=this.createTrack(e[s],n);this.tracks.push(v),e[s].id=v.id}},e.prototype.updateTracks=function(e){this.tracks.sort(function(e,t){return t.lastTimestamp-e.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},e.prototype.createTrack=function(e,t,n){var r={id:n||this.nextTrackID(),lastTimestamp:t,keypoints:dee([],e.keypoints,!0).map(function(e){return cee({},e)})};return void 0!==e.box&&(r.box=cee({},e.box)),r},e.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracks=this.tracks.filter(function(t){return!e.includes(t.id)})},e.prototype.reset=function(){this.tracks=[]},e}(),_te=function(e){function t(t){return e.call(this,t)||this}return see(t,e),t.prototype.computeSimilarity=function(e){var t=this;return 0===e.length||0===this.tracks.length?[[]]:e.map(function(e){return t.tracks.map(function(n){return t.iou(e,n)})})},t.prototype.iou=function(e,t){var n=Math.max(e.box.xMin,t.box.xMin),r=Math.max(e.box.yMin,t.box.yMin),a=Math.min(e.box.xMax,t.box.xMax),o=Math.min(e.box.yMax,t.box.yMax);if(n>=a||r>=o)return 0;var i=(a-n)*(o-r);return i/(e.box.width*e.box.height+t.box.width*t.box.height-i)},t}(Ate),Rte=function(e){function t(t){var n=e.call(this,t)||this;return n.keypointThreshold=t.keypointTrackerParams.keypointConfidenceThreshold,n.keypointFalloff=t.keypointTrackerParams.keypointFalloff,n.minNumKeyoints=t.keypointTrackerParams.minNumberOfKeypoints,n}return see(t,e),t.prototype.computeSimilarity=function(e){if(0===e.length||0===this.tracks.length)return[[]];for(var t=[],n=0,r=e;n<r.length;n++){for(var a=r[n],o=[],i=0,s=this.tracks;i<s.length;i++){var c=s[i];o.push(this.oks(a,c))}t.push(o)}return t},t.prototype.oks=function(e,t){for(var n=this.area(t.keypoints)+1e-6,r=0,a=0,o=0;o<e.keypoints.length;++o){var i=e.keypoints[o],s=t.keypoints[o];if(!(i.score<this.keypointThreshold||s.score<this.keypointThreshold)){a+=1;var c=Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2),l=2*this.keypointFalloff[o];r+=Math.exp(-1*c/(2*n*Math.pow(l,2)))}}return a<this.minNumKeyoints?0:r/a},t.prototype.area=function(e){var t=this,n=e.filter(function(e){return e.score>t.keypointThreshold}),r=Math.min.apply(Math,dee([1],n.map(function(e){return e.x}),!1)),a=Math.max.apply(Math,dee([0],n.map(function(e){return e.x}),!1)),o=Math.min.apply(Math,dee([1],n.map(function(e){return e.y}),!1));return(a-r)*(Math.max.apply(Math,dee([0],n.map(function(e){return e.y}),!1))-o)},t}(Ate);function Pte(e){switch(e){case Nte.BlazePose:return pee.reduce(function(e,t,n){return e[t]=n,e},{});case Nte.PoseNet:case Nte.MoveNet:return hee.reduce(function(e,t,n){return e[t]=n,e},{});default:throw new Error("Model ".concat(e," is not supported."))}}(Ote=Tte||(Tte={})).Keypoint="keypoint",Ote.BoundingBox="boundingBox",function(e){e.MoveNet="MoveNet",e.BlazePose="BlazePose",e.PoseNet="PoseNet"}(Nte||(Nte={}));Object.freeze({__proto__:null,getKeypointIndexBySide:function(e){switch(e){case Nte.BlazePose:return fee;case Nte.PoseNet:case Nte.MoveNet:return mee;default:throw new Error("Model ".concat(e," is not supported."))}},getAdjacentPairs:function(e){switch(e){case Nte.BlazePose:return yee;case Nte.PoseNet:case Nte.MoveNet:return gee;default:throw new Error("Model ".concat(e," is not supported."))}},getKeypointIndexByName:Pte});var Dte=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],Mte={modelType:"SinglePose.Lightning",enableSmoothing:!0},Fte={},Lte={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},zte={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},Bte={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function jte(e,t){var n,r,a,o;return e?t.width>t.height?(n=1,r=t.height/t.width,a=0,o=(t.width/2-t.height/2)/t.width):(n=t.width/t.height,r=1,a=(t.height/2-t.width/2)/t.height,o=0):t.width>t.height?(n=t.width/t.height,r=1,a=(t.height/2-t.width/2)/t.height,o=0):(n=1,r=t.height/t.width,a=0,o=(t.width/2-t.height/2)/t.width),{yMin:a,xMin:o,yMax:a+n,xMax:o+r,height:n,width:r}}function Wte(e,t){var n={maxTracks:e.maxTracks,maxAge:e.maxAge,minSimilarity:e.minSimilarity};return null!=t.maxTracks&&(n.maxTracks=t.maxTracks),null!=t.maxAge&&(n.maxAge=t.maxAge),null!=t.minSimilarity&&(n.minSimilarity=t.minSimilarity),n}var Ute=function(){function e(e,t){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=Pte(Nte.MoveNet),"SinglePose.Lightning"===t.modelType?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):"SinglePose.Thunder"===t.modelType&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel="MultiPose.Lightning"===t.modelType,this.multiPoseModel||(this.keypointFilter=new nte(Lte),this.cropRegionFilterYMin=new ete(.9),this.cropRegionFilterXMin=new ete(.9),this.cropRegionFilterYMax=new ete(.9),this.cropRegionFilterXMax=new ete(.9)),this.enableSmoothing=t.enableSmoothing,t.minPoseScore?this.minPoseScore=t.minPoseScore:this.minPoseScore=.25,t.multiPoseMaxDimension?this.multiPoseMaxDimension=t.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=t.enableTracking,this.multiPoseModel&&this.enableTracking&&(t.trackerType===Tte.Keypoint?this.tracker=new Rte(t.trackerConfig):t.trackerType===Tte.BoundingBox&&(this.tracker=new _te(t.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return e.prototype.runSinglePersonPoseModel=function(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o;return uee(this,function(i){switch(i.label){case 0:if(4!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||1!==t.shape[1]||17!==t.shape[2]||3!==t.shape[3])throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return"webgpu"===ZD()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=i.sent(),i.label=3;case 3:for(t.dispose(),r={keypoints:[],score:0},a=0,o=0;o<17;++o)r.keypoints[o]={y:n[3*o],x:n[3*o+1],score:n[3*o+2]},r.keypoints[o].score>.2&&(++a,r.score+=r.keypoints[o].score);return a>0&&(r.score/=a),[2,r]}})})},e.prototype.runMultiPersonPoseModel=function(e){return lee(this,void 0,void 0,function(){var t,n,r,a,o,i,s,c;return uee(this,function(l){switch(l.label){case 0:if(3!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||56!==t.shape[2])throw t.dispose(),new Error("Unexpected output shape from model: [".concat(t.shape,"]"));return"webgpu"===ZD()?[3,1]:(n=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:n=l.sent(),l.label=3;case 3:for(t.dispose(),r=[],a=n.length/56,o=0;o<a;++o)for(r[o]={keypoints:[]},i=56*o+51,r[o].box={yMin:n[i],xMin:n[i+1],yMax:n[i+2],xMax:n[i+3],width:n[i+3]-n[i+1],height:n[i+2]-n[i]},s=56*o+55,r[o].score=n[s],r[o].keypoints=[],c=0;c<17;++c)r[o].keypoints[c]={y:n[56*o+3*c],x:n[56*o+3*c+1],score:n[56*o+3*c+2]};return[2,r]}})})},e.prototype.estimatePoses=function(e,t,n){return void 0===t&&(t=Fte),lee(this,void 0,void 0,function(){var r,a,o,i,s,c;return uee(this,function(l){switch(l.label){case 0:return t=function(e){return null==e?Fte:cee({},e)}(t),null==e?(this.reset(),[2,[]]):(null==n?Wee(e)&&(n=1e6*e.currentTime):n*=1e3,r=Aee(e),a=Nee(r),o=oB(r,0),e instanceof lD||r.dispose(),i=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(o,a,n)]);case 1:return i=l.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(o,a,n)];case 3:i=l.sent(),l.label=4;case 4:for(s=0;s<i.length;++s)for(c=0;c<i[s].keypoints.length;++c)i[s].keypoints[c].name=hee[c],i[s].keypoints[c].y*=a.height,i[s].keypoints[c].x*=a.width;return[2,i]}})})},e.prototype.estimateSinglePose=function(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s=this;return uee(this,function(c){switch(c.label){case 0:return this.cropRegion||(this.cropRegion=jte(null==this.cropRegion,t)),r=XD(function(){var t=nW([[s.cropRegion.yMin,s.cropRegion.xMin,s.cropRegion.yMax,s.cropRegion.xMax]]),n=jB([1],"int32"),r=[s.modelInputResolution.height,s.modelInputResolution.width];return rF(MU.cropAndResize(e,t,n,r,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(r)];case 1:if(a=c.sent(),r.dispose(),a.score<this.minPoseScore)return this.reset(),[2,[]];for(o=0;o<a.keypoints.length;++o)a.keypoints[o].y=this.cropRegion.yMin+a.keypoints[o].y*this.cropRegion.height,a.keypoints[o].x=this.cropRegion.xMin+a.keypoints[o].x*this.cropRegion.width;return null!=n&&this.enableSmoothing&&(a.keypoints=this.keypointFilter.apply(a.keypoints,n,1)),i=function(e,t,n,r){for(var a={},o=0,i=hee;o<i.length;o++){var s=i[o];a[s]=[t[n[s]].y*r.height,t[n[s]].x*r.width]}if(function(e,t){return(e[t.left_hip].score>.2||e[t.right_hip].score>.2)&&(e[t.left_shoulder].score>.2||e[t.right_shoulder].score>.2)}(t,n)){var c=(a.left_hip[0]+a.right_hip[0])/2,l=(a.left_hip[1]+a.right_hip[1])/2,u=function(e,t,n,r,a){for(var o=["left_shoulder","right_shoulder","left_hip","right_hip"],i=0,s=0,c=0;c<o.length;c++)(p=Math.abs(r-n[o[c]][0]))>i&&(i=p),(f=Math.abs(a-n[o[c]][1]))>s&&(s=f);for(var l=0,u=0,d=0,h=Object.keys(n);d<h.length;d++){var p,f,m=h[d];e[t[m]].score<.2||((p=Math.abs(r-n[m][0]))>l&&(l=p),(f=Math.abs(a-n[m][1]))>u&&(u=f))}return[i,s,l,u]}(t,n,a,c,l),d=u[0],h=u[1],p=u[2],f=u[3],m=Math.max(1.9*h,1.9*d,1.2*p,1.2*f),g=[c-(m=Math.min(m,Math.max(l,r.width-l,c,r.height-c))),l-m];if(m>Math.max(r.width,r.height)/2)return jte(null==e,r);var y=2*m;return{yMin:g[0]/r.height,xMin:g[1]/r.width,yMax:(g[0]+y)/r.height,xMax:(g[1]+y)/r.width,height:(g[0]+y)/r.height-g[0]/r.height,width:(g[1]+y)/r.width-g[1]/r.width}}return jte(null==e,r)}(this.cropRegion,a.keypoints,this.keypointIndexByName,t),this.cropRegion=this.filterCropRegion(i),[2,[a]]}})})},e.prototype.estimateMultiplePoses=function(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h,p,f=this;return uee(this,function(m){switch(m.label){case 0:return t.width>t.height?(a=this.multiPoseMaxDimension,o=Math.round(this.multiPoseMaxDimension*t.height/t.width),r=MU.resizeBilinear(e,[o,a]),s=a,c=32*Math.ceil(o/32),i=JB(r,[[0,0],[0,c-o],[0,0],[0,0]])):(a=Math.round(this.multiPoseMaxDimension*t.width/t.height),o=this.multiPoseMaxDimension,r=MU.resizeBilinear(e,[o,a]),s=32*Math.ceil(a/32),c=o,i=JB(r,[[0,0],[0,0],[0,s-a],[0,0]])),r.dispose(),e.dispose(),l=rF(i,"int32"),i.dispose(),[4,this.runMultiPersonPoseModel(l)];case 1:for(u=m.sent(),l.dispose(),u=u.filter(function(e){return e.score>=f.minPoseScore}),h=0;h<u.length;++h)for(d=0;d<u[h].keypoints.length;++d)u[h].keypoints[d].y*=c/o,u[h].keypoints[d].x*=s/a;if(this.enableTracking&&(this.tracker.apply(u,n),this.enableSmoothing)){for(h=0;h<u.length;++h)this.keypointFilterMap.has(u[h].id)||this.keypointFilterMap.set(u[h].id,new nte(Lte)),u[h].keypoints=this.keypointFilterMap.get(u[h].id).apply(u[h].keypoints,n,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(e,t){p.has(t)||f.keypointFilterMap.delete(t)})}return[2,u]}})})},e.prototype.filterCropRegion=function(e){if(e){var t=this.cropRegionFilterYMin.apply(e.yMin),n=this.cropRegionFilterXMin.apply(e.xMin),r=this.cropRegionFilterYMax.apply(e.yMax),a=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:t,xMin:n,yMax:r,xMax:a,height:r-t,width:a-n}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},e.prototype.dispose=function(){this.moveNetModel.dispose()},e.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},e.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},e}();function Vte(e){return void 0===e&&(e=Mte),lee(this,void 0,void 0,function(){var t,n,r,a;return uee(this,function(o){switch(o.label){case 0:return t=function(e){var t,n=null==e?Mte:cee({},e);if(null==n.modelType)n.modelType="SinglePose.Lightning";else if(Dte.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(Dte));if(null==n.enableSmoothing&&(n.enableSmoothing=!0),null!=n.minPoseScore&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(null!=n.multiPoseMaxDimension&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if("MultiPose.Lightning"===n.modelType&&null==n.enableTracking&&(n.enableTracking=!0),"MultiPose.Lightning"===n.modelType&&!0===n.enableTracking)if(null==n.trackerType&&(n.trackerType=Tte.BoundingBox),n.trackerType===Tte.Keypoint)null!=n.trackerConfig?n.trackerConfig=function(e){var t=Wte(zte,e);return t.keypointTrackerParams=cee({},zte.keypointTrackerParams),null!=e.keypointTrackerParams&&(null!=e.keypointTrackerParams.keypointConfidenceThreshold&&(t.keypointTrackerParams.keypointConfidenceThreshold=e.keypointTrackerParams.keypointConfidenceThreshold),null!=e.keypointTrackerParams.keypointFalloff&&(t.keypointTrackerParams.keypointFalloff=e.keypointTrackerParams.keypointFalloff),null!=e.keypointTrackerParams.minNumberOfKeypoints&&(t.keypointTrackerParams.minNumberOfKeypoints=e.keypointTrackerParams.minNumberOfKeypoints)),t}(n.trackerConfig):n.trackerConfig=zte;else{if(n.trackerType!==Tte.BoundingBox)throw new Error("Tracker type not supported by MoveNet");null!=n.trackerConfig?n.trackerConfig=(t=n.trackerConfig,Wte(Bte,t)):n.trackerConfig=Bte}return n}(e),r=!0,t.modelUrl?(r="string"==typeof t.modelUrl&&t.modelUrl.indexOf("https://tfhub.dev")>-1,[4,d2(t.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=o.sent(),[3,4];case 2:return a=void 0,"SinglePose.Lightning"===t.modelType?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":"SinglePose.Thunder"===t.modelType?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":"MultiPose.Lightning"===t.modelType&&(a="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,d2(a,{fromTFHub:r})];case 3:n=o.sent(),o.label=4;case 4:return"webgl"===ZD()&&iA().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new Ute(n,t)]}})})}var Gte={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},Hte=["MobileNetV1","ResNet50"],Kte={MobileNetV1:[8,16],ResNet50:[16]},qte=[8,16,32],Xte={MobileNetV1:[.5,.75,1],ResNet50:[1]},Yte=[1,2,4],Qte={maxPoses:1,flipHorizontal:!1},Zte={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},$te=[-123.15,-115.9,-103.06];function Jte(e){return Math.floor(e/2)}var ene=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(Jte(e),e);)this.exchange(e,Jte(e)),e=Jte(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},e}();function tne(e,t,n,r,a,o){for(var i=o.shape,s=i[0],c=i[1],l=!0,u=Math.max(n-a,0),d=Math.min(n+a+1,s),h=u;h<d;++h){for(var p=Math.max(r-a,0),f=Math.min(r+a+1,c),m=p;m<f;++m)if(o.get(h,m,e)>t){l=!1;break}if(!l)break}return l}function nne(e){return lee(this,void 0,void 0,function(){return uee(this,function(t){return[2,Promise.all(e.map(function(e){return e.buffer()}))]})})}function rne(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+17)}}function ane(e,t,n){var r=rne(e.heatmapY,e.heatmapX,e.id,n),a=r.y,o=r.x;return{x:e.heatmapX*t+o,y:e.heatmapY*t+a}}function one(e,t,n,r){var a=n.x,o=n.y;return e.some(function(e){var n,i,s,c,l=e.keypoints;return n=o,i=a,(s=l[r].y-n)*s+(c=l[r].x-i)*c<=t})}var ine=hee.reduce(function(e,t,n){return e[t]=n,e},{}),sne=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(e){var t=e[0],n=e[1];return[ine[t],ine[n]]}),cne=sne.map(function(e){return e[1]}),lne=sne.map(function(e){return e[0]});function une(e,t,n){return e<t?t:e>n?n:e}function dne(e,t,n,r){return{y:une(Math.round(e.y/t),0,n-1),x:une(Math.round(e.x/t),0,r-1)}}function hne(e,t){return{x:e.x+t.x,y:e.y+t.y}}function pne(e,t,n,r,a,o,i,s){void 0===s&&(s=2);for(var c=r.shape,l=c[0],u=c[1],d={y:t.y,x:t.x},h=hne(d,function(e,t,n){var r=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,r+e)}}(e,dne(d,o,l,u),i)),p=0;p<s;p++){var f=dne(h,o,l,u),m=rne(f.y,f.x,n,a);h=hne({x:f.x*o,y:f.y*o},{x:m.x,y:m.y})}var g=dne(h,o,l,u),y=r.get(g.y,g.x,n);return{y:h.y,x:h.x,name:hee[n],score:y}}function fne(e,t,n,r,a,o){var i=t.shape[2],s=cne.length,c=new Array(i),l=e.part,u=e.score,d=ane(l,r,n);c[l.id]={score:u,name:hee[l.id],y:d.y,x:d.x};for(var h=s-1;h>=0;--h){var p=cne[h],f=lne[h];c[p]&&!c[f]&&(c[f]=pne(h,c[p],f,t,n,r,o))}for(h=0;h<s;++h)p=lne[h],f=cne[h],c[p]&&!c[f]&&(c[f]=pne(h,c[p],f,t,n,r,a));return c}function mne(e,t,n){return n.reduce(function(n,r,a){var o=r.y,i=r.x,s=r.score;return one(e,t,{y:o,x:i},a)||(n+=s),n},0)/n.length}function gne(e,t,n,r,a,o,i,s){return void 0===i&&(i=.5),void 0===s&&(s=20),lee(this,void 0,void 0,function(){var c,l,u,d,h,p,f,m,g,y,v,b;return uee(this,function(x){switch(x.label){case 0:return[4,nne([e,t,n,r])];case 1:for(c=x.sent(),l=c[0],u=c[1],d=c[2],h=c[3],p=[],f=function(e,t,n){for(var r=n.shape,a=r[0],o=r[1],i=r[2],s=new ene(a*o*i,function(e){return e.score}),c=0;c<a;++c)for(var l=0;l<o;++l)for(var u=0;u<i;++u){var d=n.get(c,l,u);d<e||tne(u,d,c,l,1,n)&&s.enqueue({score:d,part:{heatmapY:c,heatmapX:l,id:u}})}return s}(i,0,l),m=s*s;p.length<o&&!f.empty();)g=f.dequeue(),y=ane(g.part,a,u),one(p,m,y,g.part.id)||(v=fne(g,l,u,a,d,h),b=mne(p,m,v),p.push({keypoints:v,score:b}));return[2,p]}})})}function yne(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];switch(t.length){case 0:e="fn main() ";break;case 1:e="fn main(".concat(t[0]," : i32)");break;default:throw Error("Unreachable")}return e}var vne=function(){function e(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=j2(this.outputShape),this.dispatch=L2(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return e.prototype.getUserCode=function(){return"\n        ".concat(yne("index")," {\n          if (index < uniforms.size) {\n            let y = B[index * 2];\n            let x = B[index * 2 + 1];\n            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;\n            result[index] = A[outIndex];\n          }\n        }\n        ")},e}();var bne=function(){function e(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,2!==e.length||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var t=[e[0],1];this.dispatchLayout=j2(t),this.dispatch=L2(this.dispatchLayout,t,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return e.prototype.getUserCode=function(){return"\n    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {\n      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;\n      let outIndexX = outIndexY + uniforms.bShape.z;\n      let outY = i32(B[outIndexY]);\n      let outX = i32(B[outIndexX]);\n      return vec2<i32>(outY, outX);\n    }\n\n    ".concat(yne("index")," {\n      if (index < uniforms.size) {\n        let indexY = index * ").concat(this.supportedLastDimension,";\n        let indexX = indexY + 1;\n        let heatmapY = A[indexY];\n        let heatmapX = A[indexX];\n        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);\n        result[indexY] = f32(out[0]);\n        result[indexX] = f32(out[1]);\n      }\n    }\n    ")},e}();function xne(e){var t=e.shape,n=t[0],r=t[1],a=t[2];return XD(function(){var t,o,i=QL(e,[n*r,a]),s=NL(i,0),c=oB(cF(s,fF(r,"int32")),1),l=oB((t=s,o=r,XD(function(){var e=cF(t,fF(o,"int32"));return SF(t,lF(e,fF(o,"int32")))})),1);return JL([c,l],1)})}function wne(e,t,n){return XD(function(){var r=function(e,t){for(var n=[],r=0;r<hee.length;r++){var a=kne(e.get(r,0).valueOf(),e.get(r,1).valueOf(),r,t),o=a.x,i=a.y;n.push(i),n.push(o)}return nW(n,[hee.length,2])}(e,n);return iF(rF(lF(e.toTensor(),fF(t,"int32")),"float32"),r)})}function kne(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+hee.length)}}function Sne(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h;return uee(this,function(p){switch(p.label){case 0:return r=0,a=xne(e),[4,Promise.all([e.buffer(),t.buffer(),a.buffer()])];case 1:return o=p.sent(),i=o[0],s=o[1],c=o[2],[4,(l=wne(c,n,s)).buffer()];case 2:return u=p.sent(),d=Array.from(function(e,t){for(var n=t.shape[0],r=new Float32Array(n),a=0;a<n;a++){var o=t.get(a,0),i=t.get(a,1);r[a]=e.get(o,i,a)}return r}(i,c)),h=d.map(function(e,t){return r+=e,{y:u.get(t,0),x:u.get(t,1),score:e,name:hee[t]}}),a.dispose(),l.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function Cne(e,t,n){return lee(this,void 0,void 0,function(){var r,a,o;return uee(this,function(i){return r=xne(e),a=function(e,t,n){return XD(function(){var r=function(e,t){if(JD()instanceof K2)return function(e,t){var n=JD(),r=new bne(e.shape),a=n.runWebGPUProgram(r,[e,t],"float32");return qD().makeTensorFromTensorInfo(a)}(e,t);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}(e,n);return iF(rF(lF(e,fF(t,"int32")),"float32"),r)})}(r,n,t),o=function(e,t){if(JD()instanceof K2)return function(e,t){var n=JD(),r=new vne(t.shape),a=n.runWebGPUProgram(r,[e,t],"float32");return qD().makeTensorFromTensorInfo(a)}(e,t);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}(e,r),[2,[a,o]]})})}function Ine(e,t){return(e-1)%t==0}var Ene="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",Tne="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function Nne(e,t){return function(e,t){return(e-1)%t==0}(e,t)?e:Math.floor(e/t)*t+1}var One=function(){function e(e,t){this.posenetModel=e;var n=this.posenetModel.inputs[0].shape;EO(-1===n[1]&&-1===n[2],function(){return"Input shape [".concat(n[1],", ").concat(n[2],"] ")+"must both be equal to or -1"});var r,a,o=(r=t.inputResolution,a=t.outputStride,{height:Nne(r.height,a),width:Nne(r.width,a)});!function(e){EO(qte.indexOf(e)>=0,function(){return"outputStride of ".concat(e," is invalid. ")+"It must be either 8 or 16."})}(t.outputStride),function(e,t){EO(Ine(e.height,t),function(){return"height of ".concat(e.height," is invalid for output stride ")+"".concat(t,".")}),EO(Ine(e.width,t),function(){return"width of ".concat(e.width," is invalid for output stride ")+"".concat(t,".")})}(o,t.outputStride),this.inputResolution=o,this.outputStride=t.outputStride,this.architecture=t.architecture}return e.prototype.estimatePoses=function(e,t){return void 0===t&&(t=Qte),lee(this,void 0,void 0,function(){return uee(this,function(n){return[2,this.estimatePosesGPU(e,t,!1)]})})},e.prototype.estimatePosesGPU=function(e,t,n){return void 0===t&&(t=Qte),void 0===n&&(n=!1),lee(this,void 0,void 0,function(){var r,a,o,i,s,c,l,u,d,h,p,f,m,g,y,v,b,x;return uee(this,function(w){switch(w.label){case 0:return r=function(e){var t=e;if(null==t.maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(t.maxPoses,". Should be > 0."));if(t.maxPoses>1){if((t=cee(cee({},Zte),t)).scoreThreshold<0||t.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(t.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(t.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(t.nmsRadius,"."))}return t}(t),null==e?[2,n?[[],[]]:[]]:(this.maxPoses=r.maxPoses,a=Bee(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),o=a.imageTensor,i=a.padding,s="ResNet50"===this.architecture?iF(o,$te):zee(o,[-1,1]),c=this.posenetModel.predict(s),"ResNet50"===this.architecture?(l=Qj(c[2],[0]),u=Qj(c[3],[0]),d=Qj(c[0],[0]),h=Qj(c[1],[0])):(l=Qj(c[0],[0]),u=Qj(c[1],[0]),d=Qj(c[2],[0]),h=Qj(c[3],[0])),p=tz(u),1!==this.maxPoses?[3,5]:n?[4,Cne(p,l,this.outputStride)]:[3,2]);case 1:return m=w.sent(),y=m[0],g=m[1],f=[y,g],[3,4];case 2:return[4,Sne(p,l,this.outputStride)];case 3:y=w.sent(),f=[y],w.label=4;case 4:return[3,7];case 5:if(n)throw new Error("GPU renderer only supports single pose!");return[4,gne(p,l,d,h,this.outputStride,this.maxPoses,r.scoreThreshold,r.nmsRadius)];case 6:f=w.sent(),w.label=7;case 7:if(n){if(!0===r.flipHorizontal)throw new Error("flipHorizontal is not supported!");v=this.getCanvasInfo(Nee(e),this.inputResolution,i)}else x=Nee(e),b=function(e,t,n,r){var a=t.height,o=t.width,i=a/(n.height*(1-r.top-r.bottom)),s=o/(n.width*(1-r.left-r.right)),c=-r.top*n.height,l=-r.left*n.width;if(1===s&&1===i&&0===c&&0===l)return e;for(var u=0,d=e;u<d.length;u++)for(var h=0,p=d[u].keypoints;h<p.length;h++){var f=p[h];f.x=(f.x+l)*s,f.y=(f.y+c)*i}return e}(f,x,this.inputResolution,i),r.flipHorizontal&&(b=function(e,t){for(var n=0,r=e;n<r.length;n++)for(var a=0,o=r[n].keypoints;a<o.length;a++){var i=o[a];i.x=t.width-1-i.x}return e}(b,x));return o.dispose(),s.dispose(),YD(c),l.dispose(),u.dispose(),d.dispose(),h.dispose(),p.dispose(),[2,n?[f,v]:b]}})})},e.prototype.getCanvasInfo=function(e,t,n){var r=e.height,a=e.width,o=r/(t.height*(1-n.top-n.bottom)),i=a/(t.width*(1-n.left-n.right)),s=-n.top*t.height;return[-n.left*t.width,s,i,o,e.width,e.height]},e.prototype.dispose=function(){this.posenetModel.dispose()},e.prototype.reset=function(){},e}();function Ane(e){return void 0===e&&(e=Gte),lee(this,void 0,void 0,function(){var t,n,r,a,o;return uee(this,function(i){switch(i.label){case 0:return"ResNet50"!==(t=function(e){var t=e||Gte;if(null==t.architecture&&(t.architecture="MobileNetV1"),Hte.indexOf(t.architecture)<0)throw new Error("Invalid architecture ".concat(t.architecture,". ")+"Should be one of ".concat(Hte));if(null==t.inputResolution&&(t.inputResolution={height:257,width:257}),null==t.outputStride&&(t.outputStride=16),Kte[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride ".concat(t.outputStride,". ")+"Should be one of ".concat(Kte[t.architecture]," ")+"for architecture ".concat(t.architecture,"."));if(null==t.multiplier&&(t.multiplier=1),Xte[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier ".concat(t.multiplier,". ")+"Should be one of ".concat(Xte[t.architecture]," ")+"for architecture ".concat(t.architecture,"."));if(null==t.quantBytes&&(t.quantBytes=4),Yte.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(t.quantBytes,". ")+"Should be one of ".concat(Yte," ")+"for architecture ".concat(t.architecture,"."));if("MobileNetV1"===t.architecture&&32===t.outputStride&&1!==t.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return t}(e)).architecture?[3,2]:(s=t.outputStride,c=t.quantBytes,l="model-stride".concat(s,".json"),n=4===c?Tne+"float/"+l:Tne+"quant".concat(c,"/")+l,[4,d2(t.modelUrl||n)]);case 1:return r=i.sent(),[2,new One(r,t)];case 2:return a=function(e,t,n){var r={1:"100",.75:"075",.5:"050"},a="model-stride".concat(e,".json");return 4===n?Ene+"float/".concat(r[t],"/")+a:Ene+"quant".concat(n,"/").concat(r[t],"/")+a}(t.outputStride,t.multiplier,t.quantBytes),[4,d2(t.modelUrl||a)];case 3:return o=i.sent(),[2,new One(o,t)]}var s,c,l})})}var _ne={SINGLEPOSE_LIGHTNING:"SinglePose.Lightning",SINGLEPOSE_THUNDER:"SinglePose.Thunder",MULTIPOSE_LIGHTNING:"MultiPose.Lightning"};function Rne(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Pne(e){return Math.hypot(e.x,e.y)}function Dne(e,t){const n=Rne(t,e),r=-1*n.y/(Pne(n)||1);return 180*Math.acos(Math.min(1,Math.max(-1,r)))/Math.PI}function Mne(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return!!e&&(null!==(t=e.score)&&void 0!==t?t:1)>=n}function Fne(e){const t=function(e){const t=t=>["".concat(t,"_ear"),"".concat(t,"_eye"),"".concat(t,"_shoulder"),"".concat(t,"_elbow"),"".concat(t,"_wrist"),"".concat(t,"_hip")].reduce((t,n)=>{var r,a;return t+(null!==(r=null===(a=e[n])||void 0===a?void 0:a.score)&&void 0!==r?r:0)},0);return t("left")>t("right")?"left":"right"}(e),n="".concat(t,"_shoulder"),r="".concat(t,"_hip"),a="".concat(t,"_elbow"),o="".concat(t,"_wrist"),i="".concat(t,"_ear"),s="".concat(t,"_eye"),c=e[n],l=e[r],u=e[a],d=e[o],h=e[s],p=e[i],f=Mne(c)&&Mne(l)?function(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}(c,l):1,m={neck_flexion_deg:null,torso_upright_deg:null,elbow_angle_deg:null,wrist_extension_deg:null};if(Mne(p)&&Mne(c)?m.neck_flexion_deg=Dne(p,c):Mne(h)&&Mne(c)&&(m.neck_flexion_deg=Dne(h,c)),Mne(l)&&Mne(c)){const e=Dne(l,c);m.torso_upright_deg=90-Math.abs(e)}if(Mne(c)&&Mne(u)&&Mne(d)){m.elbow_angle_deg=function(e,t,n){const r=Rne(e,t),a=Rne(n,t),o=function(e,t){return e.x*t.x+e.y*t.y}(r,a)/(Pne(r)*Pne(a)||1);return 180*Math.acos(Math.min(1,Math.max(-1,o)))/Math.PI}(c,u,d);const e=Rne(d,u),t={x:1,y:0},n=(e.x*t.x+e.y*t.y)/(Pne(e)||1),r=180*Math.acos(Math.min(1,Math.max(-1,n)))/Math.PI;m.wrist_extension_deg=Math.max(0,r-0)}return{metrics:m,scale:f,side:t,visibility:[p,h,c,l,u,d].filter(e=>Mne(e)).length,totalNeeded:6}}const Lne=()=>{const[e,t]=(0,N.useState)(null),[n,r]=(0,N.useState)(!1),[a,o]=(0,N.useState)(null),[i,s]=(0,N.useState)(null),[c,l]=(0,N.useState)([]),u=(0,N.useRef)(null);return(0,F.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto",padding:"20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[(0,F.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,F.jsx)("h1",{style:{fontSize:"28px",fontWeight:"700",marginBottom:"8px",color:"#1f2937"},children:"ErgoWise Posture Analysis"}),(0,F.jsx)("p",{style:{color:"#6b7280",marginBottom:"16px"},children:"Upload a photo to get professional ergonomic assessment and recommendations"}),(0,F.jsx)("input",{type:"file",accept:"image/*",onChange:async function(e){var n;const a=null===(n=e.target.files)||void 0===n?void 0:n[0];a&&(t(URL.createObjectURL(a)),await async function(e){r(!0);try{await(t="webgl",OD.setBackend(t)),await OD.ready();const n=await function(e,t){return lee(this,void 0,void 0,function(){var n,r;return uee(this,function(a){switch(e){case Nte.PoseNet:return[2,Ane(t)];case Nte.BlazePose:if(r=void 0,null!=(n=t)){if("tfjs"===n.runtime)return[2,Ete(t)];if("mediapipe"===n.runtime)return[2,Tee(t)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case Nte.MoveNet:return[2,Vte(t)];default:throw new Error("".concat(e," is not a supported model name."))}})})}(Nte.MoveNet,{modelType:_ne.SINGLEPOSE_LIGHTNING}),a=new window.Image;a.src=URL.createObjectURL(e),await new Promise(e=>{a.onload=()=>e()});const i=await n.estimatePoses(a);if(!i.length)return r(!1),void s({detected:!1,message:"No person detected in image"});const c=function(e){const t={},n=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"];return e.keypoints.forEach((e,r)=>{var a,o;const i=(null===e||void 0===e?void 0:e.name)||n[r]||String(r);t[i]={x:e.x,y:e.y,score:null!==(a=null!==(o=e.score)&&void 0!==o?o:e.confidence)&&void 0!==a?a:1}}),t}(i[0]);!function(e,t){const n=u.current;if(!n)return;n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0),r.lineWidth=3,r.strokeStyle="#00bcd4",r.fillStyle="#00bcd4";[["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["right_shoulder","right_hip"],["left_shoulder","left_hip"],["right_hip","right_knee"],["right_knee","right_ankle"],["left_hip","left_knee"],["left_knee","left_ankle"],["right_shoulder","left_shoulder"],["right_hip","left_hip"],["nose","right_eye"],["nose","left_eye"],["right_eye","right_ear"],["left_eye","left_ear"]].forEach(e=>{let[n,a]=e;const o=t[n],i=t[a];Mne(o)&&Mne(i)&&(r.beginPath(),r.moveTo(o.x,o.y),r.lineTo(i.x,i.y),r.stroke())}),Object.values(t).forEach(e=>{Mne(e)&&(r.beginPath(),r.arc(e.x,e.y,4,0,2*Math.PI),r.fill())})}(a,c);const{metrics:d,visibility:h,totalNeeded:p}=Fne(c),f=function(e,t,n){if(t<Math.ceil(.6*n))return{score:null,quality:"insufficient_view"};let r=100;const a=(e,t,n)=>Math.max(t,Math.min(n,e));if(null!=e.neck_flexion_deg){const t=e.neck_flexion_deg;r-=a(t<=10?0:t<=20?1*(t-10):10+.75*(t-20),0,25)}if(null!=e.torso_upright_deg){const t=90-e.torso_upright_deg;r-=a(t<=10?0:1.2*(t-10),0,25)}if(null!=e.elbow_angle_deg){const t=e.elbow_angle_deg;r-=a(.8*(t<90?90-t:t>110?t-110:0),0,20)}if(null!=e.wrist_extension_deg){const t=e.wrist_extension_deg;r-=a(t<=15?0:.5*(t-15),0,10)}return{score:Math.round(a(r,0,100)),quality:"ok"}}(d,h,p),m=function(e){const t=[],n=[],r=[],{neck_flexion_deg:a,torso_upright_deg:o,elbow_angle_deg:i,shoulder_asymmetry:s,head_tilt_deg:c}=e;if(null!=c&&c<=8&&t.push("Head Position: Excellent cervical alignment with minimal forward head posture"),null!=o&&o>=80&&t.push("Spinal Alignment: Good torso positioning with proper vertical alignment"),null!=s&&s<=10&&t.push("Shoulder Balance: Well-balanced shoulder height indicating good upper body symmetry"),null!=i&&i>=85&&i<=105&&t.push("Arm Position: Optimal elbow angle for ergonomic workspace setup"),null!=c&&c>8){const e=c>15?"significantly":c>12?"moderately":"slightly";n.push("Head & Neck: Your head is ".concat(e," tilted forward (").concat(c.toFixed(1),"\xb0), which can strain cervical vertebrae"))}if(null!=a&&a>15){const e=a>25?"significantly":a>20?"moderately":"slightly";n.push("Neck Flexion: ".concat(e," forward neck positioning (").concat(a.toFixed(1),"\xb0) indicating tech neck syndrome"))}null!=o&&o<75&&n.push("Torso Position: Your upper body is leaning forward, affecting spinal curves (".concat((90-o).toFixed(1),"\xb0 deviation)")),null!=s&&s>15&&n.push("Shoulder Asymmetry: Uneven shoulder height detected, indicating muscle imbalance"),null!=i&&(i<80||i>120)&&n.push("Arm Position: Elbow angle (".concat(i.toFixed(1),"\xb0) outside optimal ergonomic range")),null!=c&&c>8&&(r.push("Monitor Height: Raise your monitor so the top of the screen is at or slightly below eye level"),r.push("Chin Tucks: Perform gentle chin tuck exercises (hold 5 seconds, repeat 10 times) hourly")),null!=a&&a>15&&(r.push("Neck Support: Use a document holder to avoid looking down at papers"),r.push("Stretching: Perform upper trap stretches and neck rotations every 30 minutes")),null!=o&&o<75&&(r.push("Chair Adjustment: Ensure your backrest supports your natural lumbar curve"),r.push("Core Strengthening: Practice drawing your belly button gently toward your spine")),null!=s&&s>15&&(r.push("Workspace Setup: Adjust your desk height and armrests to support balanced shoulders"),r.push("Shoulder Exercises: Perform backward shoulder rolls (10 reps) every 30 minutes")),null!=i&&(i<80||i>120)&&(r.push("Keyboard Position: Adjust chair and desk height for 90\xb0 elbow angle"),r.push("Arm Support: Use adjustable armrests to maintain relaxed shoulder position")),0===t.length&&t.push("Posture Awareness: You're taking proactive steps to monitor and improve your ergonomic health"),0===n.length&&n.push("Minor Adjustments: Small refinements to your setup could optimize comfort and prevent fatigue"),0===r.length&&r.push("Maintenance: Continue regular posture checks and take movement breaks every 30-45 minutes");let l=100;if(null!=c&&c>8&&(l-=Math.min(20,1.2*c)),null!=a&&a>15&&(l-=Math.min(15,.8*(a-15))),null!=o&&o<80&&(l-=Math.min(20,1.5*(80-o))),null!=s&&s>15&&(l-=Math.min(15,.5*(s-15))),null!=i&&(i<80||i>120)){const e=i<80?80-i:i-120;l-=Math.min(10,.3*e)}return l=Math.max(0,Math.round(l)),{professional_analysis:{good_observations:t,areas_to_improve:n,recommendations:r},posture_score:l,grade:l>=90?"Excellent":l>=75?"Good":l>=60?"Fair":"Needs Improvement",grade_color:l>=90?"#10b981":l>=75?"#3b82f6":l>=60?"#f59e0b":"#ef4444"}}(d),g=null!==f.score?f.score:m.posture_score,y=null!==f.score?f.score>=85?"Excellent":f.score>=75?"Good":f.score>=65?"Fair":"Needs Improvement":m.grade,v=null!==f.score?f.score>=85?"#059669":f.score>=75?"#3b82f6":f.score>=65?"#f59e0b":"#dc2626":m.grade_color;o(d),l(function(e){const t=[],{neck_flexion_deg:n,torso_upright_deg:r,elbow_angle_deg:a,wrist_extension_deg:o}=e;return null!=n&&(n>20?t.push("Raise monitor 5\u20138 cm and do chin-tuck stretches. Keep ears stacked above shoulders."):n>10&&t.push("Lift monitor slightly and sit tall with neutral neck.")),null!=r&&r<80&&t.push("Increase lumbar support and sit back fully against the backrest."),null!=a&&(a<90||a>110)&&t.push("Adjust chair/desk so elbows stay ~90\u2013100\xb0. Bring keyboard closer."),null!=o&&o>15&&t.push("Lower keyboard or add wrist rest to keep wrists neutral."),t.length||t.push("Nice posture! Keep taking micro\u2011breaks every 30\u201345 minutes."),t.slice(0,3)}(d)),s({detected:!0,message:"insufficient_view"===f.quality?"Analysis completed - Limited visibility detected. For best results, ensure full side profile is visible.":"Analysis completed using advanced AI pose detection with comprehensive ergonomic assessment",metrics:d,posture_score:g,grade:y,grade_color:v,quality:f.quality,visibility_info:"".concat(h,"/").concat(p," key points detected"),professional_analysis:m.professional_analysis})}catch(n){console.error("Local analysis failed:",n),s({detected:!1,message:"Local analysis failed: ".concat(n)})}var t;r(!1)}(a))},style:{padding:"12px",border:"2px dashed #d1d5db",borderRadius:"8px",backgroundColor:"#f9fafb",width:"100%",cursor:"pointer"}})]}),n&&(0,F.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#6b7280"},children:(0,F.jsx)("p",{children:"Analyzing posture..."})}),(0,F.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"350px 1fr",gap:"24px",alignItems:"start"},children:[e&&(0,F.jsx)("div",{style:{position:"sticky",top:"20px",maxWidth:"350px"},children:(0,F.jsxs)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",padding:"16px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},children:[(0,F.jsx)("canvas",{ref:u,style:{width:"100%",maxWidth:"318px",height:"auto",borderRadius:"12px",display:"block"}}),(0,F.jsxs)("div",{style:{marginTop:"12px",padding:"8px 12px",backgroundColor:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"12px",color:"#64748b",textAlign:"center"},children:[(0,F.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:"\ud83d\udcf8 AI Analysis"}),(0,F.jsx)("div",{children:"\ud83d\udd04 Real-time Processing"})]})]})}),i&&(0,F.jsx)("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb",overflow:"hidden"},children:i.detected?(0,F.jsxs)(F.Fragment,{children:[void 0!==i.posture_score&&(0,F.jsxs)("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"24px",textAlign:"center",color:"white"},children:[(0,F.jsxs)("div",{style:{fontSize:"48px",fontWeight:"700",marginBottom:"8px",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:[i.posture_score,"/100"]}),(0,F.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",opacity:.9},children:i.grade||"Assessment Complete"})]}),(0,F.jsxs)("div",{style:{padding:"24px"},children:[i.professional_analysis&&(0,F.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,F.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,F.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#059669",display:"flex",alignItems:"center",gap:"8px"},children:"\u2705 Good Observations"}),(0,F.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:i.professional_analysis.good_observations.map((e,t)=>(0,F.jsx)("li",{style:{padding:"12px 16px",marginBottom:"8px",backgroundColor:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:"8px",lineHeight:"1.6",fontSize:"14px"},children:e},t))})]}),(0,F.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,F.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#dc2626",display:"flex",alignItems:"center",gap:"8px"},children:"\u26a0\ufe0f Areas to Improve"}),(0,F.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:i.professional_analysis.areas_to_improve.map((e,t)=>(0,F.jsx)("li",{style:{padding:"12px 16px",marginBottom:"8px",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",lineHeight:"1.6",fontSize:"14px"},children:e},t))})]}),(0,F.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,F.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"12px",color:"#2563eb",display:"flex",alignItems:"center",gap:"8px"},children:"\ud83d\udca1 Recommendations"}),(0,F.jsx)("div",{style:{background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",border:"1px solid #93c5fd",borderRadius:"12px",padding:"20px"},children:i.professional_analysis.recommendations.map((e,t)=>(0,F.jsxs)("div",{style:{padding:"16px 20px",marginBottom:t===i.professional_analysis.recommendations.length-1?"0":"12px",backgroundColor:"#ffffff",border:"1px solid #e0e7ff",borderRadius:"8px",lineHeight:"1.7",fontSize:"15px",fontWeight:"500",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)"},children:[(0,F.jsxs)("span",{style:{color:"#1e40af",fontWeight:"600",marginRight:"8px"},children:[t+1,"."]}),e]},t))})]})]}),(0,F.jsxs)("div",{style:{borderTop:"1px solid #e5e7eb",paddingTop:"20px",backgroundColor:"#f8fafc",margin:"0 -24px -24px -24px",padding:"20px 24px"},children:[a&&(0,F.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,F.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#374151"},children:"\ud83d\udcca Technical Metrics"}),(0,F.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"8px"},children:Object.entries(a).map(e=>{let[t,n]=e;return(0,F.jsxs)("div",{style:{padding:"8px 12px",backgroundColor:"#ffffff",borderRadius:"6px",border:"1px solid #e5e7eb",textAlign:"center"},children:[(0,F.jsx)("div",{style:{fontSize:"11px",color:"#6b7280",fontWeight:"500"},children:t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}),(0,F.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"#111827"},children:null==n?"N/A":n.toFixed(1)+"\xb0"})]},t)})})]}),c.length>0&&(0,F.jsxs)("div",{children:[(0,F.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#374151"},children:"\u26a1 Quick Tips"}),(0,F.jsx)("div",{style:{backgroundColor:"#ffffff",padding:"16px",borderRadius:"8px",border:"1px solid #e5e7eb"},children:(0,F.jsx)("ul",{style:{listStyle:"disc",paddingLeft:"20px",color:"#6b7280",margin:0},children:c.map((e,t)=>(0,F.jsx)("li",{style:{marginBottom:"6px",lineHeight:"1.5",fontSize:"13px"},children:e},t))})})]}),(0,F.jsx)("p",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"16px",fontStyle:"italic",textAlign:"center",margin:"16px 0 0 0"},children:i.message})]})]})]}):(0,F.jsxs)("div",{style:{textAlign:"center",padding:"60px 40px",color:"#6b7280"},children:[(0,F.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\ud83d\ude14"}),(0,F.jsx)("p",{style:{color:"#dc2626",fontSize:"16px",fontWeight:"500"},children:i.message||"Analysis failed"})]})})]})]})},zne=["/logo192.png","/logo512.png",'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect width="24" height="24" fill="%23fb923c"/></svg>','data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect width="24" height="24" fill="%23ea580c"/></svg>'];function Bne(e){let{size:t=36}=e;const{user:n,updateUser:r}=U();return(0,F.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:zne.map((e,a)=>(0,F.jsx)("button",{onClick:()=>{r({avatar:e})},style:{border:"none",background:"transparent",padding:0,cursor:"pointer"},children:(0,F.jsx)("img",{src:e,alt:"avatar-".concat(a),width:t,height:t,style:{borderRadius:"50%",border:(null===n||void 0===n?void 0:n.avatar)===e?"2px solid var(--color-primary)":"2px solid transparent"}})},a))})}const jne=ke("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Wne=ke("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Une=ke("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Vne=ke("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Gne=ke("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Hne=ke("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Kne=ke("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function qne(e){var t;let n,{onQuickAction:r,activeTab:a,setActiveTab:o}=e,i=!1;try{const e=U();n=null===e||void 0===e?void 0:e.user,i=!0}catch(Qne){n=void 0,i=!1}const s=[{id:"assessment",label:"Quick Assessment",icon:(0,F.jsx)(Ne,{size:18}),description:"Start 2-min health check",color:"var(--color-primary)"},{id:"break",label:"Start Break",icon:(0,F.jsx)(jne,{size:18}),description:"Take a wellness break",color:"var(--color-accent)"}],c=[{id:"Dashboard",icon:(0,F.jsx)(Wne,{size:18}),label:"Dashboard"},{id:"Assessment",icon:(0,F.jsx)(Ne,{size:18}),label:"Assessment"},{id:"Analytics",icon:(0,F.jsx)(Une,{size:18}),label:"Analytics"},{id:"Break Timer",icon:(0,F.jsx)(Vne,{size:18}),label:"Break Timer"},{id:"Posture",icon:(0,F.jsx)(Ne,{size:18}),label:"Posture"}];return(0,F.jsxs)("div",{style:{width:280,background:"var(--color-surface)",borderRadius:20,padding:24,boxShadow:"var(--shadow-lg)",border:"1px solid var(--color-surface-alt2)",height:"fit-content",position:"sticky",top:32},children:[(0,F.jsxs)("div",{style:{marginBottom:32},children:[(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[(0,F.jsx)(Gne,{size:20,color:"var(--color-primary)"}),(0,F.jsx)("h3",{style:{fontSize:16,fontWeight:600,color:"var(--color-primary)",margin:0},children:"Quick Actions"})]}),(0,F.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:s.map(e=>(0,F.jsxs)("button",{onClick:()=>r(e.id),style:{display:"flex",alignItems:"center",gap:12,background:"linear-gradient(135deg, var(--color-surface-alt), var(--color-surface-alt2))",border:"1px solid var(--color-primary)",borderRadius:12,padding:"16px 20px",cursor:"pointer",transition:"all 0.2s",textAlign:"left",width:"100%"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 16px rgba(234,88,12,0.2)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,F.jsx)("div",{style:{color:e.color},children:e.icon}),(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"var(--color-text)",marginBottom:2},children:e.label}),(0,F.jsx)("div",{style:{fontSize:12,color:"var(--color-text-soft)"},children:e.description})]})]},e.id))})]}),(0,F.jsxs)("div",{children:[(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[(0,F.jsx)(Hne,{size:20,color:"var(--color-primary)"}),(0,F.jsx)("h3",{style:{fontSize:16,fontWeight:600,color:"var(--color-primary)",margin:0},children:"Navigation"})]}),(0,F.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:c.map(e=>(0,F.jsxs)("button",{onClick:()=>o(e.id),style:{display:"flex",alignItems:"center",gap:12,background:a===e.id?"var(--color-primary)":"var(--color-surface-alt)",color:a===e.id?"#fff":"var(--color-text)",border:"none",borderRadius:10,padding:"12px 16px",cursor:"pointer",transition:"all 0.2s",textAlign:"left",width:"100%",fontWeight:a===e.id?600:500,fontSize:14},onMouseOver:t=>{a!==e.id&&(t.currentTarget.style.background="var(--color-surface-alt2)")},onMouseOut:t=>{a!==e.id&&(t.currentTarget.style.background="var(--color-surface-alt)")},children:[(0,F.jsx)("div",{style:{color:a===e.id?"#fff":"var(--color-primary)"},children:e.icon}),e.label]},e.id))})]}),(0,F.jsxs)("div",{style:{marginTop:24,padding:16,background:"var(--color-surface-alt)",borderRadius:12,border:"1px solid var(--color-surface-alt2)"},children:[(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,F.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--color-surface)"},children:null!==(t=n)&&void 0!==t&&t.avatar?(0,F.jsx)("img",{src:n.avatar,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,F.jsx)(Kne,{size:20,color:"var(--color-primary)"})}),(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{style:{fontSize:14,fontWeight:600,color:"var(--color-text)",marginBottom:2},children:"Quick Stats"}),(0,F.jsx)("div",{style:{fontSize:12,color:"var(--color-text-soft)"},children:"7-day streak \u2022 82% wellness"})]})]}),i&&(0,F.jsx)("div",{style:{marginTop:12},children:(0,F.jsx)(Bne,{size:32})})]})]})}const Xne=function(){const[e,t]=(0,N.useState)("Dashboard"),[n,r]=(0,N.useState)(0);let a,o=()=>{};try{var i;const e=U();a=null===e||void 0===e?void 0:e.user,o=null!==(i=null===e||void 0===e?void 0:e.logout)&&void 0!==i?i:()=>{}}catch(Qne){a=void 0,o=()=>{}}let s=(e,t,n)=>{};try{const e=X(),t=null===e||void 0===e?void 0:e.addToast;t&&(s=t)}catch(Qne){}let c=()=>{},l=!1;const[u,d]=(0,N.useState)(()=>{try{return localStorage.getItem("ergowise:accent")||"var(--color-accent, var(--brand-primary))"}catch(e){return"var(--color-accent, var(--brand-primary))"}});try{var h,p;const e=Be();c=null!==(h=null===e||void 0===e?void 0:e.toggleTheme)&&void 0!==h?h:c,l=null!==(p=null===e||void 0===e?void 0:e.isDark)&&void 0!==p?p:l}catch(Qne){}return(0,F.jsxs)("div",{style:{minHeight:"100vh",background:"var(--gradient-bg)",fontFamily:"Segoe UI, Arial, sans-serif",padding:"24px"},children:[!a&&(0,F.jsx)(de,{}),a&&(0,F.jsxs)("div",{style:{display:"flex",gap:24,maxWidth:1400,margin:"0 auto"},children:[(0,F.jsx)(qne,{onQuickAction:e=>{"assessment"===e?(t("Assessment"),s("Starting your ergonomic assessment...","info")):"break"===e&&(t("Break Timer"),r(e=>e+1),s("Time for a healthy break! Break timer started.","success"))},activeTab:e,setActiveTab:t}),(0,F.jsxs)("div",{style:{flex:1},children:[(0,F.jsxs)("div",{style:{background:"var(--color-surface)",borderRadius:20,padding:20,paddingLeft:32,marginBottom:24,boxShadow:"var(--shadow-lg)",border:"1px solid var(--color-surface-alt2)",position:"relative"},children:[(0,F.jsxs)("div",{style:{position:"absolute",top:16,right:16,display:"flex",gap:8,alignItems:"center"},children:[(0,F.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:"var(--color-text-soft)",background:"var(--color-surface-alt2)",padding:"4px 8px",borderRadius:8,border:"1px solid var(--color-surface-alt2)"},children:[(0,F.jsx)("span",{children:"Accent"}),(0,F.jsx)("input",{type:"color",value:u,onChange:e=>(e=>{d(e);try{localStorage.setItem("ergowise:accent",e)}catch(t){}document.documentElement.style.setProperty("--color-primary",e),document.documentElement.style.setProperty("--color-accent",e),s("Accent color updated","success")})(e.target.value),style:{width:28,height:28,border:"none",background:"transparent",cursor:"pointer",padding:0},"aria-label":"Select accent color"})]}),(0,F.jsxs)("button",{onClick:()=>{c(),s("Switched to ".concat(l?"light":"dark"," mode"),"info")},style:{background:"var(--color-surface-alt2)",border:"1px solid var(--color-primary)",padding:"8px 12px",borderRadius:12,display:"flex",alignItems:"center",gap:6,cursor:"pointer",fontSize:14,fontWeight:600,color:"var(--color-primary)"},"aria-label":"Toggle theme",children:[l?(0,F.jsx)(Me,{size:16}):(0,F.jsx)(Fe,{size:16}),l?"Light":"Dark"]}),(0,F.jsx)("button",{onClick:()=>{o(),s("You have been signed out successfully.","info")},style:{background:"var(--color-primary)",color:"#fff",padding:"8px 12px",borderRadius:12,border:"none",cursor:"pointer",fontWeight:600,fontSize:14,display:"flex",alignItems:"center",gap:6},children:"Sign Out"})]}),(0,F.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,F.jsx)(De,{size:56,showWordmark:!0,tagline:"Personalized wellness assistant"}),(0,F.jsxs)("div",{children:[(0,F.jsxs)("h1",{style:{fontSize:24,margin:0,background:"linear-gradient(90deg,var(--color-primary), var(--brand-accent))",WebkitBackgroundClip:"text",color:"transparent"},children:["Welcome",a?", ".concat(a.name):""]}),(0,F.jsx)("p",{style:{margin:"6px 0 0",color:"var(--color-text-soft)",fontSize:14},children:"Optimize your workspace health with real-time posture insights."})]})]})]}),"Dashboard"===e&&(0,F.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:24},children:[(0,F.jsx)(fO,{}),(0,F.jsx)(mO,{}),(0,F.jsx)(gO,{}),(0,F.jsx)(yO,{}),(0,F.jsx)(vO,{score:82})]}),"Assessment"===e&&(0,F.jsx)(Pe,{}),"Break Timer"===e&&(0,F.jsx)(Ae,{startTrigger:n}),"Posture"===e&&(0,F.jsx)(Lne,{})]})]})]})},Yne=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then(t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:o,getTTFB:i}=t;n(e),r(e),a(e),o(e),i(e)})};A.createRoot(document.getElementById("root")).render((0,F.jsx)(N.StrictMode,{children:(0,F.jsx)(ze,{children:(0,F.jsx)(H,{children:(0,F.jsx)(W,{children:(0,F.jsx)(Xne,{})})})})})),Yne()})()})();
//# sourceMappingURL=main.8aa49d08.js.map